<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Thermal Convection</title>
    <style>
        body { margin: 0; overflow: hidden; background: #000; font-family: Arial; }
        canvas { display: block; }
        .info { position: absolute; top: 20px; left: 20px; color: #ffaa00; background: rgba(0,0,0,0.9); padding: 15px; border-radius: 10px; }
    </style>
</head>
<body>
    <div class="info">
        <h2>Thermal Convection</h2>
        <p>Hot fluid rises, cool fluid sinks</p>
        <p>Creates convection cells</p>
        <p>Natural heat transfer mechanism</p>
    </div>
    <canvas id="canvas"></canvas>
    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        class FluidParticle {
            constructor() {
                this.x = Math.random() * canvas.width;
                this.y = Math.random() * canvas.height;
                this.temperature = this.getAmbientTemp();
                this.trail = [];
            }

            getAmbientTemp() {
                // Hot at bottom, cold at top
                const normalizedY = this.y / canvas.height;
                return 1 - normalizedY; // 1 = hot, 0 = cold
            }

            update() {
                const bottomHeat = canvas.height - 100;
                const topCool = 100;

                // Heat from bottom
                if (this.y > bottomHeat) {
                    this.temperature += 0.02;
                }

                // Cool from top
                if (this.y < topCool) {
                    this.temperature -= 0.02;
                }

                // Gradually equilibrate with ambient
                const ambientTemp = this.getAmbientTemp();
                this.temperature += (ambientTemp - this.temperature) * 0.01;

                // Buoyancy: hot rises, cold sinks
                const buoyancy = (this.temperature - 0.5) * 2;

                // Convection cells - create circular patterns
                const cellWidth = 200;
                const cellCenter = Math.floor(this.x / cellWidth) * cellWidth + cellWidth / 2;
                const distFromCenter = (this.x - cellCenter) / cellWidth;

                let vx = -distFromCenter * 2;
                let vy = -buoyancy * 3;

                this.x += vx;
                this.y += vy;

                // Wrap around
                if (this.x < 0) this.x = canvas.width;
                if (this.x > canvas.width) this.x = 0;
                if (this.y < 0) this.y = canvas.height;
                if (this.y > canvas.height) this.y = 0;

                this.trail.push({x: this.x, y: this.y, temp: this.temperature});
                if (this.trail.length > 20) this.trail.shift();
            }

            draw() {
                // Trail
                if (this.trail.length > 1) {
                    ctx.beginPath();
                    this.trail.forEach((p, i) => {
                        if (i === 0) ctx.moveTo(p.x, p.y);
                        else ctx.lineTo(p.x, p.y);
                    });

                    const hue = this.temperature * 60; // 0 = blue, 60 = yellow/red
                    ctx.strokeStyle = `hsla(${hue}, 100%, 50%, 0.4)`;
                    ctx.lineWidth = 2;
                    ctx.stroke();
                }

                // Particle
                ctx.beginPath();
                ctx.arc(this.x, this.y, 3, 0, Math.PI * 2);
                const hue = this.temperature * 60;
                ctx.fillStyle = `hsl(${hue}, 100%, 50%)`;
                ctx.fill();
            }
        }

        const particles = Array.from({length: 300}, () => new FluidParticle());

        function drawHeatSource() {
            // Bottom heat source
            const gradient = ctx.createLinearGradient(0, canvas.height - 50, 0, canvas.height);
            gradient.addColorStop(0, 'rgba(255, 100, 0, 0)');
            gradient.addColorStop(1, 'rgba(255, 100, 0, 0.6)');

            ctx.fillStyle = gradient;
            ctx.fillRect(0, canvas.height - 50, canvas.width, 50);

            ctx.fillStyle = '#ff6600';
            ctx.font = 'bold 16px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('HEAT SOURCE', canvas.width / 2, canvas.height - 20);

            // Top cooling
            const coolGradient = ctx.createLinearGradient(0, 0, 0, 50);
            coolGradient.addColorStop(0, 'rgba(100, 150, 255, 0.6)');
            coolGradient.addColorStop(1, 'rgba(100, 150, 255, 0)');

            ctx.fillStyle = coolGradient;
            ctx.fillRect(0, 0, canvas.width, 50);

            ctx.fillStyle = '#6496ff';
            ctx.font = 'bold 16px Arial';
            ctx.fillText('COOLING', canvas.width / 2, 30);
        }

        function draw() {
            ctx.fillStyle = 'rgba(0, 0, 0, 0.05)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            drawHeatSource();

            particles.forEach(p => {
                p.update();
                p.draw();
            });
        }

        function animate() {
            draw();
            requestAnimationFrame(animate);
        }

        animate();
    </script>
</body>
</html>