<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Foucault Pendulum Precession - Scientific Visualizations</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #0f0f23 100%);
            min-height: 100vh;
            color: #e0e0e0;
            overflow-x: hidden;
        }

        .back-link {
            position: fixed;
            top: 20px;
            left: 20px;
            color: #81d4fa;
            text-decoration: none;
            font-size: 14px;
            opacity: 0.8;
            z-index: 100;
            background: rgba(0,0,0,0.3);
            padding: 8px 16px;
            border-radius: 20px;
            transition: all 0.3s;
        }

        .back-link:hover {
            opacity: 1;
            background: rgba(0,0,0,0.5);
        }

        header {
            text-align: center;
            padding: 60px 20px 20px;
        }

        h1 {
            font-size: 2rem;
            margin-bottom: 8px;
            background: linear-gradient(135deg, #81d4fa, #4fc3f7);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .subtitle {
            color: #b3e5fc;
            font-size: 1rem;
        }

        .container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
            padding: 20px;
            max-width: 1400px;
            margin: 0 auto;
        }

        .panel {
            background: rgba(0,0,0,0.3);
            border-radius: 16px;
            padding: 20px;
            border: 1px solid rgba(129, 212, 250, 0.2);
        }

        .main-panel {
            flex: 1;
            min-width: 500px;
        }

        .side-panel {
            width: 350px;
        }

        .panel-title {
            font-size: 1rem;
            color: #81d4fa;
            margin-bottom: 15px;
            text-align: center;
        }

        canvas {
            display: block;
            margin: 0 auto;
            border-radius: 8px;
        }

        .controls {
            width: 320px;
        }

        .control-group {
            margin-bottom: 18px;
        }

        .control-group label {
            display: block;
            font-size: 0.85rem;
            color: #b3e5fc;
            margin-bottom: 8px;
        }

        .control-group input[type="range"] {
            width: 100%;
            height: 6px;
            background: rgba(129, 212, 250, 0.2);
            border-radius: 3px;
            outline: none;
            -webkit-appearance: none;
        }

        .control-group input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 16px;
            height: 16px;
            background: #81d4fa;
            border-radius: 50%;
            cursor: pointer;
        }

        .btn-group {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .btn {
            flex: 1;
            padding: 10px;
            background: rgba(129, 212, 250, 0.2);
            border: 1px solid rgba(129, 212, 250, 0.4);
            color: #b3e5fc;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s;
        }

        .btn:hover {
            background: rgba(129, 212, 250, 0.3);
        }

        .btn.active {
            background: rgba(129, 212, 250, 0.4);
            border-color: #81d4fa;
        }

        .stats {
            background: rgba(0,0,0,0.2);
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
        }

        .stat-row {
            display: flex;
            justify-content: space-between;
            font-size: 0.85rem;
            margin-bottom: 6px;
        }

        .stat-label {
            color: #b3e5fc;
        }

        .stat-value {
            color: #81d4fa;
            font-weight: 600;
        }

        .location-presets {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 8px;
            margin-top: 10px;
        }

        .preset-btn {
            padding: 8px;
            background: rgba(129, 212, 250, 0.1);
            border: 1px solid rgba(129, 212, 250, 0.2);
            color: #b3e5fc;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.75rem;
            transition: all 0.3s;
        }

        .preset-btn:hover {
            background: rgba(129, 212, 250, 0.2);
        }

        .info-panel {
            background: rgba(0,0,0,0.3);
            border-radius: 16px;
            padding: 20px;
            border: 1px solid rgba(129, 212, 250, 0.2);
            max-width: 1360px;
            margin: 20px auto;
        }

        .info-panel h3 {
            color: #81d4fa;
            margin-bottom: 10px;
            font-size: 1rem;
        }

        .info-panel p {
            font-size: 0.9rem;
            line-height: 1.6;
            color: #b0bec5;
        }

        .equation {
            font-family: 'Times New Roman', serif;
            font-style: italic;
            background: rgba(129, 212, 250, 0.1);
            padding: 10px 15px;
            border-radius: 8px;
            margin: 10px 0;
            text-align: center;
            color: #e0e0e0;
        }

        @media (max-width: 768px) {
            .container {
                flex-direction: column;
                align-items: center;
            }

            .main-panel, .side-panel, .controls {
                width: 100%;
                min-width: auto;
            }
        }
    </style>
</head>
<body>
    <a href="index.html" class="back-link">← Back to Gallery</a>

    <header>
        <h1>Foucault Pendulum Precession</h1>
        <p class="subtitle">Demonstrating Earth's rotation through pendulum plane precession</p>
    </header>

    <div class="container">
        <div class="panel main-panel">
            <h3 class="panel-title">Pendulum Trajectory (View from Above)</h3>
            <canvas id="mainCanvas" width="500" height="500"></canvas>
        </div>

        <div class="panel side-panel">
            <h3 class="panel-title">Side View</h3>
            <canvas id="sideCanvas" width="300" height="200"></canvas>
            <div style="margin-top: 15px;">
                <h3 class="panel-title">Earth View</h3>
                <canvas id="earthCanvas" width="300" height="200"></canvas>
            </div>
        </div>

        <div class="panel controls">
            <div class="btn-group">
                <button class="btn active" id="playBtn">Play</button>
                <button class="btn" id="resetBtn">Reset</button>
            </div>

            <div class="control-group">
                <label>Latitude: <span id="latVal">48.9</span>° (Paris)</label>
                <input type="range" id="latSlider" min="-90" max="90" value="48.9" step="0.1">
            </div>

            <div class="control-group">
                <label>Time Acceleration: <span id="timeVal">1000</span>×</label>
                <input type="range" id="timeSlider" min="100" max="10000" value="1000" step="100">
            </div>

            <div class="control-group">
                <label>Pendulum Length: <span id="lengthVal">67</span> m</label>
                <input type="range" id="lengthSlider" min="10" max="100" value="67" step="1">
            </div>

            <div class="control-group">
                <label>Location Presets:</label>
                <div class="location-presets">
                    <button class="preset-btn" data-lat="90">North Pole (90°)</button>
                    <button class="preset-btn" data-lat="48.9">Paris (48.9°)</button>
                    <button class="preset-btn" data-lat="45">45° N</button>
                    <button class="preset-btn" data-lat="30">Cairo (30°)</button>
                    <button class="preset-btn" data-lat="0">Equator (0°)</button>
                    <button class="preset-btn" data-lat="-34">Sydney (-34°)</button>
                </div>
            </div>

            <div class="stats">
                <div class="stat-row">
                    <span class="stat-label">Precession rate:</span>
                    <span class="stat-value" id="precRate">-</span>
                </div>
                <div class="stat-row">
                    <span class="stat-label">Full rotation time:</span>
                    <span class="stat-value" id="rotTime">-</span>
                </div>
                <div class="stat-row">
                    <span class="stat-label">Swing period:</span>
                    <span class="stat-value" id="swingPeriod">-</span>
                </div>
                <div class="stat-row">
                    <span class="stat-label">Elapsed time:</span>
                    <span class="stat-value" id="elapsed">0h 0m</span>
                </div>
                <div class="stat-row">
                    <span class="stat-label">Plane rotation:</span>
                    <span class="stat-value" id="planeRot">0.0°</span>
                </div>
            </div>
        </div>
    </div>

    <div class="info-panel">
        <h3>The Foucault Pendulum</h3>
        <p>
            In 1851, French physicist Léon Foucault demonstrated Earth's rotation by suspending a 28 kg
            iron ball from a 67-meter wire in the Paris Panthéon. The pendulum's swing plane appears to
            rotate relative to the floor, but it's actually the floor (and Earth) rotating beneath it.
            The rate of precession depends on latitude—faster near the poles, zero at the equator.
        </p>
        <div class="equation">
            Precession rate: Ω = Ω<sub>Earth</sub> × sin(latitude) = 15°/hour × sin(φ)
        </div>
        <p>
            At the North Pole, the plane completes a full rotation in about 24 hours. At Paris (48.9°N),
            it takes approximately 32 hours. In the Northern Hemisphere, the plane rotates clockwise
            (viewed from above); in the Southern Hemisphere, it rotates counter-clockwise.
        </p>
    </div>

    <script>
        const mainCanvas = document.getElementById('mainCanvas');
        const mainCtx = mainCanvas.getContext('2d');
        const sideCanvas = document.getElementById('sideCanvas');
        const sideCtx = sideCanvas.getContext('2d');
        const earthCanvas = document.getElementById('earthCanvas');
        const earthCtx = earthCanvas.getContext('2d');

        // Constants
        const OMEGA_EARTH = 7.2921e-5; // rad/s (Earth's angular velocity)
        const g = 9.81; // m/s²

        // Parameters
        let latitude = 48.9; // Paris
        let timeAccel = 1000;
        let pendulumLength = 67; // meters (Foucault's original)
        let running = true;

        // State
        let time = 0; // seconds
        let pendulumAngle = 0.05; // radians (amplitude)
        let pendulumPhase = 0;
        let planeAngle = 0; // radians
        let trail = [];

        // Controls
        document.getElementById('playBtn').addEventListener('click', () => {
            running = !running;
            document.getElementById('playBtn').textContent = running ? 'Pause' : 'Play';
            document.getElementById('playBtn').classList.toggle('active', running);
        });

        document.getElementById('resetBtn').addEventListener('click', reset);

        document.getElementById('latSlider').addEventListener('input', (e) => {
            latitude = parseFloat(e.target.value);
            const sign = latitude >= 0 ? 'N' : 'S';
            document.getElementById('latVal').textContent = Math.abs(latitude).toFixed(1) + '° ' + sign;
            update();
        });

        document.getElementById('timeSlider').addEventListener('input', (e) => {
            timeAccel = parseFloat(e.target.value);
            document.getElementById('timeVal').textContent = timeAccel;
        });

        document.getElementById('lengthSlider').addEventListener('input', (e) => {
            pendulumLength = parseFloat(e.target.value);
            document.getElementById('lengthVal').textContent = pendulumLength;
            update();
        });

        document.querySelectorAll('.preset-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                latitude = parseFloat(btn.dataset.lat);
                document.getElementById('latSlider').value = latitude;
                const sign = latitude >= 0 ? 'N' : 'S';
                document.getElementById('latVal').textContent = Math.abs(latitude).toFixed(1) + '° ' + sign;
                reset();
            });
        });

        function precessionRate() {
            // Omega_precession = Omega_Earth * sin(latitude)
            return OMEGA_EARTH * Math.sin(latitude * Math.PI / 180);
        }

        function swingPeriod() {
            // T = 2π√(L/g)
            return 2 * Math.PI * Math.sqrt(pendulumLength / g);
        }

        function update() {
            const omega_p = precessionRate();
            const T_swing = swingPeriod();

            // Precession in degrees per hour
            const degreesPerHour = omega_p * (180 / Math.PI) * 3600;
            document.getElementById('precRate').textContent =
                Math.abs(degreesPerHour).toFixed(2) + '°/hr ' +
                (latitude >= 0 ? '(CW)' : '(CCW)');

            // Time for full rotation
            if (Math.abs(omega_p) < 1e-10) {
                document.getElementById('rotTime').textContent = '∞ (no rotation)';
            } else {
                const T_rot = 2 * Math.PI / Math.abs(omega_p);
                const hours = T_rot / 3600;
                document.getElementById('rotTime').textContent = hours.toFixed(1) + ' hours';
            }

            document.getElementById('swingPeriod').textContent = T_swing.toFixed(2) + ' s';
        }

        function reset() {
            time = 0;
            planeAngle = 0;
            pendulumPhase = 0;
            trail = [];
            update();
        }

        function drawMain() {
            const ctx = mainCtx;
            const W = mainCanvas.width;
            const H = mainCanvas.height;
            const cx = W / 2;
            const cy = H / 2;

            // Clear
            ctx.fillStyle = '#0a0a1a';
            ctx.fillRect(0, 0, W, H);

            // Draw floor pattern (concentric circles)
            for (let r = 30; r < 230; r += 30) {
                ctx.strokeStyle = 'rgba(129, 212, 250, 0.1)';
                ctx.lineWidth = 1;
                ctx.beginPath();
                ctx.arc(cx, cy, r, 0, Math.PI * 2);
                ctx.stroke();
            }

            // Draw compass directions (fixed to floor)
            ctx.font = '14px sans-serif';
            ctx.fillStyle = 'rgba(129, 212, 250, 0.5)';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            ctx.fillText('N', cx, cy - 235);
            ctx.fillText('S', cx, cy + 235);
            ctx.fillText('E', cx + 235, cy);
            ctx.fillText('W', cx - 235, cy);

            // Draw trail
            if (trail.length > 1) {
                ctx.beginPath();
                ctx.moveTo(trail[0].x, trail[0].y);
                for (let i = 1; i < trail.length; i++) {
                    ctx.lineTo(trail[i].x, trail[i].y);
                }
                ctx.strokeStyle = 'rgba(129, 212, 250, 0.3)';
                ctx.lineWidth = 2;
                ctx.stroke();
            }

            // Current pendulum position
            const T = swingPeriod();
            const omega = 2 * Math.PI / T;
            const swing = pendulumAngle * Math.cos(pendulumPhase);
            const amplitude = 180; // pixels

            // Position in rotating frame
            const x = cx + amplitude * swing * Math.cos(planeAngle);
            const y = cy + amplitude * swing * Math.sin(planeAngle);

            // Draw swing line (current plane)
            ctx.strokeStyle = 'rgba(255, 193, 7, 0.5)';
            ctx.lineWidth = 2;
            ctx.setLineDash([5, 5]);
            ctx.beginPath();
            ctx.moveTo(cx - 200 * Math.cos(planeAngle), cy - 200 * Math.sin(planeAngle));
            ctx.lineTo(cx + 200 * Math.cos(planeAngle), cy + 200 * Math.sin(planeAngle));
            ctx.stroke();
            ctx.setLineDash([]);

            // Draw initial plane reference
            ctx.strokeStyle = 'rgba(129, 212, 250, 0.2)';
            ctx.lineWidth = 1;
            ctx.setLineDash([3, 3]);
            ctx.beginPath();
            ctx.moveTo(cx - 200, cy);
            ctx.lineTo(cx + 200, cy);
            ctx.stroke();
            ctx.setLineDash([]);

            // Draw pendulum wire
            ctx.strokeStyle = 'rgba(255, 255, 255, 0.6)';
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.moveTo(cx, cy);
            ctx.lineTo(x, y);
            ctx.stroke();

            // Draw pendulum bob
            const gradient = ctx.createRadialGradient(x, y, 0, x, y, 15);
            gradient.addColorStop(0, '#ffc107');
            gradient.addColorStop(1, '#ff9800');
            ctx.beginPath();
            ctx.arc(x, y, 12, 0, Math.PI * 2);
            ctx.fillStyle = gradient;
            ctx.fill();

            // Glow
            const glow = ctx.createRadialGradient(x, y, 0, x, y, 30);
            glow.addColorStop(0, 'rgba(255, 193, 7, 0.3)');
            glow.addColorStop(1, 'rgba(255, 193, 7, 0)');
            ctx.beginPath();
            ctx.arc(x, y, 30, 0, Math.PI * 2);
            ctx.fillStyle = glow;
            ctx.fill();

            // Draw center point
            ctx.beginPath();
            ctx.arc(cx, cy, 4, 0, Math.PI * 2);
            ctx.fillStyle = '#81d4fa';
            ctx.fill();

            // Draw angle indicator
            ctx.fillStyle = '#ffc107';
            ctx.font = '12px sans-serif';
            ctx.textAlign = 'left';
            const angleDeg = (planeAngle * 180 / Math.PI) % 360;
            ctx.fillText('Plane: ' + angleDeg.toFixed(1) + '°', 15, 25);

            // Direction indicator
            if (Math.abs(latitude) > 1) {
                const dir = latitude > 0 ? 'CW ↻' : 'CCW ↺';
                ctx.fillText('Rotation: ' + dir, 15, 45);
            }
        }

        function drawSide() {
            const ctx = sideCtx;
            const W = sideCanvas.width;
            const H = sideCanvas.height;

            ctx.fillStyle = '#0a0a1a';
            ctx.fillRect(0, 0, W, H);

            const pivotX = W / 2;
            const pivotY = 30;
            const pendulumLen = 140;

            // Current swing
            const T = swingPeriod();
            const swing = pendulumAngle * Math.cos(pendulumPhase);

            const bobX = pivotX + pendulumLen * swing * 3;
            const bobY = pivotY + pendulumLen * Math.cos(swing * 3);

            // Draw ceiling
            ctx.fillStyle = 'rgba(129, 212, 250, 0.2)';
            ctx.fillRect(0, 0, W, 25);

            // Draw pivot
            ctx.beginPath();
            ctx.arc(pivotX, pivotY, 5, 0, Math.PI * 2);
            ctx.fillStyle = '#81d4fa';
            ctx.fill();

            // Draw wire
            ctx.strokeStyle = 'rgba(255, 255, 255, 0.6)';
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.moveTo(pivotX, pivotY);
            ctx.lineTo(bobX, bobY);
            ctx.stroke();

            // Draw bob
            ctx.beginPath();
            ctx.arc(bobX, bobY, 10, 0, Math.PI * 2);
            ctx.fillStyle = '#ffc107';
            ctx.fill();

            // Draw floor
            ctx.fillStyle = 'rgba(129, 212, 250, 0.1)';
            ctx.fillRect(0, H - 20, W, 20);

            // Labels
            ctx.fillStyle = '#b3e5fc';
            ctx.font = '10px sans-serif';
            ctx.textAlign = 'center';
            ctx.fillText('Side View', W / 2, H - 5);
        }

        function drawEarth() {
            const ctx = earthCtx;
            const W = earthCanvas.width;
            const H = earthCanvas.height;
            const cx = W / 2;
            const cy = H / 2;
            const R = 80;

            ctx.fillStyle = '#0a0a1a';
            ctx.fillRect(0, 0, W, H);

            // Draw Earth
            const earthGrad = ctx.createRadialGradient(cx - 20, cy - 20, 0, cx, cy, R);
            earthGrad.addColorStop(0, '#4fc3f7');
            earthGrad.addColorStop(0.5, '#1976d2');
            earthGrad.addColorStop(1, '#0d47a1');
            ctx.beginPath();
            ctx.arc(cx, cy, R, 0, Math.PI * 2);
            ctx.fillStyle = earthGrad;
            ctx.fill();

            // Draw latitude lines
            ctx.strokeStyle = 'rgba(255, 255, 255, 0.2)';
            ctx.lineWidth = 1;
            for (let lat = -60; lat <= 60; lat += 30) {
                const latRad = lat * Math.PI / 180;
                const y = cy - R * Math.sin(latRad);
                const halfWidth = R * Math.cos(latRad);
                ctx.beginPath();
                ctx.ellipse(cx, y, halfWidth, halfWidth * 0.3, 0, 0, Math.PI * 2);
                ctx.stroke();
            }

            // Draw pendulum location
            const latRad = latitude * Math.PI / 180;
            const locY = cy - R * Math.sin(latRad);
            const locX = cx + R * Math.cos(latRad) * 0.3; // Slight offset for visibility

            ctx.beginPath();
            ctx.arc(locX, locY, 5, 0, Math.PI * 2);
            ctx.fillStyle = '#ffc107';
            ctx.fill();

            // Draw rotation arrow
            const earthRotation = (time * OMEGA_EARTH * timeAccel) % (2 * Math.PI);
            ctx.save();
            ctx.translate(cx, cy - R - 15);
            ctx.rotate(earthRotation);
            ctx.strokeStyle = '#81d4fa';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.arc(0, 0, 10, 0.5, 2.5);
            ctx.stroke();
            // Arrow head
            ctx.beginPath();
            ctx.moveTo(10 * Math.cos(2.5), 10 * Math.sin(2.5));
            ctx.lineTo(10 * Math.cos(2.5) - 5, 10 * Math.sin(2.5) - 3);
            ctx.lineTo(10 * Math.cos(2.5) + 2, 10 * Math.sin(2.5) - 5);
            ctx.closePath();
            ctx.fillStyle = '#81d4fa';
            ctx.fill();
            ctx.restore();

            // Labels
            ctx.fillStyle = '#b3e5fc';
            ctx.font = '10px sans-serif';
            ctx.textAlign = 'center';
            ctx.fillText('Earth Rotation', cx, H - 5);

            // Latitude label
            ctx.fillStyle = '#ffc107';
            const sign = latitude >= 0 ? 'N' : 'S';
            ctx.fillText(Math.abs(latitude).toFixed(0) + '°' + sign, locX + 20, locY);
        }

        function animate() {
            if (running) {
                const dt = 0.016 * timeAccel; // 60 FPS, accelerated
                time += dt;

                // Update pendulum phase
                const T = swingPeriod();
                const omega = 2 * Math.PI / T;
                pendulumPhase += omega * dt;

                // Update plane angle (precession)
                const omega_p = precessionRate();
                planeAngle -= omega_p * dt; // Negative because CW in NH from above

                // Add to trail occasionally
                if (trail.length === 0 || time % (T / 10) < dt) {
                    const swing = pendulumAngle * Math.cos(pendulumPhase);
                    const amplitude = 180;
                    const cx = mainCanvas.width / 2;
                    const cy = mainCanvas.height / 2;
                    const x = cx + amplitude * swing * Math.cos(planeAngle);
                    const y = cy + amplitude * swing * Math.sin(planeAngle);
                    trail.push({ x, y });

                    // Limit trail length
                    if (trail.length > 2000) {
                        trail = trail.slice(-2000);
                    }
                }

                // Update display
                const hours = Math.floor(time / 3600);
                const mins = Math.floor((time % 3600) / 60);
                document.getElementById('elapsed').textContent = hours + 'h ' + mins + 'm';
                document.getElementById('planeRot').textContent =
                    ((-planeAngle * 180 / Math.PI) % 360).toFixed(1) + '°';
            }

            drawMain();
            drawSide();
            drawEarth();

            requestAnimationFrame(animate);
        }

        // Initialize
        update();
        animate();
    </script>
    <script src="../assets/js/enhance.js" defer></script>
</body>
</html>
