<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lagrange Points</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            background: #000;
            font-family: Arial, sans-serif;
        }
        canvas {
            display: block;
        }
        .info {
            position: absolute;
            top: 20px;
            left: 20px;
            color: #fff;
            background: rgba(0, 0, 0, 0.85);
            padding: 15px;
            border-radius: 10px;
            max-width: 320px;
        }
    </style>
</head>
<body>
    <div class="info">
        <h2>Lagrange Points</h2>
        <p>Positions where gravitational forces balance</p>
        <p><strong>L1, L2, L3:</strong> Unstable (collinear)</p>
        <p><strong>L4, L5:</strong> Stable (triangular)</p>
        <p>James Webb Space Telescope is at L2</p>
    </div>
    <canvas id="canvas"></canvas>
    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        const centerX = canvas.width / 2;
        const centerY = canvas.height / 2;

        const orbitRadius = 250;
        let angle = 0;

        // Lagrange point positions (relative to Moon)
        const lagrangePoints = [
            {name: 'L1', offset: -0.15, angle: 0, color: '#FF6B6B', stable: false},
            {name: 'L2', offset: 0.15, angle: 0, color: '#4ECDC4', stable: false},
            {name: 'L3', offset: 0, angle: Math.PI, color: '#FFE66D', stable: false},
            {name: 'L4', offset: 0, angle: Math.PI / 3, color: '#95E1D3', stable: true},
            {name: 'L5', offset: 0, angle: -Math.PI / 3, color: '#C7CEEA', stable: true}
        ];

        // Test particles around Lagrange points
        const testParticles = lagrangePoints.map(lp => {
            const particles = [];
            const count = lp.stable ? 30 : 10;
            for (let i = 0; i < count; i++) {
                const distance = (Math.random() - 0.5) * (lp.stable ? 40 : 20);
                const particleAngle = Math.random() * Math.PI * 2;
                particles.push({
                    distance: distance,
                    angle: particleAngle,
                    speed: (Math.random() - 0.5) * 0.02,
                    trail: []
                });
            }
            return particles;
        });

        function drawBody(x, y, radius, color, glow, label) {
            // Glow
            const gradient = ctx.createRadialGradient(x, y, 0, x, y, radius * 3);
            gradient.addColorStop(0, glow);
            gradient.addColorStop(0.3, glow + '88');
            gradient.addColorStop(1, 'rgba(0, 0, 0, 0)');

            ctx.beginPath();
            ctx.arc(x, y, radius * 3, 0, Math.PI * 2);
            ctx.fillStyle = gradient;
            ctx.fill();

            // Body
            ctx.beginPath();
            ctx.arc(x, y, radius, 0, Math.PI * 2);
            ctx.fillStyle = color;
            ctx.fill();
            ctx.strokeStyle = '#FFF';
            ctx.lineWidth = 2;
            ctx.stroke();

            // Label
            ctx.fillStyle = '#FFF';
            ctx.font = 'bold 14px Arial';
            ctx.textAlign = 'center';
            ctx.fillText(label, x, y + radius + 20);
        }

        function getLagrangePosition(lp, moonX, moonY, earthX, earthY) {
            const moonAngle = Math.atan2(moonY - earthY, moonX - earthX);
            const totalAngle = moonAngle + lp.angle;
            const distance = orbitRadius + lp.offset * orbitRadius;

            return {
                x: earthX + distance * Math.cos(totalAngle),
                y: earthY + distance * Math.sin(totalAngle)
            };
        }

        function draw() {
            ctx.fillStyle = 'rgba(0, 0, 0, 0.05)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // Update angle
            angle += 0.005;

            // Calculate positions
            const earthX = centerX;
            const earthY = centerY;
            const moonX = centerX + orbitRadius * Math.cos(angle);
            const moonY = centerY + orbitRadius * Math.sin(angle);

            // Draw orbit
            ctx.beginPath();
            ctx.arc(earthX, earthY, orbitRadius, 0, Math.PI * 2);
            ctx.strokeStyle = 'rgba(255, 255, 255, 0.2)';
            ctx.lineWidth = 1;
            ctx.setLineDash([5, 5]);
            ctx.stroke();
            ctx.setLineDash([]);

            // Draw connecting lines to L-points
            lagrangePoints.forEach((lp, idx) => {
                const pos = getLagrangePosition(lp, moonX, moonY, earthX, earthY);

                ctx.beginPath();
                ctx.moveTo(earthX, earthY);
                ctx.lineTo(pos.x, pos.y);
                ctx.strokeStyle = lp.color + '33';
                ctx.lineWidth = 1;
                ctx.stroke();

                // Update and draw test particles
                testParticles[idx].forEach(particle => {
                    particle.angle += particle.speed;

                    const px = pos.x + particle.distance * Math.cos(particle.angle);
                    const py = pos.y + particle.distance * Math.sin(particle.angle);

                    // Add trail
                    particle.trail.push({x: px, y: py});
                    if (particle.trail.length > 50) {
                        particle.trail.shift();
                    }

                    // Draw trail
                    ctx.beginPath();
                    particle.trail.forEach((point, i) => {
                        if (i === 0) {
                            ctx.moveTo(point.x, point.y);
                        } else {
                            ctx.lineTo(point.x, point.y);
                        }
                    });
                    ctx.strokeStyle = lp.color + '44';
                    ctx.lineWidth = 1;
                    ctx.stroke();

                    // Draw particle
                    ctx.beginPath();
                    ctx.arc(px, py, 2, 0, Math.PI * 2);
                    ctx.fillStyle = lp.color;
                    ctx.fill();

                    // Stability: particles drift away from unstable points
                    if (!lp.stable) {
                        particle.distance *= 1.001;
                        if (particle.distance > 50) {
                            particle.distance = 10;
                            particle.angle = Math.random() * Math.PI * 2;
                        }
                    }
                });

                // Draw Lagrange point
                ctx.beginPath();
                ctx.arc(pos.x, pos.y, lp.stable ? 10 : 8, 0, Math.PI * 2);
                ctx.fillStyle = lp.color;
                ctx.fill();
                ctx.strokeStyle = '#FFF';
                ctx.lineWidth = 2;
                ctx.stroke();

                // Draw stability indicator
                if (lp.stable) {
                    ctx.strokeStyle = lp.color;
                    ctx.lineWidth = 2;
                    ctx.beginPath();
                    ctx.arc(pos.x, pos.y, 15, 0, Math.PI * 2);
                    ctx.stroke();
                }

                // Label
                ctx.fillStyle = lp.color;
                ctx.font = 'bold 16px Arial';
                ctx.textAlign = 'center';
                ctx.fillText(lp.name, pos.x, pos.y - 20);

                if (lp.stable) {
                    ctx.font = '10px Arial';
                    ctx.fillText('(stable)', pos.x, pos.y + 25);
                }
            });

            // Draw Earth
            drawBody(earthX, earthY, 35, '#4488FF', '#88CCFF', 'Earth');

            // Draw Moon
            drawBody(moonX, moonY, 15, '#CCC', '#FFF', 'Moon');
        }

        function animate() {
            draw();
            requestAnimationFrame(animate);
        }

        animate();

        window.addEventListener('resize', () => {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        });
    </script>
</body>
</html>