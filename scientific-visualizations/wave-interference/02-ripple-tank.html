<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ripple Tank - Wave Interference</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            background: #001122;
            font-family: Arial, sans-serif;
        }
        canvas {
            display: block;
        }
        .info {
            position: absolute;
            top: 20px;
            left: 20px;
            color: #00ddff;
            background: rgba(0, 0, 0, 0.8);
            padding: 15px;
            border-radius: 10px;
        }
    </style>
</head>
<body>
    <div class="info">
        <h2>Ripple Tank</h2>
        <p>Multiple point sources creating waves</p>
        <p>Click to add/remove wave sources</p>
    </div>
    <canvas id="canvas"></canvas>
    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        let time = 0;
        const wavelength = 40;
        const frequency = 0.05;

        // Wave sources
        const sources = [
            {x: canvas.width * 0.3, y: canvas.height * 0.4},
            {x: canvas.width * 0.7, y: canvas.height * 0.4},
            {x: canvas.width * 0.5, y: canvas.height * 0.6}
        ];

        canvas.addEventListener('click', (e) => {
            const rect = canvas.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;

            // Check if clicking near existing source to remove it
            let removed = false;
            for (let i = sources.length - 1; i >= 0; i--) {
                const dx = sources[i].x - x;
                const dy = sources[i].y - y;
                if (Math.sqrt(dx * dx + dy * dy) < 30) {
                    sources.splice(i, 1);
                    removed = true;
                    break;
                }
            }

            // Add new source if not removing
            if (!removed && sources.length < 8) {
                sources.push({x, y});
            }
        });

        function calculateWaveAmplitude(x, y, t) {
            let totalAmplitude = 0;

            sources.forEach(source => {
                const dx = x - source.x;
                const dy = y - source.y;
                const distance = Math.sqrt(dx * dx + dy * dy);

                // Wave equation with damping
                const damping = Math.exp(-distance / 400);
                const phase = (distance / wavelength) - t * frequency;
                const amplitude = Math.sin(phase * Math.PI * 2) * damping;

                totalAmplitude += amplitude;
            });

            return totalAmplitude / Math.sqrt(sources.length);
        }

        function draw() {
            ctx.fillStyle = '#001122';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            const resolution = 5;

            // Draw wave interference pattern
            for (let x = 0; x < canvas.width; x += resolution) {
                for (let y = 0; y < canvas.height; y += resolution) {
                    const amplitude = calculateWaveAmplitude(x, y, time);

                    // Color based on amplitude
                    const intensity = (amplitude + 1) / 2; // Normalize to 0-1
                    const hue = 200;
                    const brightness = intensity * 80 + 20;
                    const saturation = 100;

                    ctx.fillStyle = `hsl(${hue}, ${saturation}%, ${brightness}%)`;
                    ctx.fillRect(x, y, resolution, resolution);
                }
            }

            // Draw wave sources
            sources.forEach((source, index) => {
                // Pulsing circle
                const pulseRadius = (time * 20) % 60;

                ctx.beginPath();
                ctx.arc(source.x, source.y, pulseRadius, 0, Math.PI * 2);
                ctx.strokeStyle = `rgba(0, 255, 255, ${1 - pulseRadius / 60})`;
                ctx.lineWidth = 2;
                ctx.stroke();

                // Source marker
                const gradient = ctx.createRadialGradient(
                    source.x, source.y, 0,
                    source.x, source.y, 15
                );
                gradient.addColorStop(0, '#00ffff');
                gradient.addColorStop(1, '#0088ff');

                ctx.beginPath();
                ctx.arc(source.x, source.y, 8, 0, Math.PI * 2);
                ctx.fillStyle = gradient;
                ctx.fill();
                ctx.strokeStyle = '#fff';
                ctx.lineWidth = 2;
                ctx.stroke();

                // Label
                ctx.fillStyle = '#fff';
                ctx.font = 'bold 12px Arial';
                ctx.textAlign = 'center';
                ctx.fillText(`S${index + 1}`, source.x, source.y + 25);
            });

            time += 1;
        }

        function animate() {
            draw();
            requestAnimationFrame(animate);
        }

        animate();

        window.addEventListener('resize', () => {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        });
    </script>
</body>
</html>