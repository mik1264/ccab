<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Hurricane Formation Spiral</title>
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body { background: #0a0e1a; overflow: hidden; font-family: 'Nunito', sans-serif; }
canvas { display: block; }
.title-overlay {
    position: fixed; top: 20px; left: 50%; transform: translateX(-50%);
    color: #fff; font-size: 1.4rem; font-weight: 600;
    text-shadow: 0 2px 10px rgba(0,0,0,0.7);
    pointer-events: none; z-index: 10; text-align: center;
}
.title-overlay .subtitle {
    font-size: 0.8rem; opacity: 0.7; margin-top: 4px; font-weight: 300;
}
.organic-back-link {
    position: fixed; top: 20px; left: 20px; z-index: 100;
    display: flex; align-items: center; gap: 8px;
    padding: 8px 16px; border-radius: 20px;
    background: rgba(255,255,255,0.1); backdrop-filter: blur(10px);
    color: #fff; text-decoration: none; font-size: 0.9rem;
    transition: background 0.3s;
}
.organic-back-link:hover { background: rgba(255,255,255,0.2); }
.controls {
    position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%);
    display: flex; gap: 20px; align-items: center; z-index: 10; flex-wrap: wrap; justify-content: center;
    background: rgba(0,0,0,0.6); backdrop-filter: blur(10px);
    padding: 12px 24px; border-radius: 20px; color: #fff; font-size: 0.85rem;
}
.controls label { display: flex; align-items: center; gap: 8px; white-space: nowrap; }
.controls input[type="range"] { width: 100px; }
.info-panel {
    position: fixed; top: 80px; right: 20px; z-index: 10;
    background: rgba(0,0,0,0.5); backdrop-filter: blur(10px);
    padding: 12px 16px; border-radius: 12px; color: #fff; font-size: 0.75rem;
    line-height: 1.6;
}
</style>
</head>
<body>
<a href="../index.html" class="organic-back-link">
    <span class="back-arrow">&larr;</span>
    <span class="back-text">Gallery</span>
</a>
<div class="title-overlay">
    Hurricane Formation Spiral
    <div class="subtitle">Coriolis-driven cyclonic rotation with spiral rain bands</div>
</div>
<div class="info-panel">
    <div>Category: <span id="catLabel">Cat 3</span></div>
    <div>Max Wind: <span id="windSpeed">0</span> km/h</div>
    <div>Eye Radius: <span id="eyeRadius">0</span> km</div>
</div>
<div class="controls">
    <label>Coriolis Strength: <input type="range" id="coriolisSlider" min="0.1" max="3" step="0.1" value="1.5"> <span id="coriolisVal">1.5</span></label>
    <label>Intensity: <input type="range" id="intensitySlider" min="0.5" max="4" step="0.1" value="2"> <span id="intensityVal">2.0</span></label>
    <label>Rain Bands: <input type="range" id="bandsSlider" min="2" max="8" step="1" value="5"> <span id="bandsVal">5</span></label>
</div>
<canvas id="canvas"></canvas>
<script>
const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d');

let W, H, cx, cy;
function resize() {
    W = canvas.width = window.innerWidth;
    H = canvas.height = window.innerHeight;
    cx = W / 2;
    cy = H / 2;
}
resize();
window.addEventListener('resize', resize);

const NUM_PARTICLES = 4000;
const particles = [];

class Particle {
    constructor() {
        this.reset();
    }
    reset() {
        const maxR = Math.min(W, H) * 0.45;
        const r = 20 + Math.random() * maxR;
        const angle = Math.random() * Math.PI * 2;
        this.x = cx + Math.cos(angle) * r;
        this.y = cy + Math.sin(angle) * r;
        this.vx = 0;
        this.vy = 0;
        this.life = 0.8 + Math.random() * 0.2;
        this.size = 1 + Math.random() * 2;
        this.moisture = 0.3 + Math.random() * 0.7;
    }
    update(coriolis, intensity, numBands, time) {
        const dx = this.x - cx;
        const dy = this.y - cy;
        const dist = Math.sqrt(dx * dx + dy * dy);
        const maxR = Math.min(W, H) * 0.45;
        const eyeR = 20 + 15 / intensity;

        if (dist < 1) { this.reset(); return; }

        const angle = Math.atan2(dy, dx);
        const nx = dx / dist;
        const ny = dy / dist;
        const tx = -ny;
        const ty = nx;

        // Tangential (rotational) velocity - stronger near the eye wall
        let tangentialSpeed;
        if (dist < eyeR) {
            tangentialSpeed = (dist / eyeR) * intensity * 3;
        } else {
            tangentialSpeed = (eyeR / dist) * intensity * 3;
        }
        tangentialSpeed *= coriolis;

        // Radial inflow
        let radialSpeed;
        if (dist > eyeR * 1.5) {
            radialSpeed = -intensity * 0.4 * (1 - eyeR / dist);
        } else if (dist > eyeR) {
            radialSpeed = -intensity * 0.1;
        } else {
            radialSpeed = intensity * 0.5; // outflow in eye
        }

        // Spiral rain bands
        const spiralAngle = angle - dist * 0.015 * numBands + time * 0.3;
        const bandInfluence = Math.sin(spiralAngle * numBands) * 0.5 + 0.5;
        this.moisture = 0.3 + bandInfluence * 0.7;

        const ax = tx * tangentialSpeed * 0.01 + nx * radialSpeed * 0.01;
        const ay = ty * tangentialSpeed * 0.01 + ny * radialSpeed * 0.01;

        this.vx = this.vx * 0.95 + ax;
        this.vy = this.vy * 0.95 + ay;

        this.x += this.vx;
        this.y += this.vy;

        this.life -= 0.001;

        if (dist > maxR || this.life <= 0 || dist < eyeR * 0.3) {
            this.reset();
        }
    }
    draw(eyeR) {
        const dx = this.x - cx;
        const dy = this.y - cy;
        const dist = Math.sqrt(dx * dx + dy * dy);
        const speed = Math.sqrt(this.vx * this.vx + this.vy * this.vy);

        // Color by wind speed: blue (slow) -> white -> red (fast)
        let r, g, b;
        const s = Math.min(1, speed / 5);
        if (s < 0.33) {
            const t = s / 0.33;
            r = 60 + t * 100; g = 100 + t * 155; b = 200 + t * 55;
        } else if (s < 0.66) {
            const t = (s - 0.33) / 0.33;
            r = 160 + t * 95; g = 255 - t * 55; b = 255 - t * 155;
        } else {
            const t = (s - 0.66) / 0.34;
            r = 255; g = 200 - t * 150; b = 100 - t * 100;
        }

        const alpha = this.life * this.moisture * (dist < eyeR ? 0.3 : 0.7);
        ctx.fillStyle = `rgba(${Math.floor(r)},${Math.floor(g)},${Math.floor(b)},${alpha})`;
        ctx.beginPath();
        ctx.arc(this.x, this.y, this.size * (1 + speed * 0.1), 0, Math.PI * 2);
        ctx.fill();
    }
}

for (let i = 0; i < NUM_PARTICLES; i++) {
    particles.push(new Particle());
}

let time = 0;

function drawEye(eyeR) {
    const grad = ctx.createRadialGradient(cx, cy, 0, cx, cy, eyeR * 2);
    grad.addColorStop(0, 'rgba(10, 14, 26, 0.8)');
    grad.addColorStop(0.3, 'rgba(10, 14, 26, 0.4)');
    grad.addColorStop(0.6, 'rgba(30, 50, 80, 0.1)');
    grad.addColorStop(1, 'rgba(30, 50, 80, 0)');
    ctx.fillStyle = grad;
    ctx.beginPath();
    ctx.arc(cx, cy, eyeR * 2, 0, Math.PI * 2);
    ctx.fill();

    // Eye wall glow
    ctx.strokeStyle = 'rgba(150, 200, 255, 0.08)';
    ctx.lineWidth = eyeR * 0.3;
    ctx.beginPath();
    ctx.arc(cx, cy, eyeR, 0, Math.PI * 2);
    ctx.stroke();
}

function animate() {
    const coriolis = parseFloat(document.getElementById('coriolisSlider').value);
    const intensity = parseFloat(document.getElementById('intensitySlider').value);
    const numBands = parseInt(document.getElementById('bandsSlider').value);
    document.getElementById('coriolisVal').textContent = coriolis.toFixed(1);
    document.getElementById('intensityVal').textContent = intensity.toFixed(1);
    document.getElementById('bandsVal').textContent = numBands;

    const eyeR = 20 + 15 / intensity;

    // Semi-transparent overlay for trails
    ctx.fillStyle = 'rgba(10, 14, 26, 0.15)';
    ctx.fillRect(0, 0, W, H);

    drawEye(eyeR);

    let maxSpeed = 0;
    for (const p of particles) {
        p.update(coriolis, intensity, numBands, time);
        p.draw(eyeR);
        const sp = Math.sqrt(p.vx * p.vx + p.vy * p.vy);
        if (sp > maxSpeed) maxSpeed = sp;
    }

    document.getElementById('windSpeed').textContent = Math.floor(maxSpeed * 60);
    document.getElementById('eyeRadius').textContent = Math.floor(eyeR);
    const windKmh = maxSpeed * 60;
    let cat = 'Tropical Storm';
    if (windKmh > 250) cat = 'Cat 5';
    else if (windKmh > 210) cat = 'Cat 4';
    else if (windKmh > 178) cat = 'Cat 3';
    else if (windKmh > 154) cat = 'Cat 2';
    else if (windKmh > 119) cat = 'Cat 1';
    document.getElementById('catLabel').textContent = cat;

    time += 0.016;
    requestAnimationFrame(animate);
}
animate();
</script>
</body>
</html>
