<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cognitive Biases Simulation | Cognitive Science</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            min-height: 100vh;
            color: #e2e8f0;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
        }

        .back-link {
            display: inline-block;
            color: #fbbf24;
            text-decoration: none;
            margin-bottom: 20px;
            padding: 8px 16px;
            border: 1px solid rgba(251, 191, 36, 0.3);
            border-radius: 20px;
            transition: all 0.3s;
        }

        .back-link:hover {
            background: rgba(251, 191, 36, 0.1);
        }

        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            background: linear-gradient(135deg, #fbbf24, #f59e0b);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .subtitle {
            color: #94a3b8;
            font-size: 1.1rem;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 350px;
            gap: 30px;
        }

        .simulation-area {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            padding: 30px;
            border: 1px solid rgba(251, 191, 36, 0.2);
        }

        .bias-demo {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            padding: 30px;
            min-height: 400px;
        }

        .demo-title {
            font-size: 1.5rem;
            color: #fbbf24;
            margin-bottom: 20px;
            text-align: center;
        }

        .anchoring-demo {
            text-align: center;
        }

        .anchor-number {
            font-size: 5rem;
            font-weight: bold;
            color: #fbbf24;
            margin: 30px 0;
            text-shadow: 0 0 30px rgba(251, 191, 36, 0.5);
        }

        .question {
            font-size: 1.3rem;
            margin: 20px 0;
            color: #e2e8f0;
        }

        .estimate-input {
            display: flex;
            gap: 15px;
            justify-content: center;
            align-items: center;
            flex-wrap: wrap;
        }

        .estimate-input input {
            padding: 15px 25px;
            font-size: 1.3rem;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(251, 191, 36, 0.3);
            border-radius: 10px;
            color: white;
            width: 150px;
            text-align: center;
        }

        .estimate-input input:focus {
            outline: none;
            border-color: #fbbf24;
        }

        .btn {
            padding: 15px 30px;
            font-size: 1rem;
            font-weight: 600;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-primary {
            background: linear-gradient(135deg, #fbbf24, #f59e0b);
            color: #1a1a2e;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(251, 191, 36, 0.4);
        }

        .result-panel {
            background: rgba(251, 191, 36, 0.1);
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
            display: none;
        }

        .result-panel.show {
            display: block;
        }

        .result-panel h4 {
            color: #fbbf24;
            margin-bottom: 15px;
        }

        .result-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            padding: 10px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 8px;
        }

        .framing-options {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin: 30px 0;
        }

        .framing-option {
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(251, 191, 36, 0.2);
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: left;
        }

        .framing-option:hover {
            border-color: #fbbf24;
            background: rgba(251, 191, 36, 0.1);
        }

        .framing-option.selected {
            border-color: #fbbf24;
            background: rgba(251, 191, 36, 0.2);
        }

        .framing-option h4 {
            color: #fbbf24;
            margin-bottom: 8px;
        }

        .framing-option p {
            color: #94a3b8;
            font-size: 0.95rem;
        }

        .controls {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            padding: 25px;
            border: 1px solid rgba(251, 191, 36, 0.2);
        }

        .control-group {
            margin-bottom: 25px;
        }

        .control-group label {
            display: block;
            margin-bottom: 10px;
            color: #fbbf24;
            font-weight: 600;
        }

        .task-select {
            width: 100%;
            padding: 12px;
            font-size: 1rem;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(251, 191, 36, 0.3);
            border-radius: 8px;
            color: white;
        }

        .task-select option {
            background: #1a1a2e;
        }

        .bias-info {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
            font-size: 0.9rem;
            line-height: 1.6;
            color: #94a3b8;
        }

        .bias-info strong {
            color: #fbbf24;
        }

        .stats-panel {
            background: rgba(251, 191, 36, 0.1);
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
        }

        .stats-panel h3 {
            color: #fbbf24;
            margin-bottom: 15px;
            font-size: 1rem;
        }

        .stat-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(251, 191, 36, 0.1);
        }

        .stat-row:last-child {
            border-bottom: none;
        }

        .stat-label {
            color: #94a3b8;
        }

        .stat-value {
            color: #fbbf24;
            font-weight: 600;
        }

        .availability-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 20px 0;
        }

        .availability-item {
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid transparent;
            border-radius: 10px;
            cursor: pointer;
            text-align: center;
            transition: all 0.3s;
        }

        .availability-item:hover {
            background: rgba(251, 191, 36, 0.1);
        }

        .availability-item.selected {
            border-color: #fbbf24;
        }

        .confirmation-scenario {
            padding: 20px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
            margin: 20px 0;
        }

        .evidence-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin: 20px 0;
        }

        .evidence-item {
            padding: 15px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .evidence-item:hover {
            background: rgba(251, 191, 36, 0.1);
        }

        .evidence-item.selected {
            background: rgba(251, 191, 36, 0.2);
            border-left: 3px solid #fbbf24;
        }

        .evidence-type {
            font-size: 0.8rem;
            padding: 3px 8px;
            border-radius: 4px;
        }

        .evidence-type.supporting {
            background: rgba(34, 197, 94, 0.3);
            color: #22c55e;
        }

        .evidence-type.opposing {
            background: rgba(239, 68, 68, 0.3);
            color: #ef4444;
        }

        @media (max-width: 1024px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <a href="index.html" class="back-link">‚Üê Back to Cognitive Science</a>
            <h1>Cognitive Biases</h1>
            <p class="subtitle">Experience anchoring, framing effects, and other systematic thinking errors</p>
        </header>

        <div class="main-content">
            <div class="simulation-area">
                <div class="bias-demo" id="biasDemo">
                    <!-- Demo content will be inserted here -->
                </div>
                <div class="result-panel" id="resultPanel">
                    <h4>Results</h4>
                    <div id="resultContent"></div>
                </div>
            </div>

            <div class="controls">
                <div class="bias-info" id="biasInfo">
                    <strong>Anchoring Bias:</strong><br>
                    We rely too heavily on the first piece of information (anchor) when making decisions. Even random numbers can influence our estimates!
                </div>

                <div class="control-group">
                    <label>Bias Type</label>
                    <select class="task-select" id="biasType">
                        <option value="anchoring">Anchoring Effect</option>
                        <option value="framing">Framing Effect</option>
                        <option value="availability">Availability Heuristic</option>
                        <option value="confirmation">Confirmation Bias</option>
                    </select>
                </div>

                <button class="btn btn-primary" id="nextBtn" style="width: 100%; margin-top: 20px;">Next Trial</button>

                <div class="stats-panel">
                    <h3>Your Bias Susceptibility</h3>
                    <div class="stat-row">
                        <span class="stat-label">Trials Completed</span>
                        <span class="stat-value" id="trialsCount">0</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Anchoring Effect</span>
                        <span class="stat-value" id="anchoringScore">-</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Framing Effect</span>
                        <span class="stat-value" id="framingScore">-</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Availability Bias</span>
                        <span class="stat-value" id="availabilityScore">-</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Confirmation Bias</span>
                        <span class="stat-value" id="confirmationScore">-</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const biasDemo = document.getElementById('biasDemo');
        const resultPanel = document.getElementById('resultPanel');
        const resultContent = document.getElementById('resultContent');
        const biasInfo = document.getElementById('biasInfo');
        const biasType = document.getElementById('biasType');
        const nextBtn = document.getElementById('nextBtn');

        let currentBias = 'anchoring';
        let currentAnchor = 0;
        let currentFrame = 'gain';
        let trialData = {
            anchoring: { high: [], low: [] },
            framing: { gain: [], loss: [] },
            availability: { responses: [] },
            confirmation: { supporting: 0, opposing: 0 }
        };

        const biasInfoTexts = {
            anchoring: '<strong>Anchoring Bias:</strong><br>We rely too heavily on the first piece of information (anchor) when making decisions. Even random numbers can influence our estimates!',
            framing: '<strong>Framing Effect:</strong><br>The way information is presented affects our decisions. "90% survival rate" feels different from "10% death rate" even though they\'re identical.',
            availability: '<strong>Availability Heuristic:</strong><br>We judge probability by how easily examples come to mind. Dramatic events (plane crashes) seem more likely than mundane ones (car accidents).',
            confirmation: '<strong>Confirmation Bias:</strong><br>We seek information that confirms our existing beliefs and ignore contradicting evidence. This creates echo chambers.'
        };

        const anchoringQuestions = [
            { question: "What percentage of African countries are in the United Nations?", actual: 28 },
            { question: "What is the average temperature in Antarctica (¬∞C)?", actual: -49 },
            { question: "How many bones are in the adult human body?", actual: 206 },
            { question: "What is the height of the Eiffel Tower in meters?", actual: 330 },
            { question: "How many countries are in Europe?", actual: 44 }
        ];

        const framingScenarios = [
            {
                gain: { title: "Program A", desc: "200 people will be saved." },
                loss: { title: "Program A", desc: "400 people will die." },
                question: "600 people are affected by a disease. Which program do you choose?"
            },
            {
                gain: { title: "Investment A", desc: "Guaranteed gain of $500." },
                loss: { title: "Investment A", desc: "50% chance to lose $1000, 50% chance to lose nothing." },
                question: "Choose your investment strategy:"
            }
        ];

        const availabilityItems = [
            { item: "Plane crash deaths", estimate: "~500/year", actual: "~300/year (US)", media: "High" },
            { item: "Car crash deaths", estimate: "~?", actual: "~40,000/year (US)", media: "Low" },
            { item: "Shark attack deaths", estimate: "~?", actual: "~5/year (US)", media: "High" },
            { item: "Falling deaths", estimate: "~?", actual: "~36,000/year (US)", media: "Low" }
        ];

        const confirmationScenarios = [
            {
                belief: "Coffee is good for your health",
                evidence: [
                    { text: "Study shows coffee drinkers have 15% lower risk of death", type: "supporting" },
                    { text: "Caffeine linked to increased anxiety and sleep problems", type: "opposing" },
                    { text: "Antioxidants in coffee reduce inflammation", type: "supporting" },
                    { text: "Coffee can increase blood pressure temporarily", type: "opposing" },
                    { text: "Regular consumption associated with lower depression risk", type: "supporting" },
                    { text: "Can lead to dependency and withdrawal symptoms", type: "opposing" }
                ]
            }
        ];

        function showAnchoring() {
            const q = anchoringQuestions[Math.floor(Math.random() * anchoringQuestions.length)];
            currentAnchor = Math.random() > 0.5 ?
                Math.floor(Math.random() * 30) + 10 :
                Math.floor(Math.random() * 30) + 60;

            biasDemo.innerHTML = `
                <div class="anchoring-demo">
                    <div class="demo-title">Anchoring Effect Demo</div>
                    <p style="color: #94a3b8; margin-bottom: 20px;">First, consider this number:</p>
                    <div class="anchor-number">${currentAnchor}</div>
                    <p style="color: #94a3b8; font-size: 0.9rem; margin-bottom: 30px;">(This is a randomly generated number)</p>
                    <div class="question">${q.question}</div>
                    <div class="estimate-input">
                        <input type="number" id="estimate" placeholder="Your estimate">
                        <button class="btn btn-primary" onclick="submitAnchoring(${q.actual})">Submit</button>
                    </div>
                </div>
            `;
            resultPanel.classList.remove('show');
        }

        function submitAnchoring(actual) {
            const estimate = parseInt(document.getElementById('estimate').value);
            if (isNaN(estimate)) return;

            if (currentAnchor >= 50) {
                trialData.anchoring.high.push(estimate);
            } else {
                trialData.anchoring.low.push(estimate);
            }

            const avgHigh = trialData.anchoring.high.length > 0 ?
                Math.round(trialData.anchoring.high.reduce((a,b) => a+b, 0) / trialData.anchoring.high.length) : '-';
            const avgLow = trialData.anchoring.low.length > 0 ?
                Math.round(trialData.anchoring.low.reduce((a,b) => a+b, 0) / trialData.anchoring.low.length) : '-';

            resultContent.innerHTML = `
                <div class="result-item">
                    <span>Your estimate:</span>
                    <span>${estimate}</span>
                </div>
                <div class="result-item">
                    <span>Actual answer:</span>
                    <span>${actual}</span>
                </div>
                <div class="result-item">
                    <span>Anchor shown:</span>
                    <span>${currentAnchor} (${currentAnchor >= 50 ? 'HIGH' : 'LOW'})</span>
                </div>
                <div class="result-item">
                    <span>Your avg (high anchors):</span>
                    <span>${avgHigh}</span>
                </div>
                <div class="result-item">
                    <span>Your avg (low anchors):</span>
                    <span>${avgLow}</span>
                </div>
            `;
            resultPanel.classList.add('show');
            updateStats();
        }

        function showFraming() {
            const scenario = framingScenarios[Math.floor(Math.random() * framingScenarios.length)];
            currentFrame = Math.random() > 0.5 ? 'gain' : 'loss';

            const optionA = currentFrame === 'gain' ? scenario.gain : scenario.loss;
            const optionB = {
                title: "Program B",
                desc: currentFrame === 'gain' ?
                    "1/3 chance all 600 are saved, 2/3 chance no one is saved." :
                    "1/3 chance no one dies, 2/3 chance all 600 die."
            };

            biasDemo.innerHTML = `
                <div class="anchoring-demo">
                    <div class="demo-title">Framing Effect Demo</div>
                    <div class="question">${scenario.question}</div>
                    <p style="color: #94a3b8; margin: 10px 0;">Frame: ${currentFrame.toUpperCase()}</p>
                    <div class="framing-options">
                        <div class="framing-option" onclick="selectFraming(this, 'A')">
                            <h4>${optionA.title}</h4>
                            <p>${optionA.desc}</p>
                        </div>
                        <div class="framing-option" onclick="selectFraming(this, 'B')">
                            <h4>${optionB.title}</h4>
                            <p>${optionB.desc}</p>
                        </div>
                    </div>
                    <button class="btn btn-primary" onclick="submitFraming()" style="width: 100%;">Submit Choice</button>
                </div>
            `;
            window.selectedFraming = null;
            resultPanel.classList.remove('show');
        }

        function selectFraming(el, choice) {
            document.querySelectorAll('.framing-option').forEach(o => o.classList.remove('selected'));
            el.classList.add('selected');
            window.selectedFraming = choice;
        }

        function submitFraming() {
            if (!window.selectedFraming) return;

            trialData.framing[currentFrame].push(window.selectedFraming);

            const gainA = trialData.framing.gain.filter(x => x === 'A').length;
            const gainTotal = trialData.framing.gain.length;
            const lossA = trialData.framing.loss.filter(x => x === 'A').length;
            const lossTotal = trialData.framing.loss.length;

            resultContent.innerHTML = `
                <div class="result-item">
                    <span>Your choice:</span>
                    <span>${window.selectedFraming === 'A' ? 'Certain option' : 'Risky option'}</span>
                </div>
                <div class="result-item">
                    <span>Frame:</span>
                    <span>${currentFrame.toUpperCase()}</span>
                </div>
                <hr style="border-color: rgba(251, 191, 36, 0.2); margin: 15px 0;">
                <p style="font-size: 0.9rem; color: #94a3b8; margin-bottom: 10px;">
                    People typically prefer the certain option in gain frames (risk-averse) but the risky option in loss frames (risk-seeking).
                </p>
                <div class="result-item">
                    <span>Gain frame (chose certain):</span>
                    <span>${gainTotal > 0 ? Math.round(gainA/gainTotal*100) : 0}%</span>
                </div>
                <div class="result-item">
                    <span>Loss frame (chose certain):</span>
                    <span>${lossTotal > 0 ? Math.round(lossA/lossTotal*100) : 0}%</span>
                </div>
            `;
            resultPanel.classList.add('show');
            updateStats();
        }

        function showAvailability() {
            biasDemo.innerHTML = `
                <div class="anchoring-demo">
                    <div class="demo-title">Availability Heuristic Demo</div>
                    <div class="question">Which causes more deaths annually in the US?</div>
                    <div class="availability-grid">
                        <div class="availability-item" onclick="selectAvailability(this, 'plane')">
                            <h4 style="color: #fbbf24;">‚úàÔ∏è Plane Crashes</h4>
                            <p style="color: #94a3b8;">Commercial aviation</p>
                        </div>
                        <div class="availability-item" onclick="selectAvailability(this, 'car')">
                            <h4 style="color: #fbbf24;">üöó Car Crashes</h4>
                            <p style="color: #94a3b8;">Traffic accidents</p>
                        </div>
                        <div class="availability-item" onclick="selectAvailability(this, 'shark')">
                            <h4 style="color: #fbbf24;">ü¶à Shark Attacks</h4>
                            <p style="color: #94a3b8;">Ocean incidents</p>
                        </div>
                        <div class="availability-item" onclick="selectAvailability(this, 'fall')">
                            <h4 style="color: #fbbf24;">ü™ú Falls</h4>
                            <p style="color: #94a3b8;">Accidental falls</p>
                        </div>
                    </div>
                    <button class="btn btn-primary" onclick="submitAvailability()" style="width: 100%;">Submit Ranking</button>
                    <p style="color: #94a3b8; font-size: 0.85rem; margin-top: 15px;">Click items to rank from MOST (1st) to LEAST (4th) deaths</p>
                </div>
            `;
            window.availabilityRanking = [];
            resultPanel.classList.remove('show');
        }

        function selectAvailability(el, item) {
            if (window.availabilityRanking.includes(item)) {
                window.availabilityRanking = window.availabilityRanking.filter(x => x !== item);
                el.classList.remove('selected');
                el.querySelector('h4').textContent = el.querySelector('h4').textContent.replace(/^\d+\.\s*/, '');
            } else if (window.availabilityRanking.length < 4) {
                window.availabilityRanking.push(item);
                el.classList.add('selected');
                const emojis = { plane: '‚úàÔ∏è', car: 'üöó', shark: 'ü¶à', fall: 'ü™ú' };
                const names = { plane: 'Plane Crashes', car: 'Car Crashes', shark: 'Shark Attacks', fall: 'Falls' };
                el.querySelector('h4').textContent = `${window.availabilityRanking.length}. ${emojis[item]} ${names[item]}`;
            }
        }

        function submitAvailability() {
            if (window.availabilityRanking.length !== 4) {
                alert('Please rank all 4 items');
                return;
            }

            const actualRanking = ['car', 'fall', 'plane', 'shark'];
            const actualDeaths = {
                car: '~40,000',
                fall: '~36,000',
                plane: '~300',
                shark: '~5'
            };

            let score = 0;
            window.availabilityRanking.forEach((item, i) => {
                if (item === actualRanking[i]) score++;
            });

            trialData.availability.responses.push(score);

            resultContent.innerHTML = `
                <p style="color: #94a3b8; margin-bottom: 15px;">Your ranking vs actual deaths:</p>
                ${window.availabilityRanking.map((item, i) => `
                    <div class="result-item" style="${item === actualRanking[i] ? 'background: rgba(34, 197, 94, 0.2);' : 'background: rgba(239, 68, 68, 0.2);'}">
                        <span>Your #${i+1}: ${item}</span>
                        <span>Actual #${i+1}: ${actualRanking[i]} (${actualDeaths[actualRanking[i]]})</span>
                    </div>
                `).join('')}
                <p style="color: #94a3b8; font-size: 0.85rem; margin-top: 15px;">
                    Media coverage makes dramatic but rare events (plane crashes, sharks) feel more common than mundane but frequent causes.
                </p>
            `;
            resultPanel.classList.add('show');
            updateStats();
        }

        function showConfirmation() {
            const scenario = confirmationScenarios[0];

            biasDemo.innerHTML = `
                <div class="anchoring-demo">
                    <div class="demo-title">Confirmation Bias Demo</div>
                    <div class="confirmation-scenario">
                        <p style="color: #94a3b8;">Imagine you believe:</p>
                        <h3 style="color: #fbbf24; margin: 10px 0;">"${scenario.belief}"</h3>
                        <p style="color: #94a3b8; font-size: 0.9rem;">Select the evidence you find most compelling (choose at least 3):</p>
                    </div>
                    <div class="evidence-list">
                        ${scenario.evidence.map((e, i) => `
                            <div class="evidence-item" onclick="selectEvidence(this, '${e.type}', ${i})">
                                <span class="evidence-type ${e.type}">${e.type}</span>
                                <span>${e.text}</span>
                            </div>
                        `).join('')}
                    </div>
                    <button class="btn btn-primary" onclick="submitConfirmation()" style="width: 100%;">Analyze My Selection</button>
                </div>
            `;
            window.selectedEvidence = [];
            resultPanel.classList.remove('show');
        }

        function selectEvidence(el, type, idx) {
            if (window.selectedEvidence.includes(idx)) {
                window.selectedEvidence = window.selectedEvidence.filter(x => x !== idx);
                el.classList.remove('selected');
            } else {
                window.selectedEvidence.push(idx);
                el.classList.add('selected');
            }
        }

        function submitConfirmation() {
            if (window.selectedEvidence.length < 3) {
                alert('Please select at least 3 pieces of evidence');
                return;
            }

            const scenario = confirmationScenarios[0];
            let supporting = 0, opposing = 0;

            window.selectedEvidence.forEach(idx => {
                if (scenario.evidence[idx].type === 'supporting') supporting++;
                else opposing++;
            });

            trialData.confirmation.supporting += supporting;
            trialData.confirmation.opposing += opposing;

            const totalS = trialData.confirmation.supporting;
            const totalO = trialData.confirmation.opposing;
            const biasRatio = totalS / (totalS + totalO);

            resultContent.innerHTML = `
                <div class="result-item">
                    <span>Supporting evidence selected:</span>
                    <span style="color: #22c55e;">${supporting}</span>
                </div>
                <div class="result-item">
                    <span>Opposing evidence selected:</span>
                    <span style="color: #ef4444;">${opposing}</span>
                </div>
                <div class="result-item">
                    <span>Selection ratio:</span>
                    <span>${Math.round(supporting/(supporting+opposing)*100)}% confirming</span>
                </div>
                <hr style="border-color: rgba(251, 191, 36, 0.2); margin: 15px 0;">
                <div class="result-item">
                    <span>Overall bias ratio:</span>
                    <span>${Math.round(biasRatio * 100)}% confirming</span>
                </div>
                <p style="color: #94a3b8; font-size: 0.85rem; margin-top: 15px;">
                    ${biasRatio > 0.6 ?
                        'You showed a preference for confirming evidence. This is very common!' :
                        'Good job seeking balanced information!'}
                </p>
            `;
            resultPanel.classList.add('show');
            updateStats();
        }

        function updateStats() {
            const trials = trialData.anchoring.high.length + trialData.anchoring.low.length +
                          trialData.framing.gain.length + trialData.framing.loss.length +
                          trialData.availability.responses.length +
                          (trialData.confirmation.supporting + trialData.confirmation.opposing > 0 ? 1 : 0);

            document.getElementById('trialsCount').textContent = trials;

            // Anchoring score
            if (trialData.anchoring.high.length > 0 && trialData.anchoring.low.length > 0) {
                const avgHigh = trialData.anchoring.high.reduce((a,b) => a+b, 0) / trialData.anchoring.high.length;
                const avgLow = trialData.anchoring.low.reduce((a,b) => a+b, 0) / trialData.anchoring.low.length;
                const diff = avgHigh - avgLow;
                document.getElementById('anchoringScore').textContent =
                    diff > 10 ? 'Strong' : diff > 5 ? 'Moderate' : 'Low';
            }

            // Framing score
            if (trialData.framing.gain.length > 0 && trialData.framing.loss.length > 0) {
                const gainA = trialData.framing.gain.filter(x => x === 'A').length / trialData.framing.gain.length;
                const lossA = trialData.framing.loss.filter(x => x === 'A').length / trialData.framing.loss.length;
                const diff = gainA - lossA;
                document.getElementById('framingScore').textContent =
                    diff > 0.3 ? 'Strong' : diff > 0.1 ? 'Moderate' : 'Low';
            }

            // Availability score
            if (trialData.availability.responses.length > 0) {
                const avg = trialData.availability.responses.reduce((a,b) => a+b, 0) / trialData.availability.responses.length;
                document.getElementById('availabilityScore').textContent =
                    avg < 2 ? 'Strong' : avg < 3 ? 'Moderate' : 'Low';
            }

            // Confirmation score
            const totalConf = trialData.confirmation.supporting + trialData.confirmation.opposing;
            if (totalConf > 0) {
                const ratio = trialData.confirmation.supporting / totalConf;
                document.getElementById('confirmationScore').textContent =
                    ratio > 0.7 ? 'Strong' : ratio > 0.5 ? 'Moderate' : 'Low';
            }
        }

        function showBias(type) {
            currentBias = type;
            biasInfo.innerHTML = biasInfoTexts[type];
            switch (type) {
                case 'anchoring': showAnchoring(); break;
                case 'framing': showFraming(); break;
                case 'availability': showAvailability(); break;
                case 'confirmation': showConfirmation(); break;
            }
        }

        biasType.addEventListener('change', () => showBias(biasType.value));
        nextBtn.addEventListener('click', () => showBias(currentBias));

        showAnchoring();
    </script>
</body>
</html>
