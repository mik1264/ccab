<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Riemann Sums - CCAB</title>
    <link rel="stylesheet" href="../assets/css/gallery-standard.css">
    <style>
        body {
            background: #fff;
            color: #333;
            font-family: system-ui;
            padding: 2rem;
            text-align: center;
        }
        .container { max-width: 1000px; margin: 0 auto; }
        
        canvas {
            border: 1px solid #ccc;
            border-radius: 8px;
            background: #fafafa;
        }
        
        .controls {
            margin: 20px;
            display: inline-flex;
            gap: 20px;
            align-items: center;
        }
        
        select, input { padding: 5px; }
        
        .results {
            font-size: 1.2rem;
            font-family: monospace;
            color: #059669;
        }
        
    </style>
</head>
<body>

<div class="container">
    <a href="../index.html" class="gallery-back">‚Üê Back to Gallery</a>
    <h1>Riemann Sum Visualizer</h1>
    <p>Approximating the area under \( f(x) = 0.1x^3 - 0.5x^2 + 2x + 2 \) from 0 to 6.</p>
    
    <canvas id="canvas" width="600" height="400"></canvas>
    
    <div class="controls">
        <label>Method:</label>
        <select id="method" onchange="update()">
            <option value="left">Left Endpoint</option>
            <option value="right">Right Endpoint</option>
            <option value="mid">Midpoint</option>
            <option value="trap">Trapezoidal</option>
        </select>
        
        <label>Partitions (n): <span id="n-val">10</span></label>
        <input type="range" id="n-slider" min="2" max="100" value="10" oninput="update()">
    </div>
    
    <div class="results">
        Approx Area: <span id="area-val">0.00</span> | Actual Area: <span id="true-area">46.20</span>
    </div>
</div>

<script>
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    
    // Function
    function f(x) {
        return 0.1 * Math.pow(x, 3) - 0.5 * Math.pow(x, 2) + 2 * x + 2;
    }
    
    // Integral 0 to 6
    // F(x) = 0.1 x^4/4 - 0.5 x^3/3 + x^2 + 2x
    // F(6) = 0.1*324 - 0.5*72 + 36 + 12 = 32.4 - 36 + 48 = 44.4
    // Wait. 6^4/4 = 1296/4 = 324. 324*0.1=32.4.
    // 6^3/3 = 216/3 = 72. 72*0.5=36.
    // 6^2 = 36.
    // 2*6 = 12.
    // 32.4 - 36 + 36 + 12 = 44.4.
    // Let's recheck equation. +2x. F is x^2. 
    // Wait. f=2x -> F=x^2. f=2 -> F=2x.
    // Sum: 32.4 - 36 + 36 + 12 = 44.4. Correct.
    
    const trueArea = 44.4;
    document.getElementById('true-area').textContent = trueArea.toFixed(4);
    
    const scaleX = 80;
    const scaleY = 20;
    const offsetX = 50;
    const offsetY = 350;
    
    function update() {
        const n = parseInt(document.getElementById('n-slider').value);
        document.getElementById('n-val').textContent = n;
        const method = document.getElementById('method').value;
        
        ctx.clearRect(0, 0, 600, 400);
        drawAxes();
        drawFunction();
        
        const a = 0;
        const b = 6;
        const dx = (b - a) / n;
        let sum = 0;
        
        ctx.fillStyle = 'rgba(59, 130, 246, 0.3)';
        ctx.strokeStyle = '#1d4ed8';
        ctx.lineWidth = 1;
        
        for (let i = 0; i < n; i++) {
            const xLeft = a + i * dx;
            const xRight = xLeft + dx;
            
            let h = 0;
            if (method === 'left') h = f(xLeft);
            else if (method === 'right') h = f(xRight);
            else if (method === 'mid') h = f((xLeft + xRight) / 2);
            
            // Draw Rect
            if (method !== 'trap') {
                const px = offsetX + xLeft * scaleX;
                const py = offsetY - h * scaleY;
                const pw = dx * scaleX;
                const ph = h * scaleY;
                
                ctx.fillRect(px, py, pw, ph);
                ctx.strokeRect(px, py, pw, ph);
                sum += h * dx;
            } else {
                // Trapezoid
                const h1 = f(xLeft);
                const h2 = f(xRight);
                const px1 = offsetX + xLeft * scaleX;
                const py1 = offsetY - h1 * scaleY;
                const px2 = offsetX + xRight * scaleX;
                const py2 = offsetY - h2 * scaleY;
                
                ctx.beginPath();
                ctx.moveTo(px1, offsetY);
                ctx.lineTo(px1, py1);
                ctx.lineTo(px2, py2);
                ctx.lineTo(px2, offsetY);
                ctx.closePath();
                ctx.fill();
                ctx.stroke();
                
                sum += ((h1 + h2) / 2) * dx;
            }
        }
        
        document.getElementById('area-val').textContent = sum.toFixed(4);
    }
    
    function drawAxes() {
        ctx.strokeStyle = '#333';
        ctx.lineWidth = 2;
        ctx.beginPath();
        // X
        ctx.moveTo(offsetX, offsetY); ctx.lineTo(offsetX + 6.5*scaleX, offsetY);
        // Y
        ctx.moveTo(offsetX, offsetY); ctx.lineTo(offsetX, offsetY - 15*scaleY);
        ctx.stroke();
        
        ctx.fillStyle = '#000';
        ctx.font = '12px Arial';
        for(let i=0; i<=6; i++) {
            ctx.fillText(i, offsetX + i*scaleX - 5, offsetY + 20);
        }
    }
    
    function drawFunction() {
        ctx.strokeStyle = '#ef4444';
        ctx.lineWidth = 3;
        ctx.beginPath();
        for (let x = 0; x <= 6; x += 0.1) {
            const px = offsetX + x * scaleX;
            const py = offsetY - f(x) * scaleY;
            if (x===0) ctx.moveTo(px, py);
            else ctx.lineTo(px, py);
        }
        ctx.stroke();
    }
    
    update();

</script>
</body>
</html>
