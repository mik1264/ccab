<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Predator-Prey Dynamics - Biology & Ecology</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', system-ui, sans-serif; background: linear-gradient(135deg, #1a2e1a 0%, #163e16 100%); color: #eee; min-height: 100vh; padding: 20px; }
        .back-link { position: fixed; top: 20px; left: 20px; color: #4ade80; text-decoration: none; font-weight: 600; padding: 8px 16px; background: rgba(0,0,0,0.3); border-radius: 20px; z-index: 100; }
        h1 { text-align: center; margin: 40px 0 10px; font-size: 2.2em; color: #4ade80; }
        .subtitle { text-align: center; opacity: 0.8; margin-bottom: 20px; }
        .container { max-width: 1200px; margin: 0 auto; display: grid; grid-template-columns: 1fr 300px; gap: 20px; }
        .panel { background: rgba(255,255,255,0.05); border-radius: 12px; padding: 25px; }
        .info-box { background: rgba(74, 222, 128, 0.1); border: 1px solid rgba(74, 222, 128, 0.3); border-radius: 8px; padding: 15px; margin-bottom: 20px; font-size: 0.85em; line-height: 1.6; }
        h3 { color: #4ade80; margin-bottom: 15px; }
        canvas { width: 100%; border-radius: 8px; background: #0a150a; }
        .control-group { margin: 15px 0; }
        .control-group label { display: block; margin-bottom: 5px; }
        .control-group input { width: 100%; }
        .value-display { color: #4ade80; font-family: monospace; }
        button { width: 100%; padding: 12px; margin: 8px 0; border: none; border-radius: 8px; font-size: 1em; font-weight: 600; cursor: pointer; }
        .btn-primary { background: #4ade80; color: #1a2e1a; }
        .btn-secondary { background: rgba(255,255,255,0.1); color: #fff; }
        .population-display { display: flex; gap: 15px; margin: 15px 0; }
        .pop-box { flex: 1; background: rgba(0,0,0,0.2); border-radius: 8px; padding: 15px; text-align: center; }
        .pop-value { font-size: 1.5em; font-weight: bold; }
        .prey { color: #4ade80; }
        .predator { color: #f87171; }
        .equations { background: rgba(0,0,0,0.2); border-radius: 8px; padding: 15px; font-family: monospace; font-size: 0.85em; margin: 15px 0; }
        @media (max-width: 900px) { .container { grid-template-columns: 1fr; } }
    </style>
</head>
<body>
    <a href="index.html" class="back-link">‚Üê Back</a>
    <h1>Predator-Prey Dynamics</h1>
    <p class="subtitle">Lotka-Volterra population model</p>

    <div class="container">
        <div class="panel">
            <canvas id="phaseCanvas" width="400" height="300"></canvas>
            <canvas id="timeCanvas" width="800" height="200" style="margin-top: 15px;"></canvas>
        </div>

        <div class="panel">
            <div class="info-box">
                <strong>Lotka-Volterra Model:</strong>
                Prey grow exponentially but are eaten by predators.
                Predators grow when prey is abundant but die without food.
                This creates characteristic boom-bust cycles in both populations.
            </div>

            <div class="equations">
                dx/dt = Œ±x - Œ≤xy<br>
                dy/dt = Œ¥xy - Œ≥y<br><br>
                x = prey, y = predators
            </div>

            <div class="population-display">
                <div class="pop-box">
                    <div class="pop-value prey" id="preyCount">üê∞ 100</div>
                    <div>Prey</div>
                </div>
                <div class="pop-box">
                    <div class="pop-value predator" id="predCount">ü¶ä 20</div>
                    <div>Predators</div>
                </div>
            </div>

            <h3>Parameters</h3>
            <div class="control-group">
                <label>Œ± (Prey birth rate): <span class="value-display" id="alphaVal">1.0</span></label>
                <input type="range" id="alphaSlider" min="50" max="200" value="100" oninput="updateParams()">
            </div>

            <div class="control-group">
                <label>Œ≤ (Predation rate): <span class="value-display" id="betaVal">0.02</span></label>
                <input type="range" id="betaSlider" min="5" max="50" value="20" oninput="updateParams()">
            </div>

            <div class="control-group">
                <label>Œ¥ (Predator efficiency): <span class="value-display" id="deltaVal">0.01</span></label>
                <input type="range" id="deltaSlider" min="5" max="30" value="10" oninput="updateParams()">
            </div>

            <div class="control-group">
                <label>Œ≥ (Predator death rate): <span class="value-display" id="gammaVal">1.0</span></label>
                <input type="range" id="gammaSlider" min="50" max="200" value="100" oninput="updateParams()">
            </div>

            <button class="btn-primary" onclick="toggleSimulation()">Start/Stop</button>
            <button class="btn-secondary" onclick="resetSimulation()">Reset</button>
        </div>
    </div>

    <script>
        const phaseCanvas = document.getElementById('phaseCanvas');
        const pctx = phaseCanvas.getContext('2d');
        const timeCanvas = document.getElementById('timeCanvas');
        const tctx = timeCanvas.getContext('2d');

        let prey = 100;
        let predators = 20;
        let alpha = 1.0;   // Prey birth rate
        let beta = 0.02;   // Predation rate
        let delta = 0.01;  // Predator efficiency
        let gamma = 1.0;   // Predator death rate

        let history = [];
        let phaseHistory = [];
        let running = false;
        let dt = 0.01;

        function updateParams() {
            alpha = parseInt(document.getElementById('alphaSlider').value) / 100;
            beta = parseInt(document.getElementById('betaSlider').value) / 1000;
            delta = parseInt(document.getElementById('deltaSlider').value) / 1000;
            gamma = parseInt(document.getElementById('gammaSlider').value) / 100;

            document.getElementById('alphaVal').textContent = alpha.toFixed(2);
            document.getElementById('betaVal').textContent = beta.toFixed(3);
            document.getElementById('deltaVal').textContent = delta.toFixed(3);
            document.getElementById('gammaVal').textContent = gamma.toFixed(2);
        }

        function lotkaVolterra() {
            // dx/dt = Œ±x - Œ≤xy
            // dy/dt = Œ¥xy - Œ≥y

            const dPrey = alpha * prey - beta * prey * predators;
            const dPred = delta * prey * predators - gamma * predators;

            prey += dPrey * dt;
            predators += dPred * dt;

            // Ensure non-negative
            prey = Math.max(0.1, prey);
            predators = Math.max(0.1, predators);

            // Record history
            history.push({ prey, predators });
            phaseHistory.push({ x: prey, y: predators });

            if (history.length > 1000) history.shift();
            if (phaseHistory.length > 2000) phaseHistory.shift();
        }

        function updateDisplay() {
            document.getElementById('preyCount').textContent = 'üê∞ ' + Math.round(prey);
            document.getElementById('predCount').textContent = 'ü¶ä ' + Math.round(predators);
        }

        function drawPhase() {
            pctx.fillStyle = '#0a150a';
            pctx.fillRect(0, 0, phaseCanvas.width, phaseCanvas.height);

            // Axes
            pctx.strokeStyle = 'rgba(255,255,255,0.2)';
            pctx.lineWidth = 1;
            pctx.beginPath();
            pctx.moveTo(50, phaseCanvas.height - 30);
            pctx.lineTo(phaseCanvas.width - 20, phaseCanvas.height - 30);
            pctx.moveTo(50, phaseCanvas.height - 30);
            pctx.lineTo(50, 20);
            pctx.stroke();

            // Axis labels
            pctx.fillStyle = '#4ade80';
            pctx.font = '12px sans-serif';
            pctx.fillText('Prey', phaseCanvas.width / 2, phaseCanvas.height - 10);
            pctx.save();
            pctx.translate(15, phaseCanvas.height / 2);
            pctx.rotate(-Math.PI / 2);
            pctx.fillStyle = '#f87171';
            pctx.fillText('Predators', 0, 0);
            pctx.restore();

            if (phaseHistory.length < 2) return;

            // Draw trajectory
            const scaleX = (phaseCanvas.width - 80) / 300;
            const scaleY = (phaseCanvas.height - 60) / 100;

            pctx.strokeStyle = 'rgba(250, 204, 21, 0.5)';
            pctx.lineWidth = 1;
            pctx.beginPath();
            phaseHistory.forEach((p, i) => {
                const x = 50 + p.x * scaleX;
                const y = phaseCanvas.height - 30 - p.y * scaleY;
                if (i === 0) pctx.moveTo(x, y);
                else pctx.lineTo(x, y);
            });
            pctx.stroke();

            // Current point
            const current = phaseHistory[phaseHistory.length - 1];
            const cx = 50 + current.x * scaleX;
            const cy = phaseCanvas.height - 30 - current.y * scaleY;

            pctx.fillStyle = '#facc15';
            pctx.beginPath();
            pctx.arc(cx, cy, 6, 0, Math.PI * 2);
            pctx.fill();

            // Equilibrium point
            const eqX = gamma / delta;
            const eqY = alpha / beta;
            const ex = 50 + eqX * scaleX;
            const ey = phaseCanvas.height - 30 - eqY * scaleY;

            pctx.strokeStyle = 'rgba(255,255,255,0.5)';
            pctx.setLineDash([3, 3]);
            pctx.beginPath();
            pctx.arc(ex, ey, 8, 0, Math.PI * 2);
            pctx.stroke();
            pctx.setLineDash([]);

            pctx.fillStyle = '#fff';
            pctx.font = 'bold 12px sans-serif';
            pctx.fillText('Phase Space', 60, 20);
        }

        function drawTime() {
            tctx.fillStyle = '#0a150a';
            tctx.fillRect(0, 0, timeCanvas.width, timeCanvas.height);

            // Axes
            tctx.strokeStyle = 'rgba(255,255,255,0.2)';
            tctx.lineWidth = 1;
            tctx.beginPath();
            tctx.moveTo(50, timeCanvas.height - 30);
            tctx.lineTo(timeCanvas.width - 20, timeCanvas.height - 30);
            tctx.moveTo(50, 20);
            tctx.lineTo(50, timeCanvas.height - 30);
            tctx.stroke();

            tctx.fillStyle = '#fff';
            tctx.font = '12px sans-serif';
            tctx.fillText('Time', timeCanvas.width / 2, timeCanvas.height - 10);
            tctx.fillText('Population', 5, 15);

            if (history.length < 2) return;

            const maxPop = Math.max(
                ...history.map(h => h.prey),
                ...history.map(h => h.predators),
                100
            );

            const scaleX = (timeCanvas.width - 70) / history.length;
            const scaleY = (timeCanvas.height - 60) / maxPop;

            // Prey line
            tctx.strokeStyle = '#4ade80';
            tctx.lineWidth = 2;
            tctx.beginPath();
            history.forEach((h, i) => {
                const x = 50 + i * scaleX;
                const y = timeCanvas.height - 30 - h.prey * scaleY;
                if (i === 0) tctx.moveTo(x, y);
                else tctx.lineTo(x, y);
            });
            tctx.stroke();

            // Predator line
            tctx.strokeStyle = '#f87171';
            tctx.lineWidth = 2;
            tctx.beginPath();
            history.forEach((h, i) => {
                const x = 50 + i * scaleX;
                const y = timeCanvas.height - 30 - h.predators * scaleY;
                if (i === 0) tctx.moveTo(x, y);
                else tctx.lineTo(x, y);
            });
            tctx.stroke();

            // Legend
            tctx.fillStyle = '#4ade80';
            tctx.fillRect(timeCanvas.width - 100, 15, 15, 15);
            tctx.fillStyle = '#fff';
            tctx.fillText('Prey', timeCanvas.width - 80, 27);

            tctx.fillStyle = '#f87171';
            tctx.fillRect(timeCanvas.width - 100, 35, 15, 15);
            tctx.fillStyle = '#fff';
            tctx.fillText('Predators', timeCanvas.width - 80, 47);
        }

        function toggleSimulation() {
            running = !running;
            if (running) animate();
        }

        function resetSimulation() {
            prey = 100;
            predators = 20;
            history = [];
            phaseHistory = [];
            updateDisplay();
            drawPhase();
            drawTime();
        }

        function animate() {
            if (!running) return;

            for (let i = 0; i < 10; i++) {
                lotkaVolterra();
            }

            updateDisplay();
            drawPhase();
            drawTime();

            requestAnimationFrame(animate);
        }

        updateParams();
        resetSimulation();
    </script>
</body>
</html>
