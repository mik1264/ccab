<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Circular Path - Orbital Motion</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: linear-gradient(135deg, #0f0f23 0%, #1a1a3e 100%);
            min-height: 100vh;
            color: #e0e0e0;
        }
        .container {
            display: flex;
            min-height: 100vh;
        }
        .sidebar {
            width: 320px;
            background: rgba(0,0,0,0.3);
            padding: 20px;
            overflow-y: auto;
            border-right: 1px solid rgba(255,255,255,0.1);
        }
        .main {
            flex: 1;
            display: flex;
            flex-direction: column;
        }
        header {
            padding: 20px;
            background: rgba(0,0,0,0.2);
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        h1 {
            font-size: 1.8em;
            margin-bottom: 8px;
            background: linear-gradient(135deg, #60a5fa 0%, #a78bfa 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .subtitle {
            color: #888;
            font-size: 0.95em;
        }
        .canvas-container {
            flex: 1;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        canvas {
            border-radius: 12px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.3);
        }
        .control-group {
            margin-bottom: 20px;
        }
        .control-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #bbb;
        }
        .control-group select,
        .control-group input[type="range"] {
            width: 100%;
            margin-bottom: 5px;
            padding: 8px;
            border-radius: 6px;
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            color: #e0e0e0;
        }
        .control-group .value {
            text-align: right;
            font-size: 0.9em;
            color: #60a5fa;
        }
        button {
            width: 100%;
            padding: 12px;
            margin-bottom: 10px;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .btn-primary {
            background: linear-gradient(135deg, #60a5fa 0%, #8b5cf6 100%);
            color: white;
        }
        .btn-secondary {
            background: rgba(255,255,255,0.1);
            color: #e0e0e0;
        }
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(96,165,250,0.3);
        }
        .stats {
            background: rgba(255,255,255,0.05);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        .stats h3 {
            margin-bottom: 12px;
            color: #60a5fa;
            font-size: 1em;
        }
        .stat-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 0.9em;
        }
        .stat-label {
            color: #888;
        }
        .stat-value {
            color: #93c5fd;
            font-weight: 600;
        }
        .info-box {
            background: rgba(96,165,250,0.1);
            border-left: 3px solid #60a5fa;
            padding: 12px;
            margin-bottom: 20px;
            font-size: 0.85em;
            border-radius: 0 8px 8px 0;
        }
        .back-link {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            color: #888;
            text-decoration: none;
            font-size: 0.9em;
            margin-bottom: 15px;
            transition: color 0.3s;
        }
        .back-link:hover {
            color: #60a5fa;
        }
        .formula {
            font-family: 'Times New Roman', serif;
            text-align: center;
            padding: 10px;
            background: rgba(0,0,0,0.2);
            border-radius: 8px;
            margin-bottom: 15px;
            color: #93c5fd;
        }
        .checkbox-group {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 5px;
        }
        .checkbox-group label {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 0.85em;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div class="container">
        <aside class="sidebar">
            <a href="index.html" class="back-link">← Back to Simulations</a>

            <div class="info-box">
                <strong>Circular Motion</strong><br>
                Explore uniform circular motion, elliptical orbits, and spirals. Observe centripetal acceleration and the relationship between speed, radius, and period.
            </div>

            <div class="control-group">
                <label>Path Type:</label>
                <select id="pathType">
                    <option value="circle">Uniform Circle</option>
                    <option value="ellipse">Elliptical Orbit</option>
                    <option value="spiral-in">Spiral Inward</option>
                    <option value="spiral-out">Spiral Outward</option>
                    <option value="epicycle">Epicycle (Circle on Circle)</option>
                    <option value="lissajous">Lissajous Figure</option>
                </select>
            </div>

            <div class="control-group">
                <label>Number of Particles: <span class="value" id="countVal">3</span></label>
                <input type="range" id="count" min="1" max="12" value="3">
            </div>

            <div class="control-group">
                <label>Angular Speed (ω): <span class="value" id="omegaVal">1.0</span> rad/s</label>
                <input type="range" id="omega" min="0.1" max="5" step="0.1" value="1">
            </div>

            <div class="control-group">
                <label>Radius: <span class="value" id="radiusVal">150</span> px</label>
                <input type="range" id="radius" min="50" max="250" value="150">
            </div>

            <div class="control-group">
                <label>Eccentricity (ellipse): <span class="value" id="eccVal">0.5</span></label>
                <input type="range" id="ecc" min="0" max="0.9" step="0.1" value="0.5">
            </div>

            <div class="control-group">
                <label>Display Options:</label>
                <div class="checkbox-group">
                    <label><input type="checkbox" id="showVelocity" checked> Velocity</label>
                    <label><input type="checkbox" id="showAccel" checked> Acceleration</label>
                    <label><input type="checkbox" id="showTrail" checked> Trail</label>
                    <label><input type="checkbox" id="showRadius" checked> Radius Line</label>
                </div>
            </div>

            <button class="btn-primary" id="startBtn">Start</button>
            <button class="btn-secondary" id="resetBtn">Reset</button>

            <div class="stats">
                <h3>Motion Parameters</h3>
                <div class="stat-row">
                    <span class="stat-label">Period (T):</span>
                    <span class="stat-value" id="period">0.00 s</span>
                </div>
                <div class="stat-row">
                    <span class="stat-label">Linear Speed (v):</span>
                    <span class="stat-value" id="speed">0.00 px/s</span>
                </div>
                <div class="stat-row">
                    <span class="stat-label">Centripetal Accel:</span>
                    <span class="stat-value" id="accel">0.00 px/s²</span>
                </div>
                <div class="stat-row">
                    <span class="stat-label">Current Angle:</span>
                    <span class="stat-value" id="angle">0.00°</span>
                </div>
                <div class="stat-row">
                    <span class="stat-label">Revolutions:</span>
                    <span class="stat-value" id="revs">0</span>
                </div>
            </div>

            <div class="formula">
                v = ωr<br>
                a<sub>c</sub> = ω²r = v²/r<br>
                T = 2π/ω
            </div>
        </aside>

        <main class="main">
            <header>
                <h1>Circular Path Motion</h1>
                <p class="subtitle">Explore circular, elliptical, and spiral trajectories with velocity and acceleration vectors</p>
            </header>
            <div class="canvas-container">
                <canvas id="simCanvas"></canvas>
            </div>
        </main>
    </div>

    <script>
        const canvas = document.getElementById('simCanvas');
        const ctx = canvas.getContext('2d');

        // Canvas sizing
        function resizeCanvas() {
            const container = canvas.parentElement;
            canvas.width = Math.min(container.clientWidth - 40, 700);
            canvas.height = canvas.width;
        }
        resizeCanvas();
        window.addEventListener('resize', resizeCanvas);

        // Simulation state
        let particles = [];
        let running = false;
        let animationId = null;
        let time = 0;
        let lastTime = 0;

        // Controls
        const controls = {
            pathType: document.getElementById('pathType'),
            count: document.getElementById('count'),
            omega: document.getElementById('omega'),
            radius: document.getElementById('radius'),
            ecc: document.getElementById('ecc'),
            showVelocity: document.getElementById('showVelocity'),
            showAccel: document.getElementById('showAccel'),
            showTrail: document.getElementById('showTrail'),
            showRadius: document.getElementById('showRadius')
        };

        // Update value displays
        ['count', 'omega', 'radius', 'ecc'].forEach(key => {
            const input = controls[key];
            const valueSpan = document.getElementById(key + 'Val');
            input.addEventListener('input', () => {
                valueSpan.textContent = input.value;
                initParticles();
            });
        });

        controls.pathType.addEventListener('change', initParticles);

        // Particle class
        class Particle {
            constructor(phaseOffset, color) {
                this.phaseOffset = phaseOffset;
                this.color = color;
                this.trail = [];
                this.x = 0;
                this.y = 0;
                this.vx = 0;
                this.vy = 0;
                this.ax = 0;
                this.ay = 0;
            }

            update(t) {
                const pathType = controls.pathType.value;
                const omega = parseFloat(controls.omega.value);
                const radius = parseFloat(controls.radius.value);
                const ecc = parseFloat(controls.ecc.value);
                const cx = canvas.width / 2;
                const cy = canvas.height / 2;

                const angle = omega * t + this.phaseOffset;

                switch (pathType) {
                    case 'circle':
                        this.x = cx + radius * Math.cos(angle);
                        this.y = cy + radius * Math.sin(angle);
                        this.vx = -radius * omega * Math.sin(angle);
                        this.vy = radius * omega * Math.cos(angle);
                        this.ax = -radius * omega * omega * Math.cos(angle);
                        this.ay = -radius * omega * omega * Math.sin(angle);
                        break;

                    case 'ellipse':
                        const a = radius;
                        const b = radius * (1 - ecc);
                        this.x = cx + a * Math.cos(angle);
                        this.y = cy + b * Math.sin(angle);
                        this.vx = -a * omega * Math.sin(angle);
                        this.vy = b * omega * Math.cos(angle);
                        this.ax = -a * omega * omega * Math.cos(angle);
                        this.ay = -b * omega * omega * Math.sin(angle);
                        break;

                    case 'spiral-in':
                        const rIn = radius * Math.exp(-0.1 * t);
                        this.x = cx + rIn * Math.cos(angle);
                        this.y = cy + rIn * Math.sin(angle);
                        this.vx = -rIn * (0.1 * Math.cos(angle) + omega * Math.sin(angle));
                        this.vy = -rIn * (0.1 * Math.sin(angle) - omega * Math.cos(angle));
                        this.ax = -omega * omega * (this.x - cx);
                        this.ay = -omega * omega * (this.y - cy);
                        break;

                    case 'spiral-out':
                        const rOut = 20 + radius * (1 - Math.exp(-0.1 * t));
                        this.x = cx + rOut * Math.cos(angle);
                        this.y = cy + rOut * Math.sin(angle);
                        this.vx = -rOut * omega * Math.sin(angle);
                        this.vy = rOut * omega * Math.cos(angle);
                        this.ax = -omega * omega * (this.x - cx);
                        this.ay = -omega * omega * (this.y - cy);
                        break;

                    case 'epicycle':
                        const r1 = radius * 0.7;
                        const r2 = radius * 0.3;
                        const omega2 = omega * 3;
                        this.x = cx + r1 * Math.cos(angle) + r2 * Math.cos(omega2 * t + this.phaseOffset);
                        this.y = cy + r1 * Math.sin(angle) + r2 * Math.sin(omega2 * t + this.phaseOffset);
                        this.vx = -r1 * omega * Math.sin(angle) - r2 * omega2 * Math.sin(omega2 * t + this.phaseOffset);
                        this.vy = r1 * omega * Math.cos(angle) + r2 * omega2 * Math.cos(omega2 * t + this.phaseOffset);
                        this.ax = -r1 * omega * omega * Math.cos(angle) - r2 * omega2 * omega2 * Math.cos(omega2 * t + this.phaseOffset);
                        this.ay = -r1 * omega * omega * Math.sin(angle) - r2 * omega2 * omega2 * Math.sin(omega2 * t + this.phaseOffset);
                        break;

                    case 'lissajous':
                        const freqX = 3;
                        const freqY = 2;
                        this.x = cx + radius * Math.sin(freqX * angle);
                        this.y = cy + radius * Math.sin(freqY * angle + Math.PI / 2);
                        this.vx = radius * freqX * omega * Math.cos(freqX * angle);
                        this.vy = radius * freqY * omega * Math.cos(freqY * angle + Math.PI / 2);
                        this.ax = -radius * freqX * freqX * omega * omega * Math.sin(freqX * angle);
                        this.ay = -radius * freqY * freqY * omega * omega * Math.sin(freqY * angle + Math.PI / 2);
                        break;
                }

                // Add to trail
                this.trail.push({ x: this.x, y: this.y });
                if (this.trail.length > 500) this.trail.shift();
            }
        }

        // Initialize particles
        function initParticles() {
            const count = parseInt(controls.count.value);
            const colors = [
                '#60a5fa', '#f472b6', '#34d399', '#fbbf24',
                '#a78bfa', '#fb923c', '#22d3d8', '#f87171',
                '#84cc16', '#e879f9', '#38bdf8', '#facc15'
            ];

            particles = [];
            for (let i = 0; i < count; i++) {
                const phaseOffset = (i / count) * Math.PI * 2;
                particles.push(new Particle(phaseOffset, colors[i % colors.length]));
            }

            time = 0;
        }

        // Update stats
        function updateStats() {
            const omega = parseFloat(controls.omega.value);
            const radius = parseFloat(controls.radius.value);

            const period = (2 * Math.PI / omega).toFixed(2);
            const speed = (omega * radius).toFixed(2);
            const accel = (omega * omega * radius).toFixed(2);
            const angleDeg = ((time * omega * 180 / Math.PI) % 360).toFixed(1);
            const revs = Math.floor(time * omega / (2 * Math.PI));

            document.getElementById('period').textContent = period + ' s';
            document.getElementById('speed').textContent = speed + ' px/s';
            document.getElementById('accel').textContent = accel + ' px/s²';
            document.getElementById('angle').textContent = angleDeg + '°';
            document.getElementById('revs').textContent = revs;
        }

        // Draw simulation
        function draw() {
            ctx.fillStyle = '#0f0f23';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            const cx = canvas.width / 2;
            const cy = canvas.height / 2;
            const radius = parseFloat(controls.radius.value);

            // Draw center point
            ctx.fillStyle = '#4b5563';
            ctx.beginPath();
            ctx.arc(cx, cy, 5, 0, Math.PI * 2);
            ctx.fill();

            // Draw reference circle/ellipse
            ctx.strokeStyle = 'rgba(255,255,255,0.1)';
            ctx.lineWidth = 1;
            ctx.setLineDash([5, 5]);

            const pathType = controls.pathType.value;
            if (pathType === 'circle' || pathType === 'spiral-in' || pathType === 'spiral-out') {
                ctx.beginPath();
                ctx.arc(cx, cy, radius, 0, Math.PI * 2);
                ctx.stroke();
            } else if (pathType === 'ellipse') {
                const ecc = parseFloat(controls.ecc.value);
                ctx.beginPath();
                ctx.ellipse(cx, cy, radius, radius * (1 - ecc), 0, 0, Math.PI * 2);
                ctx.stroke();
            }
            ctx.setLineDash([]);

            // Draw particles
            for (const particle of particles) {
                // Trail
                if (controls.showTrail.checked && particle.trail.length > 1) {
                    ctx.strokeStyle = particle.color;
                    ctx.lineWidth = 2;
                    ctx.globalAlpha = 0.5;
                    ctx.beginPath();
                    ctx.moveTo(particle.trail[0].x, particle.trail[0].y);
                    for (let i = 1; i < particle.trail.length; i++) {
                        ctx.lineTo(particle.trail[i].x, particle.trail[i].y);
                    }
                    ctx.stroke();
                    ctx.globalAlpha = 1;
                }

                // Radius line
                if (controls.showRadius.checked) {
                    ctx.strokeStyle = 'rgba(255,255,255,0.3)';
                    ctx.lineWidth = 1;
                    ctx.beginPath();
                    ctx.moveTo(cx, cy);
                    ctx.lineTo(particle.x, particle.y);
                    ctx.stroke();
                }

                // Velocity vector
                if (controls.showVelocity.checked) {
                    const scale = 0.3;
                    ctx.strokeStyle = '#22c55e';
                    ctx.lineWidth = 2;
                    ctx.beginPath();
                    ctx.moveTo(particle.x, particle.y);
                    ctx.lineTo(particle.x + particle.vx * scale, particle.y + particle.vy * scale);
                    ctx.stroke();

                    // Arrow head
                    const angle = Math.atan2(particle.vy, particle.vx);
                    ctx.beginPath();
                    ctx.moveTo(particle.x + particle.vx * scale, particle.y + particle.vy * scale);
                    ctx.lineTo(
                        particle.x + particle.vx * scale - 8 * Math.cos(angle - 0.3),
                        particle.y + particle.vy * scale - 8 * Math.sin(angle - 0.3)
                    );
                    ctx.lineTo(
                        particle.x + particle.vx * scale - 8 * Math.cos(angle + 0.3),
                        particle.y + particle.vy * scale - 8 * Math.sin(angle + 0.3)
                    );
                    ctx.closePath();
                    ctx.fillStyle = '#22c55e';
                    ctx.fill();
                }

                // Acceleration vector (centripetal)
                if (controls.showAccel.checked) {
                    const scale = 0.1;
                    ctx.strokeStyle = '#ef4444';
                    ctx.lineWidth = 2;
                    ctx.beginPath();
                    ctx.moveTo(particle.x, particle.y);
                    ctx.lineTo(particle.x + particle.ax * scale, particle.y + particle.ay * scale);
                    ctx.stroke();

                    // Arrow head
                    const angle = Math.atan2(particle.ay, particle.ax);
                    ctx.beginPath();
                    ctx.moveTo(particle.x + particle.ax * scale, particle.y + particle.ay * scale);
                    ctx.lineTo(
                        particle.x + particle.ax * scale - 8 * Math.cos(angle - 0.3),
                        particle.y + particle.ay * scale - 8 * Math.sin(angle - 0.3)
                    );
                    ctx.lineTo(
                        particle.x + particle.ax * scale - 8 * Math.cos(angle + 0.3),
                        particle.y + particle.ay * scale - 8 * Math.sin(angle + 0.3)
                    );
                    ctx.closePath();
                    ctx.fillStyle = '#ef4444';
                    ctx.fill();
                }

                // Particle
                ctx.fillStyle = particle.color;
                ctx.beginPath();
                ctx.arc(particle.x, particle.y, 10, 0, Math.PI * 2);
                ctx.fill();
                ctx.strokeStyle = '#fff';
                ctx.lineWidth = 2;
                ctx.stroke();
            }

            // Legend
            ctx.font = '12px sans-serif';
            ctx.textAlign = 'left';
            if (controls.showVelocity.checked) {
                ctx.fillStyle = '#22c55e';
                ctx.fillText('→ Velocity', 20, canvas.height - 40);
            }
            if (controls.showAccel.checked) {
                ctx.fillStyle = '#ef4444';
                ctx.fillText('→ Centripetal Acceleration', 20, canvas.height - 20);
            }
        }

        // Animation loop
        function animate(currentTime) {
            if (!running) return;

            const dt = (currentTime - lastTime) / 1000;
            lastTime = currentTime;

            time += dt;

            for (const particle of particles) {
                particle.update(time);
            }

            updateStats();
            draw();
            animationId = requestAnimationFrame(animate);
        }

        // Event listeners
        document.getElementById('startBtn').addEventListener('click', () => {
            running = !running;
            document.getElementById('startBtn').textContent = running ? 'Pause' : 'Start';
            if (running) {
                lastTime = performance.now();
                animate(lastTime);
            }
        });

        document.getElementById('resetBtn').addEventListener('click', () => {
            running = false;
            document.getElementById('startBtn').textContent = 'Start';
            if (animationId) cancelAnimationFrame(animationId);
            initParticles();
            time = 0;
            for (const p of particles) p.update(0);
            updateStats();
            draw();
        });

        // Initialize
        initParticles();
        for (const p of particles) p.update(0);
        updateStats();
        draw();
    </script>
</body>
</html>
