<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Two-Region Population Model</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 15px;
            color: #e0e0e0;
        }
        h1 {
            font-size: 1.5rem;
            margin-bottom: 5px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .description {
            text-align: center;
            max-width: 700px;
            margin-bottom: 15px;
            font-size: 0.85rem;
            color: #888;
        }
        #container { display: flex; gap: 20px; flex-wrap: wrap; justify-content: center; }
        .regions-container { display: flex; gap: 30px; align-items: center; }
        .region {
            text-align: center;
            padding: 20px;
            background: rgba(0,0,0,0.4);
            border-radius: 12px;
            width: 200px;
        }
        .region h3 { color: #667eea; margin-bottom: 10px; }
        .region-visual {
            width: 150px;
            height: 150px;
            margin: 10px auto;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            font-weight: bold;
            transition: all 0.5s;
        }
        .region-a .region-visual { background: linear-gradient(135deg, #667eea, #764ba2); }
        .region-b .region-visual { background: linear-gradient(135deg, #f093fb, #f5576c); }
        .migration-arrow {
            font-size: 2rem;
            color: #555;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }
        .migration-arrow .flow { font-size: 0.8rem; }
        .panel {
            background: rgba(0,0,0,0.6);
            padding: 15px;
            border-radius: 8px;
            width: 280px;
        }
        .panel h3 { font-size: 0.9rem; margin-bottom: 10px; color: #667eea; }
        .control-group { margin-bottom: 12px; }
        .control-group.region-a label { color: #667eea; }
        .control-group.region-b label { color: #f5576c; }
        label { display: block; font-size: 0.75rem; color: #aaa; margin-bottom: 3px; }
        input[type="range"] { width: 100%; }
        button {
            width: 100%;
            padding: 8px;
            margin-bottom: 8px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            border: none;
            border-radius: 5px;
            color: white;
            cursor: pointer;
            font-weight: bold;
        }
        button:hover { opacity: 0.9; }
        .stats { font-size: 0.75rem; color: #888; }
        .stats div { margin-bottom: 4px; display: flex; justify-content: space-between; }
        .back-link {
            position: fixed;
            top: 10px;
            left: 10px;
            padding: 8px 16px;
            background: rgba(0,0,0,0.8);
            color: #667eea;
            text-decoration: none;
            border-radius: 6px;
            font-size: 14px;
            z-index: 100;
        }
        #chartCanvas {
            background: rgba(0,0,0,0.4);
            border-radius: 8px;
            margin-top: 15px;
        }
    </style>
</head>
<body>
    <a href="index.html" class="back-link">← Back</a>
    <h1>Two-Region Population Model</h1>
    <p class="description">A dynamic population model with migration between two regions. People migrate based on population pressure, carrying capacity, and economic opportunities.</p>

    <div id="container">
        <div class="regions-container">
            <div class="region region-a">
                <h3>Region A</h3>
                <div class="region-visual" id="vizA">1000</div>
                <div class="stats">
                    <div><span>Capacity:</span> <span id="capA">2000</span></div>
                    <div><span>Pressure:</span> <span id="pressA">50</span>%</div>
                </div>
            </div>

            <div class="migration-arrow">
                <div>→ <span class="flow" id="flowAB">0</span></div>
                <div>⇄</div>
                <div>← <span class="flow" id="flowBA">0</span></div>
            </div>

            <div class="region region-b">
                <h3>Region B</h3>
                <div class="region-visual" id="vizB">500</div>
                <div class="stats">
                    <div><span>Capacity:</span> <span id="capB">1500</span></div>
                    <div><span>Pressure:</span> <span id="pressB">33</span>%</div>
                </div>
            </div>
        </div>

        <div class="panel">
            <h3>Region A Parameters</h3>
            <div class="control-group region-a">
                <label>Initial Population: <span id="popAVal">1000</span></label>
                <input type="range" id="popA" min="100" max="3000" step="100" value="1000">
            </div>
            <div class="control-group region-a">
                <label>Carrying Capacity: <span id="capAVal">2000</span></label>
                <input type="range" id="capacityA" min="500" max="5000" step="100" value="2000">
            </div>
            <div class="control-group region-a">
                <label>Birth Rate: <span id="birthAVal">0.02</span></label>
                <input type="range" id="birthA" min="0.01" max="0.05" step="0.005" value="0.02">
            </div>

            <h3>Region B Parameters</h3>
            <div class="control-group region-b">
                <label>Initial Population: <span id="popBVal">500</span></label>
                <input type="range" id="popB" min="100" max="3000" step="100" value="500">
            </div>
            <div class="control-group region-b">
                <label>Carrying Capacity: <span id="capBVal">1500</span></label>
                <input type="range" id="capacityB" min="500" max="5000" step="100" value="1500">
            </div>
            <div class="control-group region-b">
                <label>Birth Rate: <span id="birthBVal">0.02</span></label>
                <input type="range" id="birthB" min="0.01" max="0.05" step="0.005" value="0.02">
            </div>

            <h3>Migration Parameters</h3>
            <div class="control-group">
                <label>Migration Sensitivity: <span id="migSensVal">0.1</span></label>
                <input type="range" id="migSens" min="0.01" max="0.3" step="0.01" value="0.1">
            </div>
            <div class="control-group">
                <label>Base Death Rate: <span id="deathVal">0.01</span></label>
                <input type="range" id="deathRate" min="0.005" max="0.03" step="0.001" value="0.01">
            </div>

            <button id="resetBtn">Reset</button>
            <button id="pauseBtn">Pause</button>

            <h3>Totals</h3>
            <div class="stats">
                <div><span>Total Population:</span> <span id="totalPop">1500</span></div>
                <div><span>Net Migration:</span> <span id="netMig">0</span></div>
                <div><span>Time Steps:</span> <span id="timeSteps">0</span></div>
            </div>
        </div>
    </div>

    <canvas id="chartCanvas" width="700" height="200"></canvas>

    <script>
        const chartCanvas = document.getElementById('chartCanvas');
        const chartCtx = chartCanvas.getContext('2d');

        let popA, popB;
        let capacityA, capacityB;
        let birthRateA, birthRateB;
        let migrationSensitivity;
        let deathRate;
        let timeSteps = 0;
        let running = true;
        let history = { a: [], b: [], total: [] };

        function init() {
            popA = parseInt(document.getElementById('popA').value);
            popB = parseInt(document.getElementById('popB').value);
            capacityA = parseInt(document.getElementById('capacityA').value);
            capacityB = parseInt(document.getElementById('capacityB').value);
            birthRateA = parseFloat(document.getElementById('birthA').value);
            birthRateB = parseFloat(document.getElementById('birthB').value);
            migrationSensitivity = parseFloat(document.getElementById('migSens').value);
            deathRate = parseFloat(document.getElementById('deathRate').value);
            timeSteps = 0;
            history = { a: [], b: [], total: [] };
        }

        function step() {
            // Calculate population pressures
            const pressureA = popA / capacityA;
            const pressureB = popB / capacityB;

            // Calculate migration flows based on pressure differential
            const pressureDiff = pressureA - pressureB;
            let migrationAtoB = 0;
            let migrationBtoA = 0;

            if (pressureDiff > 0) {
                // A is more crowded, people move to B
                migrationAtoB = Math.floor(popA * pressureDiff * migrationSensitivity);
            } else {
                // B is more crowded, people move to A
                migrationBtoA = Math.floor(popB * (-pressureDiff) * migrationSensitivity);
            }

            // Natural growth with carrying capacity limits (logistic growth)
            const growthA = popA * birthRateA * (1 - pressureA);
            const growthB = popB * birthRateB * (1 - pressureB);

            // Deaths (increased with overcrowding)
            const deathsA = popA * deathRate * (1 + Math.max(0, pressureA - 1));
            const deathsB = popB * deathRate * (1 + Math.max(0, pressureB - 1));

            // Update populations
            popA = Math.max(0, Math.round(popA + growthA - deathsA - migrationAtoB + migrationBtoA));
            popB = Math.max(0, Math.round(popB + growthB - deathsB - migrationBtoA + migrationAtoB));

            // Record history
            history.a.push(popA);
            history.b.push(popB);
            history.total.push(popA + popB);
            if (history.a.length > 300) {
                history.a.shift();
                history.b.shift();
                history.total.shift();
            }

            timeSteps++;

            // Update displays
            updateDisplays(migrationAtoB, migrationBtoA);
        }

        function updateDisplays(flowAB, flowBA) {
            const pressureA = (popA / capacityA * 100).toFixed(0);
            const pressureB = (popB / capacityB * 100).toFixed(0);

            document.getElementById('vizA').textContent = popA.toLocaleString();
            document.getElementById('vizB').textContent = popB.toLocaleString();

            // Scale visual size based on population
            const sizeA = 100 + (popA / 3000) * 80;
            const sizeB = 100 + (popB / 3000) * 80;
            document.getElementById('vizA').style.width = sizeA + 'px';
            document.getElementById('vizA').style.height = sizeA + 'px';
            document.getElementById('vizB').style.width = sizeB + 'px';
            document.getElementById('vizB').style.height = sizeB + 'px';

            document.getElementById('pressA').textContent = pressureA;
            document.getElementById('pressB').textContent = pressureB;
            document.getElementById('capA').textContent = capacityA;
            document.getElementById('capB').textContent = capacityB;

            document.getElementById('flowAB').textContent = flowAB;
            document.getElementById('flowBA').textContent = flowBA;

            document.getElementById('totalPop').textContent = (popA + popB).toLocaleString();
            document.getElementById('netMig').textContent = (flowAB - flowBA > 0 ? '+' : '') + (flowAB - flowBA);
            document.getElementById('timeSteps').textContent = timeSteps;

            drawChart();
        }

        function drawChart() {
            chartCtx.fillStyle = 'rgba(0,0,0,0.4)';
            chartCtx.fillRect(0, 0, chartCanvas.width, chartCanvas.height);

            if (history.a.length < 2) return;

            const maxPop = Math.max(...history.total, capacityA + capacityB) * 1.1;
            const w = chartCanvas.width;
            const h = chartCanvas.height - 20;

            // Draw capacity lines
            chartCtx.setLineDash([5, 5]);
            chartCtx.strokeStyle = 'rgba(102, 126, 234, 0.3)';
            chartCtx.beginPath();
            const capAY = h - (capacityA / maxPop) * h + 10;
            chartCtx.moveTo(0, capAY);
            chartCtx.lineTo(w, capAY);
            chartCtx.stroke();

            chartCtx.strokeStyle = 'rgba(245, 87, 108, 0.3)';
            chartCtx.beginPath();
            const capBY = h - (capacityB / maxPop) * h + 10;
            chartCtx.moveTo(0, capBY);
            chartCtx.lineTo(w, capBY);
            chartCtx.stroke();
            chartCtx.setLineDash([]);

            // Draw population lines
            const drawLine = (data, color) => {
                chartCtx.strokeStyle = color;
                chartCtx.lineWidth = 2;
                chartCtx.beginPath();
                data.forEach((val, i) => {
                    const x = (i / data.length) * w;
                    const y = h - (val / maxPop) * h + 10;
                    if (i === 0) chartCtx.moveTo(x, y);
                    else chartCtx.lineTo(x, y);
                });
                chartCtx.stroke();
            };

            drawLine(history.a, '#667eea');
            drawLine(history.b, '#f5576c');
            drawLine(history.total, '#888');

            // Legend
            chartCtx.font = '12px sans-serif';
            chartCtx.fillStyle = '#667eea';
            chartCtx.fillText('Region A', 10, 15);
            chartCtx.fillStyle = '#f5576c';
            chartCtx.fillText('Region B', 80, 15);
            chartCtx.fillStyle = '#888';
            chartCtx.fillText('Total', 150, 15);
        }

        // Control listeners
        ['popA', 'popB', 'capacityA', 'capacityB', 'birthA', 'birthB', 'migSens', 'deathRate'].forEach(id => {
            document.getElementById(id).addEventListener('input', function() {
                const valId = id.replace('capacity', 'cap').replace('birth', 'birth').replace('migSens', 'migSens').replace('deathRate', 'death') + 'Val';
                const displayId = document.getElementById(valId);
                if (displayId) {
                    displayId.textContent = this.value;
                }
            });
        });

        document.getElementById('popA').addEventListener('input', function() {
            document.getElementById('popAVal').textContent = this.value;
        });
        document.getElementById('popB').addEventListener('input', function() {
            document.getElementById('popBVal').textContent = this.value;
        });
        document.getElementById('capacityA').addEventListener('input', function() {
            document.getElementById('capAVal').textContent = this.value;
            capacityA = parseInt(this.value);
        });
        document.getElementById('capacityB').addEventListener('input', function() {
            document.getElementById('capBVal').textContent = this.value;
            capacityB = parseInt(this.value);
        });
        document.getElementById('birthA').addEventListener('input', function() {
            document.getElementById('birthAVal').textContent = parseFloat(this.value).toFixed(3);
            birthRateA = parseFloat(this.value);
        });
        document.getElementById('birthB').addEventListener('input', function() {
            document.getElementById('birthBVal').textContent = parseFloat(this.value).toFixed(3);
            birthRateB = parseFloat(this.value);
        });
        document.getElementById('migSens').addEventListener('input', function() {
            document.getElementById('migSensVal').textContent = parseFloat(this.value).toFixed(2);
            migrationSensitivity = parseFloat(this.value);
        });
        document.getElementById('deathRate').addEventListener('input', function() {
            document.getElementById('deathVal').textContent = parseFloat(this.value).toFixed(3);
            deathRate = parseFloat(this.value);
        });

        document.getElementById('resetBtn').addEventListener('click', init);
        document.getElementById('pauseBtn').addEventListener('click', function() {
            running = !running;
            this.textContent = running ? 'Pause' : 'Resume';
        });

        function animate() {
            if (running) {
                step();
            }
            setTimeout(animate, 100);
        }

        init();
        updateDisplays(0, 0);
        animate();
    </script>
</body>
</html>
