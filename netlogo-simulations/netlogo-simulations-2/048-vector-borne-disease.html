<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vector-Borne Disease - CCAB</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, sans-serif; background: #1a1a2e; color: #e8e6e1; overflow: hidden; }
        #container { display: flex; height: 100vh; }
        #canvas-container { flex: 1; position: relative; }
        canvas { display: block; width: 100%; height: 100%; }
        #controls { width: 300px; background: rgba(0,0,0,0.8); padding: 20px; overflow-y: auto; }
        h1 { font-size: 1.2rem; margin-bottom: 15px; color: #fbbf24; }
        .control-group { margin-bottom: 15px; }
        label { display: block; font-size: 0.8rem; margin-bottom: 5px; color: #aaa; }
        input[type="range"] { width: 100%; }
        button { width: 100%; padding: 10px; margin-bottom: 10px; background: #fbbf24; color: #1a1a2e; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; }
        button:hover { background: #f59e0b; }
        .stats { background: rgba(255,255,255,0.1); padding: 10px; border-radius: 5px; font-size: 0.8rem; margin-bottom: 15px; }
        .back-link { position: fixed; top: 10px; left: 10px; padding: 8px 16px; background: rgba(0,0,0,0.7); color: #fbbf24; text-decoration: none; border-radius: 6px; font-size: 14px; z-index: 999; }
        .explain-btn { background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%); margin-top: 10px; }
        .modal-overlay { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.8); z-index: 1000; }
        .modal-overlay.active { display: flex; align-items: center; justify-content: center; }
        .modal { background: linear-gradient(135deg, #1e1e2e 0%, #2d2d44 100%); border-radius: 16px; padding: 30px; max-width: 600px; max-height: 80vh; overflow-y: auto; border: 1px solid rgba(255,255,255,0.1); position: relative; }
        .modal-close { position: absolute; top: 15px; right: 20px; background: none; border: none; color: #888; font-size: 28px; cursor: pointer; width: auto; }
        .modal h2 { color: #fbbf24; margin-bottom: 20px; }
        .modal-body { color: #ccc; line-height: 1.8; }
        .modal-body h3 { color: #fcd34d; margin: 20px 0 10px; }
        .modal-body strong { color: #fbbf24; }
    </style>
</head>
<body>
    <a href="index.html" class="back-link">‚Üê Back to Gallery</a>
    <div id="container">
        <div id="canvas-container"><canvas id="canvas"></canvas></div>
        <div id="controls">
            <h1>Vector-Borne Disease</h1>
            <div class="control-group">
                <label>Vector Density: <span id="vectorValue">50</span></label>
                <input type="range" id="vector" min="10" max="150" value="50">
            </div>
            <div class="control-group">
                <label>Bite Rate: <span id="biteValue">0.3</span></label>
                <input type="range" id="bite" min="0.1" max="0.8" step="0.05" value="0.3">
            </div>
            <div class="control-group">
                <label>Vector Lifespan: <span id="lifespanValue">30</span> days</label>
                <input type="range" id="lifespan" min="10" max="60" value="30">
            </div>
            <button id="reset">Reset</button>
            <button id="spray">Apply Insecticide</button>
            <button id="explainBtn" class="explain-btn">üìö Explain</button>
            <div class="stats">
                <div>Humans Infected: <span id="humansInfected">0</span></div>
                <div>Vectors Infected: <span id="vectorsInfected">0</span></div>
                <div>Vector Population: <span id="vectorPop">0</span></div>
                <div>R‚ÇÄ (Vectorial): <span id="r0">0</span></div>
                <div>Total Cases: <span id="cases">0</span></div>
            </div>
        </div>
    </div>
    <div id="explainModal" class="modal-overlay">
        <div class="modal">
            <button class="modal-close">&times;</button>
            <h2>ü¶ü Vector-Borne Disease</h2>
            <div class="modal-body">
                <p><strong>Vector-borne diseases</strong> are transmitted by arthropod vectors (mosquitoes, ticks, flies) rather than direct contact.</p>
                <h3>Two-Host System</h3>
                <ul>
                    <li>Pathogen cycles between vertebrate hosts and vector</li>
                    <li>Vector becomes infected by biting infected host</li>
                    <li>Vector transmits when biting susceptible host</li>
                </ul>
                <h3>Ross-Macdonald Model</h3>
                <p>R‚ÇÄ = ma¬≤bce^(-ŒºT) / (Œºr)</p>
                <ul>
                    <li><strong>m:</strong> Vector density (vectors per human)</li>
                    <li><strong>a:</strong> Biting rate</li>
                    <li><strong>b, c:</strong> Transmission probabilities</li>
                    <li><strong>Œº:</strong> Vector mortality rate</li>
                </ul>
                <h3>Control Strategies</h3>
                <p>Reducing vector population (insecticides, habitat control) or bite rate (bed nets, repellents) can dramatically reduce R‚ÇÄ.</p>
            </div>
        </div>
    </div>
    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        let params = { vectorDensity: 50, biteRate: 0.3, lifespan: 30 };
        let humans = [], vectors = [], totalCases = 0, day = 0;
        const S = 0, I = 1, R = 2;
        
        function resize() { canvas.width = document.getElementById('canvas-container').clientWidth; canvas.height = document.getElementById('canvas-container').clientHeight; }
        function init() {
            resize();
            totalCases = 0; day = 0;
            humans = [];
            vectors = [];
            for (let i = 0; i < 100; i++) {
                humans.push({
                    x: Math.random() * canvas.width,
                    y: Math.random() * canvas.height,
                    vx: (Math.random() - 0.5) * 1,
                    vy: (Math.random() - 0.5) * 1,
                    state: S,
                    daysInfected: 0
                });
            }
            for (let i = 0; i < params.vectorDensity; i++) {
                vectors.push(createVector());
            }
            humans[0].state = I;
            totalCases = 1;
        }
        function createVector() {
            return {
                x: Math.random() * canvas.width,
                y: Math.random() * canvas.height,
                vx: (Math.random() - 0.5) * 4,
                vy: (Math.random() - 0.5) * 4,
                infected: false,
                age: 0,
                target: null
            };
        }
        function spray() {
            vectors = vectors.filter(() => Math.random() > 0.7);
        }
        function update() {
            day++;
            // Human movement and recovery
            for (let h of humans) {
                h.x += h.vx;
                h.y += h.vy;
                if (h.x < 0 || h.x > canvas.width) h.vx *= -1;
                if (h.y < 0 || h.y > canvas.height) h.vy *= -1;
                h.x = Math.max(0, Math.min(canvas.width, h.x));
                h.y = Math.max(0, Math.min(canvas.height, h.y));
                if (h.state === I) {
                    h.daysInfected++;
                    if (h.daysInfected > 14) {
                        h.state = R;
                    }
                }
            }
            // Vector behavior
            for (let v of vectors) {
                v.age++;
                // Find nearest human
                let nearest = null, minDist = Infinity;
                for (let h of humans) {
                    const dx = h.x - v.x, dy = h.y - v.y;
                    const d = dx*dx + dy*dy;
                    if (d < minDist) { minDist = d; nearest = h; }
                }
                if (nearest && minDist > 100) {
                    // Move toward nearest human
                    const dx = nearest.x - v.x, dy = nearest.y - v.y;
                    const dist = Math.sqrt(dx*dx + dy*dy);
                    v.vx = (dx / dist) * 3;
                    v.vy = (dy / dist) * 3;
                } else {
                    v.vx += (Math.random() - 0.5) * 0.5;
                    v.vy += (Math.random() - 0.5) * 0.5;
                }
                v.x += v.vx;
                v.y += v.vy;
                v.x = Math.max(0, Math.min(canvas.width, v.x));
                v.y = Math.max(0, Math.min(canvas.height, v.y));
                // Biting
                if (nearest && minDist < 100 && Math.random() < params.biteRate * 0.02) {
                    if (v.infected && nearest.state === S) {
                        nearest.state = I;
                        nearest.daysInfected = 0;
                        totalCases++;
                    }
                    if (!v.infected && nearest.state === I) {
                        v.infected = true;
                    }
                }
            }
            // Vector death and replacement
            vectors = vectors.filter(v => v.age < params.lifespan);
            while (vectors.length < params.vectorDensity) {
                vectors.push(createVector());
            }
        }
        function draw() {
            ctx.fillStyle = '#1a1a2e';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            // Draw humans
            for (let h of humans) {
                ctx.beginPath();
                ctx.arc(h.x, h.y, 8, 0, Math.PI * 2);
                ctx.fillStyle = h.state === S ? '#3b82f6' : (h.state === I ? '#ef4444' : '#22c55e');
                ctx.fill();
            }
            // Draw vectors
            for (let v of vectors) {
                ctx.beginPath();
                ctx.arc(v.x, v.y, 3, 0, Math.PI * 2);
                ctx.fillStyle = v.infected ? '#fbbf24' : '#6b7280';
                ctx.fill();
            }
            // Stats
            const humansInfected = humans.filter(h => h.state === I).length;
            const vectorsInfected = vectors.filter(v => v.infected).length;
            const m = vectors.length / humans.length;
            const a = params.biteRate;
            const r0 = (m * a * a * 0.5 * 0.5 * Math.exp(-0.03 * 10) / (0.03 * 0.1)).toFixed(2);
            document.getElementById('humansInfected').textContent = humansInfected;
            document.getElementById('vectorsInfected').textContent = vectorsInfected;
            document.getElementById('vectorPop').textContent = vectors.length;
            document.getElementById('r0').textContent = r0;
            document.getElementById('cases').textContent = totalCases;
        }
        function animate() { update(); draw(); requestAnimationFrame(animate); }
        document.getElementById('vector').addEventListener('input', e => { params.vectorDensity = parseInt(e.target.value); document.getElementById('vectorValue').textContent = params.vectorDensity; });
        document.getElementById('bite').addEventListener('input', e => { params.biteRate = parseFloat(e.target.value); document.getElementById('biteValue').textContent = params.biteRate.toFixed(2); });
        document.getElementById('lifespan').addEventListener('input', e => { params.lifespan = parseInt(e.target.value); document.getElementById('lifespanValue').textContent = params.lifespan; });
        document.getElementById('reset').addEventListener('click', init);
        document.getElementById('spray').addEventListener('click', spray);
        window.addEventListener('resize', () => { resize(); init(); });
        const modal = document.getElementById('explainModal');
        document.getElementById('explainBtn').addEventListener('click', () => modal.classList.add('active'));
        modal.querySelector('.modal-close').addEventListener('click', () => modal.classList.remove('active'));
        modal.addEventListener('click', e => { if (e.target === modal) modal.classList.remove('active'); });
        init(); animate();
    </script>
</body>
</html>
