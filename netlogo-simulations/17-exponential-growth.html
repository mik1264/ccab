<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exponential Growth - CCAB</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            font-family: 'Segoe UI', Arial, sans-serif;
            color: white;
        }
        .container { display: flex; height: 100vh; }
        .canvas-area {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 20px;
            gap: 10px;
        }
        canvas { border: 2px solid rgba(255, 255, 255, 0.2); border-radius: 8px; }
        .controls {
            width: 320px;
            padding: 20px;
            background: rgba(0, 0, 0, 0.6);
            overflow-y: auto;
        }
        h2 { margin: 0 0 15px 0; color: #ffeaa7; }
        h3 { margin: 15px 0 8px 0; color: #fdcb6e; font-size: 14px; }
        .slider-group { margin: 12px 0; }
        .slider-group label { display: block; margin-bottom: 5px; font-size: 13px; }
        input[type="range"] { width: 100%; }
        .stats {
            background: rgba(255,255,255,0.1);
            padding: 12px;
            border-radius: 8px;
            margin: 15px 0;
        }
        .stat-row { display: flex; justify-content: space-between; margin: 5px 0; font-size: 13px; }
        .description {
            background: rgba(255,255,255,0.1);
            padding: 12px;
            border-radius: 8px;
            font-size: 12px;
            line-height: 1.5;
            margin-top: 15px;
        }
        button {
            padding: 10px 20px;
            margin: 5px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            background: #ffeaa7;
            color: #1a1a2e;
            font-weight: bold;
        }
        button:hover { background: #fdcb6e; }
        .big-number {
            font-size: 2rem;
            text-align: center;
            color: #ffeaa7;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
        }
        select {
            width: 100%;
            padding: 8px;
            border: none;
            border-radius: 6px;
            background: rgba(255,255,255,0.1);
            color: white;
            font-size: 14px;
        }
        select option { background: #1a1a2e; }
    </style>
</head>
<body>
    <a href="index.html" class="organic-back-link" style="position: fixed; top: 20px; right: 20px; z-index: 1000; display: flex; align-items: center; gap: 8px; padding: 10px 16px; background: rgba(255,255,255,0.9); backdrop-filter: blur(10px); border-radius: 30px; text-decoration: none; color: #606C38; font-family: 'Nunito', sans-serif; font-weight: 600;">
        <span>‚Üê Gallery</span>
    </a>
    <div class="container">
        <div class="canvas-area">
            <canvas id="agentCanvas"></canvas>
            <canvas id="graphCanvas"></canvas>
        </div>
        <div class="controls">
            <h2>üìà Exponential Growth</h2>
            <p style="font-size: 12px; opacity: 0.8;">Population doubling dynamics</p>

            <div class="big-number">
                Pop: <span id="population">10</span>
            </div>

            <h3>Scenario</h3>
            <select id="scenario">
                <option value="bacteria">Bacteria Colony</option>
                <option value="investment">Compound Interest</option>
                <option value="virus">Viral Spread</option>
                <option value="rabbits">Rabbit Population</option>
            </select>

            <h3>Initial Population</h3>
            <div class="slider-group">
                <label>Start: <span id="initialVal">10</span></label>
                <input type="range" id="initial" min="1" max="50" step="1" value="10">
            </div>

            <h3>Growth Rate</h3>
            <div class="slider-group">
                <label>Rate (%): <span id="rateVal">10</span></label>
                <input type="range" id="rate" min="1" max="50" step="1" value="10">
            </div>

            <h3>Speed</h3>
            <div class="slider-group">
                <label>Delay (ms): <span id="speedVal">200</span></label>
                <input type="range" id="speed" min="50" max="500" step="50" value="200">
            </div>

            <button onclick="reset()">Reset</button>
            <button onclick="togglePause()" id="pauseBtn">Pause</button>

            <div class="stats">
                <div class="stat-row"><span>Time:</span><span id="time">0</span></div>
                <div class="stat-row"><span>Population:</span><span id="popStat">10</span></div>
                <div class="stat-row"><span>Doubling Time:</span><span id="doubling">7.27</span></div>
                <div class="stat-row"><span>Growth Factor:</span><span id="growthFactor">1.00</span></div>
                <div class="stat-row"><span>Doublings:</span><span id="doublings">0</span></div>
            </div>

            <div class="description">
                <strong>Exponential Growth:</strong><br>
                P(t) = P‚ÇÄ √ó (1 + r)·µó<br><br>
                <strong>Doubling Time:</strong><br>
                t‚ÇÇ = ln(2) / ln(1 + r) ‚âà 70 / r%<br><br>
                <strong>Key Insight:</strong><br>
                Growth starts slow but becomes explosively fast. A 10% growth rate doubles population every ~7 periods.<br><br>
                <strong>Examples:</strong> Bacteria, compound interest, viral spread, technology adoption
            </div>
        </div>
    </div>

    <script>
        const agentCanvas = document.getElementById('agentCanvas');
        const agentCtx = agentCanvas.getContext('2d');
        const graphCanvas = document.getElementById('graphCanvas');
        const graphCtx = graphCanvas.getContext('2d');

        agentCanvas.width = 600;
        agentCanvas.height = 350;
        graphCanvas.width = 600;
        graphCanvas.height = 150;

        let initialPop = 10;
        let rate = 0.10;
        let speed = 200;
        let population = 10;
        let time = 0;
        let paused = false;
        let history = [];
        let agents = [];
        let animationId = null;
        let scenario = 'bacteria';

        const scenarioColors = {
            bacteria: '#55efc4',
            investment: '#ffeaa7',
            virus: '#ff7675',
            rabbits: '#a29bfe'
        };

        function createAgents(count) {
            agents = [];
            for (let i = 0; i < Math.min(count, 500); i++) {
                agents.push({
                    x: Math.random() * agentCanvas.width,
                    y: Math.random() * agentCanvas.height,
                    vx: (Math.random() - 0.5) * 3,
                    vy: (Math.random() - 0.5) * 3,
                    size: 4 + Math.random() * 4
                });
            }
        }

        function reset() {
            if (animationId) clearTimeout(animationId);
            initialPop = parseInt(document.getElementById('initial').value);
            rate = parseInt(document.getElementById('rate').value) / 100;
            speed = parseInt(document.getElementById('speed').value);
            scenario = document.getElementById('scenario').value;
            population = initialPop;
            time = 0;
            history = [population];
            paused = false;
            document.getElementById('pauseBtn').textContent = 'Pause';
            createAgents(population);
            updateStats();
            draw();
            animate();
        }

        function step() {
            // Exponential growth
            population *= (1 + rate);
            time++;
            history.push(population);

            // Update agents to match population (capped for performance)
            const targetAgents = Math.min(Math.floor(population), 500);
            while (agents.length < targetAgents) {
                const parent = agents[Math.floor(Math.random() * agents.length)];
                agents.push({
                    x: parent ? parent.x + (Math.random() - 0.5) * 20 : Math.random() * agentCanvas.width,
                    y: parent ? parent.y + (Math.random() - 0.5) * 20 : Math.random() * agentCanvas.height,
                    vx: (Math.random() - 0.5) * 3,
                    vy: (Math.random() - 0.5) * 3,
                    size: 4 + Math.random() * 4
                });
            }

            // Move agents
            for (const agent of agents) {
                agent.x += agent.vx;
                agent.y += agent.vy;

                if (agent.x < 0 || agent.x > agentCanvas.width) agent.vx *= -1;
                if (agent.y < 0 || agent.y > agentCanvas.height) agent.vy *= -1;

                agent.x = Math.max(0, Math.min(agentCanvas.width, agent.x));
                agent.y = Math.max(0, Math.min(agentCanvas.height, agent.y));
            }
        }

        function updateStats() {
            const doublingTime = Math.log(2) / Math.log(1 + rate);
            const growthFactor = population / initialPop;
            const doublings = Math.log2(growthFactor);

            document.getElementById('time').textContent = time;
            document.getElementById('population').textContent = formatNumber(Math.floor(population));
            document.getElementById('popStat').textContent = formatNumber(Math.floor(population));
            document.getElementById('doubling').textContent = doublingTime.toFixed(2);
            document.getElementById('growthFactor').textContent = growthFactor.toFixed(2);
            document.getElementById('doublings').textContent = doublings.toFixed(2);
        }

        function formatNumber(n) {
            if (n >= 1e9) return (n / 1e9).toFixed(2) + 'B';
            if (n >= 1e6) return (n / 1e6).toFixed(2) + 'M';
            if (n >= 1e3) return (n / 1e3).toFixed(2) + 'K';
            return n.toString();
        }

        function draw() {
            // Agent canvas
            agentCtx.fillStyle = '#2d2d44';
            agentCtx.fillRect(0, 0, agentCanvas.width, agentCanvas.height);

            const color = scenarioColors[scenario];
            for (const agent of agents) {
                agentCtx.fillStyle = color;
                agentCtx.beginPath();
                agentCtx.arc(agent.x, agent.y, agent.size, 0, Math.PI * 2);
                agentCtx.fill();
            }

            // Population indicator
            agentCtx.fillStyle = 'white';
            agentCtx.font = '14px Arial';
            agentCtx.fillText(`Showing ${agents.length} of ${formatNumber(Math.floor(population))}`, 10, 25);

            // Graph canvas
            graphCtx.fillStyle = '#1a1a2e';
            graphCtx.fillRect(0, 0, graphCanvas.width, graphCanvas.height);

            if (history.length > 1) {
                const maxPop = Math.max(...history);

                // Linear scale graph
                graphCtx.strokeStyle = color;
                graphCtx.lineWidth = 2;
                graphCtx.beginPath();

                for (let i = 0; i < history.length; i++) {
                    const x = (i / Math.max(history.length - 1, 1)) * graphCanvas.width;
                    const y = graphCanvas.height - (history[i] / maxPop) * (graphCanvas.height - 20);
                    if (i === 0) graphCtx.moveTo(x, y);
                    else graphCtx.lineTo(x, y);
                }
                graphCtx.stroke();
            }

            // Labels
            graphCtx.fillStyle = scenarioColors[scenario];
            graphCtx.font = '11px Arial';
            graphCtx.fillText('Population over time (linear scale)', 5, 12);
        }

        function animate() {
            if (!paused && population < 1e12) {
                step();
                updateStats();
            }
            draw();

            if (population < 1e12) {
                animationId = setTimeout(animate, speed);
            }
        }

        function togglePause() {
            paused = !paused;
            document.getElementById('pauseBtn').textContent = paused ? 'Resume' : 'Pause';
        }

        // Event listeners
        document.getElementById('initial').oninput = function() {
            document.getElementById('initialVal').textContent = this.value;
        };
        document.getElementById('rate').oninput = function() {
            document.getElementById('rateVal').textContent = this.value;
        };
        document.getElementById('speed').oninput = function() {
            speed = parseInt(this.value);
            document.getElementById('speedVal').textContent = speed;
        };
        document.getElementById('scenario').onchange = function() {
            scenario = this.value;
        };

        reset();
    </script>
</body>
</html>
