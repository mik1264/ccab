<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Population Two Region - NetLogo Simulations</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            color: #e0e0e0;
        }
        h1 {
            font-size: 1.8rem;
            margin-bottom: 10px;
            background: linear-gradient(135deg, #3498db, #2ecc71);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .description { text-align: center; max-width: 700px; margin-bottom: 20px; color: #aaa; line-height: 1.5; }
        .container { display: flex; gap: 20px; flex-wrap: wrap; justify-content: center; }
        .main-panel { display: flex; flex-direction: column; gap: 10px; }
        canvas { border-radius: 10px; box-shadow: 0 10px 30px rgba(0,0,0,0.4); }
        .controls {
            background: rgba(255,255,255,0.05);
            padding: 20px;
            border-radius: 10px;
            display: flex;
            flex-direction: column;
            gap: 15px;
            min-width: 240px;
        }
        .control-group { display: flex; flex-direction: column; gap: 5px; }
        label { font-size: 0.85rem; color: #888; }
        input[type="range"] { width: 100%; cursor: pointer; }
        .value { font-size: 0.8rem; color: #3498db; }
        button { padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; font-weight: 600; }
        .primary { background: #3498db; color: white; }
        .secondary { background: rgba(255,255,255,0.1); color: #e0e0e0; }
        .stats { margin-top: 15px; padding: 10px; background: rgba(0,0,0,0.2); border-radius: 5px; font-size: 0.85rem; }
        .stats div { margin: 3px 0; }
        .stat-value { color: #3498db; }
        .region-stats { display: flex; gap: 20px; }
        .region { flex: 1; padding: 10px; background: rgba(0,0,0,0.2); border-radius: 5px; }
        .region h4 { font-size: 0.9rem; margin-bottom: 8px; }
        .region-a { border-left: 3px solid #3498db; }
        .region-b { border-left: 3px solid #2ecc71; }
        a.back-link { position: fixed; top: 20px; left: 20px; color: #3498db; text-decoration: none; font-size: 0.9rem; opacity: 0.8; }
    </style>
</head>
<body>
    <a href="index.html" class="back-link">‚Üê Back to Gallery</a>
    <h1>Population Two Region</h1>
    <p class="description">Two-region population model with migration flows. Populations grow logistically and migrate based on relative prosperity differences.</p>
    <div class="container">
        <div class="main-panel">
            <canvas id="canvas" width="550" height="350"></canvas>
            <canvas id="graph" width="550" height="150"></canvas>
        </div>
        <div class="controls">
            <div class="control-group">
                <label>Region A Capacity: <span id="capAVal" class="value">1000</span></label>
                <input type="range" id="capacityA" min="500" max="2000" step="100" value="1000">
            </div>
            <div class="control-group">
                <label>Region B Capacity: <span id="capBVal" class="value">800</span></label>
                <input type="range" id="capacityB" min="500" max="2000" step="100" value="800">
            </div>
            <div class="control-group">
                <label>Growth Rate A: <span id="growthAVal" class="value">0.05</span></label>
                <input type="range" id="growthA" min="0.01" max="0.1" step="0.01" value="0.05">
            </div>
            <div class="control-group">
                <label>Growth Rate B: <span id="growthBVal" class="value">0.03</span></label>
                <input type="range" id="growthB" min="0.01" max="0.1" step="0.01" value="0.03">
            </div>
            <div class="control-group">
                <label>Migration Rate: <span id="migrationVal" class="value">0.02</span></label>
                <input type="range" id="migration" min="0" max="0.1" step="0.005" value="0.02">
            </div>
            <button class="primary" id="startBtn">Start</button>
            <button class="secondary" id="resetBtn">Reset</button>
            <div class="region-stats">
                <div class="region region-a">
                    <h4>Region A</h4>
                    <div>Pop: <span id="popA" class="stat-value">0</span></div>
                    <div>Density: <span id="densityA" class="stat-value">0</span>%</div>
                </div>
                <div class="region region-b">
                    <h4>Region B</h4>
                    <div>Pop: <span id="popB" class="stat-value">0</span></div>
                    <div>Density: <span id="densityB" class="stat-value">0</span>%</div>
                </div>
            </div>
            <div class="stats">
                <div>Time: <span id="time" class="stat-value">0</span></div>
                <div>Total Pop: <span id="totalPop" class="stat-value">0</span></div>
                <div>Net Migration: <span id="netMigration" class="stat-value">0</span></div>
            </div>
        </div>
    </div>
    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        const graphCanvas = document.getElementById('graph');
        const gctx = graphCanvas.getContext('2d');
        const W = canvas.width, H = canvas.height;
        const GW = graphCanvas.width, GH = graphCanvas.height;

        let popA = 200, popB = 150;
        let running = false, time = 0;
        let history = { a: [], b: [] };
        let totalMigrationAtoB = 0;

        function init() {
            popA = 200; popB = 150;
            time = 0;
            history = { a: [], b: [] };
            totalMigrationAtoB = 0;
            updateStats();
        }

        function update() {
            const capA = parseInt(document.getElementById('capacityA').value);
            const capB = parseInt(document.getElementById('capacityB').value);
            const rA = parseFloat(document.getElementById('growthA').value);
            const rB = parseFloat(document.getElementById('growthB').value);
            const migRate = parseFloat(document.getElementById('migration').value);

            // Logistic growth
            const dA = rA * popA * (1 - popA / capA);
            const dB = rB * popB * (1 - popB / capB);
            popA += dA;
            popB += dB;

            // Migration based on relative prosperity (inverse of density)
            const prosperityA = 1 - popA / capA;
            const prosperityB = 1 - popB / capB;
            const pressureAtoB = migRate * popA * Math.max(0, prosperityB - prosperityA);
            const pressureBtoA = migRate * popB * Math.max(0, prosperityA - prosperityB);

            popA += pressureBtoA - pressureAtoB;
            popB += pressureAtoB - pressureBtoA;
            totalMigrationAtoB += pressureAtoB - pressureBtoA;

            popA = Math.max(0, popA);
            popB = Math.max(0, popB);

            history.a.push(popA);
            history.b.push(popB);
            if (history.a.length > 200) { history.a.shift(); history.b.shift(); }

            time++;
        }

        function draw() {
            ctx.fillStyle = '#1a1a2e';
            ctx.fillRect(0, 0, W, H);

            const capA = parseInt(document.getElementById('capacityA').value);
            const capB = parseInt(document.getElementById('capacityB').value);

            // Draw regions
            const regionWidth = W / 2 - 20;
            
            // Region A
            ctx.strokeStyle = '#3498db';
            ctx.lineWidth = 2;
            ctx.strokeRect(20, 30, regionWidth, H - 60);
            ctx.fillStyle = 'rgba(52, 152, 219, 0.1)';
            ctx.fillRect(20, 30, regionWidth, H - 60);

            // Region B
            ctx.strokeStyle = '#2ecc71';
            ctx.strokeRect(W/2 + 10, 30, regionWidth, H - 60);
            ctx.fillStyle = 'rgba(46, 204, 113, 0.1)';
            ctx.fillRect(W/2 + 10, 30, regionWidth, H - 60);

            // Draw population as dots
            const drawPop = (pop, cap, startX, color) => {
                ctx.fillStyle = color;
                const areaW = regionWidth - 20;
                const areaH = H - 80;
                const maxDots = Math.min(pop, 200);
                for (let i = 0; i < maxDots; i++) {
                    const x = startX + 10 + Math.random() * areaW;
                    const y = 40 + Math.random() * areaH;
                    ctx.beginPath();
                    ctx.arc(x, y, 3, 0, Math.PI * 2);
                    ctx.fill();
                }
            };

            drawPop(popA, capA, 20, '#3498db');
            drawPop(popB, capB, W/2 + 10, '#2ecc71');

            // Labels
            ctx.fillStyle = '#fff';
            ctx.font = 'bold 14px sans-serif';
            ctx.textAlign = 'center';
            ctx.fillText('Region A', 20 + regionWidth/2, 20);
            ctx.fillText('Region B', W/2 + 10 + regionWidth/2, 20);

            // Migration arrow
            const migRate = parseFloat(document.getElementById('migration').value);
            if (migRate > 0) {
                const densityA = popA / capA;
                const densityB = popB / capB;
                const arrowDir = densityA > densityB ? 1 : -1;
                const arrowSize = Math.abs(densityA - densityB) * 30;
                
                ctx.strokeStyle = '#f39c12';
                ctx.lineWidth = Math.max(1, arrowSize / 5);
                ctx.beginPath();
                ctx.moveTo(W/2 - 30 * arrowDir, H/2);
                ctx.lineTo(W/2 + 30 * arrowDir, H/2);
                ctx.stroke();
                
                // Arrow head
                ctx.beginPath();
                ctx.moveTo(W/2 + 30 * arrowDir, H/2);
                ctx.lineTo(W/2 + 20 * arrowDir, H/2 - 8);
                ctx.lineTo(W/2 + 20 * arrowDir, H/2 + 8);
                ctx.closePath();
                ctx.fillStyle = '#f39c12';
                ctx.fill();
            }
        }

        function drawGraph() {
            gctx.fillStyle = '#1a1a2e';
            gctx.fillRect(0, 0, GW, GH);

            if (history.a.length < 2) return;

            const capA = parseInt(document.getElementById('capacityA').value);
            const capB = parseInt(document.getElementById('capacityB').value);
            const maxPop = Math.max(capA, capB) * 1.1;

            // Draw capacity lines
            gctx.strokeStyle = 'rgba(52, 152, 219, 0.3)';
            gctx.setLineDash([5, 5]);
            gctx.beginPath();
            const yCapA = GH - 20 - (capA / maxPop) * (GH - 40);
            gctx.moveTo(40, yCapA);
            gctx.lineTo(GW - 10, yCapA);
            gctx.stroke();

            gctx.strokeStyle = 'rgba(46, 204, 113, 0.3)';
            gctx.beginPath();
            const yCapB = GH - 20 - (capB / maxPop) * (GH - 40);
            gctx.moveTo(40, yCapB);
            gctx.lineTo(GW - 10, yCapB);
            gctx.stroke();
            gctx.setLineDash([]);

            // Draw population history
            const drawLine = (data, color) => {
                gctx.strokeStyle = color;
                gctx.lineWidth = 2;
                gctx.beginPath();
                for (let i = 0; i < data.length; i++) {
                    const x = 40 + (i / 200) * (GW - 50);
                    const y = GH - 20 - (data[i] / maxPop) * (GH - 40);
                    if (i === 0) gctx.moveTo(x, y);
                    else gctx.lineTo(x, y);
                }
                gctx.stroke();
            };

            drawLine(history.a, '#3498db');
            drawLine(history.b, '#2ecc71');

            // Labels
            gctx.fillStyle = '#888';
            gctx.font = '10px sans-serif';
            gctx.textAlign = 'left';
            gctx.fillText('Population over time', 45, 15);
        }

        function updateStats() {
            const capA = parseInt(document.getElementById('capacityA').value);
            const capB = parseInt(document.getElementById('capacityB').value);

            document.getElementById('popA').textContent = Math.round(popA);
            document.getElementById('popB').textContent = Math.round(popB);
            document.getElementById('densityA').textContent = (popA / capA * 100).toFixed(1);
            document.getElementById('densityB').textContent = (popB / capB * 100).toFixed(1);
            document.getElementById('time').textContent = time;
            document.getElementById('totalPop').textContent = Math.round(popA + popB);
            document.getElementById('netMigration').textContent = Math.round(totalMigrationAtoB);

            document.getElementById('capAVal').textContent = capA;
            document.getElementById('capBVal').textContent = capB;
            document.getElementById('growthAVal').textContent = document.getElementById('growthA').value;
            document.getElementById('growthBVal').textContent = document.getElementById('growthB').value;
            document.getElementById('migrationVal').textContent = document.getElementById('migration').value;
        }

        function animate() {
            if (running) update();
            draw();
            drawGraph();
            updateStats();
            requestAnimationFrame(animate);
        }

        document.getElementById('startBtn').addEventListener('click', function() {
            running = !running;
            this.textContent = running ? 'Pause' : 'Start';
        });

        document.getElementById('resetBtn').addEventListener('click', () => {
            running = false;
            document.getElementById('startBtn').textContent = 'Start';
            init();
        });

        init();
        animate();
    </script>
</body>
</html>
