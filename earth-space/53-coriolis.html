<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Coriolis Effect - CCAB</title>
    <link rel="stylesheet" href="../assets/css/gallery-standard.css">
    <style>
        body {
            background: #f8fafc;
            color: #333;
            font-family: system-ui;
            padding: 2rem;
            text-align: center;
        }
        .container { max-width: 1000px; margin: 0 auto; display: flex; gap: 40px; justify-content: center; }
        
        .panel {
            text-align: center;
        }
        
        canvas {
            background: #fff;
            border-radius: 50%;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            margin-top: 10px;
        }
        
        .controls {
            margin: 20px;
        }
        
        button {
            padding: 10px 20px;
            background: #3b82f6;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
    </style>
</head>
<body>

<a href="../index.html" class="gallery-back">‚Üê Back to Gallery</a>
<h1>Coriolis Effect</h1>
<p>Throwing a ball on a rotating platform.</p>

<div class="controls">
    <button onclick="throwBall()">Throw Ball</button>
    <label><input type="checkbox" id="north" checked> Northern Hemisphere (CCW)</label>
</div>

<div class="container">
    <div class="panel">
        <h3>Inertial Frame (Space)</h3>
        <p>Ball moves straight.</p>
        <canvas id="inertial" width="400" height="400"></canvas>
    </div>
    
    <div class="panel">
        <h3>Rotating Frame (Earth)</h3>
        <p>Ball appears to curve.</p>
        <canvas id="rotating" width="400" height="400"></canvas>
    </div>
</div>

<script>
    const c1 = document.getElementById('inertial').getContext('2d');
    const c2 = document.getElementById('rotating').getContext('2d');
    
    let angle = 0;
    let ball = null;
    
    function throwBall() {
        ball = { x: 0, y: 0, vx: 0, vy: -2, traceInertial: [], traceRot: [] };
    }
    
    function loop() {
        // Clear
        c1.clearRect(0, 0, 400, 400);
        c2.clearRect(0, 0, 400, 400);
        
        // Draw Disc
        const isNorth = document.getElementById('north').checked;
        const omega = isNorth ? 0.02 : -0.02;
        angle += omega;
        
        drawDisc(c1, angle);
        drawDisc(c2, 0); // Always fixed in rotating frame
        
        if (ball) {
            // Update Physics (Inertial)
            ball.x += ball.vx;
            ball.y += ball.vy;
            
            // Record Inertial Trace
            ball.traceInertial.push({x: ball.x, y: ball.y});
            
            // Transform to Rotating Frame
            // Rotate (x,y) by -angle
            const rx = ball.x * Math.cos(-angle) - ball.y * Math.sin(-angle);
            const ry = ball.x * Math.sin(-angle) + ball.y * Math.cos(-angle);
            ball.traceRot.push({x: rx, y: ry});
            
            // Draw Ball Inertial
            c1.fillStyle = '#ef4444';
            c1.beginPath(); c1.arc(200 + ball.x, 200 + ball.y, 5, 0, Math.PI*2); c1.fill();
            
            // Draw Trace Inertial
            c1.strokeStyle = '#ef4444';
            c1.beginPath();
            ball.traceInertial.forEach((p,i) => {
                if(i===0) c1.moveTo(200+p.x, 200+p.y);
                else c1.lineTo(200+p.x, 200+p.y);
            });
            c1.stroke();
            
            // Draw Ball Rotating
            c2.fillStyle = '#ef4444';
            c2.beginPath(); c2.arc(200 + rx, 200 + ry, 5, 0, Math.PI*2); c2.fill();
            
            // Draw Trace Rotating
            c2.strokeStyle = '#ef4444';
            c2.beginPath();
            ball.traceRot.forEach((p,i) => {
                if(i===0) c2.moveTo(200+p.x, 200+p.y);
                else c2.lineTo(200+p.x, 200+p.y);
            });
            c2.stroke();
            
            if (Math.hypot(ball.x, ball.y) > 200) ball = null;
        }
        
        requestAnimationFrame(loop);
    }
    
    function drawDisc(ctx, a) {
        ctx.save();
        ctx.translate(200, 200);
        ctx.rotate(a);
        
        ctx.strokeStyle = '#94a3b8';
        ctx.lineWidth = 2;
        ctx.beginPath(); ctx.arc(0, 0, 190, 0, Math.PI*2); ctx.stroke();
        
        // Crosshairs
        ctx.beginPath(); ctx.moveTo(-190, 0); ctx.lineTo(190, 0); ctx.stroke();
        ctx.beginPath(); ctx.moveTo(0, -190); ctx.lineTo(0, 190); ctx.stroke();
        
        ctx.restore();
    }
    
    requestAnimationFrame(loop);

</script>
    <script src="../assets/js/enhance.js" defer></script>
</body>
</html>
