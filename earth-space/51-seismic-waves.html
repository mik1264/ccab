<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Seismic Waves - CCAB</title>
    <link rel="stylesheet" href="../assets/css/gallery-standard.css">
    <style>
        body {
            background: #111;
            color: #eee;
            font-family: system-ui;
            padding: 2rem;
            text-align: center;
        }
        .container { max-width: 1000px; margin: 0 auto; }
        
        canvas {
            background: #222;
            border-radius: 50%;
            box-shadow: 0 0 20px rgba(255,255,255,0.1);
            margin: 20px 0;
        }
        
        .controls {
            margin: 20px;
            display: flex;
            justify-content: center;
            gap: 20px;
        }
        
        button {
            padding: 10px 20px;
            background: #d97706;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
        }
        button:hover { background: #b45309; }
        
        .legend {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 10px;
        }
        .dot { width: 12px; height: 12px; border-radius: 50%; display: inline-block; margin-right: 5px; }
        
    </style>
</head>
<body>

<div class="container">
    <a href="../index.html" class="gallery-back">‚Üê Back to Gallery</a>
    <h1>Seismic Wave Propagation</h1>
    <p>P-Waves (Primary) travel faster and pass through liquids. S-Waves (Secondary) are blocked by the liquid Outer Core.</p>
    
    <div class="legend">
        <span><div class="dot" style="background:#fcd34d"></div> P-Wave (Compression)</span>
        <span><div class="dot" style="background:#ef4444"></div> S-Wave (Shear)</span>
        <span><div class="dot" style="background:#60a5fa"></div> Shadow Zone</span>
    </div>
    
    <canvas id="canvas" width="600" height="600"></canvas>
    
    <div class="controls">
        <button onclick="triggerQuake()">Trigger Earthquake</button>
    </div>
</div>

<script>
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    
    const CX = 300;
    const CY = 300;
    const R_EARTH = 280;
    const R_CORE_OUTER = 150;
    const R_CORE_INNER = 60;
    
    // Quake source (North Pole for simplicity)
    const QX = CX;
    const QY = CY - R_EARTH + 5;
    
    let particles = []; // Wavefront particles
    
    function drawEarth() {
        // Mantle
        ctx.fillStyle = '#3f2c22'; // Brown
        ctx.beginPath(); ctx.arc(CX, CY, R_EARTH, 0, Math.PI*2); ctx.fill();
        
        // Outer Core (Liquid)
        ctx.fillStyle = '#ea580c'; // Orange
        ctx.beginPath(); ctx.arc(CX, CY, R_CORE_OUTER, 0, Math.PI*2); ctx.fill();
        ctx.fillStyle = '#fff'; ctx.fillText("Outer Core (Liquid)", CX-50, CY-100);
        
        // Inner Core (Solid)
        ctx.fillStyle = '#fcd34d'; // Yellow
        ctx.beginPath(); ctx.arc(CX, CY, R_CORE_INNER, 0, Math.PI*2); ctx.fill();
        
        // Crust outline
        ctx.strokeStyle = '#fff';
        ctx.lineWidth = 2;
        ctx.beginPath(); ctx.arc(CX, CY, R_EARTH, 0, Math.PI*2); ctx.stroke();
        
        // Shadow Zones labels
        ctx.fillStyle = 'rgba(96, 165, 250, 0.3)';
        // S-wave shadow: roughly 103 deg to 103 deg (blocked by core)
        // From source (top), core subtends angle.
        // Tangent to outer core.
        // angle = asin(150/280) = 32 deg from center? No.
        // It's the angle from epicenter. ~103 deg.
        
        // Draw S-Wave shadow sectors
        ctx.beginPath();
        ctx.moveTo(CX, CY);
        ctx.arc(CX, CY, R_EARTH + 20, Math.PI/2 - 0.5, Math.PI/2 + 0.5); // Approx
        ctx.fill();
    }
    
    function triggerQuake() {
        particles = [];
        // Spawn rays
        for (let a = 0; a < Math.PI * 2; a += 0.05) {
            // Direction from source
            // We want rays emanating from QX, QY into the earth
            // Angle should be downwards mostly
            const angle = Math.PI/2 + (a - Math.PI) * 0.9; // Cone downwards
            
            // P-Wave particle
            particles.push({
                x: QX, y: QY,
                vx: Math.cos(angle), vy: Math.sin(angle),
                type: 'P',
                speed: 3,
                active: true
            });
            
            // S-Wave particle
            particles.push({
                x: QX, y: QY,
                vx: Math.cos(angle), vy: Math.sin(angle),
                type: 'S',
                speed: 1.8, // Slower
                active: true
            });
        }
    }
    
    function loop() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        drawEarth();
        
        particles.forEach(p => {
            if (!p.active) return;
            
            // Move
            p.x += p.vx * p.speed;
            p.y += p.vy * p.speed;
            
            // Check location
            const dist = Math.hypot(p.x - CX, p.y - CY);
            
            // Boundary: Mantle -> Outer Core
            if (dist < R_CORE_OUTER && dist > R_CORE_INNER) {
                if (p.type === 'S') {
                    p.active = false; // Blocked!
                } else {
                    // P-Wave Refraction (Snell's law approx)
                    // Slows down in liquid core
                    // p.speed = 2.5; 
                    // Bend towards normal (center)
                    // Simplified visual bending:
                    // Just pull velocity vector slightly towards center
                    const dx = CX - p.x;
                    const dy = CY - p.y;
                    p.vx += dx * 0.005;
                    p.vy += dy * 0.005;
                    // Normalize
                    const v = Math.hypot(p.vx, p.vy);
                    p.vx = (p.vx/v);
                    p.vy = (p.vy/v);
                }
            }
            
            // Inner Core
            if (dist < R_CORE_INNER) {
                // P-wave speeds up again
                // p.speed = 3.2;
            }
            
            // Exit Earth
            if (dist > R_EARTH) {
                p.active = false;
                // Draw hit marker
                ctx.fillStyle = p.type === 'P' ? '#fcd34d' : '#ef4444';
                ctx.beginPath(); ctx.arc(p.x, p.y, 3, 0, Math.PI*2); ctx.fill();
            }
            
            // Draw
            ctx.fillStyle = p.type === 'P' ? '#fcd34d' : '#ef4444';
            ctx.beginPath(); ctx.arc(p.x, p.y, 2, 0, Math.PI*2); ctx.fill();
        });
        
        requestAnimationFrame(loop);
    }
    
    triggerQuake();
    loop();

</script>
</body>
</html>
