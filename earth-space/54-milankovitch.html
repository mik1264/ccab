<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Milankovitch Cycles - CCAB</title>
    <link rel="stylesheet" href="../assets/css/gallery-standard.css">
    <style>
        body {
            background: #000;
            color: #ddd;
            font-family: system-ui;
            padding: 2rem;
            text-align: center;
        }
        .container { max-width: 1000px; margin: 0 auto; }
        
        .viz-area {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        canvas {
            border: 1px solid #333;
            background: #111;
            border-radius: 8px;
        }
        
        .controls {
            margin: 20px 0;
            background: #222;
            padding: 20px;
            border-radius: 8px;
            text-align: left;
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
        }
        
        label { display: block; margin-bottom: 5px; font-weight: bold; color: #fcd34d; }
        input { width: 100%; }
        
    </style>
</head>
<body>

<div class="container">
    <a href="../index.html" class="gallery-back">← Back to Gallery</a>
    <h1>Milankovitch Cycles</h1>
    <p>Orbital variations driving long-term climate change.</p>
    
    <div class="viz-area">
        <div>
            <h3>Orbit Top View</h3>
            <canvas id="orbit" width="400" height="400"></canvas>
        </div>
        <div>
            <h3>Earth Tilt View</h3>
            <canvas id="tilt" width="400" height="400"></canvas>
        </div>
    </div>
    
    <div class="controls">
        <div>
            <label>Eccentricity (0 to 0.5)</label>
            <input type="range" id="ecc" min="0" max="0.5" step="0.01" value="0.017">
            <div id="ecc-val">0.017</div>
        </div>
        <div>
            <label>Obliquity (Tilt) (22° to 25°)</label>
            <input type="range" id="obliq" min="22" max="25" step="0.1" value="23.5">
            <div id="obliq-val">23.5°</div>
        </div>
        <div>
            <label>Precession (Wobble)</label>
            <input type="range" id="prec" min="0" max="360" step="1" value="0">
            <div id="prec-val">0°</div>
        </div>
    </div>
    
    <div style="margin-top:20px; color:#aaa;">
        Note: Exaggerated scales for visibility.
    </div>
</div>

<script>
    const ctx1 = document.getElementById('orbit').getContext('2d');
    const ctx2 = document.getElementById('tilt').getContext('2d');
    
    let ecc = 0.017;
    let obliq = 23.5;
    let prec = 0;
    
    let angle = 0;
    
    function update() {
        ecc = parseFloat(document.getElementById('ecc').value);
        obliq = parseFloat(document.getElementById('obliq').value);
        prec = parseFloat(document.getElementById('prec').value);
        
        document.getElementById('ecc-val').textContent = ecc;
        document.getElementById('obliq-val').textContent = obliq + "°";
        document.getElementById('prec-val').textContent = prec + "°";
    }
    
    ['ecc', 'obliq', 'prec'].forEach(id => document.getElementById(id).addEventListener('input', update));
    
    function loop() {
        angle += 0.01;
        
        // 1. Orbit View
        ctx1.clearRect(0, 0, 400, 400);
        
        // Draw Sun (One focus)
        // Ellipse a=150. b = a * sqrt(1-e^2). c = a*e.
        const a = 150;
        const b = a * Math.sqrt(1 - ecc*ecc);
        const c = a * ecc;
        
        ctx1.save();
        ctx1.translate(200, 200);
        
        // Sun at focus (-c, 0)
        ctx1.fillStyle = '#fcd34d';
        ctx1.beginPath(); ctx1.arc(-c, 0, 10, 0, Math.PI*2); ctx1.fill();
        
        // Orbit Path
        ctx1.strokeStyle = '#555';
        ctx1.beginPath(); ctx1.ellipse(0, 0, a, b, 0, 0, Math.PI*2); ctx1.stroke();
        
        // Earth
        const earthX = a * Math.cos(angle);
        const earthY = b * Math.sin(angle);
        ctx1.fillStyle = '#3b82f6';
        ctx1.beginPath(); ctx1.arc(earthX, earthY, 6, 0, Math.PI*2); ctx1.fill();
        
        ctx1.restore();
        
        // 2. Tilt View (Side view of Earth)
        ctx2.clearRect(0, 0, 400, 400);
        ctx2.save();
        ctx2.translate(200, 200);
        
        // Draw Earth
        ctx2.fillStyle = '#3b82f6';
        ctx2.beginPath(); ctx2.arc(0, 0, 100, 0, Math.PI*2); ctx2.fill();
        
        // Draw Axis
        // Tilt is obliquity. Precession rotates the tilt direction.
        // In 2D projection: x-tilt = sin(obliq)*cos(prec), y-tilt = cos(obliq)?
        // Just rotate the axis line by obliq
        // Precession changes the orientation relative to stars/seasons.
        // Let's visualize precession as axis wobbling in 3D (projected ellipse at pole).
        
        ctx2.save();
        // Rotate whole earth by Obliquity
        ctx2.rotate((obliq * Math.PI / 180)); 
        // This is static tilt. Precession rotates this cone.
        // Actually, Obliquity is angle from normal.
        // Precession is rotation around normal.
        
        // Let's draw the normal
        ctx2.strokeStyle = '#555';
        ctx2.setLineDash([5,5]);
        ctx2.beginPath(); ctx2.moveTo(0, -150); ctx2.lineTo(0, 150); ctx2.stroke();
        ctx2.setLineDash([]);
        ctx2.restore();
        
        // Wobble axis
        // Top of axis moves in a circle
        const axisLen = 140;
        const tiltRad = obliq * Math.PI / 180;
        const precRad = prec * Math.PI / 180;
        
        const topX = axisLen * Math.sin(tiltRad) * Math.cos(precRad); // Project x
        // y is roughly up, shortened by tilt? No, y is mostly up.
        const topY = -axisLen * Math.cos(tiltRad); // Standard vertical
        
        // Actually top point describes a circle radius sin(tilt)*Len at height cos(tilt)*Len.
        // 2D projection of that circle is line if eye level, or ellipse.
        // Let's simplify: Rotate by Tilt first (around Z), then Precession around Y?
        
        // Visualize: Axis line
        ctx2.strokeStyle = '#fff';
        ctx2.lineWidth = 4;
        ctx2.beginPath();
        ctx2.moveTo(-topX, -topY); // South
        ctx2.lineTo(topX, topY); // North
        ctx2.stroke();
        
        // Equator
        ctx2.strokeStyle = '#fff';
        ctx2.lineWidth = 2;
        // Perpendicular to axis
        // Just draw line for now
        ctx2.beginPath();
        ctx2.moveTo(-100, 0); ctx2.lineTo(100, 0);
        ctx2.stroke();
        
        ctx2.restore();
        
        requestAnimationFrame(loop);
    }
    
    requestAnimationFrame(loop);

</script>
</body>
</html>
