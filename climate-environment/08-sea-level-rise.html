<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sea Level Rise - Climate/Environment Simulations</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', system-ui, sans-serif; background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%); min-height: 100vh; color: #e2e8f0; }
        .container { max-width: 1400px; margin: 0 auto; padding: 20px; }
        header { text-align: center; margin-bottom: 30px; }
        .back-link { display: inline-flex; align-items: center; gap: 8px; color: #06b6d4; text-decoration: none; font-size: 0.9rem; margin-bottom: 20px; }
        h1 { font-size: 2.5rem; font-weight: 700; color: #06b6d4; margin-bottom: 10px; }
        .subtitle { color: #94a3b8; font-size: 1.1rem; }
        .simulation-container { display: grid; grid-template-columns: 1fr 320px; gap: 20px; margin-bottom: 30px; }
        .canvas-wrapper { background: rgba(0, 0, 0, 0.3); border-radius: 16px; padding: 20px; border: 1px solid rgba(6, 182, 212, 0.2); }
        canvas { display: block; width: 100%; height: 500px; border-radius: 8px; background: #0a1628; }
        .controls-panel { background: rgba(0, 0, 0, 0.3); border-radius: 16px; padding: 20px; border: 1px solid rgba(6, 182, 212, 0.2); }
        .control-section { margin-bottom: 20px; }
        .control-section h3 { color: #06b6d4; font-size: 0.9rem; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 12px; }
        .control-group { margin-bottom: 15px; }
        .control-group label { display: block; color: #94a3b8; font-size: 0.85rem; margin-bottom: 6px; }
        .control-group input[type="range"] { width: 100%; height: 6px; border-radius: 3px; background: #1e293b; outline: none; -webkit-appearance: none; }
        .control-group input[type="range"]::-webkit-slider-thumb { -webkit-appearance: none; width: 16px; height: 16px; border-radius: 50%; background: #06b6d4; cursor: pointer; }
        .control-value { text-align: right; color: #06b6d4; font-size: 0.85rem; font-weight: 600; }
        .level-display { text-align: center; padding: 20px; background: linear-gradient(135deg, rgba(6, 182, 212, 0.1), rgba(59, 130, 246, 0.1)); border-radius: 12px; margin-bottom: 15px; }
        .level-value { font-size: 2.5rem; font-weight: 700; color: #06b6d4; }
        .stats-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .stat-item { background: rgba(6, 182, 212, 0.1); padding: 12px; border-radius: 8px; text-align: center; }
        .stat-value { font-size: 1.4rem; font-weight: 700; color: #06b6d4; }
        .stat-label { font-size: 0.75rem; color: #94a3b8; margin-top: 4px; }
        .btn-row { display: flex; gap: 10px; margin-top: 15px; }
        .btn { flex: 1; padding: 12px; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; }
        .btn-primary { background: #06b6d4; color: #1a1a2e; }
        .btn-secondary { background: rgba(6, 182, 212, 0.2); color: #06b6d4; }
        .info-box { background: rgba(6, 182, 212, 0.1); border: 1px solid rgba(6, 182, 212, 0.3); border-radius: 12px; padding: 20px; }
        .info-box h3 { color: #06b6d4; margin-bottom: 10px; }
        .info-box p { color: #94a3b8; font-size: 0.9rem; line-height: 1.6; }
        @media (max-width: 900px) { .simulation-container { grid-template-columns: 1fr; } }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <a href="index.html" class="back-link"><span>←</span><span>Back to Climate/Environment</span></a>
            <h1>Sea Level Rise</h1>
            <p class="subtitle">Coastal flooding and land loss simulation</p>
        </header>

        <div class="simulation-container">
            <div class="canvas-wrapper">
                <canvas id="simCanvas"></canvas>
            </div>

            <div class="controls-panel">
                <div class="level-display">
                    <div class="level-value" id="seaLevel">+0.0m</div>
                    <div style="color: #94a3b8; font-size: 0.9rem;">Sea Level Rise</div>
                </div>

                <div class="control-section">
                    <h3>Scenario</h3>
                    <div class="control-group">
                        <label>Year</label>
                        <input type="range" id="year" min="2020" max="2200" value="2020">
                        <div class="control-value"><span id="yearVal">2020</span></div>
                    </div>
                    <div class="control-group">
                        <label>Emissions Scenario</label>
                        <input type="range" id="scenario" min="1" max="4" value="2">
                        <div class="control-value">RCP <span id="scenarioVal">4.5</span></div>
                    </div>
                    <div class="control-group">
                        <label>Ice Sheet Instability</label>
                        <input type="range" id="instability" min="0" max="100" value="20">
                        <div class="control-value"><span id="instabilityVal">20</span>%</div>
                    </div>
                </div>

                <div class="control-section">
                    <h3>Impact Statistics</h3>
                    <div class="stats-grid">
                        <div class="stat-item">
                            <div class="stat-value" id="landLost">0</div>
                            <div class="stat-label">km² Flooded</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="population">0</div>
                            <div class="stat-label">M Displaced</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="cities">0</div>
                            <div class="stat-label">Cities at Risk</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="cost">0</div>
                            <div class="stat-label">$T Damage</div>
                        </div>
                    </div>
                </div>

                <div class="btn-row">
                    <button class="btn btn-primary" id="resetBtn">Reset</button>
                    <button class="btn btn-secondary" id="animateBtn">Animate</button>
                </div>
            </div>
        </div>

        <div class="info-box">
            <h3>Sea Level Rise Projections</h3>
            <p>
                Sea levels rise due to thermal expansion and ice melt. Under high emissions (RCP 8.5),
                rise could exceed 1m by 2100 and several meters by 2200 if ice sheet instabilities occur.
                This simulation shows coastal flooding impacts on a stylized coastal city profile.
            </p>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('simCanvas');
        const ctx = canvas.getContext('2d');

        function resizeCanvas() {
            const rect = canvas.getBoundingClientRect();
            canvas.width = rect.width * window.devicePixelRatio;
            canvas.height = rect.height * window.devicePixelRatio;
            ctx.scale(window.devicePixelRatio, window.devicePixelRatio);
        }
        resizeCanvas();
        window.addEventListener('resize', resizeCanvas);

        let animating = false;
        let seaLevel = 0;

        const params = {
            year: 2020,
            scenario: 2,
            instability: 20
        };

        const scenarios = {
            1: { name: '2.6', rate: 0.003, max: 0.5 },
            2: { name: '4.5', rate: 0.005, max: 1.0 },
            3: { name: '6.0', rate: 0.008, max: 1.5 },
            4: { name: '8.5', rate: 0.012, max: 2.5 }
        };

        // Terrain elevation profile (meters above sea level)
        const terrain = [];
        function generateTerrain() {
            terrain.length = 0;
            const width = canvas.width / window.devicePixelRatio;

            for (let x = 0; x < width; x++) {
                let elevation;
                const t = x / width;

                if (t < 0.1) {
                    // Ocean
                    elevation = -10;
                } else if (t < 0.3) {
                    // Beach/low coast
                    elevation = (t - 0.1) * 15;
                } else if (t < 0.5) {
                    // Coastal city (low lying)
                    elevation = 3 + Math.sin(x / 20) * 0.5;
                } else if (t < 0.7) {
                    // Elevated area
                    elevation = 3 + (t - 0.5) * 30;
                } else {
                    // Mountains
                    elevation = 9 + Math.sin(x / 30) * 5 + (t - 0.7) * 40;
                }

                terrain.push(elevation);
            }
        }

        function calculateSeaLevel() {
            const scenario = scenarios[params.scenario];
            const years = params.year - 2020;
            let rise = scenario.rate * years;

            // Ice sheet instability adds exponential component
            const instabilityFactor = 1 + (params.instability / 100) * years / 100;
            rise *= instabilityFactor;

            // Cap at scenario maximum
            rise = Math.min(rise, scenario.max * (1 + params.instability / 50));

            return rise;
        }

        function drawScene() {
            const width = canvas.width / window.devicePixelRatio;
            const height = canvas.height / window.devicePixelRatio;

            // Sky
            const skyGradient = ctx.createLinearGradient(0, 0, 0, height * 0.6);
            skyGradient.addColorStop(0, '#1e3a5f');
            skyGradient.addColorStop(1, '#87CEEB');
            ctx.fillStyle = skyGradient;
            ctx.fillRect(0, 0, width, height);

            // Draw terrain
            const baseY = height * 0.7;
            const scale = 8; // meters to pixels

            // Land
            ctx.fillStyle = '#228B22';
            ctx.beginPath();
            ctx.moveTo(0, height);
            for (let x = 0; x < terrain.length; x++) {
                const y = baseY - terrain[x] * scale;
                ctx.lineTo(x, y);
            }
            ctx.lineTo(width, height);
            ctx.closePath();
            ctx.fill();

            // Buildings in coastal city area
            for (let x = width * 0.3; x < width * 0.55; x += 30) {
                const elevation = terrain[Math.floor(x)] || 3;
                const buildingHeight = 20 + Math.random() * 60;
                const y = baseY - elevation * scale;

                ctx.fillStyle = '#4b5563';
                ctx.fillRect(x - 10, y - buildingHeight, 20, buildingHeight);

                // Windows
                ctx.fillStyle = '#facc15';
                for (let wy = y - buildingHeight + 10; wy < y - 5; wy += 12) {
                    for (let wx = x - 6; wx < x + 6; wx += 8) {
                        if (Math.random() > 0.3) {
                            ctx.fillRect(wx, wy, 4, 6);
                        }
                    }
                }
            }

            // Sea level line
            const seaY = baseY - seaLevel * scale;

            // Ocean water
            ctx.fillStyle = 'rgba(30, 64, 175, 0.8)';
            ctx.beginPath();
            ctx.moveTo(0, seaY);
            for (let x = 0; x < terrain.length; x++) {
                const landY = baseY - terrain[x] * scale;
                if (landY > seaY) {
                    ctx.lineTo(x, seaY);
                } else {
                    ctx.lineTo(x, landY);
                }
            }
            ctx.lineTo(width, height);
            ctx.lineTo(0, height);
            ctx.closePath();
            ctx.fill();

            // Wave effect
            ctx.strokeStyle = 'rgba(255, 255, 255, 0.3)';
            ctx.lineWidth = 2;
            ctx.beginPath();
            for (let x = 0; x < width * 0.4; x++) {
                const waveY = seaY + Math.sin(x / 20 + Date.now() / 500) * 3;
                if (x === 0) ctx.moveTo(x, waveY);
                else ctx.lineTo(x, waveY);
            }
            ctx.stroke();

            // Flooded area highlight
            ctx.fillStyle = 'rgba(239, 68, 68, 0.3)';
            ctx.beginPath();
            let flooding = false;
            for (let x = 0; x < terrain.length; x++) {
                const landY = baseY - terrain[x] * scale;
                if (landY > seaY && terrain[x] > 0) {
                    if (!flooding) {
                        ctx.moveTo(x, seaY);
                        flooding = true;
                    }
                    ctx.lineTo(x, Math.min(landY, seaY));
                } else if (flooding) {
                    ctx.lineTo(x, seaY);
                    flooding = false;
                }
            }
            if (flooding) ctx.lineTo(terrain.length - 1, seaY);
            ctx.closePath();
            ctx.fill();

            // Labels
            ctx.fillStyle = '#fff';
            ctx.font = '12px system-ui';
            ctx.textAlign = 'center';
            ctx.fillText(`${params.year}`, width / 2, 30);
            ctx.fillText(`Sea Level: +${seaLevel.toFixed(2)}m`, width / 2, 50);

            // Elevation scale
            ctx.fillStyle = '#94a3b8';
            ctx.font = '10px system-ui';
            ctx.textAlign = 'right';
            for (let elev = 0; elev <= 15; elev += 5) {
                const y = baseY - elev * scale;
                ctx.fillText(`${elev}m`, 25, y + 4);
                ctx.strokeStyle = 'rgba(255, 255, 255, 0.1)';
                ctx.beginPath();
                ctx.moveTo(30, y);
                ctx.lineTo(width, y);
                ctx.stroke();
            }
        }

        function calculateImpacts() {
            const floodedCells = terrain.filter((elev, i) =>
                elev > 0 && elev < seaLevel && i / terrain.length > 0.1
            ).length;

            const totalCoastal = terrain.filter((elev, i) =>
                elev > 0 && elev < 10 && i / terrain.length > 0.1
            ).length;

            const landLost = Math.round(floodedCells * 10); // km²
            const population = (seaLevel * 150).toFixed(0); // millions
            const cities = Math.floor(seaLevel * 10);
            const cost = (seaLevel * 2).toFixed(1); // trillion $

            document.getElementById('landLost').textContent = landLost;
            document.getElementById('population').textContent = population;
            document.getElementById('cities').textContent = cities;
            document.getElementById('cost').textContent = cost;
        }

        function updateSimulation() {
            seaLevel = calculateSeaLevel();
            document.getElementById('seaLevel').textContent = '+' + seaLevel.toFixed(2) + 'm';
            calculateImpacts();
            drawScene();
        }

        function animate() {
            if (animating) {
                params.year++;
                if (params.year > 2200) params.year = 2020;
                document.getElementById('year').value = params.year;
                document.getElementById('yearVal').textContent = params.year;
                updateSimulation();
                setTimeout(animate, 100);
            }
        }

        document.getElementById('year').addEventListener('input', (e) => {
            params.year = parseInt(e.target.value);
            document.getElementById('yearVal').textContent = params.year;
            updateSimulation();
        });

        document.getElementById('scenario').addEventListener('input', (e) => {
            params.scenario = parseInt(e.target.value);
            document.getElementById('scenarioVal').textContent = scenarios[params.scenario].name;
            updateSimulation();
        });

        document.getElementById('instability').addEventListener('input', (e) => {
            params.instability = parseInt(e.target.value);
            document.getElementById('instabilityVal').textContent = params.instability;
            updateSimulation();
        });

        document.getElementById('resetBtn').addEventListener('click', () => {
            params.year = 2020;
            document.getElementById('year').value = 2020;
            document.getElementById('yearVal').textContent = 2020;
            animating = false;
            document.getElementById('animateBtn').textContent = 'Animate';
            updateSimulation();
        });

        document.getElementById('animateBtn').addEventListener('click', () => {
            animating = !animating;
            document.getElementById('animateBtn').textContent = animating ? 'Stop' : 'Animate';
            if (animating) animate();
        });

        generateTerrain();
        updateSimulation();
    </script>
</body>
</html>
