<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ocean Currents - Climate/Environment Simulations</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            min-height: 100vh;
            color: #e2e8f0;
        }
        .container { max-width: 1400px; margin: 0 auto; padding: 20px; }
        header { text-align: center; margin-bottom: 30px; }
        .back-link {
            display: inline-flex; align-items: center; gap: 8px;
            color: #06b6d4; text-decoration: none; font-size: 0.9rem;
            margin-bottom: 20px; transition: gap 0.3s ease;
        }
        .back-link:hover { gap: 12px; }
        h1 { font-size: 2.5rem; font-weight: 700; color: #06b6d4; margin-bottom: 10px; }
        .subtitle { color: #94a3b8; font-size: 1.1rem; }
        .simulation-container { display: grid; grid-template-columns: 1fr 320px; gap: 20px; margin-bottom: 30px; }
        .canvas-wrapper {
            background: rgba(0, 0, 0, 0.3); border-radius: 16px; padding: 20px;
            border: 1px solid rgba(6, 182, 212, 0.2);
        }
        canvas { display: block; width: 100%; height: 500px; border-radius: 8px; background: #0a1628; }
        .controls-panel {
            background: rgba(0, 0, 0, 0.3); border-radius: 16px; padding: 20px;
            border: 1px solid rgba(6, 182, 212, 0.2);
        }
        .control-section { margin-bottom: 20px; }
        .control-section h3 { color: #06b6d4; font-size: 0.9rem; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 12px; }
        .control-group { margin-bottom: 15px; }
        .control-group label { display: block; color: #94a3b8; font-size: 0.85rem; margin-bottom: 6px; }
        .control-group input[type="range"] {
            width: 100%; height: 6px; border-radius: 3px; background: #1e293b;
            outline: none; -webkit-appearance: none;
        }
        .control-group input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none; width: 16px; height: 16px;
            border-radius: 50%; background: #06b6d4; cursor: pointer;
        }
        .control-value { text-align: right; color: #06b6d4; font-size: 0.85rem; font-weight: 600; }
        .stats-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .stat-item { background: rgba(6, 182, 212, 0.1); padding: 12px; border-radius: 8px; text-align: center; }
        .stat-value { font-size: 1.4rem; font-weight: 700; color: #06b6d4; }
        .stat-label { font-size: 0.75rem; color: #94a3b8; margin-top: 4px; }
        .btn-row { display: flex; gap: 10px; margin-top: 15px; }
        .btn { flex: 1; padding: 12px; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; transition: transform 0.2s ease; }
        .btn:hover { transform: translateY(-2px); }
        .btn-primary { background: #06b6d4; color: #1a1a2e; }
        .btn-secondary { background: rgba(6, 182, 212, 0.2); color: #06b6d4; }
        .info-box { background: rgba(6, 182, 212, 0.1); border: 1px solid rgba(6, 182, 212, 0.3); border-radius: 12px; padding: 20px; }
        .info-box h3 { color: #06b6d4; margin-bottom: 10px; }
        .info-box p { color: #94a3b8; font-size: 0.9rem; line-height: 1.6; }
        @media (max-width: 900px) { .simulation-container { grid-template-columns: 1fr; } }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <a href="index.html" class="back-link"><span>‚Üê</span><span>Back to Climate/Environment</span></a>
            <h1>Ocean Currents</h1>
            <p class="subtitle">Thermohaline circulation and heat transport</p>
        </header>

        <div class="simulation-container">
            <div class="canvas-wrapper">
                <canvas id="simCanvas"></canvas>
            </div>

            <div class="controls-panel">
                <div class="control-section">
                    <h3>Circulation Drivers</h3>
                    <div class="control-group">
                        <label>Polar Ice Melt</label>
                        <input type="range" id="iceMelt" min="0" max="100" value="20">
                        <div class="control-value"><span id="iceMeltVal">20</span>%</div>
                    </div>
                    <div class="control-group">
                        <label>Equatorial Heating</label>
                        <input type="range" id="equatorHeat" min="50" max="150" value="100">
                        <div class="control-value"><span id="equatorHeatVal">100</span>%</div>
                    </div>
                    <div class="control-group">
                        <label>Salinity Gradient</label>
                        <input type="range" id="salinity" min="20" max="100" value="60">
                        <div class="control-value"><span id="salinityVal">60</span>%</div>
                    </div>
                    <div class="control-group">
                        <label>Wind Stress</label>
                        <input type="range" id="wind" min="0" max="100" value="50">
                        <div class="control-value"><span id="windVal">50</span>%</div>
                    </div>
                </div>

                <div class="control-section">
                    <h3>Circulation Stats</h3>
                    <div class="stats-grid">
                        <div class="stat-item">
                            <div class="stat-value" id="gulfStream">15</div>
                            <div class="stat-label">Gulf Stream (Sv)</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="amoc">18</div>
                            <div class="stat-label">AMOC (Sv)</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="heatTransport">1.3</div>
                            <div class="stat-label">Heat (PW)</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="overturning">25</div>
                            <div class="stat-label">Overturn Time (yr)</div>
                        </div>
                    </div>
                </div>

                <div class="btn-row">
                    <button class="btn btn-primary" id="resetBtn">Reset</button>
                    <button class="btn btn-secondary" id="pauseBtn">Pause</button>
                </div>
            </div>
        </div>

        <div class="info-box">
            <h3>Thermohaline Circulation</h3>
            <p>
                The global ocean conveyor belt is driven by temperature and salinity differences.
                Warm surface currents carry heat poleward, while cold dense water sinks and flows
                back at depth. Freshwater from melting ice can slow this circulation by reducing
                surface water density, potentially disrupting climate patterns.
            </p>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('simCanvas');
        const ctx = canvas.getContext('2d');

        function resizeCanvas() {
            const rect = canvas.getBoundingClientRect();
            canvas.width = rect.width * window.devicePixelRatio;
            canvas.height = rect.height * window.devicePixelRatio;
            ctx.scale(window.devicePixelRatio, window.devicePixelRatio);
        }
        resizeCanvas();
        window.addEventListener('resize', resizeCanvas);

        let paused = false;
        let particles = [];

        const params = {
            iceMelt: 20,
            equatorHeat: 100,
            salinity: 60,
            wind: 50
        };

        class WaterParticle {
            constructor(x, y, depth) {
                this.x = x;
                this.y = y;
                this.depth = depth; // 0 = surface, 1 = deep
                this.temp = depth === 0 ? 20 : 4;
                this.vx = 0;
                this.vy = 0;
            }

            update(width, height) {
                const circulation = params.salinity / 100 * (1 - params.iceMelt / 200);
                const windEffect = params.wind / 100;

                // Surface flow patterns
                if (this.depth < 0.3) {
                    // Gulf Stream / warm currents
                    if (this.y < height * 0.5) {
                        this.vx = 2 * circulation + windEffect;
                        this.vy = -0.3 * circulation;
                    } else {
                        this.vx = -1.5 * circulation + windEffect * 0.5;
                        this.vy = 0.2;
                    }

                    // Temperature from latitude
                    const latEffect = 1 - Math.abs(this.y / height - 0.5) * 2;
                    this.temp = 5 + latEffect * 25 * params.equatorHeat / 100;

                    // Sink at poles
                    if (this.y < height * 0.15 && this.temp < 10) {
                        this.depth += 0.02 * circulation;
                    }
                } else {
                    // Deep water flow
                    this.vx = -1 * circulation;
                    this.vy = 0.1;
                    this.temp = 2 + Math.random() * 3;

                    // Upwell at equator
                    if (this.y > height * 0.4 && this.y < height * 0.6 && this.x < width * 0.3) {
                        this.depth -= 0.01;
                    }
                }

                this.x += this.vx;
                this.y += this.vy;

                // Wrap around
                if (this.x > width) this.x = 0;
                if (this.x < 0) this.x = width;
                if (this.y < 0) this.y = height * 0.1;
                if (this.y > height) this.y = height * 0.9;

                this.depth = Math.max(0, Math.min(1, this.depth));
            }

            draw(ctx) {
                const tempColor = this.temp > 15 ?
                    `rgba(239, 68, 68, ${0.3 + this.temp / 50})` :
                    `rgba(59, 130, 246, ${0.3 + (20 - this.temp) / 40})`;

                const size = 4 - this.depth * 2;
                ctx.fillStyle = tempColor;
                ctx.beginPath();
                ctx.arc(this.x, this.y, size, 0, Math.PI * 2);
                ctx.fill();
            }
        }

        function initParticles() {
            particles = [];
            const width = canvas.width / window.devicePixelRatio;
            const height = canvas.height / window.devicePixelRatio;

            for (let i = 0; i < 300; i++) {
                const x = Math.random() * width;
                const y = Math.random() * height;
                const depth = Math.random() < 0.7 ? Math.random() * 0.3 : 0.3 + Math.random() * 0.7;
                particles.push(new WaterParticle(x, y, depth));
            }
        }

        function drawOcean(width, height) {
            // Ocean background gradient
            const gradient = ctx.createLinearGradient(0, 0, 0, height);
            gradient.addColorStop(0, '#0ea5e9');
            gradient.addColorStop(0.4, '#0284c7');
            gradient.addColorStop(1, '#0c4a6e');
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, width, height);

            // Continents (simplified)
            ctx.fillStyle = '#78716c';
            // Americas
            ctx.beginPath();
            ctx.ellipse(width * 0.15, height * 0.3, 40, 80, 0, 0, Math.PI * 2);
            ctx.fill();
            ctx.beginPath();
            ctx.ellipse(width * 0.12, height * 0.7, 30, 50, 0.3, 0, Math.PI * 2);
            ctx.fill();

            // Europe/Africa
            ctx.beginPath();
            ctx.ellipse(width * 0.55, height * 0.25, 30, 40, 0, 0, Math.PI * 2);
            ctx.fill();
            ctx.beginPath();
            ctx.ellipse(width * 0.55, height * 0.55, 35, 60, 0, 0, Math.PI * 2);
            ctx.fill();

            // Australia/Asia
            ctx.beginPath();
            ctx.ellipse(width * 0.85, height * 0.3, 50, 40, 0.2, 0, Math.PI * 2);
            ctx.fill();
            ctx.beginPath();
            ctx.ellipse(width * 0.9, height * 0.7, 25, 30, 0, 0, Math.PI * 2);
            ctx.fill();

            // Ice caps
            const iceOpacity = (100 - params.iceMelt) / 100;
            ctx.fillStyle = `rgba(255, 255, 255, ${iceOpacity * 0.8})`;
            ctx.fillRect(0, 0, width, height * 0.08);
            ctx.fillRect(0, height * 0.92, width, height * 0.08);

            // Labels
            ctx.fillStyle = '#fff';
            ctx.font = '12px system-ui';
            ctx.textAlign = 'center';
            ctx.fillText('Arctic', width / 2, 20);
            ctx.fillText('Equator', width / 2, height * 0.52);
            ctx.fillText('Antarctic', width / 2, height - 10);
        }

        function updateStats() {
            const circulation = params.salinity / 100 * (1 - params.iceMelt / 200);
            const amoc = Math.round(18 * circulation);
            const gulfStream = Math.round(15 * circulation * params.wind / 50);
            const heatTransport = (1.3 * circulation * params.equatorHeat / 100).toFixed(1);
            const overturning = Math.round(25 / Math.max(0.1, circulation));

            document.getElementById('amoc').textContent = amoc;
            document.getElementById('gulfStream').textContent = gulfStream;
            document.getElementById('heatTransport').textContent = heatTransport;
            document.getElementById('overturning').textContent = overturning;
        }

        function animate() {
            if (!paused) {
                const width = canvas.width / window.devicePixelRatio;
                const height = canvas.height / window.devicePixelRatio;

                drawOcean(width, height);

                particles.forEach(p => {
                    p.update(width, height);
                    p.draw(ctx);
                });

                // Draw current arrows
                ctx.strokeStyle = 'rgba(255, 255, 255, 0.5)';
                ctx.lineWidth = 2;

                // Gulf Stream arrow
                ctx.beginPath();
                ctx.moveTo(width * 0.2, height * 0.4);
                ctx.quadraticCurveTo(width * 0.4, height * 0.3, width * 0.5, height * 0.2);
                ctx.stroke();

                updateStats();
            }
            requestAnimationFrame(animate);
        }

        // Event listeners
        document.getElementById('iceMelt').addEventListener('input', (e) => {
            params.iceMelt = parseInt(e.target.value);
            document.getElementById('iceMeltVal').textContent = params.iceMelt;
        });

        document.getElementById('equatorHeat').addEventListener('input', (e) => {
            params.equatorHeat = parseInt(e.target.value);
            document.getElementById('equatorHeatVal').textContent = params.equatorHeat;
        });

        document.getElementById('salinity').addEventListener('input', (e) => {
            params.salinity = parseInt(e.target.value);
            document.getElementById('salinityVal').textContent = params.salinity;
        });

        document.getElementById('wind').addEventListener('input', (e) => {
            params.wind = parseInt(e.target.value);
            document.getElementById('windVal').textContent = params.wind;
        });

        document.getElementById('resetBtn').addEventListener('click', () => {
            params.iceMelt = 20;
            params.equatorHeat = 100;
            params.salinity = 60;
            params.wind = 50;
            document.getElementById('iceMelt').value = 20;
            document.getElementById('equatorHeat').value = 100;
            document.getElementById('salinity').value = 60;
            document.getElementById('wind').value = 50;
            document.getElementById('iceMeltVal').textContent = 20;
            document.getElementById('equatorHeatVal').textContent = 100;
            document.getElementById('salinityVal').textContent = 60;
            document.getElementById('windVal').textContent = 50;
            initParticles();
        });

        document.getElementById('pauseBtn').addEventListener('click', () => {
            paused = !paused;
            document.getElementById('pauseBtn').textContent = paused ? 'Resume' : 'Pause';
        });

        initParticles();
        animate();
    </script>
</body>
</html>
