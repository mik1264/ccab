<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rose Curve - Satisfying Animations - CCAB</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { background: #0a0e1a; overflow: hidden; }
        canvas { display: block; }
        .back-link { position: fixed; top: 20px; left: 20px; padding: 10px 20px; background: rgba(254, 250, 224, 0.9); color: #606C38; text-decoration: none; border-radius: 25px; font-family: 'Segoe UI', sans-serif; font-weight: 600; font-size: 14px; z-index: 1000; }
        .back-link:hover { background: #FEFAE0; transform: translateX(-5px); }
    </style>
</head>
<body>
    <a href="index.html" class="back-link">‚Üê Back</a>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.7.0/p5.min.js"></script>
    <script>
        let radius;
        let roseConfigs = [
            { n: 3, d: 1 },  // 3 petals
            { n: 5, d: 1 },  // 5 petals
            { n: 7, d: 3 },  // 7/3 rose
            { n: 4, d: 1 },  // 8 petals
            { n: 5, d: 2 },  // 5/2 rose
            { n: 6, d: 1 }   // 12 petals
        ];
        let currentConfig = 0;

        function setup() {
            createCanvas(windowWidth, windowHeight);
            colorMode(HSB, 360, 100, 100, 100);
            radius = min(width, height) * 0.35;
        }

        function draw() {
            background(230, 30, 10);

            const time = millis();
            const cycleDuration = 5000;
            const cycleTime = time % cycleDuration;

            // Switch rose every cycle
            const cycleIndex = floor(time / cycleDuration);
            currentConfig = cycleIndex % roseConfigs.length;

            const config = roseConfigs[currentConfig];
            const k = config.n / config.d;

            // Calculate total angle needed for complete rose
            const totalAngle = config.d % 2 === 0 || config.n % 2 === 0 ?
                TWO_PI * config.d : PI * config.d;

            let drawProgress;
            if (cycleTime < 3500) {
                drawProgress = easeInOutCubic(cycleTime / 3500);
            } else if (cycleTime < 4200) {
                drawProgress = 1;
            } else {
                drawProgress = 1 - easeInOutCubic((cycleTime - 4200) / 800);
            }

            translate(width / 2, height / 2);

            // Draw rose with gradient
            noFill();
            strokeWeight(3);

            const points = 1000;
            const angleStep = totalAngle / points;

            // Multiple layered roses for depth
            for (let layer = 0; layer < 3; layer++) {
                const layerOffset = layer * 0.02;
                const layerRadius = radius * (1 - layer * 0.15);
                const alpha = 100 - layer * 30;

                beginShape();
                for (let i = 0; i <= points * drawProgress; i++) {
                    const angle = i * angleStep;
                    const r = layerRadius * cos(k * angle);

                    const x = r * cos(angle);
                    const y = r * sin(angle);

                    // Color based on angle
                    const hue = (angle * 180 / PI + time * 0.02) % 360;
                    stroke(hue, 60 - layer * 10, 70 + layer * 10, alpha);

                    vertex(x, y);
                }
                endShape();
            }

            // Draw center glow
            if (drawProgress > 0.5) {
                const glowAlpha = (drawProgress - 0.5) * 2 * 40;
                const glowSize = 20 + sin(time * 0.003) * 5;

                for (let i = 3; i > 0; i--) {
                    fill(45, 50, 80, glowAlpha / i);
                    noStroke();
                    ellipse(0, 0, glowSize * i);
                }
            }

            // Draw petal count indicator
            if (drawProgress >= 1) {
                fill(0, 0, 100, 60);
                noStroke();
                textAlign(CENTER, CENTER);
                textSize(16);
                text(`n=${config.n}, d=${config.d}`, 0, radius + 40);
            }
        }

        function easeInOutCubic(x) {
            return x < 0.5 ? 4 * x * x * x : 1 - pow(-2 * x + 2, 3) / 2;
        }

        function windowResized() {
            resizeCanvas(windowWidth, windowHeight);
            radius = min(width, height) * 0.35;
        }
    </script>
</body>
</html>
