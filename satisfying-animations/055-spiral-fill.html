<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spiral Fill - Satisfying Animations - CCAB</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { background: #0a0e1a; overflow: hidden; }
        canvas { display: block; }
        .back-link { position: fixed; top: 20px; left: 20px; padding: 10px 20px; background: rgba(254, 250, 224, 0.9); color: #606C38; text-decoration: none; border-radius: 25px; font-family: 'Segoe UI', sans-serif; font-weight: 600; font-size: 14px; z-index: 1000; }
        .back-link:hover { background: #FEFAE0; transform: translateX(-5px); }
    </style>
</head>
<body>
    <a href="index.html" class="back-link">‚Üê Back</a>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.7.0/p5.min.js"></script>
    <script>
        let squares = [];
        let maxSquares = 200;
        let spawnIndex = 0;

        function setup() {
            createCanvas(windowWidth, windowHeight);
            colorMode(HSB, 360, 100, 100, 100);
            rectMode(CENTER);
            generateSpiral();
        }

        function generateSpiral() {
            squares = [];
            const centerX = width / 2;
            const centerY = height / 2;

            let angle = 0;
            let radius = 0;
            const radiusStep = 0.5;
            const angleStep = 0.15;
            const baseSize = min(width, height) * 0.03;

            for (let i = 0; i < maxSquares; i++) {
                const x = centerX + cos(angle) * radius;
                const y = centerY + sin(angle) * radius;

                // Size decreases slightly outward
                const size = baseSize * (1 - i / maxSquares * 0.3);

                squares.push({
                    x: x,
                    y: y,
                    size: size,
                    angle: angle,
                    rotation: angle,
                    hue: (i * 3) % 360,
                    spawnTime: i * 50, // Staggered spawn
                    alpha: 0
                });

                angle += angleStep;
                radius += radiusStep;
            }

            spawnIndex = 0;
        }

        function draw() {
            background(230, 30, 10);

            const time = millis();
            const loopDuration = squares.length * 50 + 3000;
            const loopTime = time % loopDuration;

            // Reset spawn when loop restarts
            if (loopTime < 100) {
                for (let s of squares) {
                    s.alpha = 0;
                }
                spawnIndex = 0;
            }

            // Spawn squares progressively
            for (let i = 0; i < squares.length; i++) {
                const s = squares[i];

                if (loopTime > s.spawnTime) {
                    // Fade in
                    s.alpha = min(100, s.alpha + 5);
                }

                // Animate rotation
                const wobble = sin(time * 0.002 + i * 0.1) * 0.1;
                const currentRotation = s.rotation + wobble;

                // Pulse size
                const pulse = 1 + sin(time * 0.003 + i * 0.05) * 0.1;
                const currentSize = s.size * pulse;

                if (s.alpha > 0) {
                    push();
                    translate(s.x, s.y);
                    rotate(currentRotation);

                    // Shadow
                    noStroke();
                    fill(0, 0, 0, s.alpha * 0.2);
                    rect(3, 3, currentSize, currentSize, 3);

                    // Square fill
                    fill(s.hue, 60, 75, s.alpha);
                    stroke(s.hue, 70, 60, s.alpha);
                    strokeWeight(1);
                    rect(0, 0, currentSize, currentSize, 3);

                    // Highlight
                    noStroke();
                    fill(0, 0, 100, s.alpha * 0.3);
                    rect(-currentSize * 0.15, -currentSize * 0.15, currentSize * 0.3, currentSize * 0.3, 2);

                    pop();
                }
            }

            // Center glow
            noStroke();
            for (let r = 100; r > 0; r -= 10) {
                fill(200, 50, 50, map(r, 100, 0, 0, 20));
                ellipse(width / 2, height / 2, r * 2);
            }
        }

        function windowResized() {
            resizeCanvas(windowWidth, windowHeight);
            generateSpiral();
        }
    </script>
</body>
</html>
