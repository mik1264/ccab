<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ASCII Flicker - Remotion Video Effects</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            background: linear-gradient(135deg, hsl(240, 35%, 8%) 0%, hsl(220, 45%, 13%) 50%, hsl(200, 30%, 10%) 100%);
            overflow: hidden;
            font-family: monospace;
        }
        canvas { display: block; }
        .vignette {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: radial-gradient(ellipse at center, transparent 35%, rgba(0,0,0,0.85) 100%);
            pointer-events: none;
            z-index: 5;
        }
        a.back-link {
            position: fixed;
            top: 1rem;
            left: 1rem;
            color: rgba(100, 200, 255, 0.6);
            text-decoration: none;
            font-size: 0.85rem;
            z-index: 20;
            transition: color 0.3s;
        }
        a.back-link:hover { color: rgba(100, 200, 255, 1); }
    </style>
</head>
<body>
    <a href="index.html" class="back-link">‚Üê Back to Gallery</a>
    <div class="vignette"></div>
    <canvas id="canvas"></canvas>

    <script>
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    let W, H, frame = 0;

    const ALL_ART = [
        // Girls
        [
            "        .--\"\"--.         ",
            "       /  ~~~~  \\        ",
            "      | /      \\ |       ",
            "      |(  o  o  )|       ",
            "      |  \\    /  |       ",
            "       \\  '--'  /        ",
            "        '------'         ",
            "       ---|  |---        ",
            "      /   |  |   \\       ",
            "     /    |  |    \\      ",
            "          |  |           ",
            "         /|  |\\          ",
            "        / |  | \\         ",
            "       /  \\  /  \\        ",
            "      '    ''    '       "
        ],
        [
            "      .;;;;;;;.          ",
            "     /~ ~ ~ ~ ~\\         ",
            "    | ~ ~ ~ ~ ~ |        ",
            "    |  (.)(.)    |        ",
            "    |    \\/      |        ",
            "     \\  '~~'   /         ",
            "      '-------'          ",
            "     \\  |    |  /        ",
            "      \\ |    | /         ",
            "       \\|    |/          ",
            "        |    |           ",
            "        |    |           ",
            "       /|    |\\          ",
            "      / |    | \\         ",
            "     /   \\  /   \\        "
        ],
        // Mountain
        [
            "                  .                     ",
            "                 / \\          .         ",
            "                /   \\        / \\        ",
            "          .    /     \\      /   \\       ",
            "         / \\  /       \\    /     \\      ",
            "        /   \\/         \\  /       \\     ",
            "   ____/     \\          \\/         \\____",
            "  /           \\                   /     ",
            " /             \\_________________/      ",
            "~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~"
        ],
        // Tree
        [
            "         &&& &&  & &&        ",
            "      && &\\/&\\|& ()|/ @, &&  ",
            "      &\\/(/&/&||/& /_/)_&/&& ",
            "   &() &\\/&|()|/&\\/ '%' & () ",
            "  &_\\_&&_\\ |& |&&/&__%_/_& &&",
            "&&   && & &| &| /& & % ()& /&&",
            "          |||                 ",
            "          |||                 ",
            "          |||                 ",
            "    , -=-~'`^`~-=-, ,        "
        ],
        // Castle
        [
            "  |>>           <<|  ",
            "  |  ___   ___   |   ",
            "  | | _ | | _ |  |   ",
            "  | || || || ||  |   ",
            "  | |___| |___|  |   ",
            "  |  ___ _ ___   |   ",
            "  | |  |_|  | |  |   ",
            " _|_|__|   |__|_|_   ",
            "|_________________|   "
        ],
        // Ship
        [
            "         |    |    |         ",
            "        )_)  )_)  )_)        ",
            "       )___))___))___) \\     ",
            "      )____)____)_____) \\\\   ",
            "    _____|____|____|____\\\\\\__",
            "----\\                  /-----",
            "     \\________________/      ",
            "  ~~~~~~~~~~~~~~~~~~~~~~~~~~~"
        ],
        // Rocket
        [
            "        /\\        ",
            "       /  \\       ",
            "      | ** |      ",
            "      | ** |      ",
            "      | ** |      ",
            "     /| ++ |\\     ",
            "    / |    | \\    ",
            "   /__|____|__\\   ",
            "      /|  |\\      ",
            "     / |  | \\     ",
            "    *  *  *  *    "
        ],
        // Cat
        [
            "    /\\_/\\     ",
            "   ( o.o )    ",
            "    > ^ <     ",
            "   /|   |\\    ",
            "  (_|   |_)   ",
            "     |_|      ",
            "    /   \\     ",
            "   /     \\    "
        ],
        // Dragon
        [
            "                 __        ",
            "                / o\\       ",
            "           __  /   /       ",
            "          /  \\/   /        ",
            "     ____/ \\     /         ",
            "    /         \\_/          ",
            "   / /\\  /\\    \\           ",
            "  / /  \\/  \\    \\          ",
            "  \\/        \\___/  ~fire~  "
        ],
        // Moon
        [
            "       _.---._       ",
            "     .'       '.     ",
            "    /    .-.    \\    ",
            "   |   /   \\   |    ",
            "   |   \\   /   |    ",
            "    \\    '-'    /    ",
            "     '.       .'     ",
            "       '-----'       "
        ]
    ];

    function seededRandom(seed) {
        const x = Math.sin(seed) * 10000;
        return x - Math.floor(x);
    }

    // Schedule appearances
    let slots = [];

    function initSlots() {
        slots = [];
        const count = 25;
        const totalFrames = 600;
        const spacing = totalFrames / count;
        for (let i = 0; i < count; i++) {
            const dur = Math.floor(seededRandom(i * 53 + 5) * 50) + 30;
            const jitter = (seededRandom(i * 53 + 1) - 0.5) * spacing * 0.4;
            const start = Math.max(0, Math.floor(i * spacing + jitter));
            slots.push({
                artIndex: Math.floor(seededRandom(i * 53 + 2) * ALL_ART.length),
                x: 30 + seededRandom(i * 53 + 3) * (W - 300),
                y: 20 + seededRandom(i * 53 + 4) * (H - 200),
                startFrame: start,
                duration: dur,
                hue: 160 + seededRandom(i * 53 + 6) * 80,
                driftX: (seededRandom(i * 53 + 8) - 0.5) * 1.5,
                driftY: (seededRandom(i * 53 + 9) - 0.5) * 0.8,
                rotAmplitude: (seededRandom(i * 53 + 10) - 0.5) * 4
            });
        }
    }

    function resize() {
        W = canvas.width = window.innerWidth;
        H = canvas.height = window.innerHeight;
        initSlots();
    }

    function animate() {
        frame++;
        if (frame > 600) frame = 0;

        // Background
        const hue = 240 + (frame * 0.08) % 30;
        const grad = ctx.createLinearGradient(0, 0, W, H);
        grad.addColorStop(0, `hsl(${hue}, 35%, 8%)`);
        grad.addColorStop(0.5, `hsl(${hue - 20}, 45%, 13%)`);
        grad.addColorStop(1, `hsl(${hue - 40}, 30%, 10%)`);
        ctx.fillStyle = grad;
        ctx.fillRect(0, 0, W, H);

        const fontSize = Math.max(10, Math.min(16, W / 80));
        ctx.font = `${fontSize}px monospace`;

        for (const slot of slots) {
            const localFrame = frame - slot.startFrame;
            if (localFrame < 0 || localFrame >= slot.duration) continue;

            // Flicker: ~15% hidden
            if (seededRandom(frame * 71 + slot.startFrame * 37) < 0.15) continue;

            const art = ALL_ART[slot.artIndex];

            // Fade
            const fadeLen = Math.min(8, Math.floor(slot.duration / 3));
            const peakOpacity = 0.5;
            let opacity;
            if (localFrame < fadeLen) {
                opacity = (localFrame / fadeLen) * peakOpacity;
            } else if (localFrame > slot.duration - fadeLen) {
                opacity = ((slot.duration - localFrame) / fadeLen) * peakOpacity;
            } else {
                opacity = peakOpacity;
            }

            const driftX = localFrame * slot.driftX;
            const driftY = localFrame * slot.driftY;
            const jitterX = (seededRandom(frame * 97 + slot.startFrame) - 0.5) * 6;
            const jitterY = (seededRandom(frame * 101 + slot.startFrame) - 0.5) * 4;

            const x = slot.x + driftX + jitterX;
            const y = slot.y + driftY + jitterY;

            ctx.fillStyle = `hsla(${slot.hue}, 70%, 72%, ${opacity})`;
            ctx.shadowColor = `hsla(${slot.hue}, 80%, 60%, ${opacity * 0.5})`;
            ctx.shadowBlur = 12;

            for (let lineIdx = 0; lineIdx < art.length; lineIdx++) {
                ctx.fillText(art[lineIdx], x, y + lineIdx * (fontSize * 1.15));
            }
            ctx.shadowBlur = 0;
        }

        requestAnimationFrame(animate);
    }

    window.addEventListener('resize', resize);
    resize();
    window.reset = () => { frame = 0; initSlots(); };
    animate();
    </script>
    <script src="../assets/js/enhance.js"></script>
</body>
</html>
