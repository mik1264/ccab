<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quantum Random Walk - Quantum Physics</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', system-ui, sans-serif; background: linear-gradient(135deg, #0a0a1a 0%, #1a1a3e 100%); color: #eee; min-height: 100vh; padding: 20px; }
        .back-link { position: fixed; top: 20px; left: 20px; color: #60a5fa; text-decoration: none; font-weight: 600; padding: 8px 16px; background: rgba(0,0,0,0.3); border-radius: 20px; z-index: 100; }
        h1 { text-align: center; margin: 40px 0 10px; font-size: 2.2em; color: #60a5fa; }
        .subtitle { text-align: center; opacity: 0.8; margin-bottom: 20px; }
        .container { max-width: 1200px; margin: 0 auto; display: grid; grid-template-columns: 1fr 300px; gap: 20px; }
        .panel { background: rgba(255,255,255,0.05); border-radius: 12px; padding: 25px; }
        .info-box { background: rgba(96, 165, 250, 0.1); border: 1px solid rgba(96, 165, 250, 0.3); border-radius: 8px; padding: 15px; margin-bottom: 20px; font-size: 0.85em; line-height: 1.6; }
        h3 { color: #60a5fa; margin-bottom: 15px; }
        canvas { width: 100%; border-radius: 8px; background: #050510; }
        .control-group { margin: 15px 0; }
        .control-group label { display: block; margin-bottom: 5px; }
        .control-group input { width: 100%; }
        .value-display { color: #60a5fa; font-family: monospace; }
        button { width: 100%; padding: 12px; margin: 8px 0; border: none; border-radius: 8px; font-size: 1em; font-weight: 600; cursor: pointer; }
        .btn-primary { background: #60a5fa; color: #0a0a1a; }
        .btn-secondary { background: rgba(255,255,255,0.1); color: #fff; }
        .comparison { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin: 15px 0; }
        .compare-box { background: rgba(0,0,0,0.2); border-radius: 8px; padding: 12px; text-align: center; }
        .compare-box h4 { font-size: 0.9em; margin-bottom: 5px; }
        .compare-value { font-size: 1.3em; font-weight: bold; }
        .quantum { color: #60a5fa; }
        .classical { color: #facc15; }
        .legend { display: flex; gap: 15px; flex-wrap: wrap; margin: 10px 0; font-size: 0.85em; }
        .legend-item { display: flex; align-items: center; gap: 5px; }
        .legend-dot { width: 12px; height: 12px; border-radius: 50%; }
        @media (max-width: 900px) { .container { grid-template-columns: 1fr; } }
    </style>
</head>
<body>
    <a href="index.html" class="back-link">← Back</a>
    <h1>Quantum Random Walk</h1>
    <p class="subtitle">Quantum vs classical random walk comparison</p>

    <div class="container">
        <div class="panel">
            <canvas id="canvas" width="800" height="500"></canvas>
        </div>

        <div class="panel">
            <div class="info-box">
                <strong>Quantum Random Walk:</strong>
                Unlike classical random walks, quantum walks use superposition.
                The walker exists at multiple positions simultaneously!
                This leads to quadratically faster spreading (ballistic vs diffusive).
                Used in quantum algorithms and quantum search.
            </div>

            <div class="legend">
                <div class="legend-item"><div class="legend-dot" style="background: #60a5fa;"></div> Quantum</div>
                <div class="legend-item"><div class="legend-dot" style="background: #facc15;"></div> Classical</div>
            </div>

            <h3>Steps</h3>
            <div class="control-group">
                <label>Number of Steps: <span class="value-display" id="stepsVal">20</span></label>
                <input type="range" id="stepsSlider" min="5" max="50" value="20" oninput="updateSteps()">
            </div>

            <div class="control-group">
                <label>Coin Bias (Hadamard angle): <span class="value-display" id="biasVal">45°</span></label>
                <input type="range" id="biasSlider" min="0" max="90" value="45" oninput="runWalks()">
            </div>

            <button class="btn-primary" onclick="runWalks()">Run Walks</button>
            <button class="btn-secondary" onclick="stepByStep()">Step-by-Step</button>
            <button class="btn-secondary" onclick="runMany()">Run 1000 Classical</button>

            <h3 style="margin-top: 15px;">Spreading Comparison</h3>
            <div class="comparison">
                <div class="compare-box">
                    <h4 class="quantum">Quantum σ</h4>
                    <div class="compare-value quantum" id="qSpread">0.00</div>
                </div>
                <div class="compare-box">
                    <h4 class="classical">Classical σ</h4>
                    <div class="compare-value classical" id="cSpread">0.00</div>
                </div>
            </div>

            <div class="info-box" style="background: rgba(250, 204, 21, 0.1); border-color: rgba(250, 204, 21, 0.3);">
                <strong>Key Insight:</strong><br>
                Classical: σ ∝ √n (diffusive)<br>
                Quantum: σ ∝ n (ballistic)<br>
                Quantum spreads faster!
            </div>

            <div style="font-size: 0.85em; margin-top: 10px;">
                Step: <span class="value-display" id="currentStep">0</span>
            </div>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');

        let steps = 20;
        let currentStep = 0;
        let coinBias = Math.PI / 4; // Hadamard

        // Quantum state: amplitudes at each position for each coin state
        let quantumState = {};
        // Classical histogram
        let classicalHist = {};

        function updateSteps() {
            steps = parseInt(document.getElementById('stepsSlider').value);
            document.getElementById('stepsVal').textContent = steps;
            runWalks();
        }

        function initQuantumState() {
            quantumState = {};
            // Start at position 0 with coin in |0⟩ state
            quantumState[0] = { up: { real: 1, imag: 0 }, down: { real: 0, imag: 0 } };
        }

        function initClassical() {
            classicalHist = {};
            classicalHist[0] = 1;
        }

        function complexMult(a, b) {
            return {
                real: a.real * b.real - a.imag * b.imag,
                imag: a.real * b.imag + a.imag * b.real
            };
        }

        function complexAdd(a, b) {
            return { real: a.real + b.real, imag: a.imag + b.imag };
        }

        function quantumStep() {
            const theta = parseFloat(document.getElementById('biasSlider').value) * Math.PI / 180;
            document.getElementById('biasVal').textContent = Math.round(theta * 180 / Math.PI) + '°';

            // Coin operator (generalized Hadamard)
            const c = Math.cos(theta);
            const s = Math.sin(theta);

            const newState = {};

            for (const pos in quantumState) {
                const p = parseInt(pos);
                const state = quantumState[pos];

                // Apply coin operator
                const newUp = complexAdd(
                    { real: c * state.up.real, imag: c * state.up.imag },
                    { real: s * state.down.real, imag: s * state.down.imag }
                );
                const newDown = complexAdd(
                    { real: s * state.up.real, imag: s * state.up.imag },
                    { real: -c * state.down.real, imag: -c * state.down.imag }
                );

                // Shift: up goes right, down goes left
                const rightPos = p + 1;
                const leftPos = p - 1;

                if (!newState[rightPos]) {
                    newState[rightPos] = { up: { real: 0, imag: 0 }, down: { real: 0, imag: 0 } };
                }
                if (!newState[leftPos]) {
                    newState[leftPos] = { up: { real: 0, imag: 0 }, down: { real: 0, imag: 0 } };
                }

                newState[rightPos].up = complexAdd(newState[rightPos].up, newUp);
                newState[leftPos].down = complexAdd(newState[leftPos].down, newDown);
            }

            quantumState = newState;
        }

        function classicalStep() {
            const newHist = {};

            for (const pos in classicalHist) {
                const p = parseInt(pos);
                const count = classicalHist[pos];

                // Split equally left and right
                const leftPos = p - 1;
                const rightPos = p + 1;

                if (!newHist[leftPos]) newHist[leftPos] = 0;
                if (!newHist[rightPos]) newHist[rightPos] = 0;

                newHist[leftPos] += count / 2;
                newHist[rightPos] += count / 2;
            }

            classicalHist = newHist;
        }

        function getQuantumProb(pos) {
            if (!quantumState[pos]) return 0;
            const state = quantumState[pos];
            const probUp = state.up.real * state.up.real + state.up.imag * state.up.imag;
            const probDown = state.down.real * state.down.real + state.down.imag * state.down.imag;
            return probUp + probDown;
        }

        function runWalks() {
            initQuantumState();
            initClassical();
            currentStep = 0;

            for (let i = 0; i < steps; i++) {
                quantumStep();
                classicalStep();
                currentStep++;
            }

            updateStats();
            draw();
        }

        function stepByStep() {
            if (currentStep === 0) {
                initQuantumState();
                initClassical();
            }

            if (currentStep < steps) {
                quantumStep();
                classicalStep();
                currentStep++;
                updateStats();
                draw();
            }
        }

        function runMany() {
            // Run many classical random walks for comparison
            const trials = 1000;
            classicalHist = {};

            for (let t = 0; t < trials; t++) {
                let pos = 0;
                for (let i = 0; i < steps; i++) {
                    pos += Math.random() < 0.5 ? -1 : 1;
                }
                if (!classicalHist[pos]) classicalHist[pos] = 0;
                classicalHist[pos]++;
            }

            // Normalize
            for (const pos in classicalHist) {
                classicalHist[pos] /= trials;
            }

            draw();
        }

        function calcSpread(dist) {
            let mean = 0;
            let total = 0;

            for (const pos in dist) {
                const p = parseInt(pos);
                const prob = dist[pos];
                mean += p * prob;
                total += prob;
            }
            mean /= total;

            let variance = 0;
            for (const pos in dist) {
                const p = parseInt(pos);
                const prob = dist[pos];
                variance += (p - mean) * (p - mean) * prob;
            }
            variance /= total;

            return Math.sqrt(variance);
        }

        function updateStats() {
            document.getElementById('currentStep').textContent = currentStep;

            // Calculate quantum distribution
            const qDist = {};
            for (const pos in quantumState) {
                qDist[pos] = getQuantumProb(pos);
            }

            const qSpread = calcSpread(qDist);
            const cSpread = calcSpread(classicalHist);

            document.getElementById('qSpread').textContent = qSpread.toFixed(2);
            document.getElementById('cSpread').textContent = cSpread.toFixed(2);
        }

        function draw() {
            ctx.fillStyle = '#050510';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            const centerX = canvas.width / 2;
            const baseY = canvas.height - 50;
            const scale = 15;
            const barWidth = 8;

            // Find max probability for scaling
            let maxProb = 0;
            for (const pos in quantumState) {
                maxProb = Math.max(maxProb, getQuantumProb(pos));
            }
            for (const pos in classicalHist) {
                maxProb = Math.max(maxProb, classicalHist[pos]);
            }

            const heightScale = (canvas.height - 150) / maxProb;

            // Draw position axis
            ctx.strokeStyle = 'rgba(255,255,255,0.3)';
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.moveTo(50, baseY);
            ctx.lineTo(canvas.width - 50, baseY);
            ctx.stroke();

            // Draw quantum distribution
            ctx.fillStyle = 'rgba(96, 165, 250, 0.7)';
            for (const pos in quantumState) {
                const p = parseInt(pos);
                const prob = getQuantumProb(pos);
                const x = centerX + p * scale;
                const height = prob * heightScale;

                ctx.fillRect(x - barWidth / 2, baseY - height, barWidth / 2 - 1, height);
            }

            // Draw classical distribution
            ctx.fillStyle = 'rgba(250, 204, 21, 0.7)';
            for (const pos in classicalHist) {
                const p = parseInt(pos);
                const prob = classicalHist[pos];
                const x = centerX + p * scale;
                const height = prob * heightScale;

                ctx.fillRect(x + 1, baseY - height, barWidth / 2 - 1, height);
            }

            // Draw position markers
            ctx.fillStyle = 'rgba(255,255,255,0.5)';
            ctx.font = '10px sans-serif';
            for (let p = -steps; p <= steps; p += 5) {
                const x = centerX + p * scale;
                ctx.fillText(p.toString(), x - 5, baseY + 15);
            }

            // Draw zero marker
            ctx.strokeStyle = 'rgba(255,255,255,0.5)';
            ctx.setLineDash([2, 2]);
            ctx.beginPath();
            ctx.moveTo(centerX, baseY);
            ctx.lineTo(centerX, 50);
            ctx.stroke();
            ctx.setLineDash([]);

            // Labels
            ctx.fillStyle = '#fff';
            ctx.font = 'bold 14px sans-serif';
            ctx.fillText('Quantum vs Classical Random Walk', 20, 30);
            ctx.font = '12px sans-serif';
            ctx.fillText(`Steps: ${currentStep}`, 20, 50);

            // Legend
            ctx.fillStyle = '#60a5fa';
            ctx.fillRect(canvas.width - 150, 20, 15, 15);
            ctx.fillStyle = '#fff';
            ctx.fillText('Quantum', canvas.width - 130, 32);

            ctx.fillStyle = '#facc15';
            ctx.fillRect(canvas.width - 150, 45, 15, 15);
            ctx.fillStyle = '#fff';
            ctx.fillText('Classical', canvas.width - 130, 57);

            // Position label
            ctx.fillText('Position', centerX - 25, baseY + 35);
        }

        runWalks();
    </script>
</body>
</html>
