<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quantum Tunneling - Quantum Physics</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', system-ui, sans-serif; background: linear-gradient(135deg, #0a0a1a 0%, #1a1a3e 100%); color: #eee; min-height: 100vh; padding: 20px; }
        .back-link { position: fixed; top: 20px; left: 20px; color: #60a5fa; text-decoration: none; font-weight: 600; padding: 8px 16px; background: rgba(0,0,0,0.3); border-radius: 20px; z-index: 100; }
        h1 { text-align: center; margin: 40px 0 10px; font-size: 2.2em; color: #60a5fa; }
        .subtitle { text-align: center; opacity: 0.8; margin-bottom: 20px; }
        .container { max-width: 1200px; margin: 0 auto; display: grid; grid-template-columns: 1fr 300px; gap: 20px; }
        .panel { background: rgba(255,255,255,0.05); border-radius: 12px; padding: 25px; }
        .info-box { background: rgba(96, 165, 250, 0.1); border: 1px solid rgba(96, 165, 250, 0.3); border-radius: 8px; padding: 15px; margin-bottom: 20px; font-size: 0.85em; line-height: 1.6; }
        h3 { color: #60a5fa; margin-bottom: 15px; }
        canvas { width: 100%; border-radius: 8px; background: #050510; }
        .control-group { margin: 15px 0; }
        .control-group label { display: block; margin-bottom: 5px; }
        .control-group input { width: 100%; }
        .value-display { color: #60a5fa; font-family: monospace; }
        button { width: 100%; padding: 12px; margin: 8px 0; border: none; border-radius: 8px; font-size: 1em; font-weight: 600; cursor: pointer; }
        .btn-primary { background: #60a5fa; color: #0a0a1a; }
        .btn-secondary { background: rgba(255,255,255,0.1); color: #fff; }
        .stats { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin: 15px 0; }
        .stat-box { background: rgba(0,0,0,0.2); border-radius: 8px; padding: 10px; text-align: center; }
        .stat-value { font-size: 1.3em; font-weight: bold; color: #60a5fa; }
        .stat-label { font-size: 0.75em; opacity: 0.8; }
        .probability-bar { height: 20px; background: rgba(0,0,0,0.3); border-radius: 10px; overflow: hidden; margin: 10px 0; }
        .probability-fill { height: 100%; background: linear-gradient(90deg, #60a5fa, #4ade80); transition: width 0.3s; }
        @media (max-width: 900px) { .container { grid-template-columns: 1fr; } }
    </style>
</head>
<body>
    <a href="index.html" class="back-link">← Back</a>
    <h1>Quantum Tunneling</h1>
    <p class="subtitle">Particles passing through potential barriers</p>

    <div class="container">
        <div class="panel">
            <canvas id="canvas" width="800" height="500"></canvas>
        </div>

        <div class="panel">
            <div class="info-box">
                <strong>Quantum Tunneling:</strong>
                Classically, a particle cannot pass through a barrier higher than its energy.
                Quantum mechanically, there's a probability of "tunneling" through!
                This enables nuclear fusion in stars and flash memory operation.
            </div>

            <h3>Barrier Properties</h3>
            <div class="control-group">
                <label>Barrier Height: <span class="value-display" id="heightVal">1.5</span>E</label>
                <input type="range" id="heightSlider" min="100" max="300" value="150" oninput="updateParam()">
            </div>

            <div class="control-group">
                <label>Barrier Width: <span class="value-display" id="widthVal">40</span>px</label>
                <input type="range" id="widthSlider" min="20" max="100" value="40" oninput="updateParam()">
            </div>

            <h3>Particle Properties</h3>
            <div class="control-group">
                <label>Particle Energy: <span class="value-display" id="energyVal">1.0</span>E</label>
                <input type="range" id="energySlider" min="50" max="200" value="100" oninput="updateParam()">
            </div>

            <button class="btn-primary" onclick="sendParticle()">Send Particle</button>
            <button class="btn-secondary" onclick="autoSend()">Auto Send (100x)</button>
            <button class="btn-secondary" onclick="resetStats()">Reset Statistics</button>

            <h3 style="margin-top: 15px;">Tunneling Probability</h3>
            <div class="probability-bar">
                <div class="probability-fill" id="probBar" style="width: 30%;"></div>
            </div>
            <div style="text-align: center; font-size: 0.9em;">
                Theoretical: <span class="value-display" id="probTheory">30%</span>
            </div>

            <h3 style="margin-top: 15px;">Statistics</h3>
            <div class="stats">
                <div class="stat-box">
                    <div class="stat-value" id="totalSent">0</div>
                    <div class="stat-label">Total Sent</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" id="tunneled">0</div>
                    <div class="stat-label">Tunneled</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" id="reflected">0</div>
                    <div class="stat-label">Reflected</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" id="measuredProb">0%</div>
                    <div class="stat-label">Measured</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');

        let barrierHeight = 1.5;
        let barrierWidth = 40;
        let particleEnergy = 1.0;
        let particles = [];
        let totalSent = 0;
        let tunneledCount = 0;
        let reflectedCount = 0;

        const barrierX = 400;

        function updateParam() {
            barrierHeight = parseInt(document.getElementById('heightSlider').value) / 100;
            barrierWidth = parseInt(document.getElementById('widthSlider').value);
            particleEnergy = parseInt(document.getElementById('energySlider').value) / 100;
            document.getElementById('heightVal').textContent = barrierHeight.toFixed(2);
            document.getElementById('widthVal').textContent = barrierWidth;
            document.getElementById('energyVal').textContent = particleEnergy.toFixed(2);
            updateProbability();
            draw();
        }

        function updateProbability() {
            // Simplified tunneling probability formula
            let prob;
            if (particleEnergy >= barrierHeight) {
                prob = 1; // Classical transmission
            } else {
                const kappa = Math.sqrt(2 * (barrierHeight - particleEnergy));
                prob = Math.exp(-2 * kappa * barrierWidth / 20);
            }
            prob = Math.min(prob, 1);
            document.getElementById('probBar').style.width = (prob * 100) + '%';
            document.getElementById('probTheory').textContent = (prob * 100).toFixed(1) + '%';
            return prob;
        }

        function sendParticle() {
            const prob = updateProbability();
            const willTunnel = Math.random() < prob;

            particles.push({
                x: 50,
                y: canvas.height / 2,
                vx: 3,
                phase: 'incoming',
                willTunnel: willTunnel,
                wavePacket: [],
                time: 0
            });
        }

        function autoSend() {
            let count = 0;
            const interval = setInterval(() => {
                sendParticle();
                count++;
                if (count >= 100) clearInterval(interval);
            }, 50);
        }

        function resetStats() {
            totalSent = 0;
            tunneledCount = 0;
            reflectedCount = 0;
            particles = [];
            updateStatsDisplay();
            draw();
        }

        function updateStatsDisplay() {
            document.getElementById('totalSent').textContent = totalSent;
            document.getElementById('tunneled').textContent = tunneledCount;
            document.getElementById('reflected').textContent = reflectedCount;
            const measured = totalSent > 0 ? (tunneledCount / totalSent * 100).toFixed(1) + '%' : '0%';
            document.getElementById('measuredProb').textContent = measured;
        }

        function updateParticles() {
            for (let i = particles.length - 1; i >= 0; i--) {
                const p = particles[i];
                p.time++;

                // Generate wave packet visualization
                if (p.time % 2 === 0) {
                    p.wavePacket.push({ x: p.x, y: p.y, age: 0 });
                }
                p.wavePacket.forEach(w => w.age++);
                p.wavePacket = p.wavePacket.filter(w => w.age < 30);

                if (p.phase === 'incoming') {
                    p.x += p.vx;
                    if (p.x >= barrierX - barrierWidth / 2) {
                        if (p.willTunnel) {
                            p.phase = 'tunneling';
                            p.vx = 1.5; // Slower in barrier
                        } else {
                            p.phase = 'reflecting';
                            p.vx = -p.vx;
                        }
                        totalSent++;
                    }
                } else if (p.phase === 'tunneling') {
                    p.x += p.vx;
                    if (p.x >= barrierX + barrierWidth / 2) {
                        p.phase = 'transmitted';
                        p.vx = 3;
                        tunneledCount++;
                    }
                } else if (p.phase === 'transmitted') {
                    p.x += p.vx;
                    if (p.x > canvas.width + 20) {
                        particles.splice(i, 1);
                    }
                } else if (p.phase === 'reflecting') {
                    p.x += p.vx;
                    if (p.x < barrierX - barrierWidth / 2 - 10) {
                        p.phase = 'reflected';
                        reflectedCount++;
                    }
                } else if (p.phase === 'reflected') {
                    p.x += p.vx;
                    if (p.x < -20) {
                        particles.splice(i, 1);
                    }
                }
            }
            updateStatsDisplay();
        }

        function draw() {
            ctx.fillStyle = '#050510';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            const groundY = canvas.height - 100;
            const energyScale = 150;

            // Draw energy axis
            ctx.strokeStyle = 'rgba(255,255,255,0.2)';
            ctx.beginPath();
            ctx.moveTo(30, groundY);
            ctx.lineTo(canvas.width - 30, groundY);
            ctx.stroke();

            // Draw particle energy level
            ctx.strokeStyle = '#4ade80';
            ctx.setLineDash([5, 5]);
            ctx.beginPath();
            const energyY = groundY - particleEnergy * energyScale;
            ctx.moveTo(30, energyY);
            ctx.lineTo(canvas.width - 30, energyY);
            ctx.stroke();
            ctx.setLineDash([]);
            ctx.fillStyle = '#4ade80';
            ctx.font = '12px sans-serif';
            ctx.fillText('Particle Energy E', canvas.width - 130, energyY - 5);

            // Draw barrier
            const barrierY = groundY - barrierHeight * energyScale;
            ctx.fillStyle = 'rgba(248, 113, 113, 0.3)';
            ctx.fillRect(barrierX - barrierWidth / 2, barrierY, barrierWidth, groundY - barrierY);
            ctx.strokeStyle = '#f87171';
            ctx.lineWidth = 2;
            ctx.strokeRect(barrierX - barrierWidth / 2, barrierY, barrierWidth, groundY - barrierY);
            ctx.fillStyle = '#f87171';
            ctx.fillText('Barrier V₀', barrierX - 25, barrierY - 10);

            // Draw wave packets
            for (const p of particles) {
                // Draw wave visualization
                ctx.strokeStyle = p.willTunnel ? 'rgba(74, 222, 128, 0.3)' : 'rgba(96, 165, 250, 0.3)';
                ctx.lineWidth = 2;

                for (const w of p.wavePacket) {
                    const alpha = 1 - w.age / 30;
                    ctx.strokeStyle = p.willTunnel ?
                        `rgba(74, 222, 128, ${alpha * 0.3})` :
                        `rgba(96, 165, 250, ${alpha * 0.3})`;
                    ctx.beginPath();
                    ctx.arc(w.x, canvas.height / 2, 10 + w.age * 0.5, 0, Math.PI * 2);
                    ctx.stroke();
                }

                // Draw wave function (simplified)
                ctx.strokeStyle = p.willTunnel ? '#4ade80' : '#60a5fa';
                ctx.lineWidth = 2;
                ctx.beginPath();

                const waveWidth = 80;
                for (let dx = -waveWidth; dx <= waveWidth; dx += 2) {
                    const x = p.x + dx;
                    let amplitude = Math.exp(-dx * dx / 800) * Math.cos(dx * 0.15 + p.time * 0.1);

                    // Decay inside barrier
                    if (x > barrierX - barrierWidth / 2 && x < barrierX + barrierWidth / 2) {
                        if (particleEnergy < barrierHeight) {
                            const dist = x - (barrierX - barrierWidth / 2);
                            amplitude *= Math.exp(-dist * 0.05);
                        }
                    }

                    const y = canvas.height / 2 + amplitude * 40;
                    if (dx === -waveWidth) ctx.moveTo(x, y);
                    else ctx.lineTo(x, y);
                }
                ctx.stroke();

                // Draw particle center
                ctx.fillStyle = p.willTunnel ? '#4ade80' : '#60a5fa';
                ctx.beginPath();
                ctx.arc(p.x, canvas.height / 2, 8, 0, Math.PI * 2);
                ctx.fill();
            }

            // Labels
            ctx.fillStyle = '#fff';
            ctx.font = 'bold 14px sans-serif';
            if (particleEnergy >= barrierHeight) {
                ctx.fillText('E > V₀: Classical transmission', 20, 30);
            } else {
                ctx.fillText('E < V₀: Quantum tunneling possible', 20, 30);
            }

            ctx.font = '12px sans-serif';
            ctx.fillText('← Incident', 80, canvas.height / 2 - 60);
            ctx.fillText('Transmitted →', canvas.width - 120, canvas.height / 2 - 60);
        }

        function animate() {
            updateParticles();
            draw();
            requestAnimationFrame(animate);
        }

        updateParam();
        animate();
    </script>
</body>
</html>
