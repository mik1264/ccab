<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Galaxy Dynamics Demo - CCAB</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { background: linear-gradient(135deg, #0a0a20 0%, #1a0a30 100%); min-height: 100vh; font-family: system-ui, sans-serif; color: #e8e8f0; overflow: hidden; }
        .back-link { position: fixed; top: 15px; left: 15px; padding: 10px 18px; background: rgba(0,0,0,0.6); color: #a78bfa; text-decoration: none; border-radius: 8px; font-size: 14px; z-index: 1000; border: 1px solid rgba(167,139,250,0.3); }
        #canvas { position: fixed; top: 0; left: 0; width: 100%; height: 100%; }
        #panel { position: fixed; right: 0; top: 0; width: 320px; height: 100%; background: rgba(0,0,0,0.9); padding: 70px 15px 15px; border-left: 1px solid rgba(167,139,250,0.2); overflow-y: auto; }
        h1 { font-size: 1.2rem; margin-bottom: 10px; color: #a78bfa; }
        .desc { font-size: 0.8rem; line-height: 1.6; color: #888; margin-bottom: 15px; }
        .btn { padding: 8px 16px; background: linear-gradient(135deg, #a78bfa, #8b5cf6); border: none; color: white; border-radius: 6px; cursor: pointer; font-size: 0.85rem; margin-right: 8px; margin-bottom: 8px; }
        .controls { margin-bottom: 15px; }
        .slider-group { margin-bottom: 12px; }
        .slider-group label { display: block; font-size: 0.75rem; color: #888; margin-bottom: 4px; }
        input[type="range"] { width: 100%; height: 5px; -webkit-appearance: none; background: rgba(167,139,250,0.2); border-radius: 3px; }
        input[type="range"]::-webkit-slider-thumb { -webkit-appearance: none; width: 14px; height: 14px; background: #a78bfa; border-radius: 50%; cursor: pointer; }
        .stat-row { display: flex; justify-content: space-between; margin: 15px 0; }
        .stat { text-align: center; }
        .stat-value { font-size: 1.1rem; color: #a78bfa; font-weight: 600; }
        .stat-label { font-size: 0.65rem; color: #666; }
        .info-box { background: rgba(167,139,250,0.1); border: 1px solid rgba(167,139,250,0.2); border-radius: 8px; padding: 12px; margin-top: 15px; font-size: 0.8rem; line-height: 1.5; color: #aaa; }
    </style>
</head>
<body>
    <a href="index.html" class="back-link">← Back</a>
    <canvas id="canvas"></canvas>
    <div id="panel">
        <h1 id="title">Galaxy Dynamics</h1>
        <p class="desc" id="description">Interactive galaxy dynamics simulation.</p>
        <div class="controls">
            <button class="btn" id="playBtn">⏸ Pause</button>
            <button class="btn" id="resetBtn">↺ Reset</button>
        </div>
        <div class="slider-group">
            <label>Parameter: <span id="paramVal">1.0</span></label>
            <input type="range" id="param" min="0" max="2" step="0.1" value="1">
        </div>
        <div class="stat-row">
            <div class="stat"><div class="stat-value" id="stat1">-</div><div class="stat-label" id="label1">Value 1</div></div>
            <div class="stat"><div class="stat-value" id="stat2">-</div><div class="stat-label" id="label2">Value 2</div></div>
        </div>
        <div class="info-box" id="infoBox"></div>
    </div>
    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        function resize() { canvas.width = window.innerWidth; canvas.height = window.innerHeight; }
        resize(); window.addEventListener('resize', resize);

        let playing = true, time = 0, param = 1;

        const demos = {
            '12-ram-pressure': { title: 'Ram Pressure Stripping', desc: 'Galaxy gas stripped by hot intergalactic medium as it moves through a cluster.', info: 'Creates jellyfish galaxies with long tails of stripped gas. Common in galaxy clusters.', labels: ['Velocity','Gas Loss'] },
            '13-dynamical-friction': { title: 'Dynamical Friction', desc: 'Massive objects slow down as they gravitationally pull on surrounding matter.', info: 'Causes satellite galaxies to spiral inward toward the center of host halos.', labels: ['Orbit','Energy'] },
            '14-spiral-arm-triggering': { title: 'Spiral Arm Star Formation', desc: 'Gas compressed by density waves triggers star formation in spiral arms.', info: 'Shock fronts at spiral arm edges compress molecular clouds, forming stars.', labels: ['SFR','Density'] },
            '15-galaxy-classification': { title: 'Galaxy Classification', desc: 'The Hubble sequence classifies galaxies by morphology: elliptical to spiral.', info: 'E0-E7 ellipticals, S0 lenticulars, Sa-Sd spirals, SBa-SBd barred spirals.', labels: ['Type','Features'] },
            '16-elliptical-galaxy-formation': { title: 'Elliptical Galaxy Formation', desc: 'Major galaxy mergers create elliptical galaxies from disk systems.', info: 'Violent relaxation scrambles ordered rotation into random stellar orbits.', labels: ['Merger','Shape'] },
            '17-active-galactic-nuclei': { title: 'Active Galactic Nuclei', desc: 'Supermassive black holes accreting matter produce powerful AGN emission.', info: 'Jets can extend millions of light years, influencing galaxy evolution.', labels: ['Luminosity','Jet Power'] }
        };

        const filename = window.location.pathname.split('/').pop().replace('.html', '');
        const demo = demos[filename] || demos['12-ram-pressure'];
        document.getElementById('title').textContent = demo.title;
        document.getElementById('description').textContent = demo.desc;
        document.getElementById('infoBox').textContent = demo.info;
        document.getElementById('label1').textContent = demo.labels[0];
        document.getElementById('label2').textContent = demo.labels[1];
        document.title = demo.title + ' - CCAB';

        class Particle {
            constructor(x, y, vx, vy, type) {
                this.x = x; this.y = y; this.vx = vx; this.vy = vy;
                this.type = type;
            }
        }

        let particles = [];
        function initParticles() {
            particles = [];
            const cx = (canvas.width - 320) / 2, cy = canvas.height / 2;
            for (let i = 0; i < 500; i++) {
                const a = Math.random() * Math.PI * 2;
                const r = 20 + Math.random() * 100;
                particles.push(new Particle(
                    cx + Math.cos(a) * r,
                    cy + Math.sin(a) * r,
                    -Math.sin(a) * 0.5 * param,
                    Math.cos(a) * 0.5 * param,
                    Math.random() < 0.3 ? 'gas' : 'star'
                ));
            }
        }
        initParticles();

        function animate() {
            ctx.fillStyle = 'rgba(10,10,32,0.15)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            const cx = (canvas.width - 320) / 2, cy = canvas.height / 2;
            if (playing) time += 0.016;

            particles.forEach(p => {
                if (playing) {
                    p.x += p.vx;
                    p.y += p.vy;
                    // Simple orbital motion
                    const dx = p.x - cx, dy = p.y - cy;
                    const d = Math.sqrt(dx*dx + dy*dy) + 1;
                    const force = 0.02 * param / d;
                    p.vx -= dx * force / d;
                    p.vy -= dy * force / d;
                }
                ctx.beginPath();
                ctx.arc(p.x, p.y, p.type === 'gas' ? 2 : 1.5, 0, Math.PI * 2);
                ctx.fillStyle = p.type === 'gas' ? `rgba(100,150,255,${0.5 + 0.3*Math.sin(time)})` : '#a78bfa';
                ctx.fill();
            });

            // Central glow
            const grad = ctx.createRadialGradient(cx, cy, 0, cx, cy, 50);
            grad.addColorStop(0, 'rgba(167,139,250,0.5)');
            grad.addColorStop(1, 'rgba(167,139,250,0)');
            ctx.fillStyle = grad;
            ctx.beginPath();
            ctx.arc(cx, cy, 50, 0, Math.PI * 2);
            ctx.fill();

            document.getElementById('stat1').textContent = time.toFixed(1);
            document.getElementById('stat2').textContent = particles.filter(p => p.type === 'gas').length;

            requestAnimationFrame(animate);
        }

        document.getElementById('playBtn').onclick = () => { playing = !playing; document.getElementById('playBtn').textContent = playing ? '⏸ Pause' : '▶ Play'; };
        document.getElementById('resetBtn').onclick = () => { time = 0; initParticles(); };
        document.getElementById('param').oninput = e => { param = parseFloat(e.target.value); document.getElementById('paramVal').textContent = param.toFixed(1); };

        animate();
    </script>
</body>
</html>
