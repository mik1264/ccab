<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Solar Rotation Tracking AR4274</title>
    <style>
        body { margin: 0; overflow: hidden; background: #000; font-family: Arial; }
        canvas { display: block; }
        .info {
            position: absolute; top: 20px; right: 20px; color: #fff;
            background: rgba(0,0,0,0.8); padding: 15px; border-radius: 5px;
        }
    </style>
</head>
<body>
    <canvas id="canvas"></canvas>
    <div class="info">
        <h3>AR4274 Tracking</h3>
        <div id="longitude">Longitude: 0°</div>
        <div id="visibility">Visibility: Earth-facing</div>
        <div id="rotation">Rotation: Day 1/27</div>
    </div>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        const centerX = canvas.width / 2;
        const centerY = canvas.height / 2;
        const sunRadius = 200;

        let rotationDay = 0;
        const sunspotLongitude = 45; // Initial position

        function drawSun(time) {
            const gradient = ctx.createRadialGradient(centerX, centerY, 0, centerX, centerY, sunRadius);
            gradient.addColorStop(0, '#ffff88');
            gradient.addColorStop(0.7, '#ffaa44');
            gradient.addColorStop(1, '#ff6600');

            ctx.beginPath();
            ctx.arc(centerX, centerY, sunRadius, 0, Math.PI * 2);
            ctx.fillStyle = gradient;
            ctx.fill();

            // Granulation
            for (let i = 0; i < 50; i++) {
                const angle = Math.random() * Math.PI * 2;
                const dist = Math.random() * sunRadius * 0.9;
                const x = centerX + Math.cos(angle) * dist;
                const y = centerY + Math.sin(angle) * dist;
                const size = Math.random() * 5 + 2;

                ctx.beginPath();
                ctx.arc(x, y, size, 0, Math.PI * 2);
                ctx.fillStyle = 'rgba(255, 200, 100, 0.3)';
                ctx.fill();
            }
        }

        function drawSunspot(longitude) {
            const angle = (longitude - 90) * Math.PI / 180;
            const depth = Math.cos(angle);

            if (depth > 0) {
                const x = centerX + Math.sin(angle) * sunRadius * 0.7;
                const y = centerY - 30;
                const size = 30 * depth;

                // Sunspot shadow
                ctx.beginPath();
                ctx.ellipse(x, y, size, size * 0.8, 0, 0, Math.PI * 2);
                ctx.fillStyle = '#111';
                ctx.fill();

                // Penumbra
                ctx.beginPath();
                ctx.ellipse(x, y, size * 1.5, size * 1.2, 0, 0, Math.PI * 2);
                ctx.fillStyle = '#333';
                ctx.fill();

                // Label
                if (depth > 0.3) {
                    ctx.fillStyle = '#ff6600';
                    ctx.font = 'bold 14px Arial';
                    ctx.textAlign = 'center';
                    ctx.fillText('AR4274', x, y - size - 10);
                }

                return {visible: true, earthFacing: Math.abs(angle) < Math.PI / 4};
            }

            return {visible: false, earthFacing: false};
        }

        function drawLatitudeLines() {
            for (let lat = -60; lat <= 60; lat += 30) {
                ctx.beginPath();

                const y = centerY + (lat / 90) * sunRadius * 0.8;

                for (let lon = -90; lon <= 90; lon += 5) {
                    const angle = lon * Math.PI / 180;
                    const depth = Math.cos(angle);

                    if (depth > 0) {
                        const x = centerX + Math.sin(angle) * sunRadius * 0.9 * depth;
                        const yOffset = y - centerY;

                        if (lon === -90) {
                            ctx.moveTo(x, centerY + yOffset * depth);
                        } else {
                            ctx.lineTo(x, centerY + yOffset * depth);
                        }
                    }
                }

                ctx.strokeStyle = 'rgba(255, 255, 255, 0.2)';
                ctx.lineWidth = 1;
                ctx.stroke();
            }
        }

        function drawEquator() {
            ctx.beginPath();

            for (let lon = -90; lon <= 90; lon += 2) {
                const angle = lon * Math.PI / 180;
                const depth = Math.cos(angle);

                if (depth > 0) {
                    const x = centerX + Math.sin(angle) * sunRadius * 0.9 * depth;

                    if (lon === -90) {
                        ctx.moveTo(x, centerY);
                    } else {
                        ctx.lineTo(x, centerY);
                    }
                }
            }

            ctx.strokeStyle = 'rgba(255, 255, 255, 0.5)';
            ctx.lineWidth = 2;
            ctx.setLineDash([5, 5]);
            ctx.stroke();
            ctx.setLineDash([]);
        }

        function updateInfo(currentLongitude, status) {
            const displayLon = Math.round(currentLongitude);
            document.getElementById('longitude').textContent = `Longitude: ${displayLon}°`;
            document.getElementById('visibility').textContent = `Visibility: ${status.earthFacing ? 'Earth-facing ⚠' : 'Not visible'}`;
            document.getElementById('rotation').textContent = `Rotation: Day ${Math.floor(rotationDay)}/27`;
        }

        let time = 0;

        function animate() {
            ctx.fillStyle = '#000';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // Solar rotation: 27 days (simplified)
            rotationDay = (time / 60) % 27;
            const currentLongitude = (sunspotLongitude + (rotationDay / 27) * 360) % 360;

            drawSun(time);
            drawLatitudeLines();
            drawEquator();

            const status = drawSunspot(currentLongitude);
            updateInfo(currentLongitude, status);

            time++;
            requestAnimationFrame(animate);
        }

        animate();

        window.addEventListener('resize', () => {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        });
    </script>
</body>
</html>
