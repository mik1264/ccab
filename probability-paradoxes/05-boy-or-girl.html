<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Boy or Girl Paradox</title>
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body { background: #0a0e1a; color: #e0e0e0; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; overflow: hidden; }
canvas { display: block; }
#controls {
    position: fixed; top: 16px; right: 16px; z-index: 10;
    background: rgba(20,20,40,0.85); backdrop-filter: blur(10px);
    border: 1px solid rgba(100,140,255,0.2); border-radius: 12px;
    padding: 16px; min-width: 260px;
}
#controls h3 { color: #7aa2f7; margin-bottom: 10px; font-size: 14px; text-transform: uppercase; letter-spacing: 1px; }
#controls .stat { display: flex; justify-content: space-between; margin: 4px 0; font-size: 13px; }
#controls .stat span:last-child { color: #7aa2f7; font-weight: bold; }
#controls .section-label { font-size: 11px; color: #bb9af7; margin-top: 10px; text-transform: uppercase; letter-spacing: 1px; }
#controls button {
    width: 100%; padding: 8px; margin-top: 6px; border: 1px solid rgba(100,140,255,0.3);
    background: rgba(40,50,80,0.6); color: #c0d0ff; border-radius: 6px;
    cursor: pointer; font-size: 13px; transition: background 0.2s;
}
#controls button:hover { background: rgba(60,80,140,0.7); }
.mode-btn { display: inline-block !important; width: 48% !important; font-size: 11px !important; }
.mode-btn.active { background: rgba(80,110,200,0.6) !important; border-color: #7aa2f7 !important; }
#info {
    position: fixed; bottom: 16px; left: 16px; z-index: 10;
    background: rgba(20,20,40,0.85); backdrop-filter: blur(10px);
    border: 1px solid rgba(100,140,255,0.2); border-radius: 12px;
    padding: 16px; max-width: 400px; font-size: 13px; line-height: 1.5;
}
#info h3 { color: #7aa2f7; margin-bottom: 8px; }
#info em { color: #bb9af7; }
a.back { position: fixed; top: 16px; left: 16px; color: #7aa2f7; text-decoration: none; font-size: 14px; z-index: 20; }
a.back:hover { text-decoration: underline; }
</style>
</head>
<body>
<a href="index.html" class="back">&larr; Back</a>
<canvas id="c"></canvas>
<div id="controls">
    <h3>Boy or Girl Paradox</h3>
    <div class="section-label">Question A: "At least one boy"</div>
    <div class="stat"><span>Families shown:</span><span id="sAFam">0</span></div>
    <div class="stat"><span>Both boys:</span><span id="sABoth">0</span></div>
    <div class="stat"><span>P(both boys):</span><span id="sAProb">-</span></div>
    <div class="stat"><span>Expected:</span><span style="color:#bb9af7">1/3 = 33.3%</span></div>
    <hr style="border-color: rgba(100,140,255,0.1); margin: 6px 0;">
    <div class="section-label">Question B: "Older child is a boy"</div>
    <div class="stat"><span>Families shown:</span><span id="sBFam">0</span></div>
    <div class="stat"><span>Both boys:</span><span id="sBBoth">0</span></div>
    <div class="stat"><span>P(both boys):</span><span id="sBProb">-</span></div>
    <div class="stat"><span>Expected:</span><span style="color:#bb9af7">1/2 = 50.0%</span></div>
    <hr style="border-color: rgba(100,140,255,0.1); margin: 6px 0;">
    <div>
        <button class="mode-btn active" id="btnSide">Side by Side</button>
        <button class="mode-btn" id="btnMonte" style="margin-left:2%">Monte Carlo</button>
    </div>
    <button id="btnGenerate">Generate 200 Families</button>
    <button id="btnSim10k">Monte Carlo 10,000</button>
    <button id="btnSim100k">Monte Carlo 100,000</button>
    <button id="btnReset">Reset</button>
</div>
<div id="info">
    <h3>The Boy or Girl Paradox</h3>
    <p>A family has two children. You learn that <em>at least one is a boy</em>. What's the probability both are boys?</p>
    <p style="margin-top:6px;">Most say 1/2, but it's <em>1/3</em>! The possible families with at least one boy are: <em>BB, BG, GB</em>. Only 1 of 3 is BB.</p>
    <p style="margin-top:6px;">But if you learn the <em>older</em> child is a boy, then: <em>BB, BG</em>. Now it IS <em>1/2</em>! The extra information about <em>which child</em> changes everything.</p>
</div>
<script>
const canvas = document.getElementById('c');
const ctx = canvas.getContext('2d');

let W, H;
function resize() { W = canvas.width = window.innerWidth; H = canvas.height = window.innerHeight; }
resize();
window.addEventListener('resize', resize);

// State
let mode = 'side'; // 'side' or 'monte'
let families = []; // {child1: 'B'|'G', child2: 'B'|'G', x, y, opacity, filtered}
let monteResults = null;

// Stats
let statsA = { shown: 0, bothBoys: 0 };
let statsB = { shown: 0, bothBoys: 0 };

function generateFamilies(n) {
    families = [];
    for (let i = 0; i < n; i++) {
        let c1 = Math.random() < 0.5 ? 'B' : 'G';
        let c2 = Math.random() < 0.5 ? 'B' : 'G';
        families.push({ child1: c1, child2: c2, opacity: 0, targetOpacity: 1, filterA: false, filterB: false });
    }

    // Filter A: at least one boy
    // Filter B: older (child1) is a boy
    families.forEach(f => {
        f.filterA = (f.child1 === 'B' || f.child2 === 'B');
        f.filterB = (f.child1 === 'B');
    });

    // Calculate stats
    let famA = families.filter(f => f.filterA);
    let famB = families.filter(f => f.filterB);
    statsA.shown = famA.length;
    statsA.bothBoys = famA.filter(f => f.child1 === 'B' && f.child2 === 'B').length;
    statsB.shown = famB.length;
    statsB.bothBoys = famB.filter(f => f.child1 === 'B' && f.child2 === 'B').length;

    updateUI();
}

function runMonteCarlo(n) {
    let aTotal = 0, aBB = 0;
    let bTotal = 0, bBB = 0;

    for (let i = 0; i < n; i++) {
        let c1 = Math.random() < 0.5 ? 'B' : 'G';
        let c2 = Math.random() < 0.5 ? 'B' : 'G';

        // Question A: at least one boy
        if (c1 === 'B' || c2 === 'B') {
            aTotal++;
            if (c1 === 'B' && c2 === 'B') aBB++;
        }

        // Question B: older is a boy
        if (c1 === 'B') {
            bTotal++;
            if (c2 === 'B') bBB++;
        }
    }

    monteResults = {
        n, aTotal, aBB, aRate: aBB / aTotal,
        bTotal, bBB, bRate: bBB / bTotal
    };

    statsA = { shown: aTotal, bothBoys: aBB };
    statsB = { shown: bTotal, bothBoys: bBB };
    updateUI();
}

function updateUI() {
    document.getElementById('sAFam').textContent = statsA.shown;
    document.getElementById('sABoth').textContent = statsA.bothBoys;
    document.getElementById('sAProb').textContent = statsA.shown > 0 ? (statsA.bothBoys / statsA.shown * 100).toFixed(1) + '%' : '-';
    document.getElementById('sBFam').textContent = statsB.shown;
    document.getElementById('sBBoth').textContent = statsB.bothBoys;
    document.getElementById('sBProb').textContent = statsB.shown > 0 ? (statsB.bothBoys / statsB.shown * 100).toFixed(1) + '%' : '-';
}

function drawPerson(x, y, size, gender) {
    // Head
    ctx.beginPath();
    ctx.arc(x, y - size * 0.6, size * 0.3, 0, Math.PI * 2);
    ctx.fillStyle = gender === 'B' ? '#4a90d9' : '#d94a8a';
    ctx.fill();

    // Body
    ctx.beginPath();
    ctx.moveTo(x, y - size * 0.3);
    ctx.lineTo(x, y + size * 0.3);
    ctx.strokeStyle = gender === 'B' ? '#4a90d9' : '#d94a8a';
    ctx.lineWidth = size * 0.12;
    ctx.stroke();

    // Arms
    ctx.beginPath();
    ctx.moveTo(x - size * 0.3, y - size * 0.05);
    ctx.lineTo(x + size * 0.3, y - size * 0.05);
    ctx.stroke();

    // Legs
    ctx.beginPath();
    ctx.moveTo(x, y + size * 0.3);
    ctx.lineTo(x - size * 0.2, y + size * 0.65);
    ctx.moveTo(x, y + size * 0.3);
    ctx.lineTo(x + size * 0.2, y + size * 0.65);
    ctx.stroke();

    // Gender label
    ctx.fillStyle = gender === 'B' ? '#4a90d9' : '#d94a8a';
    ctx.font = `${size * 0.25}px "Segoe UI"`;
    ctx.textAlign = 'center';
    ctx.fillText(gender === 'B' ? 'B' : 'G', x, y + size * 0.9);
}

function drawFamilyGrid() {
    if (families.length === 0) return;

    let leftArea = { x: W * 0.05, y: H * 0.12, w: W * 0.35, h: H * 0.75 };
    let rightArea = { x: W * 0.44, y: H * 0.12, w: W * 0.35, h: H * 0.75 };

    // Labels
    ctx.fillStyle = '#7aa2f7';
    ctx.font = 'bold 13px "Segoe UI"';
    ctx.textAlign = 'center';
    ctx.fillText('Q.A: "At least one is a boy"', leftArea.x + leftArea.w / 2, leftArea.y - 4);
    ctx.fillText('Q.B: "The older child is a boy"', rightArea.x + rightArea.w / 2, rightArea.y - 4);

    let famA = families.filter(f => f.filterA);
    let famB = families.filter(f => f.filterB);
    let famNotA = families.filter(f => !f.filterA);
    let famNotB = families.filter(f => !f.filterB);

    function drawGrid(fams, area, highlight) {
        let cols = Math.ceil(Math.sqrt(fams.length * 1.5));
        let rows = Math.ceil(fams.length / cols);
        let cellW = area.w / cols;
        let cellH = Math.min(area.h / rows, 50);
        let personSize = Math.min(cellW * 0.35, cellH * 0.5, 16);

        fams.forEach((f, i) => {
            let col = i % cols;
            let row = Math.floor(i / cols);
            let cx = area.x + col * cellW + cellW / 2;
            let cy = area.y + 10 + row * cellH + cellH / 2;

            if (cy > area.y + area.h) return;

            let isBB = f.child1 === 'B' && f.child2 === 'B';

            // Background for BB families
            if (isBB && highlight) {
                ctx.fillStyle = 'rgba(100,180,255,0.1)';
                ctx.fillRect(cx - cellW/2 + 1, cy - cellH/2 + 1, cellW - 2, cellH - 2);
                ctx.strokeStyle = 'rgba(100,180,255,0.3)';
                ctx.lineWidth = 1;
                ctx.strokeRect(cx - cellW/2 + 1, cy - cellH/2 + 1, cellW - 2, cellH - 2);
            }

            drawPerson(cx - personSize * 0.6, cy, personSize, f.child1);
            drawPerson(cx + personSize * 0.6, cy, personSize, f.child2);
        });
    }

    drawGrid(famA, leftArea, true);
    drawGrid(famB, rightArea, true);

    // Summary bars
    function drawSummaryBar(area, shown, bb) {
        let y = area.y + area.h + 5;
        let bw = area.w * 0.8;
        let bh = 14;
        let x = area.x + (area.w - bw) / 2;

        ctx.fillStyle = 'rgba(40,50,80,0.5)';
        ctx.fillRect(x, y, bw, bh);

        if (shown > 0) {
            let ratio = bb / shown;
            ctx.fillStyle = 'rgba(100,180,255,0.5)';
            ctx.fillRect(x, y, bw * ratio, bh);
        }

        ctx.fillStyle = '#c0d0ff';
        ctx.font = '10px "Segoe UI"';
        ctx.textAlign = 'center';
        ctx.fillText(bb + ' / ' + shown + ' = ' + (shown > 0 ? (bb/shown*100).toFixed(1) + '%' : '-') + ' both boys', area.x + area.w / 2, y + bh + 12);
    }

    drawSummaryBar(leftArea, statsA.shown, statsA.bothBoys);
    drawSummaryBar(rightArea, statsB.shown, statsB.bothBoys);
}

function drawMonteCarloView() {
    if (!monteResults) return;

    let cx = W * 0.38;
    let cy = H * 0.4;

    ctx.fillStyle = '#7aa2f7';
    ctx.font = 'bold 16px "Segoe UI"';
    ctx.textAlign = 'center';
    ctx.fillText('Monte Carlo Simulation: ' + monteResults.n.toLocaleString() + ' families', cx, H * 0.1);

    // Two pie-chart like visualizations
    let r = Math.min(H * 0.18, W * 0.1);

    // Question A
    let axc = cx - r * 2;
    let ayc = cy;
    drawPieChart(axc, ayc, r, monteResults.aRate,
        'Q.A: "At least one boy"',
        (monteResults.aRate * 100).toFixed(2) + '% both boys',
        'Expected: 33.33%');

    // Question B
    let bxc = cx + r * 2;
    let byc = cy;
    drawPieChart(bxc, byc, r, monteResults.bRate,
        'Q.B: "Older child is boy"',
        (monteResults.bRate * 100).toFixed(2) + '% both boys',
        'Expected: 50.00%');

    // Explanation
    ctx.fillStyle = '#8090b0';
    ctx.font = '13px "Segoe UI"';
    ctx.textAlign = 'center';
    let ey = H * 0.7;
    ctx.fillText('All possible family configurations:', cx, ey);

    ctx.font = 'bold 14px "Segoe UI"';
    let configs = [
        { label: 'BB', c1: 'B', c2: 'B', inA: true, inB: true },
        { label: 'BG', c1: 'B', c2: 'G', inA: true, inB: true },
        { label: 'GB', c1: 'G', c2: 'B', inA: true, inB: false },
        { label: 'GG', c1: 'G', c2: 'G', inA: false, inB: false }
    ];

    let spacing = 90;
    configs.forEach((c, i) => {
        let x = cx - spacing * 1.5 + i * spacing;
        let y = ey + 30;

        // Box
        ctx.strokeStyle = c.inA ? 'rgba(100,180,255,0.5)' : 'rgba(100,100,100,0.3)';
        ctx.lineWidth = 2;
        ctx.strokeRect(x - 30, y - 15, 60, 45);

        drawPerson(x - 10, y + 8, 10, c.c1);
        drawPerson(x + 10, y + 8, 10, c.c2);

        ctx.fillStyle = '#c0d0ff';
        ctx.font = '10px "Segoe UI"';
        ctx.textAlign = 'center';
        ctx.fillText('(' + c.label + ')', x, y + 28);

        // A marker
        ctx.font = '9px "Segoe UI"';
        ctx.fillStyle = c.inA ? '#7dda58' : '#f76c6c';
        ctx.fillText(c.inA ? 'In A' : 'Not A', x, y + 42);

        // B marker
        ctx.fillStyle = c.inB ? '#7dda58' : '#f76c6c';
        ctx.fillText(c.inB ? 'In B' : 'Not B', x, y + 54);
    });

    // Arrows and notes
    ctx.fillStyle = '#bb9af7';
    ctx.font = '12px "Segoe UI"';
    ctx.fillText('A includes BB, BG, GB: P(BB|A) = 1/3', cx, ey + 78);
    ctx.fillText('B includes BB, BG only: P(BB|B) = 1/2', cx, ey + 96);
}

function drawPieChart(x, y, r, ratio, title, label1, label2) {
    // Title
    ctx.fillStyle = '#c0d0ff';
    ctx.font = 'bold 13px "Segoe UI"';
    ctx.textAlign = 'center';
    ctx.fillText(title, x, y - r - 14);

    // Background circle
    ctx.beginPath();
    ctx.arc(x, y, r, 0, Math.PI * 2);
    ctx.fillStyle = 'rgba(200,100,100,0.3)';
    ctx.fill();
    ctx.strokeStyle = 'rgba(200,200,200,0.2)';
    ctx.lineWidth = 1;
    ctx.stroke();

    // BB segment
    ctx.beginPath();
    ctx.moveTo(x, y);
    ctx.arc(x, y, r, -Math.PI / 2, -Math.PI / 2 + ratio * Math.PI * 2);
    ctx.closePath();
    ctx.fillStyle = 'rgba(100,180,255,0.5)';
    ctx.fill();

    // Labels
    ctx.fillStyle = '#80c0ff';
    ctx.font = '12px "Segoe UI"';
    ctx.fillText(label1, x, y + r + 18);
    ctx.fillStyle = '#bb9af7';
    ctx.font = '11px "Segoe UI"';
    ctx.fillText(label2, x, y + r + 34);

    // Center percentage
    ctx.fillStyle = '#fff';
    ctx.font = 'bold 18px "Segoe UI"';
    ctx.fillText((ratio * 100).toFixed(1) + '%', x, y + 6);
}

// Buttons
document.getElementById('btnSide').addEventListener('click', () => {
    mode = 'side';
    document.getElementById('btnSide').classList.add('active');
    document.getElementById('btnMonte').classList.remove('active');
});
document.getElementById('btnMonte').addEventListener('click', () => {
    mode = 'monte';
    document.getElementById('btnMonte').classList.add('active');
    document.getElementById('btnSide').classList.remove('active');
});
document.getElementById('btnGenerate').addEventListener('click', () => { generateFamilies(200); mode = 'side'; document.getElementById('btnSide').classList.add('active'); document.getElementById('btnMonte').classList.remove('active'); });
document.getElementById('btnSim10k').addEventListener('click', () => { runMonteCarlo(10000); mode = 'monte'; document.getElementById('btnMonte').classList.add('active'); document.getElementById('btnSide').classList.remove('active'); });
document.getElementById('btnSim100k').addEventListener('click', () => { runMonteCarlo(100000); mode = 'monte'; document.getElementById('btnMonte').classList.add('active'); document.getElementById('btnSide').classList.remove('active'); });
document.getElementById('btnReset').addEventListener('click', () => {
    families = []; monteResults = null;
    statsA = { shown: 0, bothBoys: 0 };
    statsB = { shown: 0, bothBoys: 0 };
    updateUI();
});

function animate() {
    ctx.clearRect(0, 0, W, H);

    // Grid
    ctx.strokeStyle = 'rgba(50,60,100,0.1)';
    ctx.lineWidth = 1;
    for (let x = 0; x < W; x += 40) { ctx.beginPath(); ctx.moveTo(x, 0); ctx.lineTo(x, H); ctx.stroke(); }
    for (let y = 0; y < H; y += 40) { ctx.beginPath(); ctx.moveTo(0, y); ctx.lineTo(W, y); ctx.stroke(); }

    // Title
    ctx.fillStyle = '#7aa2f7';
    ctx.font = 'bold 22px "Segoe UI"';
    ctx.textAlign = 'center';
    ctx.fillText('The Boy or Girl Paradox', W * 0.38, 36);
    ctx.fillStyle = '#5a6a8a';
    ctx.font = '13px "Segoe UI"';
    ctx.fillText('How the phrasing of a question changes the answer', W * 0.38, 58);

    if (mode === 'side') {
        if (families.length > 0) {
            drawFamilyGrid();
        } else {
            ctx.fillStyle = 'rgba(200,220,255,0.4)';
            ctx.font = '15px "Segoe UI"';
            ctx.textAlign = 'center';
            ctx.fillText('Click "Generate 200 Families" to start', W * 0.38, H * 0.45);
        }
    } else {
        if (monteResults) {
            drawMonteCarloView();
        } else {
            ctx.fillStyle = 'rgba(200,220,255,0.4)';
            ctx.font = '15px "Segoe UI"';
            ctx.textAlign = 'center';
            ctx.fillText('Click "Monte Carlo 10,000" to simulate', W * 0.38, H * 0.45);
        }
    }

    requestAnimationFrame(animate);
}

generateFamilies(200);
animate();

window.reset = function() {
    families = []; monteResults = null;
    statsA = { shown: 0, bothBoys: 0 };
    statsB = { shown: 0, bothBoys: 0 };
    updateUI();
    generateFamilies(200);
};
</script>
<script src="../assets/js/enhance.js"></script>
</body>
</html>
