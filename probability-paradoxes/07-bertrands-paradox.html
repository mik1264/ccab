<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bertrand's Paradox - What Does "Random" Mean?</title>
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body { background: #0a0e1a; overflow: hidden; font-family: 'Segoe UI', Arial, sans-serif; color: #cde; }
canvas { display: block; }
a.back { position: fixed; top: 20px; left: 20px; color: #8af; text-decoration: none; z-index: 100; font-size: 1.1em; }
a.back:hover { color: #bdf; }

#controls {
    position: fixed; top: 20px; right: 20px;
    background: rgba(20,20,40,0.85); backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px);
    border: 1px solid rgba(138,170,255,0.15); border-radius: 12px;
    padding: 18px; z-index: 100; width: 260px; font-size: 13px;
}
#controls h3 { margin-bottom: 10px; color: #8af; font-size: 15px; }
.method-btn {
    display: block; width: 100%; text-align: left;
    background: rgba(138,170,255,0.1); color: #aac; border: 1px solid rgba(138,170,255,0.2);
    border-radius: 8px; padding: 10px 12px; cursor: pointer; font-size: 12px; margin: 5px 0;
    transition: all 0.2s;
}
.method-btn.active { background: rgba(138,170,255,0.25); color: #fff; border-color: #8af; }
.method-btn:hover { background: rgba(138,170,255,0.2); }
.method-btn .name { font-weight: 600; font-size: 13px; }
.method-btn .desc { opacity: 0.7; font-size: 11px; margin-top: 2px; }
.ctrl-row { margin: 8px 0; display: flex; justify-content: space-between; align-items: center; }
.ctrl-row label { flex: 0 0 60px; font-size: 12px; }
.ctrl-row input[type=range] { flex: 1; margin: 0 8px; accent-color: #8af; }
.ctrl-row .val { flex: 0 0 40px; text-align: right; color: #8af; font-size: 12px; }
button {
    background: rgba(138,170,255,0.15); color: #8af; border: 1px solid rgba(138,170,255,0.3);
    border-radius: 6px; padding: 5px 12px; cursor: pointer; font-size: 12px; margin: 2px;
}
button:hover { background: rgba(138,170,255,0.3); }

#stats-panel {
    position: fixed; bottom: 20px; left: 20px;
    background: rgba(20,20,40,0.85); backdrop-filter: blur(10px);
    border: 1px solid rgba(138,170,255,0.15); border-radius: 12px;
    padding: 14px 18px; z-index: 100; font-size: 13px; min-width: 240px;
}
#stats-panel .row { display: flex; justify-content: space-between; margin: 3px 0; }
#stats-panel .val { color: #8af; font-weight: 600; }
#stats-panel .highlight { color: #f8a; font-weight: 700; font-size: 15px; }

#info {
    position: fixed; bottom: 20px; right: 20px;
    background: rgba(20,20,40,0.85); backdrop-filter: blur(10px);
    border: 1px solid rgba(138,170,255,0.15); border-radius: 12px;
    padding: 14px 18px; z-index: 100; font-size: 12px; max-width: 300px; line-height: 1.5;
}
#info h4 { color: #8af; margin-bottom: 6px; font-size: 14px; }
#info .key { color: #f8a; font-weight: 600; }
</style>
</head>
<body>
<a href="index.html" class="back">&#8592; Back</a>
<canvas id="canvas"></canvas>

<div id="controls">
    <h3>Bertrand's Paradox</h3>
    <div class="method-btn active" onclick="setMethod(0)" id="mb0">
        <div class="name">1. Random Endpoints</div>
        <div class="desc">Two random points on circumference</div>
    </div>
    <div class="method-btn" onclick="setMethod(1)" id="mb1">
        <div class="name">2. Random Radius</div>
        <div class="desc">Random point on a radius, perpendicular chord</div>
    </div>
    <div class="method-btn" onclick="setMethod(2)" id="mb2">
        <div class="name">3. Random Midpoint</div>
        <div class="desc">Random point in circle as chord midpoint</div>
    </div>
    <div class="ctrl-row">
        <label>Speed</label>
        <input type="range" id="speed" min="1" max="50" value="10">
        <span class="val" id="speedVal">10</span>
    </div>
    <div style="display:flex;gap:6px;margin-top:8px;">
        <button onclick="window.reset()">Reset</button>
        <button onclick="dropBatch(1000)">+1K</button>
        <button onclick="dropBatch(10000)">+10K</button>
    </div>
</div>

<div id="stats-panel">
    <div class="row"><span>Total chords:</span><span class="val" id="totalChords">0</span></div>
    <div class="row"><span>Longer than triangle side:</span><span class="val" id="longerCount">0</span></div>
    <div class="row"><span>Ratio:</span><span class="highlight" id="ratio">-</span></div>
    <div class="row" style="margin-top:8px;border-top:1px solid rgba(138,170,255,0.15);padding-top:8px;">
        <span>Expected:</span><span class="val" id="expected">1/3</span>
    </div>
</div>

<div id="info">
    <h4>The Paradox</h4>
    <p>"What is the probability a random chord is longer than the side of an inscribed equilateral triangle?"</p>
    <p style="margin-top:6px;">The answer depends on what <span class="key">"random"</span> means:</p>
    <p style="margin-top:4px;">
        Method 1: <span class="key">P = 1/3</span><br>
        Method 2: <span class="key">P = 1/2</span><br>
        Method 3: <span class="key">P = 1/4</span>
    </p>
    <p style="margin-top:6px;">All three are legitimate! "Random" is ambiguous without specifying a distribution.</p>
</div>

<script>
const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d');
let W, H, cx, cy, R;
let method = 0;
let chords = [];
let total = 0, longer = 0;
let paused = false;
let animId;
const MAX_CHORDS = 3000;
const expectedVals = ['1/3', '1/2', '1/4'];
const expectedNums = [1/3, 1/2, 1/4];

const triangleSideLen = (r) => r * Math.sqrt(3);

function resize() {
    W = canvas.width = window.innerWidth;
    H = canvas.height = window.innerHeight;
    cx = W / 2;
    cy = H / 2;
    R = Math.min(W, H) * 0.32;
}

function chordFromEndpoints() {
    const a1 = Math.random() * Math.PI * 2;
    const a2 = Math.random() * Math.PI * 2;
    return {
        x1: cx + R * Math.cos(a1), y1: cy + R * Math.sin(a1),
        x2: cx + R * Math.cos(a2), y2: cy + R * Math.sin(a2)
    };
}

function chordFromRadius() {
    const angle = Math.random() * Math.PI * 2;
    const dist = Math.random() * R;
    const mx = cx + dist * Math.cos(angle);
    const my = cy + dist * Math.sin(angle);
    const halfLen = Math.sqrt(R * R - dist * dist);
    const perpAngle = angle + Math.PI / 2;
    return {
        x1: mx + halfLen * Math.cos(perpAngle), y1: my + halfLen * Math.sin(perpAngle),
        x2: mx - halfLen * Math.cos(perpAngle), y2: my - halfLen * Math.sin(perpAngle)
    };
}

function chordFromMidpoint() {
    let mx, my, d;
    do {
        mx = cx + (Math.random() * 2 - 1) * R;
        my = cy + (Math.random() * 2 - 1) * R;
        d = Math.sqrt((mx - cx) ** 2 + (my - cy) ** 2);
    } while (d >= R);

    const halfLen = Math.sqrt(R * R - d * d);
    const angle = Math.atan2(my - cy, mx - cx) + Math.PI / 2;
    return {
        x1: mx + halfLen * Math.cos(angle), y1: my + halfLen * Math.sin(angle),
        x2: mx - halfLen * Math.cos(angle), y2: my - halfLen * Math.sin(angle)
    };
}

function dropChord() {
    let c;
    if (method === 0) c = chordFromEndpoints();
    else if (method === 1) c = chordFromRadius();
    else c = chordFromMidpoint();

    const len = Math.sqrt((c.x2 - c.x1) ** 2 + (c.y2 - c.y1) ** 2);
    c.isLonger = len > triangleSideLen(R);
    total++;
    if (c.isLonger) longer++;

    if (chords.length < MAX_CHORDS) {
        chords.push(c);
    } else {
        chords[Math.floor(Math.random() * chords.length)] = c;
    }
}

function dropBatch(n) {
    for (let i = 0; i < n; i++) dropChord();
    updateStats();
}

function setMethod(m) {
    method = m;
    document.querySelectorAll('.method-btn').forEach((b, i) => b.classList.toggle('active', i === m));
    document.getElementById('expected').textContent = expectedVals[m];
    window.reset();
}

function updateStats() {
    document.getElementById('totalChords').textContent = total.toLocaleString();
    document.getElementById('longerCount').textContent = longer.toLocaleString();
    if (total > 0) {
        document.getElementById('ratio').textContent = (longer / total).toFixed(4);
    }
}

function drawCircle() {
    ctx.beginPath();
    ctx.arc(cx, cy, R, 0, Math.PI * 2);
    ctx.strokeStyle = 'rgba(138,170,255,0.4)';
    ctx.lineWidth = 2;
    ctx.stroke();

    // inscribed equilateral triangle
    ctx.beginPath();
    for (let i = 0; i < 3; i++) {
        const a = (i * Math.PI * 2) / 3 - Math.PI / 2;
        const x = cx + R * Math.cos(a);
        const y = cy + R * Math.sin(a);
        if (i === 0) ctx.moveTo(x, y);
        else ctx.lineTo(x, y);
    }
    ctx.closePath();
    ctx.strokeStyle = 'rgba(255,200,80,0.3)';
    ctx.lineWidth = 1.5;
    ctx.setLineDash([6, 4]);
    ctx.stroke();
    ctx.setLineDash([]);
}

function drawChords() {
    for (const c of chords) {
        ctx.beginPath();
        ctx.moveTo(c.x1, c.y1);
        ctx.lineTo(c.x2, c.y2);
        ctx.strokeStyle = c.isLonger ? 'rgba(255,80,80,0.35)' : 'rgba(80,180,255,0.2)';
        ctx.lineWidth = 0.8;
        ctx.stroke();
    }
}

function draw() {
    ctx.clearRect(0, 0, W, H);
    drawCircle();
    drawChords();
    updateStats();
}

function animate() {
    if (!paused) {
        const spd = parseInt(document.getElementById('speed').value);
        for (let i = 0; i < spd; i++) dropChord();
    }
    draw();
    animId = requestAnimationFrame(animate);
}

document.getElementById('speed').addEventListener('input', function() {
    document.getElementById('speedVal').textContent = this.value;
});

window.addEventListener('resize', resize);

window.addEventListener('keydown', function(e) {
    if (e.code === 'Space') { e.preventDefault(); paused = !paused; }
});

window.reset = function() {
    chords = [];
    total = 0;
    longer = 0;
    updateStats();
    document.getElementById('ratio').textContent = '-';
};

resize();
animate();
</script>
<script src="../assets/js/enhance.js"></script>
</body>
</html>
