<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Elliptic Filter - Sharpest Cutoff</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Courier New', monospace;
            background: linear-gradient(135deg, #0a0a1a 0%, #1a1a3e 100%);
            color: #00aaff;
            min-height: 100vh;
            padding: 20px;
        }
        .back-link {
            position: fixed; top: 20px; left: 20px;
            color: #00aaff; text-decoration: none;
            padding: 10px 20px; background: rgba(0,170,255,0.1);
            border: 1px solid #00aaff; border-radius: 5px; z-index: 100;
        }
        .container { max-width: 1100px; margin: 60px auto 0; }
        h1 { font-size: 2rem; margin-bottom: 10px; text-align: center; }
        .subtitle { color: #888; margin-bottom: 30px; text-align: center; }
        .comparison-panel {
            background: rgba(0,0,0,0.5); padding: 25px;
            border-radius: 15px; border: 1px solid #00aaff; margin-bottom: 30px;
        }
        canvas { width: 100%; height: 300px; background: rgba(0,20,40,0.5); border-radius: 10px; }
        .legend {
            display: flex; justify-content: center; gap: 30px;
            margin-top: 15px; flex-wrap: wrap;
        }
        .legend-item { display: flex; align-items: center; gap: 8px; }
        .legend-color { width: 30px; height: 4px; border-radius: 2px; }
        .specs {
            display: grid; grid-template-columns: repeat(4, 1fr);
            gap: 15px; margin-top: 20px;
        }
        .spec-box {
            background: rgba(0,0,0,0.3); padding: 15px;
            border-radius: 10px; text-align: center;
        }
        .spec-box h4 { color: #888; font-size: 0.8rem; margin-bottom: 5px; }
        .spec-box .value { color: #00ffff; font-size: 1.1rem; }
        .info { background: rgba(0,170,255,0.05); padding: 20px; border-radius: 10px; }
        .info h3 { color: #00ccff; margin-bottom: 10px; }
        .info p { color: #aaa; line-height: 1.6; margin-bottom: 10px; }
        table {
            width: 100%; margin-top: 15px; border-collapse: collapse;
        }
        th, td {
            padding: 10px; text-align: center;
            border: 1px solid rgba(0,170,255,0.3);
        }
        th { background: rgba(0,170,255,0.1); color: #00ccff; }
        @media (max-width: 768px) { .specs { grid-template-columns: 1fr 1fr; } }
    </style>
</head>
<body>
    <a href="index.html" class="back-link">‚Üê Back</a>
    <div class="container">
        <h1>Elliptic (Cauer) Filter</h1>
        <p class="subtitle">The sharpest possible transition for a given filter order</p>

        <div class="comparison-panel">
            <h3 style="color:#00ccff; text-align:center; margin-bottom:15px;">Filter Type Comparison (Order 4)</h3>
            <canvas id="mainCanvas"></canvas>
            <div class="legend">
                <div class="legend-item">
                    <div class="legend-color" style="background: #ff6688;"></div>
                    <span>Butterworth</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #ffaa00;"></div>
                    <span>Chebyshev Type I</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #00ffaa;"></div>
                    <span>Elliptic</span>
                </div>
            </div>
            <div class="specs">
                <div class="spec-box">
                    <h4>Filter Order</h4>
                    <div class="value">4</div>
                </div>
                <div class="spec-box">
                    <h4>Passband Ripple</h4>
                    <div class="value">1 dB</div>
                </div>
                <div class="spec-box">
                    <h4>Stopband Atten.</h4>
                    <div class="value">40 dB</div>
                </div>
                <div class="spec-box">
                    <h4>Transition Width</h4>
                    <div class="value">Elliptic: Narrowest</div>
                </div>
            </div>
        </div>

        <div class="info">
            <h3>Elliptic Filter Characteristics</h3>
            <p><strong>Optimal Transition:</strong> Elliptic filters achieve the sharpest possible transition between passband and stopband for a given filter order - no other filter can do better.</p>
            <p><strong>Equiripple Everywhere:</strong> Unlike Butterworth (flat) or Chebyshev (ripple in one band), elliptic filters have equiripple in BOTH the passband and stopband.</p>
            <p><strong>Trade-off:</strong> The price for the sharpest cutoff is ripple in both bands and significant phase distortion. Not suitable when linear phase is required.</p>

            <table>
                <tr>
                    <th>Filter Type</th>
                    <th>Passband</th>
                    <th>Stopband</th>
                    <th>Transition</th>
                    <th>Phase</th>
                </tr>
                <tr>
                    <td>Butterworth</td>
                    <td>Maximally Flat</td>
                    <td>Monotonic</td>
                    <td>Widest</td>
                    <td>Best</td>
                </tr>
                <tr>
                    <td>Chebyshev I</td>
                    <td>Equiripple</td>
                    <td>Monotonic</td>
                    <td>Medium</td>
                    <td>Medium</td>
                </tr>
                <tr>
                    <td>Chebyshev II</td>
                    <td>Monotonic</td>
                    <td>Equiripple</td>
                    <td>Medium</td>
                    <td>Medium</td>
                </tr>
                <tr style="background: rgba(0,255,170,0.1);">
                    <td>Elliptic</td>
                    <td>Equiripple</td>
                    <td>Equiripple</td>
                    <td>Narrowest</td>
                    <td>Worst</td>
                </tr>
            </table>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('mainCanvas');
        const ctx = canvas.getContext('2d');

        function resizeCanvas() {
            const dpr = window.devicePixelRatio || 1;
            const rect = canvas.getBoundingClientRect();
            canvas.width = rect.width * dpr;
            canvas.height = rect.height * dpr;
            ctx.scale(dpr, dpr);
        }

        function butterworth(omega, n, wc) {
            return 1 / Math.sqrt(1 + Math.pow(omega / wc, 2 * n));
        }

        function chebyshev(omega, n, eps, wc) {
            const x = omega / wc;
            let Tn;
            if (Math.abs(x) <= 1) {
                Tn = Math.cos(n * Math.acos(x));
            } else {
                Tn = Math.cosh(n * Math.acosh(Math.abs(x)));
            }
            return 1 / Math.sqrt(1 + eps * eps * Tn * Tn);
        }

        // Simplified elliptic approximation for visualization
        function elliptic(omega, n, eps, wc, As) {
            const x = omega / wc;
            if (x < 1) {
                // Passband with ripple
                const ripple = Math.cos(n * Math.acos(x));
                return 1 / Math.sqrt(1 + eps * eps * ripple * ripple);
            } else {
                // Very sharp transition then stopband ripple
                const transition = (x - 1) / 0.1;
                const stopLevel = Math.pow(10, -As / 20);
                const attenuation = 1 - (1 - stopLevel) * Math.min(1, transition);
                // Add stopband ripple
                const ripple = 0.8 + 0.2 * Math.cos(4 * Math.PI * x);
                return attenuation * ripple * stopLevel;
            }
        }

        function draw() {
            const w = canvas.width / (window.devicePixelRatio || 1);
            const h = canvas.height / (window.devicePixelRatio || 1);

            ctx.fillStyle = 'rgba(0,20,40,0.5)';
            ctx.fillRect(0, 0, w, h);

            // Grid
            ctx.strokeStyle = 'rgba(0,170,255,0.1)';
            ctx.lineWidth = 1;
            ctx.fillStyle = '#666';
            ctx.font = '10px Courier New';

            for (let db = 0; db >= -60; db -= 10) {
                const y = (-db / 60) * h;
                ctx.beginPath();
                ctx.moveTo(0, y);
                ctx.lineTo(w, y);
                ctx.stroke();
                ctx.fillText(`${db}dB`, 5, y - 3);
            }

            const n = 4;
            const wc = 0.4;
            const eps = 0.5;
            const As = 40;

            // Cutoff line
            ctx.strokeStyle = 'rgba(255,255,255,0.3)';
            ctx.setLineDash([5, 5]);
            ctx.beginPath();
            ctx.moveTo(wc * w, 0);
            ctx.lineTo(wc * w, h);
            ctx.stroke();
            ctx.setLineDash([]);

            // Butterworth
            ctx.strokeStyle = '#ff6688';
            ctx.lineWidth = 2;
            ctx.beginPath();
            for (let x = 1; x < w; x++) {
                const omega = x / w;
                const mag = butterworth(omega, n, wc);
                const db = 20 * Math.log10(mag + 1e-10);
                const y = Math.min(h, Math.max(0, (-db / 60) * h));
                if (x === 1) ctx.moveTo(x, y);
                else ctx.lineTo(x, y);
            }
            ctx.stroke();

            // Chebyshev
            ctx.strokeStyle = '#ffaa00';
            ctx.lineWidth = 2;
            ctx.beginPath();
            for (let x = 1; x < w; x++) {
                const omega = x / w;
                const mag = chebyshev(omega, n, eps, wc);
                const db = 20 * Math.log10(mag + 1e-10);
                const y = Math.min(h, Math.max(0, (-db / 60) * h));
                if (x === 1) ctx.moveTo(x, y);
                else ctx.lineTo(x, y);
            }
            ctx.stroke();

            // Elliptic (approximation)
            ctx.strokeStyle = '#00ffaa';
            ctx.lineWidth = 3;
            ctx.beginPath();
            for (let x = 1; x < w; x++) {
                const omega = x / w;
                const mag = elliptic(omega, n, eps, wc, As);
                const db = 20 * Math.log10(mag + 1e-10);
                const y = Math.min(h, Math.max(0, (-db / 60) * h));
                if (x === 1) ctx.moveTo(x, y);
                else ctx.lineTo(x, y);
            }
            ctx.stroke();

            // Frequency labels
            ctx.fillStyle = '#888';
            ctx.fillText('0', 5, h - 5);
            ctx.fillText('Normalized Frequency', w / 2 - 60, h - 5);
            ctx.fillText('1', w - 15, h - 5);
        }

        function init() {
            resizeCanvas();
            draw();
        }

        window.addEventListener('resize', init);
        init();
    </script>
    <script src="../assets/js/enhance.js" defer></script>
</body>
</html>
