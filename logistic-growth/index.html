<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Logistic Population Growth</title>
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body { background: #0a0e1a; overflow: hidden; font-family: sans-serif; }
canvas { display: block; }
#title {
    position: fixed; top: 50px; left: 50%; transform: translateX(-50%);
    color: #fbbf24; font-size: 22px; font-weight: bold; text-align: center;
    text-shadow: 0 0 20px rgba(251,191,36,0.3); z-index: 10; pointer-events: none;
}
#controls {
    position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%);
    display: flex; gap: 20px; z-index: 10; background: rgba(0,0,0,0.7);
    padding: 12px 20px; border-radius: 10px; align-items: center;
}
.ctrl { display: flex; flex-direction: column; align-items: center; }
.ctrl label { color: #ccc; font-size: 11px; margin-bottom: 4px; }
.ctrl input[type=range] { width: 120px; accent-color: #fbbf24; }
.ctrl span { color: #fbbf24; font-size: 11px; margin-top: 2px; }
button {
    background: rgba(251,191,36,0.2); color: #fbbf24; border: 1px solid #fbbf24;
    padding: 6px 14px; border-radius: 6px; cursor: pointer; font-size: 12px;
}
button:hover { background: rgba(251,191,36,0.4); }
#stats {
    position: fixed; top: 50px; right: 20px; color: #ccc; font-size: 13px;
    background: rgba(0,0,0,0.7); padding: 10px 16px; border-radius: 8px; z-index: 10;
    line-height: 1.6;
}
</style>
</head>
<body>
<a href="../index.html" style="position:fixed;top:10px;left:10px;padding:8px 16px;background:rgba(0,0,0,0.7);color:#fbbf24;text-decoration:none;border-radius:6px;font-size:14px;z-index:999;font-family:sans-serif;">← Back to Gallery</a>
<div id="title">Logistic Population Growth</div>
<div id="stats">
    Population: <span id="popCount" style="color:#4ade80;">0</span><br>
    Carrying Capacity: <span id="capCount" style="color:#fbbf24;">0</span><br>
    Phase: <span id="phase" style="color:#c084fc;">Exponential</span>
</div>
<div id="controls">
    <div class="ctrl">
        <label>Growth Rate (r)</label>
        <input type="range" id="growthRate" min="0.01" max="0.08" step="0.005" value="0.04">
        <span id="growthVal">0.04</span>
    </div>
    <div class="ctrl">
        <label>Carrying Capacity (K)</label>
        <input type="range" id="capacity" min="100" max="600" step="25" value="350">
        <span id="capVal">350</span>
    </div>
    <button id="resetBtn">Reset</button>
</div>
<canvas id="canvas"></canvas>
<script>
const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d');

function resize() {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
}
resize();
window.addEventListener('resize', resize);

let growthRate = 0.04;
let carryingCapacity = 350;
let organisms = [];
let popHistory = [];
const MAX_HISTORY = 400;

document.getElementById('growthRate').oninput = function() {
    growthRate = parseFloat(this.value);
    document.getElementById('growthVal').textContent = this.value;
};
document.getElementById('capacity').oninput = function() {
    carryingCapacity = parseInt(this.value);
    document.getElementById('capVal').textContent = this.value;
};

class Organism {
    constructor(x, y) {
        this.x = x;
        this.y = y;
        this.vx = (Math.random() - 0.5) * 1.5;
        this.vy = (Math.random() - 0.5) * 1.5;
        this.size = 2.5 + Math.random() * 1.5;
        this.pulse = Math.random() * Math.PI * 2;
        this.hue = 120 + Math.random() * 40;
        this.alive = true;
        this.age = 0;
    }

    update(w, h) {
        this.age++;
        this.pulse += 0.05;
        this.vx += (Math.random() - 0.5) * 0.2;
        this.vy += (Math.random() - 0.5) * 0.2;
        let speed = Math.sqrt(this.vx * this.vx + this.vy * this.vy);
        if (speed > 1.5) {
            this.vx = (this.vx / speed) * 1.5;
            this.vy = (this.vy / speed) * 1.5;
        }
        this.x += this.vx;
        this.y += this.vy;
        let margin = 80;
        if (this.x < margin) this.vx += 0.1;
        if (this.x > w - margin) this.vx -= 0.1;
        if (this.y < margin + 40) this.vy += 0.1;
        if (this.y > h - margin) this.vy -= 0.1;
        if (this.x < 10) { this.x = 10; this.vx *= -1; }
        if (this.x > w - 10) { this.x = w - 10; this.vx *= -1; }
        if (this.y < 10) { this.y = 10; this.vy *= -1; }
        if (this.y > h - 10) { this.y = h - 10; this.vy *= -1; }
    }

    draw(ctx) {
        let s = this.size + Math.sin(this.pulse) * 0.5;
        let ratio = organisms.length / carryingCapacity;
        let r = Math.min(1, ratio);
        let red = Math.floor(r * 200);
        let green = Math.floor((1 - r * 0.5) * 220);
        ctx.beginPath();
        ctx.arc(this.x, this.y, s, 0, Math.PI * 2);
        ctx.fillStyle = `rgba(${red}, ${green}, 100, 0.9)`;
        ctx.shadowColor = `rgba(${red}, ${green}, 100, 0.5)`;
        ctx.shadowBlur = 6;
        ctx.fill();
        ctx.shadowBlur = 0;
    }
}

function init() {
    organisms = [];
    popHistory = [];
    let cx = canvas.width / 2;
    let cy = canvas.height / 2;
    for (let i = 0; i < 10; i++) {
        organisms.push(new Organism(
            cx + (Math.random() - 0.5) * 100,
            cy + (Math.random() - 0.5) * 100
        ));
    }
}

document.getElementById('resetBtn').onclick = init;
init();

let frameCount = 0;

function update() {
    frameCount++;
    let w = canvas.width;
    let h = canvas.height;

    for (let o of organisms) {
        o.update(w, h);
    }

    let pop = organisms.length;
    let logisticFactor = 1 - (pop / carryingCapacity);
    let birthProb = growthRate * Math.max(0, logisticFactor);

    if (frameCount % 2 === 0) {
        let births = [];
        for (let o of organisms) {
            if (Math.random() < birthProb && organisms.length + births.length < carryingCapacity * 1.2) {
                births.push(new Organism(
                    o.x + (Math.random() - 0.5) * 30,
                    o.y + (Math.random() - 0.5) * 30
                ));
            }
        }
        for (let b of births) organisms.push(b);
    }

    if (pop > carryingCapacity) {
        let excess = pop - carryingCapacity;
        let deathProb = (excess / carryingCapacity) * 0.05;
        organisms = organisms.filter(() => Math.random() > deathProb);
    }

    if (frameCount % 5 === 0) {
        popHistory.push(organisms.length);
        if (popHistory.length > MAX_HISTORY) popHistory.shift();
    }

    document.getElementById('popCount').textContent = organisms.length;
    document.getElementById('capCount').textContent = carryingCapacity;

    let ratio = organisms.length / carryingCapacity;
    let phaseEl = document.getElementById('phase');
    if (ratio < 0.3) {
        phaseEl.textContent = 'Exponential Growth';
        phaseEl.style.color = '#4ade80';
    } else if (ratio < 0.7) {
        phaseEl.textContent = 'Decelerating Growth';
        phaseEl.style.color = '#fbbf24';
    } else {
        phaseEl.textContent = 'Carrying Capacity';
        phaseEl.style.color = '#f87171';
    }
}

function drawGraph(ctx) {
    let gw = 280, gh = 150;
    let gx = 20, gy = canvas.height - gh - 80;

    ctx.fillStyle = 'rgba(0,0,0,0.7)';
    ctx.strokeStyle = 'rgba(251,191,36,0.3)';
    ctx.lineWidth = 1;
    ctx.beginPath();
    ctx.roundRect(gx - 10, gy - 25, gw + 20, gh + 45, 8);
    ctx.fill();
    ctx.stroke();

    ctx.fillStyle = '#fbbf24';
    ctx.font = '11px sans-serif';
    ctx.fillText('Population vs Time', gx + 5, gy - 10);

    ctx.strokeStyle = 'rgba(255,255,255,0.1)';
    ctx.beginPath();
    ctx.moveTo(gx, gy + gh); ctx.lineTo(gx + gw, gy + gh);
    ctx.moveTo(gx, gy); ctx.lineTo(gx, gy + gh);
    ctx.stroke();

    let capY = gy + gh - (carryingCapacity / (carryingCapacity * 1.3)) * gh;
    ctx.strokeStyle = 'rgba(251,191,36,0.5)';
    ctx.setLineDash([4, 4]);
    ctx.beginPath();
    ctx.moveTo(gx, capY);
    ctx.lineTo(gx + gw, capY);
    ctx.stroke();
    ctx.setLineDash([]);
    ctx.fillStyle = '#fbbf24';
    ctx.font = '9px sans-serif';
    ctx.fillText('K=' + carryingCapacity, gx + gw - 40, capY - 4);

    if (popHistory.length > 1) {
        let maxVal = carryingCapacity * 1.3;
        ctx.beginPath();
        for (let i = 0; i < popHistory.length; i++) {
            let x = gx + (i / MAX_HISTORY) * gw;
            let y = gy + gh - (popHistory[i] / maxVal) * gh;
            if (i === 0) ctx.moveTo(x, y);
            else ctx.lineTo(x, y);
        }
        ctx.strokeStyle = '#4ade80';
        ctx.lineWidth = 2;
        ctx.stroke();

        ctx.lineTo(gx + ((popHistory.length - 1) / MAX_HISTORY) * gw, gy + gh);
        ctx.lineTo(gx, gy + gh);
        ctx.closePath();
        let grad = ctx.createLinearGradient(0, gy, 0, gy + gh);
        grad.addColorStop(0, 'rgba(74,222,128,0.3)');
        grad.addColorStop(1, 'rgba(74,222,128,0)');
        ctx.fillStyle = grad;
        ctx.fill();
    }

    ctx.fillStyle = '#666';
    ctx.font = '9px sans-serif';
    ctx.fillText('Time →', gx + gw / 2 - 15, gy + gh + 14);
}

function draw() {
    ctx.fillStyle = '#0a0e1a';
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    let grad = ctx.createRadialGradient(
        canvas.width / 2, canvas.height / 2, 0,
        canvas.width / 2, canvas.height / 2, canvas.width * 0.5
    );
    grad.addColorStop(0, 'rgba(20,40,30,0.3)');
    grad.addColorStop(1, 'rgba(10,14,26,0)');
    ctx.fillStyle = grad;
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    for (let o of organisms) {
        o.draw(ctx);
    }

    drawGraph(ctx);
}

function animate() {
    update();
    draw();
    requestAnimationFrame(animate);
}
animate();
</script>
</body>
</html>
