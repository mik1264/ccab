<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Phase Diagrams - Chemistry</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', system-ui, sans-serif; background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%); color: #eee; min-height: 100vh; padding: 20px; }
        .back-link { position: fixed; top: 20px; left: 20px; color: #60a5fa; text-decoration: none; font-weight: 600; padding: 8px 16px; background: rgba(0,0,0,0.3); border-radius: 20px; z-index: 100; }
        h1 { text-align: center; margin: 40px 0 10px; font-size: 2.2em; color: #60a5fa; }
        .subtitle { text-align: center; opacity: 0.8; margin-bottom: 20px; }
        .container { max-width: 1200px; margin: 0 auto; display: grid; grid-template-columns: 1fr 300px; gap: 20px; }
        .panel { background: rgba(255,255,255,0.05); border-radius: 12px; padding: 25px; }
        .info-box { background: rgba(96, 165, 250, 0.1); border: 1px solid rgba(96, 165, 250, 0.3); border-radius: 8px; padding: 15px; margin-bottom: 20px; font-size: 0.85em; line-height: 1.6; }
        h3 { color: #60a5fa; margin-bottom: 15px; }
        canvas { width: 100%; border-radius: 8px; cursor: crosshair; }
        .control-group { margin: 15px 0; }
        .control-group label { display: block; margin-bottom: 5px; }
        .control-group input, .control-group select { width: 100%; }
        .value-display { color: #60a5fa; font-family: monospace; }
        button { width: 100%; padding: 12px; margin: 8px 0; border: none; border-radius: 8px; font-size: 1em; font-weight: 600; cursor: pointer; }
        .btn-primary { background: #60a5fa; color: #1a1a2e; }
        .btn-secondary { background: rgba(255,255,255,0.1); color: #fff; }
        .phase-display { font-size: 2em; text-align: center; padding: 15px; border-radius: 12px; margin: 15px 0; }
        .state-solid { background: rgba(96, 165, 250, 0.3); }
        .state-liquid { background: rgba(74, 222, 128, 0.3); }
        .state-gas { background: rgba(248, 113, 113, 0.3); }
        .state-supercritical { background: rgba(167, 139, 250, 0.3); }
        @media (max-width: 900px) { .container { grid-template-columns: 1fr; } }
    </style>
</head>
<body>
    <a href="index.html" class="back-link">‚Üê Back</a>
    <h1>Phase Diagrams</h1>
    <p class="subtitle">States of matter and phase transitions</p>

    <div class="container">
        <div class="panel">
            <canvas id="canvas" width="800" height="500"></canvas>
            <p style="text-align: center; font-size: 0.85em; margin-top: 10px; opacity: 0.7;">
                Click on the diagram to set temperature and pressure
            </p>
        </div>

        <div class="panel">
            <div class="info-box">
                <strong>Phase Diagram:</strong>
                Shows which phase (solid, liquid, gas) exists at different
                temperatures and pressures. Special points include the
                <em>triple point</em> and <em>critical point</em>.
            </div>

            <div class="phase-display state-liquid" id="phaseDisplay">
                üíß LIQUID
            </div>

            <div class="control-group">
                <label>Substance:</label>
                <select id="substanceSelect" onchange="updateSubstance()">
                    <option value="water">Water (H‚ÇÇO)</option>
                    <option value="co2">Carbon Dioxide (CO‚ÇÇ)</option>
                    <option value="nitrogen">Nitrogen (N‚ÇÇ)</option>
                    <option value="ethanol">Ethanol (C‚ÇÇH‚ÇÖOH)</option>
                </select>
            </div>

            <div class="control-group">
                <label>Temperature: <span class="value-display" id="tempVal">25¬∞C</span></label>
                <input type="range" id="tempSlider" min="-100" max="500" value="25" oninput="updateConditions()">
            </div>

            <div class="control-group">
                <label>Pressure: <span class="value-display" id="pressVal">1 atm</span></label>
                <input type="range" id="pressSlider" min="0" max="300" value="100" oninput="updateConditions()">
            </div>

            <button class="btn-primary" onclick="animateTransition('heat')">Heat</button>
            <button class="btn-primary" onclick="animateTransition('cool')">Cool</button>
            <button class="btn-secondary" onclick="animateTransition('compress')">Compress</button>
            <button class="btn-secondary" onclick="animateTransition('expand')">Expand</button>

            <h3 style="margin-top: 15px;">Critical Points</h3>
            <div style="font-size: 0.9em;">
                <div style="display: flex; justify-content: space-between; padding: 3px 0;">
                    <span>Triple Point:</span><span class="value-display" id="tripleVal">0.01¬∞C, 0.006 atm</span>
                </div>
                <div style="display: flex; justify-content: space-between; padding: 3px 0;">
                    <span>Critical Point:</span><span class="value-display" id="criticalVal">374¬∞C, 218 atm</span>
                </div>
                <div style="display: flex; justify-content: space-between; padding: 3px 0;">
                    <span>Boiling Point:</span><span class="value-display" id="boilingVal">100¬∞C</span>
                </div>
                <div style="display: flex; justify-content: space-between; padding: 3px 0;">
                    <span>Melting Point:</span><span class="value-display" id="meltingVal">0¬∞C</span>
                </div>
            </div>

            <h3 style="margin-top: 15px;">Phase Transitions</h3>
            <div style="font-size: 0.85em; line-height: 1.8;">
                <div>Solid ‚Üí Liquid: <em>Melting</em></div>
                <div>Liquid ‚Üí Gas: <em>Vaporization</em></div>
                <div>Solid ‚Üí Gas: <em>Sublimation</em></div>
                <div>Gas ‚Üí Liquid: <em>Condensation</em></div>
            </div>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');

        const substances = {
            water: {
                name: 'Water',
                triple: { t: 0.01, p: 0.006 },
                critical: { t: 374, p: 218 },
                boiling: 100,
                melting: 0,
                slopeNegative: true // Water has negative slope for solid-liquid line
            },
            co2: {
                name: 'Carbon Dioxide',
                triple: { t: -56.6, p: 5.11 },
                critical: { t: 31, p: 73 },
                boiling: -78.5, // sublimation at 1 atm
                melting: -56.6,
                slopeNegative: false
            },
            nitrogen: {
                name: 'Nitrogen',
                triple: { t: -210, p: 0.125 },
                critical: { t: -147, p: 34 },
                boiling: -196,
                melting: -210,
                slopeNegative: false
            },
            ethanol: {
                name: 'Ethanol',
                triple: { t: -114, p: 0.00004 },
                critical: { t: 241, p: 63 },
                boiling: 78,
                melting: -114,
                slopeNegative: false
            }
        };

        let currentSubstance = 'water';
        let temperature = 25; // ¬∞C
        let pressure = 1; // atm
        let animating = false;

        function updateSubstance() {
            currentSubstance = document.getElementById('substanceSelect').value;
            const s = substances[currentSubstance];

            document.getElementById('tripleVal').textContent =
                `${s.triple.t}¬∞C, ${s.triple.p} atm`;
            document.getElementById('criticalVal').textContent =
                `${s.critical.t}¬∞C, ${s.critical.p} atm`;
            document.getElementById('boilingVal').textContent = s.boiling + '¬∞C';
            document.getElementById('meltingVal').textContent = s.melting + '¬∞C';

            draw();
        }

        function updateConditions() {
            temperature = parseInt(document.getElementById('tempSlider').value);
            pressure = parseInt(document.getElementById('pressSlider').value) / 100;

            document.getElementById('tempVal').textContent = temperature + '¬∞C';
            document.getElementById('pressVal').textContent = pressure.toFixed(2) + ' atm';

            updatePhaseDisplay();
            draw();
        }

        function getPhase(t, p, substance) {
            const s = substances[substance];

            // Above critical point
            if (t > s.critical.t && p > s.critical.p) {
                return 'supercritical';
            }

            // Below triple point pressure - only solid and gas
            if (p < s.triple.p) {
                // Sublimation curve (simplified)
                const sublimationT = s.triple.t - 20 * Math.log(s.triple.p / Math.max(p, 0.0001));
                return t < sublimationT ? 'solid' : 'gas';
            }

            // Between triple and critical
            // Solid-liquid boundary
            let meltingT;
            if (s.slopeNegative) {
                // Water - negative slope
                meltingT = s.melting - (p - 1) * 0.01;
            } else {
                meltingT = s.melting + (p - s.triple.p) * 0.5;
            }

            // Liquid-gas boundary (Clausius-Clapeyron approximation)
            const boilingT = s.boiling + 30 * Math.log(p);

            if (t < meltingT) return 'solid';
            if (t < boilingT && p < s.critical.p) return 'liquid';
            if (t < s.critical.t && p > s.critical.p) return 'liquid';
            return 'gas';
        }

        function updatePhaseDisplay() {
            const phase = getPhase(temperature, pressure, currentSubstance);
            const display = document.getElementById('phaseDisplay');

            display.className = 'phase-display';
            switch (phase) {
                case 'solid':
                    display.classList.add('state-solid');
                    display.textContent = 'üßä SOLID';
                    break;
                case 'liquid':
                    display.classList.add('state-liquid');
                    display.textContent = 'üíß LIQUID';
                    break;
                case 'gas':
                    display.classList.add('state-gas');
                    display.textContent = 'üí® GAS';
                    break;
                case 'supercritical':
                    display.classList.add('state-supercritical');
                    display.textContent = '‚ö° SUPERCRITICAL';
                    break;
            }
        }

        function animateTransition(type) {
            if (animating) return;
            animating = true;

            const step = () => {
                let changed = false;

                if (type === 'heat' && temperature < 500) {
                    temperature += 5;
                    changed = true;
                } else if (type === 'cool' && temperature > -100) {
                    temperature -= 5;
                    changed = true;
                } else if (type === 'compress' && pressure < 300) {
                    pressure += 0.1;
                    changed = true;
                } else if (type === 'expand' && pressure > 0.01) {
                    pressure -= 0.1;
                    changed = true;
                }

                if (changed) {
                    document.getElementById('tempSlider').value = temperature;
                    document.getElementById('pressSlider').value = pressure * 100;
                    updateConditions();
                    setTimeout(step, 50);
                } else {
                    animating = false;
                }
            };

            step();
        }

        function tempToX(t) {
            const s = substances[currentSubstance];
            const minT = Math.min(-100, s.triple.t - 50);
            const maxT = Math.max(500, s.critical.t + 150);
            return 80 + (t - minT) / (maxT - minT) * (canvas.width - 120);
        }

        function pressToY(p) {
            // Logarithmic scale for pressure
            const minP = 0.001;
            const maxP = 300;
            const logP = Math.log10(Math.max(p, minP));
            const logMin = Math.log10(minP);
            const logMax = Math.log10(maxP);
            return canvas.height - 60 - (logP - logMin) / (logMax - logMin) * (canvas.height - 100);
        }

        function draw() {
            const s = substances[currentSubstance];

            ctx.fillStyle = '#0a0a14';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // Fill phase regions
            // Solid region
            ctx.fillStyle = 'rgba(96, 165, 250, 0.2)';
            ctx.beginPath();
            ctx.moveTo(80, 40);
            ctx.lineTo(tempToX(s.triple.t), pressToY(s.triple.p));
            ctx.lineTo(tempToX(s.melting - 50), canvas.height - 60);
            ctx.lineTo(80, canvas.height - 60);
            ctx.closePath();
            ctx.fill();

            // Liquid region
            ctx.fillStyle = 'rgba(74, 222, 128, 0.2)';
            ctx.beginPath();
            ctx.lineTo(tempToX(s.triple.t), pressToY(s.triple.p));
            ctx.lineTo(tempToX(s.critical.t), pressToY(s.critical.p));
            ctx.lineTo(tempToX(s.critical.t), 40);
            ctx.lineTo(tempToX(s.melting - 50), 40);
            ctx.closePath();
            ctx.fill();

            // Gas region
            ctx.fillStyle = 'rgba(248, 113, 113, 0.2)';
            ctx.beginPath();
            ctx.moveTo(tempToX(s.triple.t), pressToY(s.triple.p));
            ctx.lineTo(tempToX(s.critical.t), pressToY(s.critical.p));
            ctx.lineTo(canvas.width - 40, pressToY(s.critical.p));
            ctx.lineTo(canvas.width - 40, canvas.height - 60);
            ctx.lineTo(tempToX(s.boiling - 50), canvas.height - 60);
            ctx.closePath();
            ctx.fill();

            // Supercritical region
            ctx.fillStyle = 'rgba(167, 139, 250, 0.2)';
            ctx.beginPath();
            ctx.moveTo(tempToX(s.critical.t), pressToY(s.critical.p));
            ctx.lineTo(tempToX(s.critical.t), 40);
            ctx.lineTo(canvas.width - 40, 40);
            ctx.lineTo(canvas.width - 40, pressToY(s.critical.p));
            ctx.closePath();
            ctx.fill();

            // Draw phase boundary lines
            ctx.strokeStyle = '#fff';
            ctx.lineWidth = 2;

            // Solid-Liquid line (from triple to beyond)
            ctx.beginPath();
            ctx.moveTo(tempToX(s.triple.t), pressToY(s.triple.p));
            const topMeltT = s.slopeNegative ? s.melting - 3 : s.melting + 150;
            ctx.lineTo(tempToX(topMeltT), 40);
            ctx.stroke();

            // Liquid-Gas line (from triple to critical)
            ctx.beginPath();
            ctx.moveTo(tempToX(s.triple.t), pressToY(s.triple.p));
            for (let p = s.triple.p; p <= s.critical.p; p += 0.5) {
                const t = s.boiling + 30 * Math.log(p);
                if (t <= s.critical.t) {
                    ctx.lineTo(tempToX(t), pressToY(p));
                }
            }
            ctx.lineTo(tempToX(s.critical.t), pressToY(s.critical.p));
            ctx.stroke();

            // Solid-Gas line (sublimation, below triple)
            ctx.beginPath();
            ctx.moveTo(tempToX(s.triple.t), pressToY(s.triple.p));
            for (let p = s.triple.p; p >= 0.001; p *= 0.7) {
                const t = s.triple.t - 20 * Math.log(s.triple.p / p);
                ctx.lineTo(tempToX(t), pressToY(p));
            }
            ctx.stroke();

            // Triple point
            ctx.fillStyle = '#facc15';
            ctx.beginPath();
            ctx.arc(tempToX(s.triple.t), pressToY(s.triple.p), 8, 0, Math.PI * 2);
            ctx.fill();
            ctx.fillStyle = '#fff';
            ctx.font = '12px sans-serif';
            ctx.fillText('Triple Point', tempToX(s.triple.t) - 30, pressToY(s.triple.p) + 25);

            // Critical point
            ctx.fillStyle = '#a78bfa';
            ctx.beginPath();
            ctx.arc(tempToX(s.critical.t), pressToY(s.critical.p), 8, 0, Math.PI * 2);
            ctx.fill();
            ctx.fillStyle = '#fff';
            ctx.fillText('Critical Point', tempToX(s.critical.t) - 35, pressToY(s.critical.p) - 15);

            // Current position marker
            const px = tempToX(temperature);
            const py = pressToY(pressure);

            ctx.strokeStyle = '#fff';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(px - 10, py);
            ctx.lineTo(px + 10, py);
            ctx.moveTo(px, py - 10);
            ctx.lineTo(px, py + 10);
            ctx.stroke();

            ctx.fillStyle = '#fff';
            ctx.beginPath();
            ctx.arc(px, py, 6, 0, Math.PI * 2);
            ctx.fill();

            // Axes
            ctx.strokeStyle = 'rgba(255,255,255,0.5)';
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.moveTo(80, 40);
            ctx.lineTo(80, canvas.height - 60);
            ctx.lineTo(canvas.width - 40, canvas.height - 60);
            ctx.stroke();

            // Labels
            ctx.fillStyle = '#aaa';
            ctx.font = '14px sans-serif';
            ctx.textAlign = 'center';
            ctx.fillText('Temperature (¬∞C)', canvas.width / 2, canvas.height - 20);

            ctx.save();
            ctx.translate(25, canvas.height / 2);
            ctx.rotate(-Math.PI / 2);
            ctx.fillText('Pressure (atm)', 0, 0);
            ctx.restore();

            // Phase labels
            ctx.fillStyle = '#60a5fa';
            ctx.font = 'bold 16px sans-serif';
            ctx.fillText('SOLID', 130, 150);

            ctx.fillStyle = '#4ade80';
            ctx.fillText('LIQUID', tempToX(s.critical.t / 2), 120);

            ctx.fillStyle = '#f87171';
            ctx.fillText('GAS', canvas.width - 150, canvas.height - 120);

            ctx.fillStyle = '#a78bfa';
            ctx.fillText('SUPERCRITICAL', canvas.width - 120, 80);

            // Title
            ctx.fillStyle = '#fff';
            ctx.font = 'bold 16px sans-serif';
            ctx.textAlign = 'left';
            ctx.fillText(s.name + ' Phase Diagram', 100, 30);
        }

        // Click to set conditions
        canvas.addEventListener('click', (e) => {
            const rect = canvas.getBoundingClientRect();
            const x = (e.clientX - rect.left) * (canvas.width / rect.width);
            const y = (e.clientY - rect.top) * (canvas.height / rect.height);

            const s = substances[currentSubstance];
            const minT = Math.min(-100, s.triple.t - 50);
            const maxT = Math.max(500, s.critical.t + 150);

            temperature = Math.round(minT + (x - 80) / (canvas.width - 120) * (maxT - minT));
            temperature = Math.max(-100, Math.min(500, temperature));

            const logMin = Math.log10(0.001);
            const logMax = Math.log10(300);
            const logP = logMin + (canvas.height - 60 - y) / (canvas.height - 100) * (logMax - logMin);
            pressure = Math.pow(10, logP);
            pressure = Math.max(0.001, Math.min(300, pressure));

            document.getElementById('tempSlider').value = temperature;
            document.getElementById('pressSlider').value = pressure * 100;
            updateConditions();
        });

        updateSubstance();
        updateConditions();
    </script>
</body>
</html>
