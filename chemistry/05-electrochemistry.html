<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Electrochemistry - Chemistry</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', system-ui, sans-serif; background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%); color: #eee; min-height: 100vh; padding: 20px; }
        .back-link { position: fixed; top: 20px; left: 20px; color: #60a5fa; text-decoration: none; font-weight: 600; padding: 8px 16px; background: rgba(0,0,0,0.3); border-radius: 20px; z-index: 100; }
        h1 { text-align: center; margin: 40px 0 10px; font-size: 2.2em; color: #60a5fa; }
        .subtitle { text-align: center; opacity: 0.8; margin-bottom: 20px; }
        .container { max-width: 1200px; margin: 0 auto; display: grid; grid-template-columns: 1fr 300px; gap: 20px; }
        .panel { background: rgba(255,255,255,0.05); border-radius: 12px; padding: 25px; }
        .info-box { background: rgba(96, 165, 250, 0.1); border: 1px solid rgba(96, 165, 250, 0.3); border-radius: 8px; padding: 15px; margin-bottom: 20px; font-size: 0.85em; line-height: 1.6; }
        h3 { color: #60a5fa; margin-bottom: 15px; }
        canvas { width: 100%; border-radius: 8px; }
        .control-group { margin: 15px 0; }
        .control-group label { display: block; margin-bottom: 5px; }
        .control-group input, .control-group select { width: 100%; }
        .value-display { color: #60a5fa; font-family: monospace; }
        button { width: 100%; padding: 12px; margin: 8px 0; border: none; border-radius: 8px; font-size: 1em; font-weight: 600; cursor: pointer; }
        .btn-primary { background: #60a5fa; color: #1a1a2e; }
        .btn-secondary { background: rgba(255,255,255,0.1); color: #fff; }
        .voltage-display { font-size: 2.5em; text-align: center; font-family: monospace; padding: 15px; background: rgba(0,0,0,0.3); border-radius: 12px; margin: 15px 0; }
        .half-reaction { font-family: monospace; font-size: 0.85em; padding: 8px; background: rgba(0,0,0,0.2); border-radius: 6px; margin: 5px 0; }
        @media (max-width: 900px) { .container { grid-template-columns: 1fr; } }
    </style>
</head>
<body>
    <a href="index.html" class="back-link">← Back</a>
    <h1>Electrochemistry</h1>
    <p class="subtitle">Galvanic cells, electron flow, and redox reactions</p>

    <div class="container">
        <div class="panel">
            <canvas id="canvas" width="800" height="500"></canvas>
        </div>

        <div class="panel">
            <div class="info-box">
                <strong>Galvanic Cell:</strong>
                Converts chemical energy to electrical energy through
                spontaneous redox reactions. Electrons flow from the
                anode (oxidation) to cathode (reduction).
            </div>

            <div class="voltage-display" id="voltageDisplay">
                E° = 1.10 V
            </div>

            <div class="control-group">
                <label>Anode Metal:</label>
                <select id="anodeSelect" onchange="updateCell()">
                    <option value="Zn">Zinc (Zn)</option>
                    <option value="Fe">Iron (Fe)</option>
                    <option value="Al">Aluminum (Al)</option>
                    <option value="Mg">Magnesium (Mg)</option>
                </select>
            </div>

            <div class="control-group">
                <label>Cathode Metal:</label>
                <select id="cathodeSelect" onchange="updateCell()">
                    <option value="Cu" selected>Copper (Cu)</option>
                    <option value="Ag">Silver (Ag)</option>
                    <option value="Au">Gold (Au)</option>
                    <option value="Pt">Platinum (Pt)</option>
                </select>
            </div>

            <div class="control-group">
                <label>Electron Flow Rate: <span class="value-display" id="rateVal">Medium</span></label>
                <input type="range" id="rateSlider" min="1" max="10" value="5" oninput="updateParams()">
            </div>

            <h3>Half Reactions</h3>
            <div class="half-reaction" id="anodeReaction" style="border-left: 3px solid #f87171;">
                Zn → Zn²⁺ + 2e⁻ (Oxidation)
            </div>
            <div class="half-reaction" id="cathodeReaction" style="border-left: 3px solid #4ade80;">
                Cu²⁺ + 2e⁻ → Cu (Reduction)
            </div>

            <button class="btn-primary" onclick="toggleSim()">Start/Stop</button>
            <button class="btn-secondary" onclick="resetSim()">Reset</button>

            <h3 style="margin-top: 15px;">Cell Data</h3>
            <div style="font-size: 0.9em;">
                <div style="display: flex; justify-content: space-between; padding: 3px 0;">
                    <span>E°(anode):</span><span class="value-display" id="anodeE">-0.76 V</span>
                </div>
                <div style="display: flex; justify-content: space-between; padding: 3px 0;">
                    <span>E°(cathode):</span><span class="value-display" id="cathodeE">+0.34 V</span>
                </div>
                <div style="display: flex; justify-content: space-between; padding: 3px 0;">
                    <span>Current:</span><span class="value-display" id="currentVal">0 mA</span>
                </div>
                <div style="display: flex; justify-content: space-between; padding: 3px 0;">
                    <span>Electrons Transferred:</span><span class="value-display" id="electronVal">0</span>
                </div>
            </div>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');

        // Standard reduction potentials (V)
        const E0 = {
            'Zn': -0.76, 'Fe': -0.44, 'Al': -1.66, 'Mg': -2.37,
            'Cu': 0.34, 'Ag': 0.80, 'Au': 1.50, 'Pt': 1.20
        };

        const colors = {
            'Zn': '#9ca3af', 'Fe': '#78716c', 'Al': '#d1d5db', 'Mg': '#e5e7eb',
            'Cu': '#f59e0b', 'Ag': '#e5e7eb', 'Au': '#fbbf24', 'Pt': '#9ca3af'
        };

        const ionColors = {
            'Zn': '#60a5fa', 'Fe': '#a3e635', 'Al': '#e5e7eb', 'Mg': '#f9fafb',
            'Cu': '#60a5fa', 'Ag': '#e5e7eb', 'Au': '#fbbf24', 'Pt': '#9ca3af'
        };

        let anode = 'Zn';
        let cathode = 'Cu';
        let flowRate = 5;
        let running = false;
        let electrons = [];
        let ions = [];
        let totalElectrons = 0;

        function updateCell() {
            anode = document.getElementById('anodeSelect').value;
            cathode = document.getElementById('cathodeSelect').value;

            const cellVoltage = E0[cathode] - E0[anode];

            document.getElementById('voltageDisplay').textContent = 'E° = ' + cellVoltage.toFixed(2) + ' V';
            document.getElementById('anodeE').textContent = E0[anode].toFixed(2) + ' V';
            document.getElementById('cathodeE').textContent = E0[cathode].toFixed(2) + ' V';

            // Update half reactions
            document.getElementById('anodeReaction').textContent =
                `${anode} → ${anode}²⁺ + 2e⁻ (Oxidation)`;
            document.getElementById('cathodeReaction').textContent =
                `${cathode}²⁺ + 2e⁻ → ${cathode} (Reduction)`;

            resetSim();
        }

        function updateParams() {
            flowRate = parseInt(document.getElementById('rateSlider').value);
            const rates = ['Very Slow', 'Slow', 'Slow', 'Medium', 'Medium', 'Medium', 'Fast', 'Fast', 'Very Fast', 'Very Fast'];
            document.getElementById('rateVal').textContent = rates[flowRate - 1];
        }

        function createElectron() {
            electrons.push({
                x: 150,
                y: 200 + Math.random() * 100,
                progress: 0,
                speed: 0.005 + Math.random() * 0.005
            });
        }

        function createIon(type, x, y) {
            ions.push({
                type: type,
                x: x,
                y: y,
                vx: (Math.random() - 0.5) * 2,
                vy: (Math.random() - 0.5) * 2,
                age: 0
            });
        }

        function update() {
            // Create new electrons
            if (Math.random() < flowRate * 0.02) {
                createElectron();
            }

            // Update electrons
            for (let i = electrons.length - 1; i >= 0; i--) {
                const e = electrons[i];
                e.progress += e.speed * flowRate;

                // Path through wire
                if (e.progress < 0.3) {
                    e.x = 150 + e.progress * 500;
                    e.y = 200 - Math.sin(e.progress * Math.PI * 3) * 50;
                } else if (e.progress < 0.5) {
                    const t = (e.progress - 0.3) / 0.2;
                    e.x = 300 + t * 200;
                    e.y = 80;
                } else if (e.progress < 0.8) {
                    const t = (e.progress - 0.5) / 0.3;
                    e.x = 500 + t * 150;
                    e.y = 80 + t * 150;
                } else {
                    e.x = 650;
                    e.y = 230 + (e.progress - 0.8) * 500;
                }

                if (e.progress >= 1) {
                    electrons.splice(i, 1);
                    totalElectrons++;
                    // Create ion at cathode
                    if (Math.random() < 0.5) {
                        createIon(cathode, 650 + Math.random() * 50, 350 + Math.random() * 100);
                    }
                }
            }

            // Create anode ions (metal dissolving)
            if (Math.random() < flowRate * 0.01) {
                createIon(anode, 100 + Math.random() * 80, 280 + Math.random() * 120);
            }

            // Update ions
            for (let i = ions.length - 1; i >= 0; i--) {
                const ion = ions[i];
                ion.x += ion.vx;
                ion.y += ion.vy;
                ion.vy += 0.02; // Gravity
                ion.age++;

                // Salt bridge flow
                if (ion.x > 350 && ion.x < 450) {
                    ion.vx += (ion.type === anode ? 0.1 : -0.1);
                }

                if (ion.age > 300 || ion.y > 500) {
                    ions.splice(i, 1);
                }
            }

            // Update display
            const current = flowRate * totalElectrons * 0.1;
            document.getElementById('currentVal').textContent = current.toFixed(1) + ' mA';
            document.getElementById('electronVal').textContent = totalElectrons;
        }

        function draw() {
            ctx.fillStyle = '#0a0a14';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // Draw beakers
            // Anode beaker
            ctx.strokeStyle = '#60a5fa';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.moveTo(50, 200);
            ctx.lineTo(50, 450);
            ctx.lineTo(250, 450);
            ctx.lineTo(250, 200);
            ctx.stroke();

            // Cathode beaker
            ctx.beginPath();
            ctx.moveTo(550, 200);
            ctx.lineTo(550, 450);
            ctx.lineTo(750, 450);
            ctx.lineTo(750, 200);
            ctx.stroke();

            // Solutions
            ctx.fillStyle = ionColors[anode] + '30';
            ctx.fillRect(53, 250, 194, 197);
            ctx.fillStyle = ionColors[cathode] + '30';
            ctx.fillRect(553, 250, 194, 197);

            // Electrodes
            // Anode
            ctx.fillStyle = colors[anode];
            ctx.fillRect(130, 150, 40, 250);
            ctx.fillStyle = '#fff';
            ctx.font = 'bold 16px sans-serif';
            ctx.textAlign = 'center';
            ctx.fillText(anode, 150, 145);
            ctx.fillStyle = '#f87171';
            ctx.fillText('ANODE', 150, 420);
            ctx.fillText('(−)', 150, 440);

            // Cathode
            ctx.fillStyle = colors[cathode];
            ctx.fillRect(630, 150, 40, 250);
            ctx.fillStyle = '#fff';
            ctx.fillText(cathode, 650, 145);
            ctx.fillStyle = '#4ade80';
            ctx.fillText('CATHODE', 650, 420);
            ctx.fillText('(+)', 650, 440);

            // Wire
            ctx.strokeStyle = '#facc15';
            ctx.lineWidth = 4;
            ctx.beginPath();
            ctx.moveTo(150, 150);
            ctx.lineTo(150, 80);
            ctx.lineTo(650, 80);
            ctx.lineTo(650, 150);
            ctx.stroke();

            // Voltmeter
            ctx.fillStyle = '#1a1a2e';
            ctx.beginPath();
            ctx.arc(400, 80, 35, 0, Math.PI * 2);
            ctx.fill();
            ctx.strokeStyle = '#60a5fa';
            ctx.lineWidth = 2;
            ctx.stroke();

            const cellVoltage = E0[cathode] - E0[anode];
            ctx.fillStyle = '#4ade80';
            ctx.font = 'bold 14px monospace';
            ctx.fillText(cellVoltage.toFixed(2) + 'V', 400, 85);

            // Salt bridge
            ctx.fillStyle = '#9ca3af';
            ctx.beginPath();
            ctx.moveTo(250, 280);
            ctx.bezierCurveTo(350, 250, 450, 250, 550, 280);
            ctx.lineTo(550, 300);
            ctx.bezierCurveTo(450, 270, 350, 270, 250, 300);
            ctx.closePath();
            ctx.fill();

            ctx.fillStyle = '#333';
            ctx.font = '12px sans-serif';
            ctx.fillText('Salt Bridge', 400, 265);

            // Draw electrons
            ctx.fillStyle = '#facc15';
            for (const e of electrons) {
                ctx.beginPath();
                ctx.arc(e.x, e.y, 4, 0, Math.PI * 2);
                ctx.fill();

                // Trail
                ctx.fillStyle = '#facc1540';
                ctx.beginPath();
                ctx.arc(e.x - 10, e.y, 3, 0, Math.PI * 2);
                ctx.fill();
                ctx.fillStyle = '#facc15';
            }

            // Draw ions
            ctx.font = 'bold 10px sans-serif';
            for (const ion of ions) {
                ctx.fillStyle = ionColors[ion.type];
                ctx.beginPath();
                ctx.arc(ion.x, ion.y, 6, 0, Math.PI * 2);
                ctx.fill();

                ctx.fillStyle = '#000';
                ctx.textAlign = 'center';
                ctx.fillText(ion.type + '²⁺', ion.x, ion.y + 3);
            }

            // Electron flow arrow
            ctx.fillStyle = '#facc15';
            ctx.font = '14px sans-serif';
            ctx.textAlign = 'center';
            ctx.fillText('e⁻ →', 400, 60);

            // Labels
            ctx.fillStyle = '#aaa';
            ctx.font = '12px sans-serif';
            ctx.fillText(anode + 'SO₄ solution', 150, 470);
            ctx.fillText(cathode + 'SO₄ solution', 650, 470);
        }

        function toggleSim() {
            running = !running;
            if (running) animate();
        }

        function resetSim() {
            running = false;
            electrons = [];
            ions = [];
            totalElectrons = 0;
            document.getElementById('currentVal').textContent = '0 mA';
            document.getElementById('electronVal').textContent = '0';
            draw();
        }

        function animate() {
            if (!running) return;
            update();
            draw();
            requestAnimationFrame(animate);
        }

        updateCell();
        updateParams();
        draw();
    </script>
</body>
</html>
