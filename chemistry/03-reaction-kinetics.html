<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reaction Kinetics - Chemistry</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', system-ui, sans-serif; background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%); color: #eee; min-height: 100vh; padding: 20px; }
        .back-link { position: fixed; top: 20px; left: 20px; color: #60a5fa; text-decoration: none; font-weight: 600; padding: 8px 16px; background: rgba(0,0,0,0.3); border-radius: 20px; z-index: 100; }
        h1 { text-align: center; margin: 40px 0 10px; font-size: 2.2em; color: #60a5fa; }
        .subtitle { text-align: center; opacity: 0.8; margin-bottom: 20px; }
        .container { max-width: 1200px; margin: 0 auto; display: grid; grid-template-columns: 1fr 300px; gap: 20px; }
        .panel { background: rgba(255,255,255,0.05); border-radius: 12px; padding: 25px; }
        .info-box { background: rgba(96, 165, 250, 0.1); border: 1px solid rgba(96, 165, 250, 0.3); border-radius: 8px; padding: 15px; margin-bottom: 20px; font-size: 0.85em; line-height: 1.6; }
        h3 { color: #60a5fa; margin-bottom: 15px; }
        canvas { width: 100%; border-radius: 8px; }
        .control-group { margin: 15px 0; }
        .control-group label { display: block; margin-bottom: 5px; }
        .control-group input, .control-group select { width: 100%; }
        .value-display { color: #60a5fa; font-family: monospace; }
        button { width: 100%; padding: 12px; margin: 8px 0; border: none; border-radius: 8px; font-size: 1em; font-weight: 600; cursor: pointer; }
        .btn-primary { background: #60a5fa; color: #1a1a2e; }
        .btn-secondary { background: rgba(255,255,255,0.1); color: #fff; }
        .equation { font-family: 'Times New Roman', serif; font-size: 1em; text-align: center; padding: 12px; background: rgba(0,0,0,0.3); border-radius: 8px; margin: 10px 0; }
        @media (max-width: 900px) { .container { grid-template-columns: 1fr; } }
    </style>
</head>
<body>
    <a href="index.html" class="back-link">← Back</a>
    <h1>Reaction Kinetics</h1>
    <p class="subtitle">Rate laws, activation energy, and catalysis</p>

    <div class="container">
        <div class="panel">
            <canvas id="energyCanvas" width="800" height="250"></canvas>
            <canvas id="chartCanvas" width="800" height="250" style="margin-top: 15px;"></canvas>
        </div>

        <div class="panel">
            <div class="info-box">
                <strong>Arrhenius Equation:</strong><br>
                k = A·e<sup>-Ea/RT</sup><br><br>
                Reaction rate depends on temperature and activation energy.
                Catalysts lower the activation energy barrier.
            </div>

            <div class="equation" id="rateEq">
                Rate = k[A] (First Order)
            </div>

            <div class="control-group">
                <label>Reaction Order:</label>
                <select id="orderSelect" onchange="updateParams()">
                    <option value="0">Zero Order</option>
                    <option value="1" selected>First Order</option>
                    <option value="2">Second Order</option>
                </select>
            </div>

            <div class="control-group">
                <label>Activation Energy: <span class="value-display" id="eaVal">50</span> kJ/mol</label>
                <input type="range" id="eaSlider" min="20" max="100" value="50" oninput="updateParams()">
            </div>

            <div class="control-group">
                <label>Temperature: <span class="value-display" id="tempVal">300</span> K</label>
                <input type="range" id="tempSlider" min="200" max="500" value="300" oninput="updateParams()">
            </div>

            <div class="control-group">
                <label>Initial Concentration: <span class="value-display" id="concVal">1.0</span> M</label>
                <input type="range" id="concSlider" min="1" max="20" value="10" oninput="updateParams()">
            </div>

            <button class="btn-primary" onclick="toggleCatalyst()">Toggle Catalyst</button>
            <button class="btn-primary" onclick="toggleSim()">Start/Stop</button>
            <button class="btn-secondary" onclick="resetSim()">Reset</button>

            <h3 style="margin-top: 15px;">Kinetics Data</h3>
            <div style="font-size: 0.9em;">
                <div style="display: flex; justify-content: space-between; padding: 3px 0;">
                    <span>Rate Constant (k):</span><span class="value-display" id="kVal">0.00</span>
                </div>
                <div style="display: flex; justify-content: space-between; padding: 3px 0;">
                    <span>Current [A]:</span><span class="value-display" id="currentConc">1.0 M</span>
                </div>
                <div style="display: flex; justify-content: space-between; padding: 3px 0;">
                    <span>Reaction Rate:</span><span class="value-display" id="rateVal">0.00</span>
                </div>
                <div style="display: flex; justify-content: space-between; padding: 3px 0;">
                    <span>Half-life:</span><span class="value-display" id="halfVal">0 s</span>
                </div>
                <div style="display: flex; justify-content: space-between; padding: 3px 0;">
                    <span>Time:</span><span class="value-display" id="timeVal">0 s</span>
                </div>
                <div style="display: flex; justify-content: space-between; padding: 3px 0;">
                    <span>Catalyst:</span><span class="value-display" id="catVal">OFF</span>
                </div>
            </div>
        </div>
    </div>

    <script>
        const energyCanvas = document.getElementById('energyCanvas');
        const ectx = energyCanvas.getContext('2d');
        const chartCanvas = document.getElementById('chartCanvas');
        const cctx = chartCanvas.getContext('2d');

        let reactionOrder = 1;
        let activationEnergy = 50; // kJ/mol
        let temperature = 300; // K
        let initialConc = 1.0;
        let concentration = 1.0;
        let time = 0;
        let running = false;
        let catalystActive = false;
        let history = [];

        const R = 8.314; // Gas constant J/(mol·K)
        const A = 1e10; // Pre-exponential factor

        function updateParams() {
            reactionOrder = parseInt(document.getElementById('orderSelect').value);
            activationEnergy = parseInt(document.getElementById('eaSlider').value);
            temperature = parseInt(document.getElementById('tempSlider').value);
            initialConc = parseInt(document.getElementById('concSlider').value) / 10;

            document.getElementById('eaVal').textContent = activationEnergy;
            document.getElementById('tempVal').textContent = temperature;
            document.getElementById('concVal').textContent = initialConc.toFixed(1);

            // Update rate equation display
            const orders = ['Rate = k (Zero Order)', 'Rate = k[A] (First Order)', 'Rate = k[A]² (Second Order)'];
            document.getElementById('rateEq').textContent = orders[reactionOrder];

            calculateRateConstant();
            drawEnergyDiagram();
        }

        function calculateRateConstant() {
            const Ea = (catalystActive ? activationEnergy * 0.6 : activationEnergy) * 1000; // Convert to J/mol
            const k = A * Math.exp(-Ea / (R * temperature));
            return k;
        }

        function toggleCatalyst() {
            catalystActive = !catalystActive;
            document.getElementById('catVal').textContent = catalystActive ? 'ON' : 'OFF';
            drawEnergyDiagram();
        }

        function updateReaction() {
            time += 0.1;
            const k = calculateRateConstant();

            // Rate depends on order
            let rate;
            if (reactionOrder === 0) {
                rate = k;
                concentration = Math.max(0, concentration - rate * 0.1);
            } else if (reactionOrder === 1) {
                rate = k * concentration;
                concentration = Math.max(0.001, concentration * Math.exp(-k * 0.1));
            } else {
                rate = k * concentration * concentration;
                concentration = Math.max(0.001, concentration / (1 + k * concentration * 0.1));
            }

            // Record history
            history.push({ t: time, c: concentration });
            if (history.length > 500) history.shift();

            updateDisplay(k, rate);
        }

        function updateDisplay(k, rate) {
            document.getElementById('kVal').textContent = k.toExponential(2);
            document.getElementById('currentConc').textContent = concentration.toFixed(3) + ' M';
            document.getElementById('rateVal').textContent = rate.toExponential(2) + ' M/s';
            document.getElementById('timeVal').textContent = time.toFixed(1) + ' s';

            // Half-life calculation
            let halfLife;
            if (reactionOrder === 0) {
                halfLife = initialConc / (2 * k);
            } else if (reactionOrder === 1) {
                halfLife = Math.log(2) / k;
            } else {
                halfLife = 1 / (k * initialConc);
            }
            document.getElementById('halfVal').textContent = halfLife.toFixed(2) + ' s';
        }

        function drawEnergyDiagram() {
            ectx.fillStyle = '#0a0a14';
            ectx.fillRect(0, 0, energyCanvas.width, energyCanvas.height);

            const margin = 50;
            const width = energyCanvas.width - 2 * margin;
            const height = energyCanvas.height - 2 * margin;

            // Axes
            ectx.strokeStyle = 'rgba(255,255,255,0.3)';
            ectx.lineWidth = 1;
            ectx.beginPath();
            ectx.moveTo(margin, margin);
            ectx.lineTo(margin, energyCanvas.height - margin);
            ectx.lineTo(energyCanvas.width - margin, energyCanvas.height - margin);
            ectx.stroke();

            // Labels
            ectx.fillStyle = '#aaa';
            ectx.font = '12px sans-serif';
            ectx.textAlign = 'center';
            ectx.fillText('Reaction Progress', energyCanvas.width / 2, energyCanvas.height - 15);

            ectx.save();
            ectx.translate(20, energyCanvas.height / 2);
            ectx.rotate(-Math.PI / 2);
            ectx.fillText('Energy', 0, 0);
            ectx.restore();

            // Energy levels
            const reactantE = height * 0.7;
            const productE = height * 0.5;
            const barrierE = height * (1 - activationEnergy / 120);
            const catalystBarrierE = height * (1 - activationEnergy * 0.6 / 120);

            // Draw reaction pathway
            ectx.strokeStyle = '#60a5fa';
            ectx.lineWidth = 3;
            ectx.beginPath();
            ectx.moveTo(margin, margin + reactantE);
            ectx.lineTo(margin + width * 0.2, margin + reactantE);

            // Bezier curve to activation peak
            ectx.bezierCurveTo(
                margin + width * 0.35, margin + reactantE,
                margin + width * 0.4, margin + barrierE,
                margin + width * 0.5, margin + barrierE
            );
            ectx.bezierCurveTo(
                margin + width * 0.6, margin + barrierE,
                margin + width * 0.65, margin + productE,
                margin + width * 0.8, margin + productE
            );
            ectx.lineTo(margin + width, margin + productE);
            ectx.stroke();

            // Catalyst pathway
            if (catalystActive) {
                ectx.strokeStyle = '#4ade80';
                ectx.setLineDash([5, 5]);
                ectx.beginPath();
                ectx.moveTo(margin, margin + reactantE);
                ectx.lineTo(margin + width * 0.2, margin + reactantE);
                ectx.bezierCurveTo(
                    margin + width * 0.35, margin + reactantE,
                    margin + width * 0.4, margin + catalystBarrierE,
                    margin + width * 0.5, margin + catalystBarrierE
                );
                ectx.bezierCurveTo(
                    margin + width * 0.6, margin + catalystBarrierE,
                    margin + width * 0.65, margin + productE,
                    margin + width * 0.8, margin + productE
                );
                ectx.lineTo(margin + width, margin + productE);
                ectx.stroke();
                ectx.setLineDash([]);
            }

            // Ea arrow
            ectx.strokeStyle = '#f87171';
            ectx.lineWidth = 2;
            ectx.beginPath();
            ectx.moveTo(margin + width * 0.3, margin + reactantE);
            ectx.lineTo(margin + width * 0.3, margin + barrierE);
            ectx.stroke();

            // Arrow head
            ectx.beginPath();
            ectx.moveTo(margin + width * 0.3 - 5, margin + barrierE + 10);
            ectx.lineTo(margin + width * 0.3, margin + barrierE);
            ectx.lineTo(margin + width * 0.3 + 5, margin + barrierE + 10);
            ectx.stroke();

            // Labels
            ectx.fillStyle = '#f87171';
            ectx.font = '14px sans-serif';
            ectx.textAlign = 'left';
            ectx.fillText('Ea = ' + activationEnergy + ' kJ/mol', margin + width * 0.32, margin + (reactantE + barrierE) / 2);

            ectx.fillStyle = '#60a5fa';
            ectx.fillText('Reactants', margin + 10, margin + reactantE - 10);
            ectx.fillText('Products', margin + width - 60, margin + productE - 10);

            if (catalystActive) {
                ectx.fillStyle = '#4ade80';
                ectx.fillText('With Catalyst (Ea = ' + Math.round(activationEnergy * 0.6) + ' kJ/mol)', margin + width * 0.55, margin + 30);
            }

            // Title
            ectx.fillStyle = '#fff';
            ectx.font = 'bold 16px sans-serif';
            ectx.textAlign = 'center';
            ectx.fillText('Energy Diagram', energyCanvas.width / 2, 30);
        }

        function drawChart() {
            cctx.fillStyle = '#0a0a14';
            cctx.fillRect(0, 0, chartCanvas.width, chartCanvas.height);

            if (history.length < 2) {
                cctx.fillStyle = '#666';
                cctx.font = '14px sans-serif';
                cctx.textAlign = 'center';
                cctx.fillText('Start simulation to see concentration vs time', chartCanvas.width / 2, chartCanvas.height / 2);
                return;
            }

            const margin = 50;
            const width = chartCanvas.width - 2 * margin;
            const height = chartCanvas.height - 2 * margin;

            // Axes
            cctx.strokeStyle = 'rgba(255,255,255,0.3)';
            cctx.lineWidth = 1;
            cctx.beginPath();
            cctx.moveTo(margin, margin);
            cctx.lineTo(margin, chartCanvas.height - margin);
            cctx.lineTo(chartCanvas.width - margin, chartCanvas.height - margin);
            cctx.stroke();

            // Concentration curve
            const maxTime = Math.max(history[history.length - 1].t, 10);
            const scaleX = width / maxTime;
            const scaleY = height / initialConc;

            cctx.strokeStyle = '#60a5fa';
            cctx.lineWidth = 2;
            cctx.beginPath();
            history.forEach((h, i) => {
                const x = margin + h.t * scaleX;
                const y = chartCanvas.height - margin - h.c * scaleY;
                if (i === 0) cctx.moveTo(x, y);
                else cctx.lineTo(x, y);
            });
            cctx.stroke();

            // Half-life marker
            const k = calculateRateConstant();
            let halfLife;
            if (reactionOrder === 1) {
                halfLife = Math.log(2) / k;
            } else if (reactionOrder === 0) {
                halfLife = initialConc / (2 * k);
            } else {
                halfLife = 1 / (k * initialConc);
            }

            if (halfLife < maxTime) {
                cctx.strokeStyle = '#facc15';
                cctx.setLineDash([5, 5]);
                cctx.beginPath();
                const hlX = margin + halfLife * scaleX;
                const hlY = chartCanvas.height - margin - (initialConc / 2) * scaleY;
                cctx.moveTo(hlX, chartCanvas.height - margin);
                cctx.lineTo(hlX, hlY);
                cctx.lineTo(margin, hlY);
                cctx.stroke();
                cctx.setLineDash([]);

                cctx.fillStyle = '#facc15';
                cctx.font = '11px sans-serif';
                cctx.textAlign = 'center';
                cctx.fillText('t½', hlX, chartCanvas.height - margin + 15);
            }

            // Labels
            cctx.fillStyle = '#aaa';
            cctx.font = '12px sans-serif';
            cctx.textAlign = 'center';
            cctx.fillText('Time (s)', chartCanvas.width / 2, chartCanvas.height - 10);

            cctx.save();
            cctx.translate(15, chartCanvas.height / 2);
            cctx.rotate(-Math.PI / 2);
            cctx.fillText('[A] (M)', 0, 0);
            cctx.restore();

            // Title
            cctx.fillStyle = '#fff';
            cctx.font = 'bold 16px sans-serif';
            cctx.fillText('Concentration vs Time', chartCanvas.width / 2, 25);
        }

        function toggleSim() {
            running = !running;
            if (running) animate();
        }

        function resetSim() {
            running = false;
            time = 0;
            concentration = initialConc;
            history = [];
            updateDisplay(calculateRateConstant(), 0);
            drawChart();
        }

        function animate() {
            if (!running) return;
            updateReaction();
            drawChart();
            requestAnimationFrame(animate);
        }

        updateParams();
        resetSim();
    </script>
</body>
</html>
