<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Color Wave Murmuration Art | CCAB</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            background: #000;
            overflow: hidden;
        }
        canvas { display: block; }
        .overlay {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.8);
            padding: 20px;
            border-radius: 12px;
            border: 1px solid rgba(102, 126, 234, 0.3);
            color: #fff;
            font-family: 'Segoe UI', system-ui, sans-serif;
            max-width: 280px;
        }
        h1 {
            font-size: 1.2rem;
            margin-bottom: 8px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .subtitle {
            font-size: 0.8rem;
            color: #888;
            margin-bottom: 16px;
        }
        .control-group {
            margin-bottom: 12px;
        }
        label {
            display: block;
            font-size: 0.75rem;
            color: #888;
            margin-bottom: 4px;
        }
        input[type="range"] {
            width: 100%;
            height: 4px;
            border-radius: 2px;
            background: rgba(255,255,255,0.1);
            -webkit-appearance: none;
        }
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #667eea;
            cursor: pointer;
        }
        .color-scheme {
            display: flex;
            gap: 8px;
            margin-top: 12px;
        }
        .color-btn {
            flex: 1;
            padding: 8px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.7rem;
            transition: transform 0.2s;
        }
        .color-btn:hover { transform: scale(1.05); }
        .info {
            margin-top: 12px;
            font-size: 0.7rem;
            color: #666;
            line-height: 1.4;
        }
        .back-link {
            position: fixed;
            top: 20px;
            left: 20px;
            color: #667eea;
            text-decoration: none;
            font-size: 0.9rem;
            font-family: 'Segoe UI', system-ui, sans-serif;
            opacity: 0.8;
        }
        .back-link:hover { opacity: 1; }
    </style>
</head>
<body>
    <a href="index.html" class="back-link">‚Üê Back to Gallery</a>

    <canvas id="canvas"></canvas>

    <div class="overlay">
        <h1>Color Wave Art</h1>
        <p class="subtitle">Murmuration patterns as generative art</p>

        <div class="control-group">
            <label>Wave Complexity</label>
            <input type="range" id="complexity" min="1" max="10" value="5">
        </div>

        <div class="control-group">
            <label>Speed</label>
            <input type="range" id="speed" min="0.1" max="2" step="0.1" value="1">
        </div>

        <div class="control-group">
            <label>Color Shift</label>
            <input type="range" id="colorShift" min="0" max="360" value="0">
        </div>

        <div class="color-scheme">
            <button class="color-btn" style="background: linear-gradient(90deg, #4ade80, #60a5fa)" onclick="setScheme('murmur')">Murmur</button>
            <button class="color-btn" style="background: linear-gradient(90deg, #f472b6, #fbbf24)" onclick="setScheme('sunset')">Sunset</button>
            <button class="color-btn" style="background: linear-gradient(90deg, #06b6d4, #8b5cf6)" onclick="setScheme('aurora')">Aurora</button>
        </div>

        <div class="info">
            Abstract visualization of elliptic curve murmurations. The interweaving waves represent rank 0 and rank 1 patterns dancing through prime space.
        </div>
    </div>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');

        let width, height;
        let complexity = 5;
        let speed = 1;
        let colorShift = 0;
        let colorScheme = 'murmur';
        let time = 0;

        const schemes = {
            murmur: { c1: [74, 222, 128], c2: [96, 165, 250] },
            sunset: { c1: [244, 114, 182], c2: [251, 191, 36] },
            aurora: { c1: [6, 182, 212], c2: [139, 92, 246] }
        };

        function resize() {
            width = window.innerWidth;
            height = window.innerHeight;
            canvas.width = width;
            canvas.height = height;
        }
        resize();
        window.addEventListener('resize', resize);

        function setScheme(name) {
            colorScheme = name;
        }

        function lerp(a, b, t) {
            return a + (b - a) * t;
        }

        function lerpColor(c1, c2, t) {
            return [
                Math.round(lerp(c1[0], c2[0], t)),
                Math.round(lerp(c1[1], c2[1], t)),
                Math.round(lerp(c1[2], c2[2], t))
            ];
        }

        function hueShift(rgb, shift) {
            const r = rgb[0] / 255, g = rgb[1] / 255, b = rgb[2] / 255;
            const max = Math.max(r, g, b), min = Math.min(r, g, b);
            let h, s, l = (max + min) / 2;

            if (max === min) {
                h = s = 0;
            } else {
                const d = max - min;
                s = l > 0.5 ? d / (2 - max - min) : d / (max + min);
                switch (max) {
                    case r: h = ((g - b) / d + (g < b ? 6 : 0)) / 6; break;
                    case g: h = ((b - r) / d + 2) / 6; break;
                    case b: h = ((r - g) / d + 4) / 6; break;
                }
            }

            h = (h + shift / 360) % 1;

            function hue2rgb(p, q, t) {
                if (t < 0) t += 1;
                if (t > 1) t -= 1;
                if (t < 1/6) return p + (q - p) * 6 * t;
                if (t < 1/2) return q;
                if (t < 2/3) return p + (q - p) * (2/3 - t) * 6;
                return p;
            }

            let r2, g2, b2;
            if (s === 0) {
                r2 = g2 = b2 = l;
            } else {
                const q = l < 0.5 ? l * (1 + s) : l + s - l * s;
                const p = 2 * l - q;
                r2 = hue2rgb(p, q, h + 1/3);
                g2 = hue2rgb(p, q, h);
                b2 = hue2rgb(p, q, h - 1/3);
            }

            return [Math.round(r2 * 255), Math.round(g2 * 255), Math.round(b2 * 255)];
        }

        function draw() {
            // Subtle fade
            ctx.fillStyle = 'rgba(0, 0, 0, 0.03)';
            ctx.fillRect(0, 0, width, height);

            const scheme = schemes[colorScheme];
            const numLayers = Math.floor(complexity * 3);

            for (let layer = 0; layer < numLayers; layer++) {
                const isRank0 = layer % 2 === 0;
                const baseColor = isRank0 ? scheme.c1 : scheme.c2;
                const layerPhase = layer * Math.PI / numLayers;
                const layerAmp = 1 - layer / numLayers * 0.5;

                ctx.beginPath();

                for (let x = 0; x <= width; x += 3) {
                    const t = x / width;
                    const timeOffset = time * speed * 0.02;

                    // Multi-frequency wave
                    let y = 0;
                    for (let f = 1; f <= complexity; f++) {
                        const freq = f * 2;
                        const amp = layerAmp / f;
                        const phase = isRank0 ? 0 : Math.PI * 0.3;
                        y += amp * Math.sin(t * Math.PI * freq + timeOffset + layerPhase + phase);
                    }

                    // Decay
                    const decay = Math.exp(-Math.abs(t - 0.5) * 1.5);
                    y *= decay;

                    const screenY = height / 2 + y * height * 0.35;

                    if (x === 0) ctx.moveTo(x, screenY);
                    else ctx.lineTo(x, screenY);
                }

                // Color with shift and alpha
                const alpha = 0.3 * layerAmp;
                const color = hueShift(baseColor, colorShift);
                ctx.strokeStyle = `rgba(${color[0]}, ${color[1]}, ${color[2]}, ${alpha})`;
                ctx.lineWidth = 2 + (numLayers - layer) * 0.5;
                ctx.stroke();
            }

            // Central glow
            const gradient = ctx.createRadialGradient(
                width / 2, height / 2, 0,
                width / 2, height / 2, Math.min(width, height) / 2
            );
            const c1 = hueShift(scheme.c1, colorShift);
            const c2 = hueShift(scheme.c2, colorShift);
            gradient.addColorStop(0, `rgba(${c1[0]}, ${c1[1]}, ${c1[2]}, 0.1)`);
            gradient.addColorStop(0.5, `rgba(${c2[0]}, ${c2[1]}, ${c2[2]}, 0.05)`);
            gradient.addColorStop(1, 'rgba(0, 0, 0, 0)');

            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, width, height);

            time++;
        }

        function animate() {
            draw();
            requestAnimationFrame(animate);
        }

        document.getElementById('complexity').addEventListener('input', (e) => {
            complexity = parseInt(e.target.value);
        });

        document.getElementById('speed').addEventListener('input', (e) => {
            speed = parseFloat(e.target.value);
        });

        document.getElementById('colorShift').addEventListener('input', (e) => {
            colorShift = parseInt(e.target.value);
        });

        animate();
    </script>
    <script src="../assets/js/enhance.js" defer></script>
</body>
</html>
