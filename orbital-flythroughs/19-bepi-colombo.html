<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BepiColombo - Mercury Mission (ESA/JAXA)</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { background: #0a0a1a; overflow: hidden; font-family: 'Segoe UI', sans-serif; }
        canvas { display: block; }
        .info-panel {
            position: fixed; top: 20px; left: 20px;
            background: rgba(10, 20, 40, 0.9); border: 1px solid #9b59b6;
            border-radius: 10px; padding: 20px; color: #ecf0f1; max-width: 300px; z-index: 100;
        }
        .info-panel h1 { font-size: 1.4em; color: #9b59b6; margin-bottom: 10px; }
        .info-panel p { font-size: 0.85em; line-height: 1.5; color: #bdc3c7; }
        .mission-stats { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-top: 12px; }
        .stat { background: rgba(155, 89, 182, 0.2); padding: 6px; border-radius: 5px; text-align: center; }
        .stat-value { font-size: 1em; color: #9b59b6; font-weight: bold; }
        .stat-label { font-size: 0.65em; color: #7f8c8d; }
        .controls { position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); display: flex; gap: 10px; z-index: 100; }
        .controls button { background: rgba(155, 89, 182, 0.8); border: none; color: white; padding: 10px 20px; border-radius: 5px; cursor: pointer; }
        .controls button:hover { background: rgba(155, 89, 182, 1); }
        .controls button.active { background: #27ae60; }
        .back-link { position: fixed; top: 20px; right: 20px; background: rgba(10, 20, 40, 0.9); border: 1px solid #9b59b6; border-radius: 8px; padding: 10px 15px; color: #9b59b6; text-decoration: none; z-index: 100; }
        .back-link:hover { background: #9b59b6; color: white; }
        .flyby-indicator { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: rgba(155, 89, 182, 0.9); padding: 20px 40px; border-radius: 10px; color: white; font-size: 1.3em; font-weight: bold; opacity: 0; transition: opacity 0.5s; pointer-events: none; z-index: 200; }
        .flyby-indicator.show { opacity: 1; }
    </style>
</head>
<body>
    <canvas id="canvas"></canvas>
    <div class="info-panel">
        <h1>üöÄ BepiColombo üá™üá∫üáØüáµ</h1>
        <p>Joint ESA/JAXA Mercury mission! Launched Oct 2018. Uses 9 gravity assists (1 Earth, 2 Venus, 6 Mercury) over 7 years.</p>
        <p style="margin-top:8px">Most complex gravity assist sequence ever! Carries two orbiters to study Mercury from different orbits.</p>
        <div class="mission-stats">
            <div class="stat"><div class="stat-value">2018</div><div class="stat-label">Launch</div></div>
            <div class="stat"><div class="stat-value">9</div><div class="stat-label">Gravity Assists</div></div>
            <div class="stat"><div class="stat-value">2025</div><div class="stat-label">Arrival</div></div>
            <div class="stat"><div class="stat-value">2</div><div class="stat-label">Orbiters</div></div>
        </div>
    </div>
    <a href="index.html" class="back-link">‚Üê Back</a>
    <div class="controls">
        <button id="playPause" class="active">‚è∏ Pause</button>
        <button id="restart">üîÑ Restart</button>
        <button id="speedDown">üê¢</button>
        <button id="speedUp">üêá</button>
    </div>
    <div class="flyby-indicator" id="flybyIndicator">EVENT!</div>
    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        let width, height, centerX, centerY, scale;
        function resize() {
            width = canvas.width = window.innerWidth;
            height = canvas.height = window.innerHeight;
            centerX = width / 2; centerY = height / 2;
            scale = Math.min(width, height) / 4;
        }
        resize();
        window.addEventListener('resize', resize);
        let playing = true, time = 0, speed = 1;
        const planets = [
            { name: 'Mercury', radius: 0.39, color: '#a0522d', size: 5, period: 0.24 },
            { name: 'Venus', radius: 0.72, color: '#daa520', size: 7, period: 0.62 },
            { name: 'Earth', radius: 1.0, color: '#4169e1', size: 7, period: 1.0 }
        ];
        const trajectory = [];
        const missionDuration = 14;
        function generateTrajectory() {
            trajectory.length = 0;
            const times = { earth: 1.0, venus1: 2.0, venus2: 3.0, mercury1: 4.5, mercury2: 5.5, mercury3: 6.5, mercury4: 7.5, mercury5: 8.5, mercury6: 9.5, arrival: 10.5 };
            let angle = Math.PI;
            // To Earth flyby
            for (let t = 0; t < times.earth; t += 0.02) {
                const progress = t / times.earth;
                const r = 1.0 + Math.sin(progress * Math.PI) * 0.3;
                angle = Math.PI + progress * Math.PI * 2;
                trajectory.push({ time: t, x: r * Math.cos(angle), y: r * Math.sin(angle) });
            }
            // Earth flyby
            for (let i = 0; i < 10; i++) {
                trajectory.push({ time: times.earth + i * 0.006, x: Math.cos(angle + i * 0.05), y: Math.sin(angle + i * 0.05), gravityAssist: true, planet: 'Earth' });
            }
            angle += 0.5;
            // To Venus 1
            for (let t = times.earth + 0.1; t < times.venus1; t += 0.02) {
                const progress = (t - times.earth - 0.1) / (times.venus1 - times.earth - 0.1);
                const r = 1.0 - progress * 0.28;
                angle += 0.03;
                trajectory.push({ time: t, x: r * Math.cos(angle), y: r * Math.sin(angle) });
            }
            // Venus 1 flyby
            for (let i = 0; i < 10; i++) {
                trajectory.push({ time: times.venus1 + i * 0.006, x: 0.72 * Math.cos(angle + i * 0.05), y: 0.72 * Math.sin(angle + i * 0.05), gravityAssist: true, planet: 'Venus (1)' });
            }
            angle += 0.5;
            // Continue pattern for remaining flybys...
            for (let t = times.venus1 + 0.1; t < times.venus2; t += 0.02) {
                const progress = (t - times.venus1 - 0.1) / (times.venus2 - times.venus1 - 0.1);
                angle += 0.04;
                const r = 0.72 + Math.sin(progress * Math.PI) * 0.2;
                trajectory.push({ time: t, x: r * Math.cos(angle), y: r * Math.sin(angle) });
            }
            for (let i = 0; i < 10; i++) {
                trajectory.push({ time: times.venus2 + i * 0.006, x: 0.72 * Math.cos(angle + i * 0.05), y: 0.72 * Math.sin(angle + i * 0.05), gravityAssist: true, planet: 'Venus (2)' });
            }
            angle += 0.5;
            // Mercury flybys
            const mercuryTimes = [times.mercury1, times.mercury2, times.mercury3, times.mercury4, times.mercury5, times.mercury6];
            let prevTime = times.venus2 + 0.1;
            for (let m = 0; m < mercuryTimes.length; m++) {
                for (let t = prevTime; t < mercuryTimes[m]; t += 0.02) {
                    angle += 0.05;
                    const r = 0.39 + Math.sin((t - prevTime) * 3) * 0.15;
                    trajectory.push({ time: t, x: r * Math.cos(angle), y: r * Math.sin(angle) });
                }
                for (let i = 0; i < 8; i++) {
                    trajectory.push({ time: mercuryTimes[m] + i * 0.005, x: 0.39 * Math.cos(angle + i * 0.06), y: 0.39 * Math.sin(angle + i * 0.06), gravityAssist: true, planet: `Mercury (${m + 1})` });
                }
                prevTime = mercuryTimes[m] + 0.05;
                angle += 0.4;
            }
            // Mercury orbit
            for (let t = times.arrival; t < missionDuration; t += 0.02) {
                const progress = (t - times.arrival) / (missionDuration - times.arrival);
                angle += 0.1;
                const r = 0.39 + Math.sin(progress * Math.PI * 10) * 0.02;
                trajectory.push({ time: t, x: r * Math.cos(angle), y: r * Math.sin(angle), atMercury: true });
            }
        }
        generateTrajectory();
        function drawStars() {
            ctx.fillStyle = '#0a0a1a';
            ctx.fillRect(0, 0, width, height);
            for (let i = 0; i < 150; i++) {
                ctx.fillStyle = `rgba(255,255,255,${0.3 + Math.sin(time + i) * 0.2})`;
                ctx.beginPath();
                ctx.arc((Math.sin(i * 192.5) * 0.5 + 0.5) * width, (Math.cos(i * 281.3) * 0.5 + 0.5) * height, 1, 0, Math.PI * 2);
                ctx.fill();
            }
        }
        function drawSun() {
            const g = ctx.createRadialGradient(centerX, centerY, 0, centerX, centerY, 40);
            g.addColorStop(0, '#fff'); g.addColorStop(0.3, '#ffcc00'); g.addColorStop(0.7, '#ff6600'); g.addColorStop(1, 'transparent');
            ctx.fillStyle = g;
            ctx.beginPath();
            ctx.arc(centerX, centerY, 40, 0, Math.PI * 2);
            ctx.fill();
        }
        function drawPlanets() {
            planets.forEach(p => {
                ctx.strokeStyle = 'rgba(255,255,255,0.1)';
                ctx.beginPath();
                ctx.arc(centerX, centerY, p.radius * scale, 0, Math.PI * 2);
                ctx.stroke();
                const missionTime = (time * 0.2) % missionDuration;
                const a = (missionTime * 2 * Math.PI / p.period) + p.radius * 10;
                const x = centerX + p.radius * scale * Math.cos(a);
                const y = centerY + p.radius * scale * Math.sin(a);
                ctx.fillStyle = p.color;
                ctx.beginPath();
                ctx.arc(x, y, p.size, 0, Math.PI * 2);
                ctx.fill();
                ctx.fillStyle = 'rgba(255,255,255,0.7)';
                ctx.font = '9px sans-serif';
                ctx.textAlign = 'center';
                ctx.fillText(p.name, x, y + p.size + 10);
            });
        }
        function drawTrajectory() {
            const currentTime = (time * 0.2) % missionDuration;
            let idx = 0;
            for (let i = 0; i < trajectory.length; i++) if (trajectory[i].time <= currentTime) idx = i;
            ctx.beginPath();
            for (let i = 0; i <= idx; i++) {
                const p = trajectory[i];
                const x = centerX + p.x * scale, y = centerY + p.y * scale;
                if (i === 0) ctx.moveTo(x, y); else ctx.lineTo(x, y);
            }
            ctx.strokeStyle = '#9b59b6';
            ctx.lineWidth = 2;
            ctx.stroke();
            for (let i = 0; i <= idx; i++) {
                if (trajectory[i].gravityAssist) {
                    const x = centerX + trajectory[i].x * scale, y = centerY + trajectory[i].y * scale;
                    ctx.fillStyle = 'rgba(241,196,15,0.6)';
                    ctx.beginPath();
                    ctx.arc(x, y, 3, 0, Math.PI * 2);
                    ctx.fill();
                }
            }
            if (idx < trajectory.length) {
                const p = trajectory[idx];
                const x = centerX + p.x * scale, y = centerY + p.y * scale;
                ctx.fillStyle = '#9b59b6';
                ctx.beginPath();
                ctx.arc(x, y, 5, 0, Math.PI * 2);
                ctx.fill();
                ctx.font = 'bold 10px sans-serif';
                ctx.fillText('BepiColombo', x + 10, y - 8);
                const ind = document.getElementById('flybyIndicator');
                if (p.gravityAssist) { ind.textContent = `${p.planet} FLYBY!`; ind.classList.add('show'); }
                else if (p.atMercury) { ind.textContent = 'MERCURY ORBIT'; ind.classList.add('show'); }
                else ind.classList.remove('show');
            }
        }
        function animate() {
            if (playing) time += 0.016 * speed;
            drawStars(); drawSun(); drawPlanets(); drawTrajectory();
            requestAnimationFrame(animate);
        }
        document.getElementById('playPause').onclick = function() { playing = !playing; this.textContent = playing ? '‚è∏ Pause' : '‚ñ∂ Play'; this.classList.toggle('active', playing); };
        document.getElementById('restart').onclick = () => time = 0;
        document.getElementById('speedDown').onclick = () => speed = Math.max(0.25, speed * 0.5);
        document.getElementById('speedUp').onclick = () => speed = Math.min(4, speed * 2);
        animate();
    </script>
</body>
</html>
