<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>All 50 Space Missions - Combined Visualization</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { background: #0a0a1a; overflow: hidden; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        canvas { display: block; }
        .info-panel {
            position: fixed; top: 20px; left: 20px;
            background: rgba(10, 20, 40, 0.95); border: 1px solid #3498db;
            border-radius: 12px; padding: 20px; color: #ecf0f1; max-width: 350px; z-index: 100;
        }
        .info-panel h1 { font-size: 1.4em; color: #3498db; margin-bottom: 10px; }
        .info-panel p { font-size: 0.85em; line-height: 1.5; color: #bdc3c7; margin-bottom: 10px; }
        .mission-stats { display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; margin-top: 15px; }
        .stat { background: rgba(52, 152, 219, 0.2); padding: 8px; border-radius: 5px; text-align: center; }
        .stat-value { font-size: 1.3em; color: #3498db; font-weight: bold; }
        .stat-label { font-size: 0.65em; color: #7f8c8d; text-transform: uppercase; }
        .controls {
            position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%);
            display: flex; flex-wrap: wrap; justify-content: center; gap: 10px; z-index: 100;
            background: rgba(10, 20, 40, 0.9); padding: 15px; border-radius: 10px;
        }
        .controls button {
            background: rgba(52, 152, 219, 0.8); border: none; color: white;
            padding: 10px 18px; border-radius: 5px; cursor: pointer; font-size: 0.85em; transition: all 0.3s;
        }
        .controls button:hover { background: rgba(52, 152, 219, 1); transform: scale(1.05); }
        .controls button.active { background: #27ae60; }
        .controls button.simultaneous { background: #9b59b6; }
        .controls button.simultaneous.active { background: #8e44ad; }
        .legend {
            position: fixed; bottom: 20px; right: 20px;
            background: rgba(10, 20, 40, 0.95); border: 1px solid #3498db;
            border-radius: 10px; padding: 15px; color: #ecf0f1; z-index: 100; max-width: 220px;
        }
        .legend h3 { font-size: 0.9em; color: #3498db; margin-bottom: 10px; }
        .legend-item { display: flex; align-items: center; gap: 8px; margin: 4px 0; font-size: 0.75em; }
        .legend-color { width: 15px; height: 3px; border-radius: 2px; }
        .back-link {
            position: fixed; top: 20px; right: 20px;
            background: rgba(10, 20, 40, 0.9); border: 1px solid #3498db;
            border-radius: 8px; padding: 10px 15px; color: #3498db;
            text-decoration: none; font-size: 0.9em; z-index: 100; transition: all 0.3s;
        }
        .back-link:hover { background: #3498db; color: white; }
        .mission-indicator {
            position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
            background: rgba(52, 152, 219, 0.95); padding: 15px 30px; border-radius: 10px;
            color: white; font-size: 1.2em; font-weight: bold; opacity: 0;
            transition: opacity 0.3s; pointer-events: none; z-index: 200; text-align: center;
        }
        .mission-indicator.show { opacity: 1; }
        .mission-list {
            position: fixed; top: 70px; right: 20px;
            background: rgba(10, 20, 40, 0.95); border: 1px solid #3498db;
            border-radius: 10px; padding: 10px; color: #ecf0f1; z-index: 100;
            max-height: calc(100vh - 180px); overflow-y: auto; width: 180px;
        }
        .mission-list h3 { font-size: 0.8em; color: #3498db; margin-bottom: 8px; text-align: center; }
        .mission-list-item { font-size: 0.65em; padding: 2px 5px; margin: 1px 0; border-radius: 3px; cursor: pointer; transition: background 0.2s; }
        .mission-list-item:hover { background: rgba(52, 152, 219, 0.3); }
        .mission-list-item.active { background: rgba(52, 152, 219, 0.5); }
        .mission-list::-webkit-scrollbar { width: 5px; }
        .mission-list::-webkit-scrollbar-thumb { background: #3498db; border-radius: 3px; }
    </style>
</head>
<body>
    <canvas id="canvas"></canvas>
    <div class="info-panel">
        <h1>üöÄ All 50 Space Missions</h1>
        <p>Watch humanity's greatest space exploration journeys unfold simultaneously across the solar system.</p>
        <p><strong>Simultaneous Mode:</strong> Launch all missions at once from Earth and watch them spread across the solar system!</p>
        <div class="mission-stats">
            <div class="stat"><div class="stat-value" id="activeCount">0</div><div class="stat-label">Active</div></div>
            <div class="stat"><div class="stat-value">50</div><div class="stat-label">Missions</div></div>
            <div class="stat"><div class="stat-value">8</div><div class="stat-label">Agencies</div></div>
        </div>
    </div>
    <a href="index.html" class="back-link">‚Üê Back to Gallery</a>
    <div class="controls">
        <button id="playPause" class="active">‚è∏ Pause</button>
        <button id="restart">üîÑ Restart</button>
        <button id="speedDown">üê¢ Slower</button>
        <button id="speedUp">üêá Faster</button>
        <button id="simultaneousMode" class="simultaneous">üéØ Simultaneous Launch</button>
        <button id="staggeredMode">üìÖ Historical Order</button>
        <button id="toggleTrails">üëÅ Toggle Trails</button>
    </div>
    <div class="legend">
        <h3>Mission Types</h3>
        <div class="legend-item"><div class="legend-color" style="background: #3498db;"></div><span>Outer Solar System</span></div>
        <div class="legend-item"><div class="legend-color" style="background: #e74c3c;"></div><span>Mars Missions</span></div>
        <div class="legend-item"><div class="legend-color" style="background: #f39c12;"></div><span>Inner Planets</span></div>
        <div class="legend-item"><div class="legend-color" style="background: #9b59b6;"></div><span>Asteroids/Comets</span></div>
        <div class="legend-item"><div class="legend-color" style="background: #1abc9c;"></div><span>Lunar Missions</span></div>
    </div>
    <div class="mission-list" id="missionList">
        <h3>Missions (click to highlight)</h3>
    </div>
    <div class="mission-indicator" id="missionIndicator"></div>
    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        let width, height, centerX, centerY, scale;

        function resize() {
            width = canvas.width = window.innerWidth;
            height = canvas.height = window.innerHeight;
            centerX = width / 2;
            centerY = height / 2;
            scale = Math.min(width, height) / 70;
        }
        resize();
        window.addEventListener('resize', resize);

        let playing = true;
        let time = 0;
        let speed = 1;
        let simultaneousMode = true;
        let showTrails = true;
        let highlightedMission = null;

        // Planet data (AU from Sun, orbital period in Earth years)
        const planets = [
            { name: 'Mercury', radius: 0.39, color: '#a0522d', size: 3, period: 0.24 },
            { name: 'Venus', radius: 0.72, color: '#daa520', size: 4, period: 0.62 },
            { name: 'Earth', radius: 1.0, color: '#4169e1', size: 5, period: 1.0 },
            { name: 'Mars', radius: 1.52, color: '#cd5c5c', size: 4, period: 1.88 },
            { name: 'Jupiter', radius: 5.2, color: '#deb887', size: 12, period: 11.86 },
            { name: 'Saturn', radius: 9.5, color: '#f4a460', size: 10, period: 29.46 },
            { name: 'Uranus', radius: 19.2, color: '#87ceeb', size: 7, period: 84.01 },
            { name: 'Neptune', radius: 30.0, color: '#4169e1', size: 7, period: 164.8 }
        ];

        // Define all 50 missions
        const missions = [
            // Outer Solar System (blue)
            { name: 'Voyager 1', color: '#3498db', agency: 'NASA', year: 1977, targets: ['Jupiter', 'Saturn'], type: 'outer' },
            { name: 'Voyager 2', color: '#5dade2', agency: 'NASA', year: 1977, targets: ['Jupiter', 'Saturn', 'Uranus', 'Neptune'], type: 'outer' },
            { name: 'Pioneer 10', color: '#2980b9', agency: 'NASA', year: 1972, targets: ['Jupiter'], type: 'outer' },
            { name: 'Pioneer 11', color: '#1f618d', agency: 'NASA', year: 1973, targets: ['Jupiter', 'Saturn'], type: 'outer' },
            { name: 'Cassini', color: '#85c1e9', agency: 'NASA/ESA', year: 1997, targets: ['Saturn'], type: 'outer' },
            { name: 'New Horizons', color: '#aed6f1', agency: 'NASA', year: 2006, targets: ['Jupiter', 'Pluto'], type: 'outer' },
            { name: 'Galileo', color: '#21618c', agency: 'NASA', year: 1989, targets: ['Jupiter'], type: 'outer' },
            { name: 'Juno', color: '#2e86ab', agency: 'NASA', year: 2011, targets: ['Jupiter'], type: 'outer' },
            { name: 'JUICE', color: '#5499c7', agency: 'ESA', year: 2023, targets: ['Jupiter'], type: 'outer' },
            { name: 'Europa Clipper', color: '#7fb3d5', agency: 'NASA', year: 2024, targets: ['Jupiter'], type: 'outer' },
            { name: 'Ulysses', color: '#1a5276', agency: 'ESA/NASA', year: 1990, targets: ['Jupiter', 'Sun'], type: 'outer' },

            // Mars Missions (red)
            { name: 'Mariner 4', color: '#e74c3c', agency: 'NASA', year: 1964, targets: ['Mars'], type: 'mars' },
            { name: 'Mariner 9', color: '#c0392b', agency: 'NASA', year: 1971, targets: ['Mars'], type: 'mars' },
            { name: 'Mars 3', color: '#a93226', agency: 'USSR', year: 1971, targets: ['Mars'], type: 'mars' },
            { name: 'Viking 1', color: '#d35400', agency: 'NASA', year: 1975, targets: ['Mars'], type: 'mars' },
            { name: 'Phobos 2', color: '#922b21', agency: 'USSR', year: 1988, targets: ['Mars'], type: 'mars' },
            { name: 'Mars Express', color: '#ec7063', agency: 'ESA', year: 2003, targets: ['Mars'], type: 'mars' },
            { name: 'Mangalyaan', color: '#e67e22', agency: 'ISRO', year: 2013, targets: ['Mars'], type: 'mars' },
            { name: 'Tianwen-1', color: '#f1948a', agency: 'CNSA', year: 2020, targets: ['Mars'], type: 'mars' },
            { name: 'Hope', color: '#f5b7b1', agency: 'UAE', year: 2020, targets: ['Mars'], type: 'mars' },
            { name: 'Perseverance', color: '#cb4335', agency: 'NASA', year: 2020, targets: ['Mars'], type: 'mars' },
            { name: 'InSight', color: '#b03a2e', agency: 'NASA', year: 2018, targets: ['Mars'], type: 'mars' },

            // Inner Solar System (orange/yellow)
            { name: 'Mariner 2', color: '#f39c12', agency: 'NASA', year: 1962, targets: ['Venus'], type: 'inner' },
            { name: 'Mariner 10', color: '#d68910', agency: 'NASA', year: 1973, targets: ['Venus', 'Mercury'], type: 'inner' },
            { name: 'MESSENGER', color: '#f5b041', agency: 'NASA', year: 2004, targets: ['Mercury'], type: 'inner' },
            { name: 'BepiColombo', color: '#f8c471', agency: 'ESA/JAXA', year: 2018, targets: ['Mercury'], type: 'inner' },
            { name: 'Venera 9', color: '#eb984e', agency: 'USSR', year: 1975, targets: ['Venus'], type: 'inner' },
            { name: 'Venus Express', color: '#dc7633', agency: 'ESA', year: 2005, targets: ['Venus'], type: 'inner' },
            { name: 'Akatsuki', color: '#e59866', agency: 'JAXA', year: 2010, targets: ['Venus'], type: 'inner' },
            { name: 'Parker Solar', color: '#fad7a0', agency: 'NASA', year: 2018, targets: ['Sun'], type: 'inner' },
            { name: 'Solar Orbiter', color: '#f9e79f', agency: 'ESA', year: 2020, targets: ['Sun'], type: 'inner' },

            // Asteroids & Comets (purple)
            { name: 'Dawn', color: '#9b59b6', agency: 'NASA', year: 2007, targets: ['Vesta', 'Ceres'], type: 'asteroid' },
            { name: 'OSIRIS-REx', color: '#8e44ad', agency: 'NASA', year: 2016, targets: ['Bennu'], type: 'asteroid' },
            { name: 'Lucy', color: '#a569bd', agency: 'NASA', year: 2021, targets: ['Trojans'], type: 'asteroid' },
            { name: 'Hayabusa2', color: '#bb8fce', agency: 'JAXA', year: 2014, targets: ['Ryugu'], type: 'asteroid' },
            { name: 'NEAR Shoemaker', color: '#7d3c98', agency: 'NASA', year: 1996, targets: ['Eros'], type: 'asteroid' },
            { name: 'Psyche', color: '#6c3483', agency: 'NASA', year: 2023, targets: ['16 Psyche'], type: 'asteroid' },
            { name: 'Vega 1/2', color: '#c39bd3', agency: 'USSR', year: 1984, targets: ['Venus', 'Halley'], type: 'asteroid' },
            { name: 'Giotto', color: '#af7ac5', agency: 'ESA', year: 1985, targets: ['Halley'], type: 'asteroid' },
            { name: 'Rosetta', color: '#d7bde2', agency: 'ESA', year: 2004, targets: ['67P'], type: 'asteroid' },
            { name: 'Stardust', color: '#e8daef', agency: 'NASA', year: 1999, targets: ['Wild 2'], type: 'asteroid' },
            { name: 'Deep Impact', color: '#9a7d0a', agency: 'NASA', year: 2005, targets: ['Tempel 1'], type: 'asteroid' },
            { name: "Chang'e 2", color: '#884ea0', agency: 'CNSA', year: 2010, targets: ['Moon', 'Toutatis'], type: 'asteroid' },

            // Lunar Missions (teal)
            { name: 'Luna 3', color: '#1abc9c', agency: 'USSR', year: 1959, targets: ['Moon'], type: 'lunar' },
            { name: 'Chandrayaan-1', color: '#16a085', agency: 'ISRO', year: 2008, targets: ['Moon'], type: 'lunar' },
            { name: 'Clementine', color: '#48c9b0', agency: 'NASA', year: 1994, targets: ['Moon'], type: 'lunar' },
            { name: 'Lunar Gateway', color: '#76d7c4', agency: 'Intl', year: 2025, targets: ['Moon'], type: 'lunar' },
            { name: 'Artemis', color: '#a3e4d7', agency: 'NASA', year: 2024, targets: ['Moon'], type: 'lunar' },
            { name: 'Genesis', color: '#17a589', agency: 'NASA', year: 2001, targets: ['L1'], type: 'lunar' },
            { name: 'Dragonfly', color: '#0e6655', agency: 'NASA', year: 2028, targets: ['Titan'], type: 'outer' }
        ];

        // Generate trajectory for each mission
        function generateMissionTrajectory(mission) {
            const trajectory = [];
            const targetPlanets = {
                'Sun': { radius: 0.05, duration: 6 },
                'Mercury': { radius: 0.39, duration: 3 },
                'Venus': { radius: 0.72, duration: 2 },
                'Earth': { radius: 1.0, duration: 0 },
                'Moon': { radius: 1.1, duration: 0.5 },
                'L1': { radius: 1.5, duration: 2 },
                'Mars': { radius: 1.52, duration: 4 },
                'Vesta': { radius: 2.4, duration: 5 },
                'Ceres': { radius: 2.8, duration: 6 },
                'Jupiter': { radius: 5.2, duration: 5 },
                'Trojans': { radius: 5.2, duration: 8 },
                'Saturn': { radius: 9.5, duration: 8 },
                'Titan': { radius: 9.5, duration: 10 },
                'Uranus': { radius: 19.2, duration: 12 },
                'Neptune': { radius: 30.0, duration: 15 },
                'Pluto': { radius: 35, duration: 18 },
                'Bennu': { radius: 1.3, duration: 4 },
                'Ryugu': { radius: 1.2, duration: 4 },
                'Eros': { radius: 1.4, duration: 3 },
                '16 Psyche': { radius: 2.9, duration: 6 },
                'Halley': { radius: 2.0, duration: 5 },
                '67P': { radius: 3.5, duration: 8 },
                'Wild 2': { radius: 2.5, duration: 6 },
                'Tempel 1': { radius: 2.8, duration: 6 },
                'Toutatis': { radius: 2.5, duration: 4 }
            };

            let currentTime = 0;
            let currentAngle = Math.random() * Math.PI * 2;
            let currentRadius = 1.0;

            // Start from Earth
            trajectory.push({ time: 0, x: currentRadius, y: 0, target: 'Earth' });

            // Generate path through each target
            for (const targetName of mission.targets) {
                const target = targetPlanets[targetName] || { radius: 1.5, duration: 3 };
                const startRadius = currentRadius;
                const endRadius = target.radius;
                const duration = target.duration + Math.random() * 2;
                const segments = 30;

                for (let i = 1; i <= segments; i++) {
                    const t = i / segments;
                    const progress = t;
                    const r = startRadius + (endRadius - startRadius) * progress;
                    const angleOffset = (progress * Math.PI * 0.5) * (endRadius > startRadius ? 1 : -1);
                    const x = r * Math.cos(currentAngle + angleOffset);
                    const y = r * Math.sin(currentAngle + angleOffset);

                    trajectory.push({
                        time: currentTime + duration * t,
                        x, y,
                        target: i === segments ? targetName : null
                    });
                }

                currentTime += duration;
                currentRadius = endRadius;
                currentAngle += Math.PI * 0.5 * (endRadius > startRadius ? 1 : -1);
            }

            // Continue outward or orbit
            const finalRadius = currentRadius;
            for (let t = 0; t < 20; t += 0.5) {
                const progress = t / 20;
                const r = finalRadius + progress * 5;
                const x = r * Math.cos(currentAngle + progress * 0.3);
                const y = r * Math.sin(currentAngle + progress * 0.3);
                trajectory.push({ time: currentTime + t, x, y });
            }

            return trajectory;
        }

        // Initialize all mission trajectories
        missions.forEach((mission, index) => {
            mission.trajectory = generateMissionTrajectory(mission);
            mission.maxTime = mission.trajectory[mission.trajectory.length - 1].time;
            mission.launchOffset = simultaneousMode ? 0 : index * 0.5; // Stagger launches
        });

        // Populate mission list
        const missionListEl = document.getElementById('missionList');
        missions.forEach((mission, i) => {
            const item = document.createElement('div');
            item.className = 'mission-list-item';
            item.style.borderLeft = `3px solid ${mission.color}`;
            item.textContent = mission.name;
            item.onclick = () => {
                highlightedMission = highlightedMission === i ? null : i;
                document.querySelectorAll('.mission-list-item').forEach(el => el.classList.remove('active'));
                if (highlightedMission !== null) item.classList.add('active');
            };
            missionListEl.appendChild(item);
        });

        function drawStars() {
            ctx.fillStyle = '#0a0a1a';
            ctx.fillRect(0, 0, width, height);
            for (let i = 0; i < 300; i++) {
                const x = (Math.sin(i * 192.5) * 0.5 + 0.5) * width;
                const y = (Math.cos(i * 281.3) * 0.5 + 0.5) * height;
                const brightness = 0.3 + Math.sin(time * 0.5 + i) * 0.2;
                ctx.fillStyle = `rgba(255, 255, 255, ${brightness})`;
                ctx.beginPath();
                ctx.arc(x, y, Math.random() * 1.5, 0, Math.PI * 2);
                ctx.fill();
            }
        }

        function drawSun() {
            const gradient = ctx.createRadialGradient(centerX, centerY, 0, centerX, centerY, 40);
            gradient.addColorStop(0, '#fff7e6');
            gradient.addColorStop(0.3, '#ffcc00');
            gradient.addColorStop(0.7, '#ff6600');
            gradient.addColorStop(1, 'transparent');
            ctx.fillStyle = gradient;
            ctx.beginPath();
            ctx.arc(centerX, centerY, 40, 0, Math.PI * 2);
            ctx.fill();
            ctx.fillStyle = '#ffff00';
            ctx.beginPath();
            ctx.arc(centerX, centerY, 10, 0, Math.PI * 2);
            ctx.fill();
        }

        function drawPlanets() {
            const missionTime = (time * 0.5) % 50;
            planets.forEach(planet => {
                // Orbit path
                ctx.strokeStyle = 'rgba(255, 255, 255, 0.08)';
                ctx.lineWidth = 1;
                ctx.beginPath();
                ctx.arc(centerX, centerY, planet.radius * scale, 0, Math.PI * 2);
                ctx.stroke();

                // Planet position
                const angle = (missionTime * 2 * Math.PI / planet.period) + planet.radius * 5;
                const x = centerX + planet.radius * scale * Math.cos(angle);
                const y = centerY + planet.radius * scale * Math.sin(angle);

                // Glow
                const glowGradient = ctx.createRadialGradient(x, y, 0, x, y, planet.size * 2);
                glowGradient.addColorStop(0, planet.color);
                glowGradient.addColorStop(1, 'transparent');
                ctx.fillStyle = glowGradient;
                ctx.beginPath();
                ctx.arc(x, y, planet.size * 2, 0, Math.PI * 2);
                ctx.fill();

                // Planet
                ctx.fillStyle = planet.color;
                ctx.beginPath();
                ctx.arc(x, y, planet.size, 0, Math.PI * 2);
                ctx.fill();

                // Saturn rings
                if (planet.name === 'Saturn') {
                    ctx.strokeStyle = 'rgba(244, 164, 96, 0.5)';
                    ctx.lineWidth = 2;
                    ctx.beginPath();
                    ctx.ellipse(x, y, planet.size * 1.6, planet.size * 0.4, Math.PI / 6, 0, Math.PI * 2);
                    ctx.stroke();
                }

                // Label
                ctx.fillStyle = 'rgba(255, 255, 255, 0.5)';
                ctx.font = '9px sans-serif';
                ctx.textAlign = 'center';
                ctx.fillText(planet.name, x, y + planet.size + 12);
            });
        }

        function drawMission(mission, index) {
            const launchOffset = simultaneousMode ? 0 : index * 0.8;
            const missionTime = Math.max(0, (time * 0.3) - launchOffset) % (mission.maxTime + 5);

            if (missionTime <= 0) return false; // Not launched yet

            // Find current position
            let currentIndex = 0;
            for (let i = 0; i < mission.trajectory.length; i++) {
                if (mission.trajectory[i].time <= missionTime) currentIndex = i;
            }

            const isHighlighted = highlightedMission === index;
            const opacity = highlightedMission === null || isHighlighted ? 1 : 0.2;

            // Draw trail
            if (showTrails) {
                ctx.beginPath();
                ctx.globalAlpha = 0.4 * opacity;
                let started = false;
                const trailStart = Math.max(0, currentIndex - 100);
                for (let i = trailStart; i <= currentIndex; i++) {
                    const point = mission.trajectory[i];
                    const x = centerX + point.x * scale;
                    const y = centerY + point.y * scale;
                    if (!started) { ctx.moveTo(x, y); started = true; }
                    else ctx.lineTo(x, y);
                }
                ctx.strokeStyle = mission.color;
                ctx.lineWidth = isHighlighted ? 3 : 1.5;
                ctx.stroke();
                ctx.globalAlpha = 1;
            }

            // Draw spacecraft
            if (currentIndex < mission.trajectory.length) {
                const point = mission.trajectory[currentIndex];
                const x = centerX + point.x * scale;
                const y = centerY + point.y * scale;

                ctx.globalAlpha = opacity;

                // Glow
                if (isHighlighted) {
                    const glowGradient = ctx.createRadialGradient(x, y, 0, x, y, 20);
                    glowGradient.addColorStop(0, mission.color);
                    glowGradient.addColorStop(1, 'transparent');
                    ctx.fillStyle = glowGradient;
                    ctx.beginPath();
                    ctx.arc(x, y, 20, 0, Math.PI * 2);
                    ctx.fill();
                }

                // Spacecraft
                ctx.fillStyle = mission.color;
                ctx.beginPath();
                ctx.arc(x, y, isHighlighted ? 5 : 3, 0, Math.PI * 2);
                ctx.fill();

                // Label
                if (isHighlighted) {
                    ctx.fillStyle = mission.color;
                    ctx.font = 'bold 11px sans-serif';
                    ctx.textAlign = 'left';
                    ctx.fillText(mission.name, x + 10, y - 8);
                    ctx.font = '9px sans-serif';
                    ctx.fillStyle = 'rgba(255,255,255,0.7)';
                    ctx.fillText(`${mission.agency} ${mission.year}`, x + 10, y + 4);
                }

                ctx.globalAlpha = 1;
            }

            return true;
        }

        function animate() {
            if (playing) time += 0.016 * speed;

            drawStars();
            drawSun();
            drawPlanets();

            let activeCount = 0;
            missions.forEach((mission, i) => {
                if (drawMission(mission, i)) activeCount++;
            });
            document.getElementById('activeCount').textContent = activeCount;

            requestAnimationFrame(animate);
        }

        // Controls
        document.getElementById('playPause').addEventListener('click', function() {
            playing = !playing;
            this.textContent = playing ? '‚è∏ Pause' : '‚ñ∂ Play';
            this.classList.toggle('active', playing);
        });
        document.getElementById('restart').addEventListener('click', () => time = 0);
        document.getElementById('speedDown').addEventListener('click', () => speed = Math.max(0.25, speed * 0.5));
        document.getElementById('speedUp').addEventListener('click', () => speed = Math.min(8, speed * 2));
        document.getElementById('simultaneousMode').addEventListener('click', function() {
            simultaneousMode = true;
            this.classList.add('active');
            document.getElementById('staggeredMode').classList.remove('active');
            time = 0;
        });
        document.getElementById('staggeredMode').addEventListener('click', function() {
            simultaneousMode = false;
            this.classList.add('active');
            document.getElementById('simultaneousMode').classList.remove('active');
            time = 0;
        });
        document.getElementById('toggleTrails').addEventListener('click', function() {
            showTrails = !showTrails;
            this.classList.toggle('active', showTrails);
        });

        // Start with simultaneous mode
        document.getElementById('simultaneousMode').classList.add('active');
        document.getElementById('toggleTrails').classList.add('active');
        animate();
    </script>
</body>
</html>
