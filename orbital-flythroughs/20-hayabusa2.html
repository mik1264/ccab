<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hayabusa2 - Asteroid Sample Return (JAXA)</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { background: #0a0a1a; overflow: hidden; font-family: 'Segoe UI', sans-serif; }
        canvas { display: block; }
        .info-panel { position: fixed; top: 20px; left: 20px; background: rgba(10, 20, 40, 0.9); border: 1px solid #e74c3c; border-radius: 10px; padding: 20px; color: #ecf0f1; max-width: 300px; z-index: 100; }
        .info-panel h1 { font-size: 1.4em; color: #e74c3c; margin-bottom: 10px; }
        .info-panel p { font-size: 0.85em; line-height: 1.5; color: #bdc3c7; }
        .mission-stats { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-top: 12px; }
        .stat { background: rgba(231, 76, 60, 0.2); padding: 6px; border-radius: 5px; text-align: center; }
        .stat-value { font-size: 1em; color: #e74c3c; font-weight: bold; }
        .stat-label { font-size: 0.65em; color: #7f8c8d; }
        .controls { position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); display: flex; gap: 10px; z-index: 100; }
        .controls button { background: rgba(231, 76, 60, 0.8); border: none; color: white; padding: 10px 20px; border-radius: 5px; cursor: pointer; }
        .controls button.active { background: #27ae60; }
        .back-link { position: fixed; top: 20px; right: 20px; background: rgba(10, 20, 40, 0.9); border: 1px solid #e74c3c; border-radius: 8px; padding: 10px 15px; color: #e74c3c; text-decoration: none; z-index: 100; }
        .flyby-indicator { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: rgba(231, 76, 60, 0.9); padding: 20px 40px; border-radius: 10px; color: white; font-size: 1.3em; font-weight: bold; opacity: 0; transition: opacity 0.5s; pointer-events: none; z-index: 200; }
        .flyby-indicator.show { opacity: 1; }
    </style>
</head>
<body>
    <canvas id="canvas"></canvas>
    <div class="info-panel">
        <h1>üöÄ Hayabusa2 üáØüáµ</h1>
        <p>JAXA's asteroid sample return mission! Launched Dec 2014. Used Earth gravity assist to reach asteroid Ryugu.</p>
        <p style="margin-top:8px">Collected samples including subsurface material via impactor. Returned 5.4g of pristine asteroid material in Dec 2020.</p>
        <div class="mission-stats">
            <div class="stat"><div class="stat-value">2014</div><div class="stat-label">Launch</div></div>
            <div class="stat"><div class="stat-value">JAXA</div><div class="stat-label">Agency</div></div>
            <div class="stat"><div class="stat-value">5.4g</div><div class="stat-label">Sample</div></div>
            <div class="stat"><div class="stat-value">2020</div><div class="stat-label">Return</div></div>
        </div>
    </div>
    <a href="index.html" class="back-link">‚Üê Back</a>
    <div class="controls">
        <button id="playPause" class="active">‚è∏ Pause</button>
        <button id="restart">üîÑ Restart</button>
        <button id="speedDown">üê¢</button>
        <button id="speedUp">üêá</button>
    </div>
    <div class="flyby-indicator" id="flybyIndicator">EVENT!</div>
    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        let width, height, centerX, centerY, scale;
        function resize() { width = canvas.width = window.innerWidth; height = canvas.height = window.innerHeight; centerX = width / 2; centerY = height / 2; scale = Math.min(width, height) / 5; }
        resize(); window.addEventListener('resize', resize);
        let playing = true, time = 0, speed = 1;
        const planets = [{ name: 'Earth', radius: 1.0, color: '#4169e1', size: 7, period: 1.0 }, { name: 'Mars', radius: 1.52, color: '#cd5c5c', size: 5, period: 1.88 }];
        const ryugu = { name: 'Ryugu', radius: 1.19, size: 4, color: '#696969' };
        const trajectory = [];
        const dur = 10;
        function genTraj() {
            trajectory.length = 0;
            const earthFlyby = 1.0, ryuguArr = 3.5, ryuguDep = 5.5, earthRet = 8;
            // To Earth flyby
            for (let t = 0; t < earthFlyby; t += 0.02) {
                const p = t / earthFlyby;
                const a = Math.PI + p * Math.PI * 2;
                const r = 1.0 + Math.sin(p * Math.PI) * 0.3;
                trajectory.push({ time: t, x: r * Math.cos(a), y: r * Math.sin(a) });
            }
            let angle = Math.PI * 3;
            for (let i = 0; i < 12; i++) trajectory.push({ time: earthFlyby + i * 0.008, x: Math.cos(angle + i * 0.05), y: Math.sin(angle + i * 0.05), gravityAssist: true, planet: 'Earth' });
            angle += 0.6;
            // To Ryugu
            for (let t = earthFlyby + 0.1; t < ryuguArr; t += 0.02) {
                const p = (t - earthFlyby - 0.1) / (ryuguArr - earthFlyby - 0.1);
                const r = 1.0 + p * 0.19;
                angle += 0.025;
                trajectory.push({ time: t, x: r * Math.cos(angle), y: r * Math.sin(angle) });
            }
            // At Ryugu
            for (let t = ryuguArr; t < ryuguDep; t += 0.02) {
                const p = (t - ryuguArr) / (ryuguDep - ryuguArr);
                const isSample = p > 0.3 && p < 0.35;
                const isImpact = p > 0.5 && p < 0.55;
                trajectory.push({ time: t, x: 1.19 * Math.cos(angle + p * 0.3), y: 1.19 * Math.sin(angle + p * 0.3), atRyugu: true, sampling: isSample, impact: isImpact });
            }
            angle += 0.3;
            // Return to Earth
            for (let t = ryuguDep; t < earthRet; t += 0.02) {
                const p = (t - ryuguDep) / (earthRet - ryuguDep);
                const r = 1.19 - p * 0.19;
                angle += 0.03;
                trajectory.push({ time: t, x: r * Math.cos(angle), y: r * Math.sin(angle), returning: true });
            }
            for (let i = 0; i < 10; i++) trajectory.push({ time: earthRet + i * 0.008, x: Math.cos(angle + i * 0.04), y: Math.sin(angle + i * 0.04), earthReturn: true });
            // Extended mission
            for (let t = earthRet + 0.1; t < dur; t += 0.02) {
                const p = (t - earthRet - 0.1) / (dur - earthRet - 0.1);
                angle += 0.04;
                const r = 1.0 + p * 0.5;
                trajectory.push({ time: t, x: r * Math.cos(angle), y: r * Math.sin(angle), extended: true });
            }
        }
        genTraj();
        function draw() {
            ctx.fillStyle = '#0a0a1a'; ctx.fillRect(0, 0, width, height);
            for (let i = 0; i < 150; i++) { ctx.fillStyle = `rgba(255,255,255,${0.3 + Math.sin(time + i) * 0.2})`; ctx.beginPath(); ctx.arc((Math.sin(i * 192) * 0.5 + 0.5) * width, (Math.cos(i * 281) * 0.5 + 0.5) * height, 1, 0, Math.PI * 2); ctx.fill(); }
            const g = ctx.createRadialGradient(centerX, centerY, 0, centerX, centerY, 30);
            g.addColorStop(0, '#fff'); g.addColorStop(0.3, '#ffcc00'); g.addColorStop(1, 'transparent');
            ctx.fillStyle = g; ctx.beginPath(); ctx.arc(centerX, centerY, 30, 0, Math.PI * 2); ctx.fill();
            planets.forEach(p => {
                ctx.strokeStyle = 'rgba(255,255,255,0.1)'; ctx.beginPath(); ctx.arc(centerX, centerY, p.radius * scale, 0, Math.PI * 2); ctx.stroke();
                const a = (time * 0.15 / p.period) + p.radius * 10;
                const x = centerX + p.radius * scale * Math.cos(a), y = centerY + p.radius * scale * Math.sin(a);
                ctx.fillStyle = p.color; ctx.beginPath(); ctx.arc(x, y, p.size, 0, Math.PI * 2); ctx.fill();
                ctx.fillStyle = 'rgba(255,255,255,0.7)'; ctx.font = '9px sans-serif'; ctx.textAlign = 'center'; ctx.fillText(p.name, x, y + p.size + 10);
            });
            // Ryugu
            const rAngle = (time * 0.15 / 1.3) + 5;
            const rx = centerX + ryugu.radius * scale * Math.cos(rAngle), ry = centerY + ryugu.radius * scale * Math.sin(rAngle);
            ctx.fillStyle = ryugu.color; ctx.beginPath(); ctx.arc(rx, ry, ryugu.size, 0, Math.PI * 2); ctx.fill();
            ctx.fillStyle = 'rgba(255,255,255,0.8)'; ctx.font = 'bold 9px sans-serif'; ctx.fillText('Ryugu', rx, ry - 10);
            const currentTime = (time * 0.25) % dur;
            let idx = 0; for (let i = 0; i < trajectory.length; i++) if (trajectory[i].time <= currentTime) idx = i;
            ctx.beginPath();
            for (let i = 0; i <= idx; i++) { const p = trajectory[i]; const x = centerX + p.x * scale, y = centerY + p.y * scale; if (i === 0) ctx.moveTo(x, y); else ctx.lineTo(x, y); }
            ctx.strokeStyle = '#e74c3c'; ctx.lineWidth = 2; ctx.stroke();
            if (idx < trajectory.length) {
                const p = trajectory[idx];
                const x = centerX + p.x * scale, y = centerY + p.y * scale;
                ctx.fillStyle = '#e74c3c'; ctx.beginPath(); ctx.arc(x, y, 5, 0, Math.PI * 2); ctx.fill();
                ctx.font = 'bold 10px sans-serif'; ctx.fillText('Hayabusa2', x + 10, y - 8);
                const ind = document.getElementById('flybyIndicator');
                if (p.gravityAssist) { ind.textContent = 'EARTH GRAVITY ASSIST!'; ind.classList.add('show'); }
                else if (p.sampling) { ind.textContent = 'SAMPLE COLLECTION!'; ind.style.background = 'rgba(241,196,15,0.9)'; ind.classList.add('show'); }
                else if (p.impact) { ind.textContent = 'SCI IMPACTOR!'; ind.style.background = 'rgba(155,89,182,0.9)'; ind.classList.add('show'); }
                else if (p.earthReturn) { ind.textContent = 'SAMPLE CAPSULE RETURN!'; ind.style.background = 'rgba(39,174,96,0.9)'; ind.classList.add('show'); }
                else if (p.atRyugu) { ind.textContent = 'AT RYUGU'; ind.style.background = 'rgba(105,105,105,0.9)'; ind.classList.add('show'); }
                else ind.classList.remove('show');
            }
        }
        function animate() { if (playing) time += 0.016 * speed; draw(); requestAnimationFrame(animate); }
        document.getElementById('playPause').onclick = function() { playing = !playing; this.textContent = playing ? '‚è∏ Pause' : '‚ñ∂ Play'; this.classList.toggle('active', playing); };
        document.getElementById('restart').onclick = () => time = 0;
        document.getElementById('speedDown').onclick = () => speed = Math.max(0.25, speed * 0.5);
        document.getElementById('speedUp').onclick = () => speed = Math.min(4, speed * 2);
        animate();
    </script>
</body>
</html>
