<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SSL/TLS Handshake - Secure Connection Visualization</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Courier New', monospace;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 100%);
            color: #00ff88;
            min-height: 100vh;
            padding: 20px;
        }
        .back-link {
            position: fixed;
            top: 20px;
            left: 20px;
            color: #00ff88;
            text-decoration: none;
            padding: 10px 20px;
            background: rgba(0,255,136,0.1);
            border: 1px solid #00ff88;
            border-radius: 5px;
            z-index: 100;
        }
        .back-link:hover { background: rgba(0,255,136,0.2); }
        .container {
            max-width: 1100px;
            margin: 60px auto 0;
        }
        h1 { font-size: 2rem; margin-bottom: 10px; text-align: center; }
        .subtitle { color: #888; margin-bottom: 30px; text-align: center; }
        .handshake-container {
            display: grid;
            grid-template-columns: 200px 1fr 200px;
            gap: 20px;
        }
        .entity {
            background: rgba(0,0,0,0.5);
            padding: 20px;
            border-radius: 15px;
            text-align: center;
        }
        .entity.client { border: 2px solid #66aaff; }
        .entity.server { border: 2px solid #ff66aa; }
        .entity-icon { font-size: 3rem; margin-bottom: 10px; }
        .entity h3 { margin-bottom: 10px; }
        .entity.client h3 { color: #66aaff; }
        .entity.server h3 { color: #ff66aa; }
        .timeline {
            position: relative;
            padding: 20px 0;
        }
        .message {
            display: flex;
            align-items: center;
            margin: 15px 0;
            opacity: 0.3;
            transition: all 0.5s;
        }
        .message.active { opacity: 1; }
        .message.complete { opacity: 0.8; }
        .message-content {
            flex: 1;
            padding: 15px;
            background: rgba(0,255,136,0.1);
            border-radius: 10px;
            font-size: 0.85rem;
        }
        .message.client-to-server .message-content {
            margin-right: 50px;
            border-left: 3px solid #66aaff;
        }
        .message.server-to-client .message-content {
            margin-left: 50px;
            border-right: 3px solid #ff66aa;
        }
        .arrow {
            position: absolute;
            font-size: 1.5rem;
        }
        .message.client-to-server .arrow {
            right: 0;
            color: #66aaff;
        }
        .message.server-to-client .arrow {
            left: 0;
            color: #ff66aa;
        }
        .message h4 { color: #00ccff; margin-bottom: 5px; }
        .message-details { color: #888; font-size: 0.8rem; }
        button {
            display: block;
            width: 200px;
            margin: 20px auto;
            padding: 15px 30px;
            font-size: 1rem;
            font-family: inherit;
            background: rgba(0,255,136,0.1);
            border: 1px solid #00ff88;
            color: #00ff88;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
        }
        button:hover { background: rgba(0,255,136,0.3); }
        .status {
            text-align: center;
            padding: 20px;
            margin-top: 20px;
            border-radius: 10px;
            font-size: 1.2rem;
        }
        .status.pending { background: rgba(255,255,0,0.1); border: 1px solid #ffff00; color: #ffff00; }
        .status.secure { background: rgba(0,255,136,0.1); border: 1px solid #00ff88; }
        .info {
            margin-top: 30px;
            padding: 20px;
            background: rgba(0,255,136,0.05);
            border-radius: 10px;
        }
        .info h3 { color: #00ccff; margin-bottom: 10px; }
        .info p { color: #aaa; line-height: 1.6; }
        .cipher-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        .cipher-box {
            background: rgba(0,0,0,0.3);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }
        .cipher-box .label { color: #888; font-size: 0.8rem; }
        .cipher-box .value { color: #00ff88; font-size: 0.9rem; margin-top: 5px; }
    </style>
</head>
<body>
    <a href="index.html" class="back-link">‚Üê Back</a>
    <div class="container">
        <h1>SSL/TLS Handshake</h1>
        <p class="subtitle">Establishing a secure HTTPS connection</p>

        <button onclick="runHandshake()">Start Handshake</button>

        <div class="handshake-container">
            <div class="entity client">
                <div class="entity-icon">üíª</div>
                <h3>Client</h3>
                <p style="color:#888;font-size:0.8rem;">Browser</p>
            </div>

            <div class="timeline">
                <div class="message client-to-server" id="msg1">
                    <div class="message-content">
                        <h4>1. ClientHello</h4>
                        <div class="message-details">
                            TLS Version: 1.3<br>
                            Random: 32 bytes<br>
                            Cipher Suites: TLS_AES_256_GCM_SHA384...<br>
                            Extensions: SNI, ALPN, supported_groups
                        </div>
                    </div>
                    <span class="arrow">‚Üí</span>
                </div>

                <div class="message server-to-client" id="msg2">
                    <span class="arrow">‚Üê</span>
                    <div class="message-content">
                        <h4>2. ServerHello</h4>
                        <div class="message-details">
                            TLS Version: 1.3<br>
                            Random: 32 bytes<br>
                            Selected Cipher: TLS_AES_256_GCM_SHA384<br>
                            Key Share: X25519 public key
                        </div>
                    </div>
                </div>

                <div class="message server-to-client" id="msg3">
                    <span class="arrow">‚Üê</span>
                    <div class="message-content">
                        <h4>3. Certificate</h4>
                        <div class="message-details">
                            Server Certificate Chain<br>
                            X.509 Certificate<br>
                            Signed by: Let's Encrypt Authority X3<br>
                            Valid: 90 days
                        </div>
                    </div>
                </div>

                <div class="message server-to-client" id="msg4">
                    <span class="arrow">‚Üê</span>
                    <div class="message-content">
                        <h4>4. CertificateVerify</h4>
                        <div class="message-details">
                            Signature Algorithm: RSA-PSS-SHA256<br>
                            Proof of private key ownership
                        </div>
                    </div>
                </div>

                <div class="message server-to-client" id="msg5">
                    <span class="arrow">‚Üê</span>
                    <div class="message-content">
                        <h4>5. Server Finished</h4>
                        <div class="message-details">
                            HMAC of handshake transcript<br>
                            Encrypted with handshake key
                        </div>
                    </div>
                </div>

                <div class="message client-to-server" id="msg6">
                    <div class="message-content">
                        <h4>6. Client Finished</h4>
                        <div class="message-details">
                            HMAC of handshake transcript<br>
                            Confirms key derivation
                        </div>
                    </div>
                    <span class="arrow">‚Üí</span>
                </div>

                <div class="message client-to-server" id="msg7">
                    <div class="message-content">
                        <h4>7. Application Data</h4>
                        <div class="message-details">
                            üîí Encrypted HTTP Request<br>
                            GET / HTTP/1.1
                        </div>
                    </div>
                    <span class="arrow">‚Üí</span>
                </div>
            </div>

            <div class="entity server">
                <div class="entity-icon">üñ•Ô∏è</div>
                <h3>Server</h3>
                <p style="color:#888;font-size:0.8rem;">example.com</p>
            </div>
        </div>

        <div class="status pending" id="status">
            Waiting to start handshake...
        </div>

        <div class="cipher-info" id="cipherInfo" style="display:none;">
            <div class="cipher-box">
                <div class="label">Protocol</div>
                <div class="value">TLS 1.3</div>
            </div>
            <div class="cipher-box">
                <div class="label">Key Exchange</div>
                <div class="value">X25519</div>
            </div>
            <div class="cipher-box">
                <div class="label">Cipher</div>
                <div class="value">AES-256-GCM</div>
            </div>
            <div class="cipher-box">
                <div class="label">MAC</div>
                <div class="value">SHA-384</div>
            </div>
        </div>

        <div class="info">
            <h3>TLS 1.3 Improvements</h3>
            <p>TLS 1.3 significantly improves upon older versions:</p>
            <p>‚Ä¢ <strong>1-RTT Handshake:</strong> Connection established in one round trip (vs. 2 for TLS 1.2)</p>
            <p>‚Ä¢ <strong>0-RTT Resumption:</strong> Send data immediately on reconnection</p>
            <p>‚Ä¢ <strong>Removed weak ciphers:</strong> No more RC4, 3DES, or static RSA</p>
            <p>‚Ä¢ <strong>Perfect Forward Secrecy:</strong> Required for all connections</p>
            <p>‚Ä¢ <strong>Encrypted handshake:</strong> More metadata protected from observers</p>
        </div>
    </div>

    <script>
        let currentStep = 0;
        const totalSteps = 7;

        async function runHandshake() {
            // Reset all messages
            for (let i = 1; i <= totalSteps; i++) {
                document.getElementById(`msg${i}`).classList.remove('active', 'complete');
            }
            document.getElementById('cipherInfo').style.display = 'none';

            currentStep = 0;

            const status = document.getElementById('status');
            status.className = 'status pending';
            status.textContent = 'Handshake in progress...';

            for (let i = 1; i <= totalSteps; i++) {
                await new Promise(r => setTimeout(r, 800));

                // Complete previous message
                if (i > 1) {
                    document.getElementById(`msg${i-1}`).classList.remove('active');
                    document.getElementById(`msg${i-1}`).classList.add('complete');
                }

                // Activate current message
                document.getElementById(`msg${i}`).classList.add('active');

                // Update status
                const steps = [
                    'Client sending supported ciphers and random data...',
                    'Server selecting cipher suite and sending key share...',
                    'Server sending certificate chain...',
                    'Server proving certificate ownership...',
                    'Server confirming handshake integrity...',
                    'Client confirming handshake completion...',
                    'üîí Secure connection established!'
                ];
                status.textContent = steps[i-1];
            }

            await new Promise(r => setTimeout(r, 500));
            document.getElementById(`msg${totalSteps}`).classList.remove('active');
            document.getElementById(`msg${totalSteps}`).classList.add('complete');

            status.className = 'status secure';
            status.innerHTML = 'üîí Secure TLS 1.3 Connection Established<br><small>All traffic is now encrypted</small>';

            document.getElementById('cipherInfo').style.display = 'grid';
        }
    </script>
    <script src="../assets/js/enhance.js" defer></script>
</body>
</html>
