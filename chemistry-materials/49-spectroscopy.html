<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spectroscopy - CCAB</title>
    <link rel="stylesheet" href="../assets/css/gallery-standard.css">
    <style>
        body {
            background: #000;
            color: #ddd;
            font-family: system-ui;
            padding: 2rem;
            text-align: center;
        }
        .container { max-width: 1000px; margin: 0 auto; }
        
        .atom-view {
            position: relative;
            width: 400px;
            height: 400px;
            margin: 0 auto;
            border: 1px solid #333;
            border-radius: 50%;
        }
        
        .nucleus {
            position: absolute;
            top: 190px; left: 190px;
            width: 20px; height: 20px;
            background: #ef4444;
            border-radius: 50%;
            box-shadow: 0 0 10px #ef4444;
        }
        
        .orbit {
            position: absolute;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            border: 1px solid #555;
            border-radius: 50%;
        }
        
        .electron {
            position: absolute;
            width: 10px; height: 10px;
            background: #3b82f6;
            border-radius: 50%;
            box-shadow: 0 0 5px #3b82f6;
            transition: top 0.2s, left 0.2s; /* Jump anim */
        }
        
        .spectrum {
            margin-top: 30px;
            height: 50px;
            background: linear-gradient(to right, 
                #4b0082, /* Violet */
                #0000ff, /* Blue */
                #00ff00, /* Green */
                #ffff00, /* Yellow */
                #ff7f00, /* Orange */
                #ff0000  /* Red */
            );
            position: relative;
            border: 1px solid #fff;
        }
        
        .absorption-line {
            position: absolute;
            top: 0; height: 100%; width: 2px;
            background: #000;
            opacity: 0.8;
        }
        
        .photon {
            position: absolute;
            width: 10px; height: 10px;
            border-radius: 50%;
        }
        
    </style>
</head>
<body>

<div class="container">
    <a href="../index.html" class="gallery-back">‚Üê Back to Gallery</a>
    <h1>Absorption Spectroscopy</h1>
    <p>Photons with specific energy match electron transitions, causing absorption lines.</p>
    
    <div class="atom-view" id="atom">
        <div class="nucleus"></div>
        <div class="orbit" style="width: 100px; height: 100px;"></div> <!-- n=1 -->
        <div class="orbit" style="width: 200px; height: 200px;"></div> <!-- n=2 -->
        <div class="orbit" style="width: 300px; height: 300px;"></div> <!-- n=3 -->
        
        <div class="electron" id="elec"></div>
    </div>
    
    <div class="spectrum" id="spec">
        <!-- Lines injected -->
    </div>
    
    <div style="margin-top:20px;">
        <button onclick="fireRandom()">Fire Photon Storm</button>
        <button onclick="reset()">Reset Spectrum</button>
    </div>
</div>

<script>
    const atom = document.getElementById('atom');
    const elec = document.getElementById('elec');
    const spec = document.getElementById('spec');
    
    // Energy Levels (Arbitrary units)
    // n=1: E1, n=2: E2, n=3: E3
    // Transitions: 1->2, 1->3, 2->3
    
    // Radii
    const radii = [0, 50, 100, 150]; // n=0 unused
    let currentN = 1;
    let angle = 0;
    
    // Transition Energies -> Wavelengths
    // Delta E ~ 1/n1^2 - 1/n2^2
    // Map to 0-100% of spectrum
    const transitions = [
        { n1: 1, n2: 2, pos: 85 }, // Red (Low energy gap? Wait. 1->2 is largest gap. Blue/UV. Let's fake positions for visual spread)
        { n1: 1, n2: 3, pos: 10 }, // Violet
        { n1: 2, n2: 3, pos: 60 }  // Green
    ];
    
    // Let's use fake physics for clear visuals
    // High energy (Violet) = Big jump.
    // Low energy (Red) = Small jump.
    // 1->2: Medium (Green)
    // 1->3: High (Violet)
    // 2->3: Low (Red)
    
    const validJumps = [
        { from: 1, to: 2, color: '#00ff00', x: 50 }, // Green
        { from: 1, to: 3, color: '#8a2be2', x: 10 }, // Violet
        { from: 2, to: 3, color: '#ff0000', x: 90 }  // Red
    ];
    
    function reset() {
        spec.innerHTML = '';
        currentN = 1;
    }
    
    function fireRandom() {
        // Fire 20 photons
        for(let i=0; i<20; i++) {
            setTimeout(spawnPhoton, i*200);
        }
    }
    
    function spawnPhoton() {
        // Random wavelength 0-100
        const x = Math.random() * 100;
        
        // Visual
        const p = document.createElement('div');
        p.className = 'photon';
        // Map x to color (rough)
        p.style.backgroundColor = `hsl(${280 - x*2.8}, 100%, 50%)`;
        p.style.left = '-20px';
        p.style.top = '200px';
        atom.appendChild(p);
        
        // Animate
        let px = -20;
        const anim = setInterval(() => {
            px += 5;
            p.style.left = px + 'px';
            
            // Hit center (approx 200)
            if (px > 180 && px < 220) {
                // Check absorption
                const hit = checkAbsorption(x);
                if (hit) {
                    p.remove();
                    clearInterval(anim);
                    absorb(hit);
                }
            }
            
            if (px > 420) {
                p.remove();
                clearInterval(anim);
            }
        }, 16);
    }
    
    function checkAbsorption(x) {
        // Find matching jump from current N
        // Tolerance +/- 5
        const jump = validJumps.find(j => j.from === currentN && Math.abs(j.x - x) < 5);
        return jump;
    }
    
    function absorb(jump) {
        // Move Electron
        currentN = jump.to;
        
        // Add line to spectrum
        const line = document.createElement('div');
        line.className = 'absorption-line';
        line.style.left = jump.x + '%';
        spec.appendChild(line);
        
        // Decay later
        setTimeout(() => {
            // Emit photon?
            // Just drop back down
            currentN = 1; // Simplify: always ground state decay
        }, 1000);
    }
    
    function loop() {
        angle += 0.05;
        const r = radii[currentN];
        
        // Circular motion
        const ex = 200 + r * Math.cos(angle) - 5;
        const ey = 200 + r * Math.sin(angle) - 5;
        
        elec.style.left = ex + 'px';
        elec.style.top = ey + 'px';
        
        requestAnimationFrame(loop);
    }
    
    loop();

</script>
</body>
</html>
