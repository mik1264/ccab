<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Wireworld Electronic Circuit</title>
    <style>
        * { margin: 0; padding: 0; }
        body { background: #000; color: #e0e0e0; font-family: sans-serif; overflow: hidden; }
        #canvas { display: block; }
        .info { position: fixed; top: 20px; left: 20px; background: rgba(26, 26, 46, 0.95); padding: 20px; border-radius: 10px; max-width: 300px; }
        h1 { font-size: 1.3em; color: #64ffda; margin-bottom: 10px; }
        p { font-size: 0.85em; color: #c0c0c0; line-height: 1.6; }
    </style>
</head>
<body>
    <div class="info">
        <h1>Wireworld</h1>
        <p>CA for simulating logic circuits. Watch electrical signals propagate through wires and logic gates.</p>
    </div>
    <canvas id="canvas"></canvas>
    <script>
        const canvas = document.getElementById('canvas'), ctx = canvas.getContext('2d');
        const cellSize = 8, cols = Math.floor(window.innerWidth / cellSize), rows = Math.floor(window.innerHeight / cellSize);
        canvas.width = cols * cellSize; canvas.height = rows * cellSize;

        const EMPTY = 0, HEAD = 1, TAIL = 2, WIRE = 3;
        let grid = new Uint8Array(cols * rows);

        // Create a simple oscillator circuit
        function init() {
            grid.fill(0);
            const cx = Math.floor(cols / 2), cy = Math.floor(rows / 2);

            // Horizontal wire
            for (let x = cx - 20; x <= cx + 20; x++) {
                grid[cy * cols + x] = WIRE;
            }

            // Vertical wires
            for (let y = cy - 10; y <= cy + 10; y++) {
                grid[y * cols + (cx - 10)] = WIRE;
                grid[y * cols + (cx + 10)] = WIRE;
            }

            // Top/bottom connectors
            for (let x = cx - 10; x <= cx + 10; x++) {
                grid[(cy - 10) * cols + x] = WIRE;
                grid[(cy + 10) * cols + x] = WIRE;
            }

            // Signal
            grid[cy * cols + (cx - 15)] = HEAD;
            grid[cy * cols + (cx - 14)] = TAIL;
        }

        function step() {
            const newGrid = new Uint8Array(cols * rows);
            for (let y = 0; y < rows; y++) {
                for (let x = 0; x < cols; x++) {
                    const idx = y * cols + x;
                    const current = grid[idx];

                    if (current === EMPTY) {
                        newGrid[idx] = EMPTY;
                    } else if (current === HEAD) {
                        newGrid[idx] = TAIL;
                    } else if (current === TAIL) {
                        newGrid[idx] = WIRE;
                    } else { // WIRE
                        let headCount = 0;
                        for (let dy = -1; dy <= 1; dy++) {
                            for (let dx = -1; dx <= 1; dx++) {
                                if (dx === 0 && dy === 0) continue;
                                const nx = x + dx, ny = y + dy;
                                if (nx >= 0 && nx < cols && ny >= 0 && ny < rows) {
                                    if (grid[ny * cols + nx] === HEAD) headCount++;
                                }
                            }
                        }
                        newGrid[idx] = (headCount === 1 || headCount === 2) ? HEAD : WIRE;
                    }
                }
            }
            grid = newGrid;
        }

        function render() {
            const colors = ['#000000', '#64ffda', '#ff6b6b', '#ffe66d'];
            for (let y = 0; y < rows; y++) {
                for (let x = 0; x < cols; x++) {
                    const state = grid[y * cols + x];
                    ctx.fillStyle = colors[state];
                    ctx.fillRect(x * cellSize, y * cellSize, cellSize, cellSize);
                }
            }
        }

        function animate() {
            step(); render();
            setTimeout(animate, 100);
        }

        init(); animate();
    </script>
</body>
</html>
