<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ballistic Deposition Fractal</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%); color: #e0e0e0; font-family: 'Segoe UI', sans-serif; overflow: hidden; }
        #canvas { display: block; background: #000000; }
        .controls { position: fixed; top: 20px; right: 20px; background: rgba(26, 26, 46, 0.95); padding: 20px; border-radius: 10px; min-width: 280px; }
        .info { position: fixed; top: 20px; left: 20px; background: rgba(26, 26, 46, 0.95); padding: 20px; border-radius: 10px; max-width: 300px; }
        h1 { font-size: 1.3em; margin-bottom: 10px; color: #64ffda; }
        h2 { font-size: 1em; margin-bottom: 15px; color: #64ffda; }
        .control-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; font-size: 0.9em; color: #b0b0b0; }
        input[type="range"] { width: 100%; }
        .value { font-size: 0.85em; color: #64ffda; }
        button { width: 100%; padding: 10px; margin: 10px 0; background: #667eea; color: white; border: none; border-radius: 5px; cursor: pointer; }
        button:hover { background: #764ba2; }
        .info p { font-size: 0.85em; line-height: 1.6; margin-bottom: 10px; color: #c0c0c0; }
    </style>
</head>
<body>
    <div class="info">
        <h1>Ballistic Deposition</h1>
        <p>Particles fall vertically and stick where they first contact the surface. Models thin film growth, powder deposition, and surface roughening.</p>
        <p>Creates columnar structures with self-affine fractal roughness.</p>
    </div>
    <div class="controls">
        <h2>Deposition Parameters</h2>
        <div class="control-group">
            <label>Deposition Rate: <span class="value" id="rateValue">10</span></label>
            <input type="range" id="rateSlider" min="1" max="50" step="1" value="10">
        </div>
        <div class="control-group">
            <label>Lateral Relaxation: <span class="value" id="relaxValue">Yes</span></label>
            <input type="range" id="relaxSlider" min="0" max="1" step="1" value="1">
        </div>
        <button id="resetBtn">Reset</button>
        <button id="pauseBtn">Pause</button>
    </div>
    <canvas id="canvas"></canvas>
    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        const cols = 400;
        const cellWidth = canvas.width / cols;
        let depositionRate = 10, relaxation = true, paused = false;
        let heights = new Array(cols).fill(0);
        let maxHeight = 0;

        function init() {
            heights = new Array(cols).fill(0);
            maxHeight = 0;
            ctx.fillStyle = '#000000';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
        }

        function depositParticle() {
            const col = Math.floor(Math.random() * cols);
            let targetHeight = heights[col];

            if (relaxation) {
                const left = col > 0 ? heights[col - 1] : Infinity;
                const right = col < cols - 1 ? heights[col + 1] : Infinity;
                const minNeighbor = Math.min(left, right);
                if (minNeighbor < targetHeight) {
                    targetHeight = minNeighbor;
                }
            }

            heights[col] = targetHeight + 1;
            maxHeight = Math.max(maxHeight, heights[col]);

            const y = canvas.height - heights[col] * cellWidth;
            const hue = (heights[col] / maxHeight) * 240 + 180;
            ctx.fillStyle = `hsl(${hue}, 100%, 60%)`;
            ctx.fillRect(col * cellWidth, y, cellWidth + 1, cellWidth + 1);
        }

        function animate() {
            if (!paused && maxHeight * cellWidth < canvas.height * 0.9) {
                for (let i = 0; i < depositionRate; i++) {
                    depositParticle();
                }
            }
            requestAnimationFrame(animate);
        }

        document.getElementById('rateSlider').addEventListener('input', (e) => {
            depositionRate = parseInt(e.target.value);
            document.getElementById('rateValue').textContent = depositionRate;
        });
        document.getElementById('relaxSlider').addEventListener('input', (e) => {
            relaxation = e.target.value === '1';
            document.getElementById('relaxValue').textContent = relaxation ? 'Yes' : 'No';
        });
        document.getElementById('resetBtn').addEventListener('click', init);
        document.getElementById('pauseBtn').addEventListener('click', (e) => {
            paused = !paused; e.target.textContent = paused ? 'Resume' : 'Pause';
        });

        init(); animate();
    </script>
</body>
</html>
