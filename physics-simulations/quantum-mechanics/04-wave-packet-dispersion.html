<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Gaussian Wave Packet Dispersion</title>
    <style>
        * { margin: 0; padding: 0; }
        body { background: #000; color: #e0e0e0; font-family: sans-serif; overflow: hidden; }
        #canvas { display: block; }
        .info { position: fixed; top: 20px; left: 20px; background: rgba(26, 26, 46, 0.95); padding: 20px; border-radius: 10px; max-width: 300px; }
        h1 { font-size: 1.3em; color: #64ffda; margin-bottom: 10px; }
        p { font-size: 0.85em; color: #c0c0c0; line-height: 1.6; }
    </style>
</head>
<body>
    <div class="info">
        <h1>Wave Packet Dispersion</h1>
        <p>Free Gaussian wave packet spreads over time due to uncertainty principle. Demonstrates wave-particle duality.</p>
    </div>
    <canvas id="canvas"></canvas>
    <script>
        const canvas = document.getElementById('canvas'), ctx = canvas.getContext('2d');
        const N = 256; canvas.width = N * 2; canvas.height = 300;

        let psi_r = new Float32Array(N), psi_i = new Float32Array(N);
        let time = 0;

        function init() {
            const x0 = N / 2, sigma = 15, k0 = 0.5;
            for (let x = 0; x < N; x++) {
                const amp = Math.exp(-((x - x0) ** 2) / (2 * sigma ** 2));
                psi_r[x] = amp * Math.cos(k0 * (x - x0));
                psi_i[x] = amp * Math.sin(k0 * (x - x0));
            }
            time = 0;
        }

        function step() {
            const new_r = new Float32Array(N), new_i = new Float32Array(N);
            const dt = 0.1, hbar = 1, m = 1;

            for (let x = 1; x < N - 1; x++) {
                const lap_r = psi_r[x - 1] + psi_r[x + 1] - 2 * psi_r[x];
                const lap_i = psi_i[x - 1] + psi_i[x + 1] - 2 * psi_i[x];

                new_r[x] = psi_r[x] + (dt / hbar) * (hbar ** 2 / (2 * m)) * lap_i;
                new_i[x] = psi_i[x] - (dt / hbar) * (hbar ** 2 / (2 * m)) * lap_r;
            }

            psi_r = new_r; psi_i = new_i;
            time += dt;
        }

        function render() {
            ctx.fillStyle = '#000';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            const centerY = canvas.height / 2;

            // Probability density
            ctx.fillStyle = '#64ffda40';
            ctx.beginPath();
            ctx.moveTo(0, centerY);
            for (let x = 0; x < N; x++) {
                const prob = psi_r[x] ** 2 + psi_i[x] ** 2;
                ctx.lineTo(x * 2, centerY - prob * 3000);
            }
            ctx.lineTo(canvas.width, centerY);
            ctx.closePath();
            ctx.fill();

            // Real part
            ctx.strokeStyle = '#ff6b6b';
            ctx.lineWidth = 2;
            ctx.beginPath();
            for (let x = 0; x < N; x++) {
                const y = centerY - psi_r[x] * 200;
                x === 0 ? ctx.moveTo(x * 2, y) : ctx.lineTo(x * 2, y);
            }
            ctx.stroke();

            // Imaginary part
            ctx.strokeStyle = '#4ecdc4';
            ctx.lineWidth = 2;
            ctx.beginPath();
            for (let x = 0; x < N; x++) {
                const y = centerY - psi_i[x] * 200;
                x === 0 ? ctx.moveTo(x * 2, y) : ctx.lineTo(x * 2, y);
            }
            ctx.stroke();

            // Center line
            ctx.strokeStyle = '#3a3a4a';
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.moveTo(0, centerY);
            ctx.lineTo(canvas.width, centerY);
            ctx.stroke();
        }

        function animate() {
            for (let i = 0; i < 3; i++) step();
            render();
            if (time > 50) init();
            requestAnimationFrame(animate);
        }
        init(); animate();
    </script>
</body>
</html>
