<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Silencing Illusion</title>
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body { background: #1a1a2e; overflow: hidden; font-family: 'Segoe UI', Tahoma, sans-serif; }
canvas { display: block; }
a { position: fixed; top: 20px; left: 20px; color: #8af; text-decoration: none; z-index: 100; font-size: 1.2em; }
#controls {
  position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%);
  background: rgba(20,20,40,0.85); backdrop-filter: blur(10px);
  padding: 18px 24px; border-radius: 14px; color: #ccd; z-index: 100;
  display: flex; flex-wrap: wrap; gap: 14px; align-items: center; max-width: 850px;
  border: 1px solid rgba(255,255,255,0.08);
}
#controls label { font-size: 0.85em; display: flex; align-items: center; gap: 6px; }
#controls input[type=range] { width: 90px; accent-color: #8af; }
#controls select { background: rgba(60,60,100,0.6); color: #ccd; border: 1px solid rgba(255,255,255,0.15); padding: 4px 8px; border-radius: 6px; font-size: 0.82em; }
button {
  background: rgba(100,140,255,0.2); color: #8af; border: 1px solid rgba(100,140,255,0.3);
  padding: 6px 14px; border-radius: 8px; cursor: pointer; font-size: 0.85em;
}
button:hover { background: rgba(100,140,255,0.35); }
button.active { background: rgba(100,255,140,0.2); color: #8fa; border-color: rgba(100,255,140,0.3); }
#info {
  position: fixed; top: 20px; right: 20px; background: rgba(20,20,40,0.85);
  backdrop-filter: blur(10px); padding: 16px 20px; border-radius: 12px;
  color: #aab; font-size: 0.82em; max-width: 320px; z-index: 100; line-height: 1.5;
  border: 1px solid rgba(255,255,255,0.08);
}
#info strong { color: #dde; }
#label-left, #label-right {
  position: fixed; top: 50%; transform: translateY(-50%);
  color: rgba(200,200,220,0.5); font-size: 0.9em; z-index: 50;
  pointer-events: none;
}
#label-left { left: calc(25% - 60px); }
#label-right { right: calc(25% - 60px); }
</style>
</head>
<body>
<a href="index.html">&#8592; Back</a>
<canvas id="c"></canvas>

<div id="label-left">STATIONARY<br><span style="font-size:0.8em;color:rgba(100,255,140,0.5)">Changes visible</span></div>
<div id="label-right">ROTATING<br><span style="font-size:0.8em;color:rgba(255,100,100,0.5)">Changes silenced!</span></div>

<div id="info">
  <strong>Silencing Illusion</strong> (Suchow & Alvarez, 2011)<br><br>
  When objects move coherently, the visual system "freezes" their features. This suggests global motion signals override local change detection - a fundamental limit of awareness.<br><br>
  <strong>Tip:</strong> Press "Freeze!" to stop the rotation and see the changes appear instantly.
</div>

<div id="controls">
  <label>Rotation <input type="range" id="rotSpeed" min="0" max="100" value="50"> <span id="rotVal">50</span></label>
  <label>Color speed <input type="range" id="colorSpeed" min="1" max="20" value="8"></label>
  <label>Dots <input type="range" id="numDots" min="6" max="30" value="16"></label>
  <label>Dot size <input type="range" id="dotSize" min="8" max="40" value="20"></label>
  <label>Change <select id="changeType">
    <option value="color">Color (Hue)</option>
    <option value="size">Size</option>
    <option value="brightness">Brightness</option>
  </select></label>
  <button id="btnFreeze">Freeze!</button>
  <button id="btnSplit" class="active">Split View</button>
</div>

<script>
const canvas = document.getElementById('c');
const ctx = canvas.getContext('2d');
let W, H;

let rotSpeed = 50;
let colorSpeedVal = 8;
let numDots = 16;
let dotSize = 20;
let changeType = 'color';
let frozen = false;
let splitView = true;
let rotAngle = 0;

// Each dot has its own phase offset for change
let dotPhases = [];

function initDots() {
  dotPhases = [];
  for (let i = 0; i < 30; i++) {
    dotPhases.push(Math.random() * Math.PI * 2);
  }
}

function resize() {
  W = canvas.width = window.innerWidth;
  H = canvas.height = window.innerHeight;
}

function drawRing(cx, cy, radius, rotation, t) {
  const angleStep = (Math.PI * 2) / numDots;

  for (let i = 0; i < numDots; i++) {
    const baseAngle = i * angleStep;
    const angle = baseAngle + rotation;
    const x = cx + Math.cos(angle) * radius;
    const y = cy + Math.sin(angle) * radius;
    const phase = dotPhases[i % dotPhases.length];
    const changeT = t * colorSpeedVal * 0.3 + phase;

    let color, size;

    if (changeType === 'color') {
      const hue = (changeT * 60) % 360;
      color = `hsl(${hue}, 85%, 55%)`;
      size = dotSize;
    } else if (changeType === 'size') {
      const s = 0.5 + 0.5 * Math.sin(changeT * 2);
      size = dotSize * (0.4 + s * 0.8);
      color = `hsl(${(i / numDots) * 360}, 80%, 55%)`;
    } else { // brightness
      const b = 30 + 40 * Math.sin(changeT * 2);
      color = `hsl(200, 70%, ${b}%)`;
      size = dotSize;
    }

    ctx.beginPath();
    ctx.arc(x, y, size, 0, Math.PI * 2);
    ctx.fillStyle = color;
    ctx.fill();
  }

  // Center fixation
  ctx.beginPath();
  ctx.arc(cx, cy, 4, 0, Math.PI * 2);
  ctx.fillStyle = '#ff4444';
  ctx.fill();
}

let lastTime = 0;

function animate(time) {
  const dt = (time - lastTime) / 1000;
  lastTime = time;
  const t = time / 1000;

  if (!frozen) {
    rotAngle += dt * rotSpeed * 0.03;
  }

  ctx.fillStyle = '#1a1a2e';
  ctx.fillRect(0, 0, W, H);

  if (splitView) {
    // Draw divider
    ctx.strokeStyle = 'rgba(200,200,220,0.1)';
    ctx.lineWidth = 1;
    ctx.setLineDash([5, 5]);
    ctx.beginPath();
    ctx.moveTo(W/2, 0);
    ctx.lineTo(W/2, H);
    ctx.stroke();
    ctx.setLineDash([]);

    const radius = Math.min(W * 0.2, H * 0.3);

    // Left ring: stationary (changes visible)
    drawRing(W * 0.25, H * 0.45, radius, 0, t);

    // Right ring: rotating (changes silenced)
    drawRing(W * 0.75, H * 0.45, radius, rotAngle, t);

    // Show labels
    document.getElementById('label-left').style.display = 'block';
    document.getElementById('label-right').style.display = 'block';
  } else {
    const radius = Math.min(W * 0.3, H * 0.35);
    drawRing(W/2, H * 0.45, radius, rotAngle, t);
    document.getElementById('label-left').style.display = 'none';
    document.getElementById('label-right').style.display = 'none';
  }

  requestAnimationFrame(animate);
}

document.getElementById('rotSpeed').addEventListener('input', e => {
  rotSpeed = parseInt(e.target.value);
  document.getElementById('rotVal').textContent = rotSpeed;
});

document.getElementById('colorSpeed').addEventListener('input', e => {
  colorSpeedVal = parseInt(e.target.value);
});

document.getElementById('numDots').addEventListener('input', e => {
  numDots = parseInt(e.target.value);
});

document.getElementById('dotSize').addEventListener('input', e => {
  dotSize = parseInt(e.target.value);
});

document.getElementById('changeType').addEventListener('change', e => {
  changeType = e.target.value;
});

document.getElementById('btnFreeze').addEventListener('click', () => {
  frozen = !frozen;
  const btn = document.getElementById('btnFreeze');
  btn.textContent = frozen ? 'Resume' : 'Freeze!';
  btn.classList.toggle('active', frozen);
});

document.getElementById('btnSplit').addEventListener('click', () => {
  splitView = !splitView;
  const btn = document.getElementById('btnSplit');
  btn.textContent = splitView ? 'Split View' : 'Single Ring';
  btn.classList.toggle('active', splitView);
});

window.reset = function() {
  rotSpeed = 50;
  colorSpeedVal = 8;
  numDots = 16;
  dotSize = 20;
  changeType = 'color';
  frozen = false;
  splitView = true;
  rotAngle = 0;
  document.getElementById('rotSpeed').value = 50;
  document.getElementById('rotVal').textContent = '50';
  document.getElementById('colorSpeed').value = 8;
  document.getElementById('numDots').value = 16;
  document.getElementById('dotSize').value = 20;
  document.getElementById('changeType').value = 'color';
  document.getElementById('btnFreeze').textContent = 'Freeze!';
  document.getElementById('btnFreeze').classList.remove('active');
  document.getElementById('btnSplit').textContent = 'Split View';
  document.getElementById('btnSplit').classList.add('active');
  initDots();
};

let resizeTimer;
window.addEventListener('resize', () => {
  clearTimeout(resizeTimer);
  resizeTimer = setTimeout(resize, 150);
});

initDots();
resize();
requestAnimationFrame(animate);
</script>
<script src="../assets/js/enhance.js"></script>
</body>
</html>