<!DOCTYPE html>
<html><head><meta charset="UTF-8"><title>Crowd - Pathfinding Agents</title>
<style>body{margin:0;overflow:hidden;background:#1a1a1a;display:flex;justify-content:center;align-items:center;height:100vh}canvas{border:2px solid#333;cursor:pointer}.info{position:absolute;top:20px;left:20px;color:white;background:rgba(0,0,0,0.8);padding:15px;border-radius:8px;font-family:Arial}</style></head>
<body><div class="info">Click to add obstacles</div><canvas id="c"></canvas><script>
const c=document.getElementById('c'),ctx=c.getContext('2d');c.width=800;c.height=600;
const obstacles=[{x:300,y:200,r:40},{x:500,y:400,r:50},{x:400,y:300,r:30}];
c.addEventListener('click',e=>{const rect=c.getBoundingClientRect();obstacles.push({x:e.clientX-rect.left,y:e.clientY-rect.top,r:20+Math.random()*40})});
class Agent{constructor(x,y,targetX,targetY){this.x=x;this.y=y;this.targetX=targetX;this.targetY=targetY;this.vx=0;this.vy=0;this.speed=2;this.arrived=false}
update(){if(this.arrived)return;
let desiredX=this.targetX-this.x,desiredY=this.targetY-this.y;const dist=Math.sqrt(desiredX**2+desiredY**2);if(dist<5){this.arrived=true;return}
desiredX/=dist;desiredY/=dist;
for(const obs of obstacles){const dx=this.x-obs.x,dy=this.y-obs.y,d=Math.sqrt(dx**2+dy**2);if(d<obs.r+30){const avoidX=dx/d,avoidY=dy/d,strength=(obs.r+30-d)/30;desiredX+=avoidX*strength*2;desiredY+=avoidY*strength*2}}
const mag=Math.sqrt(desiredX**2+desiredY**2);if(mag>0){desiredX=desiredX/mag*this.speed;desiredY=desiredY/mag*this.speed}
this.vx+=(desiredX-this.vx)*0.1;this.vy+=(desiredY-this.vy)*0.1;this.x+=this.vx;this.y+=this.vy}
draw(){ctx.fillStyle=this.arrived?'#4CAF50':'#2196F3';ctx.beginPath();ctx.arc(this.x,this.y,5,0,Math.PI*2);ctx.fill();
if(!this.arrived){ctx.strokeStyle='rgba(33,150,243,0.3)';ctx.lineWidth=1;ctx.beginPath();ctx.moveTo(this.x,this.y);ctx.lineTo(this.targetX,this.targetY);ctx.stroke()}}}
const agents=[];for(let i=0;i<30;i++){const angle=i/30*Math.PI*2,r=100;agents.push(new Agent(c.width/2+Math.cos(angle)*r,c.height/2+Math.sin(angle)*r,c.width/2+Math.cos(angle+Math.PI)*r,c.height/2+Math.sin(angle+Math.PI)*r))}
function animate(){ctx.fillStyle='rgba(26,26,26,0.3)';ctx.fillRect(0,0,c.width,c.height);
for(const obs of obstacles){ctx.fillStyle='#666';ctx.beginPath();ctx.arc(obs.x,obs.y,obs.r,0,Math.PI*2);ctx.fill()}
for(const a of agents){a.update();a.draw()}
requestAnimationFrame(animate)}
animate();
</script></body></html>
