<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Graphene Properties</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, sans-serif; background: #1a1a2e; color: #e8e6e1; overflow: hidden; }
        #container { display: flex; height: 100vh; }
        #canvas-container { flex: 1; position: relative; }
        canvas { display: block; width: 100%; height: 100%; }
        #controls { width: 320px; background: rgba(0,0,0,0.8); padding: 20px; overflow-y: auto; }
        h1 { font-size: 1.2rem; margin-bottom: 10px; color: #616161; }
        .description { font-size: 0.75rem; color: #888; margin-bottom: 15px; line-height: 1.4; }
        .control-group { margin-bottom: 15px; }
        label { display: block; font-size: 0.8rem; margin-bottom: 5px; color: #aaa; }
        input[type="range"] { width: 100%; }
        button { width: 100%; padding: 10px; margin-bottom: 8px; background: #616161; color: #fff; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; }
        button.active { background: #9e9e9e; }
        .stats { background: rgba(255,255,255,0.1); padding: 10px; border-radius: 5px; font-size: 0.75rem; margin-top: 10px; }
        .back-link { position: fixed; top: 10px; left: 10px; padding: 8px 16px; background: rgba(0,0,0,0.7); color: #616161; text-decoration: none; border-radius: 6px; font-size: 14px; z-index: 999; }
    </style>
</head>
<body>
    <a href="index.html" class="back-link">← Back to Gallery</a>
    <div id="container">
        <div id="canvas-container"><canvas id="canvas"></canvas></div>
        <div id="controls">
            <h1>Graphene Properties</h1>
            <p class="description">Graphene is a single layer of carbon atoms in a honeycomb lattice. It exhibits extraordinary electronic (Dirac fermions), mechanical (Young's modulus ~1 TPa), and thermal properties.</p>

            <div class="control-group">
                <label>Strain (%): <span id="strainVal">0</span></label>
                <input type="range" id="strain" min="0" max="25" step="0.5" value="0">
            </div>

            <div class="control-group">
                <label>Temperature (K): <span id="tempVal">300</span></label>
                <input type="range" id="temperature" min="10" max="600" value="300">
            </div>

            <div class="control-group">
                <label>Defect Density (%): <span id="defectVal">0</span></label>
                <input type="range" id="defects" min="0" max="10" step="0.5" value="0">
            </div>

            <button id="showElectronic">Show Electronic Properties</button>
            <button id="showMechanical">Show Mechanical Properties</button>
            <button id="showPhonon">Show Phonon Dispersion</button>
            <button id="reset">Reset</button>

            <div class="stats">
                <div>Lattice Constant: <span id="latticeConst">2.46</span> Å</div>
                <div>Young's Modulus: <span id="youngsModulus">1000</span> GPa</div>
                <div>Carrier Mobility: <span id="mobility">200000</span> cm²/Vs</div>
                <div>Thermal Conductivity: <span id="thermal">5000</span> W/mK</div>
            </div>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');

        let width, height;
        let strain = 0;
        let temperature = 300;
        let defectDensity = 0;
        let viewMode = 'lattice';

        let atoms = [];
        let bonds = [];
        let defects = new Set();
        let time = 0;

        const a = 1.42; // C-C bond length in Angstroms
        const SCALE = 25; // pixels per Angstrom

        function resize() {
            const container = document.getElementById('canvas-container');
            width = container.clientWidth;
            height = container.clientHeight;
            canvas.width = width;
            canvas.height = height;
        }

        function init() {
            resize();
            atoms = [];
            bonds = [];
            defects.clear();

            // Create honeycomb lattice
            const latticeConst = a * Math.sqrt(3); // 2.46 Angstroms
            const cols = Math.floor(width / (SCALE * latticeConst)) + 2;
            const rows = Math.floor(height / (SCALE * 1.5 * a)) + 2;

            const offsetX = (width - cols * SCALE * latticeConst) / 2 + 100;
            const offsetY = (height - rows * SCALE * 1.5 * a) / 2 + 50;

            let idx = 0;
            for (let row = 0; row < rows; row++) {
                for (let col = 0; col < cols; col++) {
                    const x = col * latticeConst * SCALE + offsetX;
                    const y = row * 1.5 * a * SCALE + offsetY;

                    // Two atoms per unit cell (A and B sublattice)
                    atoms.push({
                        id: idx++,
                        x: x,
                        y: y,
                        x0: x,
                        y0: y,
                        sublattice: 'A',
                        col, row
                    });

                    atoms.push({
                        id: idx++,
                        x: x + latticeConst * SCALE / 2,
                        y: y + a * SCALE / 2,
                        x0: x + latticeConst * SCALE / 2,
                        y0: y + a * SCALE / 2,
                        sublattice: 'B',
                        col, row
                    });
                }
            }

            // Create bonds
            for (let i = 0; i < atoms.length; i++) {
                for (let j = i + 1; j < atoms.length; j++) {
                    const dx = atoms[i].x0 - atoms[j].x0;
                    const dy = atoms[i].y0 - atoms[j].y0;
                    const dist = Math.sqrt(dx * dx + dy * dy);

                    if (dist < a * SCALE * 1.2) {
                        bonds.push({ i, j });
                    }
                }
            }

            // Add defects
            updateDefects();
            updateStats();
        }

        function updateDefects() {
            defects.clear();
            const numDefects = Math.floor(atoms.length * defectDensity / 100);
            while (defects.size < numDefects) {
                defects.add(Math.floor(Math.random() * atoms.length));
            }
        }

        function applyStrain() {
            const strainFactor = 1 + strain / 100;
            const centerX = width / 2;
            const centerY = height / 2;

            for (const atom of atoms) {
                if (defects.has(atom.id)) continue;

                // Apply uniaxial strain along x-direction
                atom.x = centerX + (atom.x0 - centerX) * strainFactor;
                // Poisson contraction
                const poisson = 0.16; // Graphene Poisson ratio
                atom.y = centerY + (atom.y0 - centerY) * (1 - poisson * strain / 100);
            }
        }

        function applyThermalVibrations() {
            const amplitude = Math.sqrt(temperature) * 0.02;
            for (const atom of atoms) {
                if (defects.has(atom.id)) continue;
                atom.x += (Math.random() - 0.5) * amplitude;
                atom.y += (Math.random() - 0.5) * amplitude;
            }
        }

        function draw() {
            ctx.fillStyle = '#1a1a2e';
            ctx.fillRect(0, 0, width, height);

            time += 0.02;

            applyStrain();
            applyThermalVibrations();

            if (viewMode === 'lattice' || viewMode === 'mechanical') {
                drawLattice();
            }

            if (viewMode === 'electronic') {
                drawElectronicBands();
            }

            if (viewMode === 'phonon') {
                drawPhononDispersion();
            }

            if (viewMode === 'mechanical') {
                drawStressField();
            }

            updateStats();
        }

        function drawLattice() {
            // Draw bonds
            ctx.lineWidth = 2;
            for (const bond of bonds) {
                if (defects.has(bond.i) || defects.has(bond.j)) continue;

                const a1 = atoms[bond.i];
                const a2 = atoms[bond.j];

                // Color based on bond strain
                const dx = a2.x - a1.x;
                const dy = a2.y - a1.y;
                const dist = Math.sqrt(dx * dx + dy * dy);
                const bondStrain = (dist - a * SCALE) / (a * SCALE);

                if (bondStrain > 0.1) {
                    ctx.strokeStyle = '#f44336'; // Stretched
                } else if (bondStrain < -0.05) {
                    ctx.strokeStyle = '#2196f3'; // Compressed
                } else {
                    ctx.strokeStyle = 'rgba(150, 150, 150, 0.6)';
                }

                ctx.beginPath();
                ctx.moveTo(a1.x, a1.y);
                ctx.lineTo(a2.x, a2.y);
                ctx.stroke();
            }

            // Draw atoms
            for (const atom of atoms) {
                if (defects.has(atom.id)) {
                    // Vacancy defect
                    ctx.fillStyle = 'rgba(244, 67, 54, 0.5)';
                    ctx.beginPath();
                    ctx.arc(atom.x, atom.y, 4, 0, Math.PI * 2);
                    ctx.fill();
                    continue;
                }

                // Color by sublattice
                ctx.fillStyle = atom.sublattice === 'A' ? '#424242' : '#757575';

                ctx.beginPath();
                ctx.arc(atom.x, atom.y, 5, 0, Math.PI * 2);
                ctx.fill();

                // Electron cloud visualization
                if (viewMode === 'electronic') {
                    ctx.fillStyle = 'rgba(33, 150, 243, 0.2)';
                    ctx.beginPath();
                    ctx.arc(atom.x, atom.y, 12, 0, Math.PI * 2);
                    ctx.fill();
                }
            }
        }

        function drawElectronicBands() {
            // Draw Dirac cone in corner
            const cx = width - 150;
            const cy = 150;
            const size = 100;

            ctx.strokeStyle = '#2196f3';
            ctx.lineWidth = 2;

            // Upper cone (conduction band)
            ctx.beginPath();
            ctx.moveTo(cx - size, cy - size);
            ctx.lineTo(cx, cy);
            ctx.lineTo(cx + size, cy - size);
            ctx.stroke();

            // Lower cone (valence band)
            ctx.beginPath();
            ctx.moveTo(cx - size, cy + size);
            ctx.lineTo(cx, cy);
            ctx.lineTo(cx + size, cy + size);
            ctx.stroke();

            // Fermi level
            ctx.strokeStyle = '#ff9800';
            ctx.setLineDash([5, 5]);
            ctx.beginPath();
            ctx.moveTo(cx - size - 20, cy);
            ctx.lineTo(cx + size + 20, cy);
            ctx.stroke();
            ctx.setLineDash([]);

            // Labels
            ctx.fillStyle = '#fff';
            ctx.font = '12px sans-serif';
            ctx.fillText('E', cx - size - 30, cy - size + 10);
            ctx.fillText('k', cx + size + 10, cy + 5);
            ctx.fillText('Dirac Point (K)', cx - 40, cy + size + 20);
            ctx.fillText('EF', cx + size + 10, cy - 5);

            // Band gap from strain
            if (strain > 10) {
                ctx.fillStyle = 'rgba(255, 152, 0, 0.3)';
                ctx.fillRect(cx - 30, cy - 5, 60, 10);
                ctx.fillStyle = '#ff9800';
                ctx.fillText('Gap opens!', cx - 30, cy + size + 35);
            }
        }

        function drawPhononDispersion() {
            const cx = width - 150;
            const cy = height - 150;
            const w = 200;
            const h = 100;

            // Axes
            ctx.strokeStyle = '#666';
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.moveTo(cx - w/2, cy + h/2);
            ctx.lineTo(cx + w/2, cy + h/2);
            ctx.lineTo(cx + w/2, cy - h/2);
            ctx.stroke();

            // Phonon branches
            ctx.lineWidth = 2;

            // Acoustic branches (LA, TA, ZA)
            ctx.strokeStyle = '#4caf50';
            ctx.beginPath();
            ctx.moveTo(cx - w/2, cy + h/2);
            ctx.quadraticCurveTo(cx, cy, cx + w/2, cy - h/4);
            ctx.stroke();

            ctx.strokeStyle = '#8bc34a';
            ctx.beginPath();
            ctx.moveTo(cx - w/2, cy + h/2);
            ctx.quadraticCurveTo(cx - w/4, cy + h/4, cx + w/2, cy);
            ctx.stroke();

            ctx.strokeStyle = '#cddc39';
            ctx.beginPath();
            ctx.moveTo(cx - w/2, cy + h/2);
            ctx.quadraticCurveTo(cx, cy + h/3, cx + w/2, cy + h/4);
            ctx.stroke();

            // Optical branches (LO, TO, ZO)
            ctx.strokeStyle = '#2196f3';
            ctx.beginPath();
            ctx.moveTo(cx - w/2, cy - h/3);
            ctx.quadraticCurveTo(cx, cy - h/2.5, cx + w/2, cy - h/2.5);
            ctx.stroke();

            ctx.fillStyle = '#fff';
            ctx.font = '11px sans-serif';
            ctx.fillText('ω', cx - w/2 - 20, cy - h/2);
            ctx.fillText('Γ', cx - w/2, cy + h/2 + 15);
            ctx.fillText('K', cx, cy + h/2 + 15);
            ctx.fillText('M', cx + w/2, cy + h/2 + 15);
            ctx.fillText('Phonon Dispersion', cx - 50, cy - h/2 - 10);
        }

        function drawStressField() {
            // Stress distribution visualization
            if (strain > 0) {
                ctx.fillStyle = '#616161';
                ctx.font = '14px sans-serif';
                ctx.textAlign = 'center';
                ctx.fillText(`Applied Stress: ${(strain * 10).toFixed(0)} GPa`, width / 2, 30);
                ctx.fillText(`Strain: ${strain.toFixed(1)}%`, width / 2, 50);

                // Arrows showing tension
                ctx.strokeStyle = '#f44336';
                ctx.lineWidth = 2;

                // Left arrow
                ctx.beginPath();
                ctx.moveTo(50, height / 2);
                ctx.lineTo(20, height / 2);
                ctx.moveTo(30, height / 2 - 10);
                ctx.lineTo(20, height / 2);
                ctx.lineTo(30, height / 2 + 10);
                ctx.stroke();

                // Right arrow
                ctx.beginPath();
                ctx.moveTo(width - 50, height / 2);
                ctx.lineTo(width - 20, height / 2);
                ctx.moveTo(width - 30, height / 2 - 10);
                ctx.lineTo(width - 20, height / 2);
                ctx.lineTo(width - 30, height / 2 + 10);
                ctx.stroke();

                ctx.textAlign = 'left';
            }
        }

        function updateStats() {
            // Calculate properties based on strain and defects
            const latticeStrain = 2.46 * (1 + strain / 100);
            const mobilityReduction = Math.exp(-defectDensity / 2);
            const thermalReduction = Math.exp(-defectDensity / 3) * (1 - strain / 50);

            // Young's modulus (decreases with strain approaching failure)
            const youngsModulus = strain > 20 ? 0 : 1000 * (1 - Math.pow(strain / 25, 2));

            // Carrier mobility (affected by defects and temperature)
            const mobility = 200000 * mobilityReduction * (300 / temperature);

            // Thermal conductivity
            const thermal = 5000 * thermalReduction * Math.sqrt(300 / temperature);

            document.getElementById('latticeConst').textContent = latticeStrain.toFixed(2);
            document.getElementById('youngsModulus').textContent = youngsModulus.toFixed(0);
            document.getElementById('mobility').textContent = mobility.toFixed(0);
            document.getElementById('thermal').textContent = thermal.toFixed(0);
        }

        function animate() {
            draw();
            requestAnimationFrame(animate);
        }

        document.getElementById('strain').addEventListener('input', e => {
            strain = parseFloat(e.target.value);
            document.getElementById('strainVal').textContent = strain;
        });

        document.getElementById('temperature').addEventListener('input', e => {
            temperature = parseInt(e.target.value);
            document.getElementById('tempVal').textContent = temperature;
        });

        document.getElementById('defects').addEventListener('input', e => {
            defectDensity = parseFloat(e.target.value);
            document.getElementById('defectVal').textContent = defectDensity;
            updateDefects();
        });

        document.getElementById('showElectronic').addEventListener('click', () => {
            viewMode = viewMode === 'electronic' ? 'lattice' : 'electronic';
            document.querySelectorAll('button').forEach(b => b.classList.remove('active'));
            if (viewMode === 'electronic') document.getElementById('showElectronic').classList.add('active');
        });

        document.getElementById('showMechanical').addEventListener('click', () => {
            viewMode = viewMode === 'mechanical' ? 'lattice' : 'mechanical';
            document.querySelectorAll('button').forEach(b => b.classList.remove('active'));
            if (viewMode === 'mechanical') document.getElementById('showMechanical').classList.add('active');
        });

        document.getElementById('showPhonon').addEventListener('click', () => {
            viewMode = viewMode === 'phonon' ? 'lattice' : 'phonon';
            document.querySelectorAll('button').forEach(b => b.classList.remove('active'));
            if (viewMode === 'phonon') document.getElementById('showPhonon').classList.add('active');
        });

        document.getElementById('reset').addEventListener('click', () => {
            strain = 0;
            temperature = 300;
            defectDensity = 0;
            document.getElementById('strain').value = 0;
            document.getElementById('temperature').value = 300;
            document.getElementById('defects').value = 0;
            document.getElementById('strainVal').textContent = '0';
            document.getElementById('tempVal').textContent = '300';
            document.getElementById('defectVal').textContent = '0';
            viewMode = 'lattice';
            document.querySelectorAll('button').forEach(b => b.classList.remove('active'));
            init();
        });

        window.addEventListener('resize', init);

        init();
        animate();
    </script>
</body>
</html>
