<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gallery Overview - Jensen Linkage - CCAB</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            background: #0a0a15;
        }
        #canvas { display: block; }
        .back-link {
            position: fixed;
            top: 10px;
            left: 10px;
            padding: 8px 16px;
            background: rgba(0, 0, 0, 0.7);
            color: #fbbf24;
            text-decoration: none;
            border-radius: 6px;
            font-size: 14px;
            z-index: 999;
        }
        .title {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            color: #fff;
            font-family: sans-serif;
            font-size: 16px;
            text-align: center;
        }
    </style>
</head>
<body>
    <a href="index.html" class="back-link">‚Üê Back to Gallery</a>
    <div class="title">Jensen Linkage Gallery - 16 Variations</div>
    <canvas id="canvas"></canvas>
    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');

        function resize() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }
        resize();
        window.addEventListener('resize', resize);

        let angle = 0;

        // Different linkage configurations
        const variations = [
            { crankLength: 30, upperLeg: 85, lowerLeg: 85, connectingRod: 70, crankPivotX: 22, crankPivotY: -14, phase: 0 },
            { crankLength: 40, upperLeg: 100, lowerLeg: 100, connectingRod: 85, crankPivotX: 28, crankPivotY: -18, phase: 0.5 },
            { crankLength: 25, upperLeg: 75, lowerLeg: 90, connectingRod: 60, crankPivotX: 18, crankPivotY: -12, phase: 1.0 },
            { crankLength: 35, upperLeg: 95, lowerLeg: 80, connectingRod: 75, crankPivotX: 25, crankPivotY: -16, phase: 1.5 },
            { crankLength: 45, upperLeg: 110, lowerLeg: 110, connectingRod: 95, crankPivotX: 32, crankPivotY: -20, phase: 2.0 },
            { crankLength: 28, upperLeg: 80, lowerLeg: 95, connectingRod: 65, crankPivotX: 20, crankPivotY: -13, phase: 2.5 },
            { crankLength: 38, upperLeg: 105, lowerLeg: 85, connectingRod: 80, crankPivotX: 27, crankPivotY: -17, phase: 3.0 },
            { crankLength: 32, upperLeg: 90, lowerLeg: 105, connectingRod: 72, crankPivotX: 23, crankPivotY: -15, phase: 3.5 },
            { crankLength: 42, upperLeg: 115, lowerLeg: 100, connectingRod: 90, crankPivotX: 30, crankPivotY: -19, phase: 4.0 },
            { crankLength: 27, upperLeg: 78, lowerLeg: 92, connectingRod: 62, crankPivotX: 19, crankPivotY: -12, phase: 4.5 },
            { crankLength: 36, upperLeg: 98, lowerLeg: 88, connectingRod: 78, crankPivotX: 26, crankPivotY: -16, phase: 5.0 },
            { crankLength: 33, upperLeg: 93, lowerLeg: 102, connectingRod: 74, crankPivotX: 24, crankPivotY: -15, phase: 5.5 },
            { crankLength: 29, upperLeg: 82, lowerLeg: 88, connectingRod: 66, crankPivotX: 21, crankPivotY: -13, phase: 0.3 },
            { crankLength: 37, upperLeg: 102, lowerLeg: 95, connectingRod: 82, crankPivotX: 27, crankPivotY: -17, phase: 0.8 },
            { crankLength: 31, upperLeg: 88, lowerLeg: 98, connectingRod: 70, crankPivotX: 22, crankPivotY: -14, phase: 1.3 },
            { crankLength: 39, upperLeg: 108, lowerLeg: 92, connectingRod: 86, crankPivotX: 28, crankPivotY: -18, phase: 1.8 }
        ];

        function solveJensen(l, angle) {
            const crankX = l.crankPivotX + Math.cos(angle) * l.crankLength;
            const crankY = l.crankPivotY + Math.sin(angle) * l.crankLength;
            const d = Math.sqrt(crankX * crankX + crankY * crankY);

            if (d > l.upperLeg + l.connectingRod || d < Math.abs(l.upperLeg - l.connectingRod)) return null;

            const cosa = (l.upperLeg * l.upperLeg + d * d - l.connectingRod * l.connectingRod) / (2 * l.upperLeg * d);
            const kneeAngle = Math.atan2(crankY, crankX) - Math.acos(Math.max(-1, Math.min(1, cosa)));
            const kneeX = Math.cos(kneeAngle) * l.upperLeg;
            const kneeY = Math.sin(kneeAngle) * l.upperLeg;
            const legAngle = Math.atan2(kneeY, kneeX);
            const footX = kneeX + Math.cos(legAngle + 0.25) * l.lowerLeg;
            const footY = kneeY + Math.sin(legAngle + 0.25) * l.lowerLeg;

            return { knee: { x: kneeX, y: kneeY }, foot: { x: footX, y: footY } };
        }

        function animate() {
            ctx.fillStyle = 'rgba(10, 10, 21, 0.2)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            const cols = 4;
            const rows = 4;
            const cellW = canvas.width / cols;
            const cellH = (canvas.height - 60) / rows;

            variations.forEach((l, i) => {
                const col = i % cols;
                const row = Math.floor(i / cols);
                const cx = cellW * (col + 0.5);
                const cy = cellH * (row + 0.5) + 20;

                const p = solveJensen(l, angle + l.phase);
                if (!p) return;

                const hue = (i / variations.length) * 360;

                ctx.save();
                ctx.translate(cx, cy);

                // Draw linkage
                ctx.strokeStyle = `hsla(${hue}, 70%, 50%, 0.8)`;
                ctx.lineWidth = 3;
                ctx.lineCap = 'round';

                ctx.beginPath();
                ctx.moveTo(0, 0);
                ctx.lineTo(p.knee.x, p.knee.y);
                ctx.lineTo(p.foot.x, p.foot.y);
                ctx.stroke();

                // Joints
                ctx.fillStyle = `hsl(${hue}, 80%, 60%)`;
                [[0, 0, 5], [p.knee.x, p.knee.y, 4], [p.foot.x, p.foot.y, 5]].forEach(([x, y, r]) => {
                    ctx.beginPath();
                    ctx.arc(x, y, r, 0, Math.PI * 2);
                    ctx.fill();
                });

                // Cell number
                ctx.fillStyle = 'rgba(255, 255, 255, 0.3)';
                ctx.font = '12px sans-serif';
                ctx.textAlign = 'center';
                ctx.fillText(`#${i + 1}`, 0, -cellH / 2 + 20);

                ctx.restore();
            });

            // Draw grid
            ctx.strokeStyle = 'rgba(255, 255, 255, 0.1)';
            ctx.lineWidth = 1;
            for (let i = 1; i < cols; i++) {
                ctx.beginPath();
                ctx.moveTo(cellW * i, 20);
                ctx.lineTo(cellW * i, canvas.height - 40);
                ctx.stroke();
            }
            for (let i = 1; i < rows; i++) {
                ctx.beginPath();
                ctx.moveTo(0, cellH * i + 20);
                ctx.lineTo(canvas.width, cellH * i + 20);
                ctx.stroke();
            }

            angle += 0.02;
            requestAnimationFrame(animate);
        }

        animate();
    </script>
</body>
</html>
