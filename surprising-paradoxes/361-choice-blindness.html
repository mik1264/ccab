<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Choice Blindness - Surprising Paradoxes</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            color: #e0e0e0;
            min-height: 100vh;
            padding: 20px;
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
        }

        h1 {
            font-size: 2.5rem;
            background: linear-gradient(135deg, #a29bfe, #6c5ce7);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
        }

        .subtitle {
            font-size: 1.2rem;
            color: #888;
        }

        .back-link {
            display: inline-block;
            color: #a29bfe;
            text-decoration: none;
            margin-bottom: 20px;
            transition: transform 0.3s;
        }

        .back-link:hover {
            transform: translateX(-5px);
        }

        .intro-panel {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .intro-panel h2 {
            color: #a29bfe;
            margin-bottom: 15px;
            font-size: 1.4rem;
        }

        .intro-panel p {
            color: #ccc;
        }

        .main-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
            margin-bottom: 25px;
        }

        @media (max-width: 900px) {
            .main-grid {
                grid-template-columns: 1fr;
            }
        }

        .panel {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .panel h3 {
            color: #6c5ce7;
            margin-bottom: 15px;
            font-size: 1.2rem;
        }

        .trial-display {
            text-align: center;
            margin-bottom: 20px;
        }

        .trial-counter {
            color: #888;
            margin-bottom: 15px;
        }

        .choice-pair {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-bottom: 20px;
        }

        .choice-card {
            width: 150px;
            height: 200px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            border: 3px solid transparent;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        .choice-card:hover {
            border-color: rgba(162, 155, 254, 0.5);
            transform: translateY(-5px);
        }

        .choice-card.selected {
            border-color: #a29bfe;
            box-shadow: 0 0 20px rgba(162, 155, 254, 0.3);
        }

        .choice-card.revealed-swap {
            border-color: #ff7675;
            box-shadow: 0 0 20px rgba(255, 118, 117, 0.3);
        }

        .choice-card.revealed-correct {
            border-color: #00b894;
            box-shadow: 0 0 20px rgba(0, 184, 148, 0.3);
        }

        .face-placeholder {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            margin-bottom: 10px;
        }

        .choice-label {
            color: #888;
            font-size: 0.9rem;
        }

        .swap-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #ff7675;
            color: #fff;
            padding: 3px 8px;
            border-radius: 10px;
            font-size: 0.7rem;
            display: none;
        }

        .swap-badge.visible {
            display: block;
        }

        .explanation-section {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            padding: 20px;
            display: none;
        }

        .explanation-section.visible {
            display: block;
        }

        .explanation-prompt {
            color: #a29bfe;
            margin-bottom: 15px;
            text-align: center;
        }

        .chosen-display {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin-bottom: 15px;
            padding: 15px;
            background: rgba(162, 155, 254, 0.1);
            border-radius: 10px;
        }

        .chosen-face {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
        }

        .chosen-text {
            color: #fff;
        }

        .explanation-input {
            width: 100%;
            padding: 15px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            color: #fff;
            font-size: 1rem;
            resize: none;
            height: 80px;
            outline: none;
        }

        .explanation-input:focus {
            border-color: #a29bfe;
        }

        .submit-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #a29bfe, #6c5ce7);
            border: none;
            border-radius: 10px;
            color: #fff;
            font-size: 1rem;
            cursor: pointer;
            margin-top: 15px;
            transition: transform 0.3s;
        }

        .submit-btn:hover {
            transform: translateY(-2px);
        }

        .submit-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .results-panel {
            display: none;
        }

        .results-panel.visible {
            display: block;
        }

        .result-header {
            text-align: center;
            margin-bottom: 20px;
        }

        .result-title {
            font-size: 1.5rem;
            color: #a29bfe;
            margin-bottom: 10px;
        }

        .detection-rate {
            font-size: 3rem;
            font-weight: bold;
            color: #ff7675;
        }

        .detection-label {
            color: #888;
            font-size: 0.9rem;
        }

        .trial-review {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
        }

        .trial-review-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .trial-number {
            color: #888;
            font-size: 0.85rem;
        }

        .trial-status {
            padding: 3px 10px;
            border-radius: 10px;
            font-size: 0.75rem;
        }

        .trial-status.swapped {
            background: rgba(255, 118, 117, 0.2);
            color: #ff7675;
        }

        .trial-status.normal {
            background: rgba(0, 184, 148, 0.2);
            color: #00b894;
        }

        .trial-choices {
            display: flex;
            gap: 15px;
            margin-bottom: 10px;
        }

        .mini-choice {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 12px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            font-size: 0.85rem;
        }

        .mini-face {
            font-size: 1.2rem;
        }

        .explanation-review {
            background: rgba(255, 255, 255, 0.05);
            padding: 10px 15px;
            border-radius: 8px;
            font-style: italic;
            color: #888;
            font-size: 0.9rem;
            border-left: 3px solid #6c5ce7;
        }

        .confabulation-alert {
            background: rgba(255, 118, 117, 0.1);
            border: 1px solid rgba(255, 118, 117, 0.3);
            padding: 10px 15px;
            border-radius: 8px;
            color: #ff7675;
            font-size: 0.85rem;
            margin-top: 10px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }

        .stat-box {
            background: rgba(0, 0, 0, 0.2);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }

        .stat-value {
            font-size: 1.8rem;
            font-weight: bold;
            color: #a29bfe;
        }

        .stat-label {
            font-size: 0.75rem;
            color: #888;
        }

        .comparison-bar {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
        }

        .bar-row {
            margin-bottom: 15px;
        }

        .bar-label {
            color: #888;
            font-size: 0.85rem;
            margin-bottom: 5px;
            display: flex;
            justify-content: space-between;
        }

        .bar-container {
            height: 30px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 5px;
            overflow: hidden;
        }

        .bar-fill {
            height: 100%;
            border-radius: 5px;
            display: flex;
            align-items: center;
            padding-left: 10px;
            font-size: 0.85rem;
            color: #fff;
        }

        .bar-fill.you {
            background: linear-gradient(90deg, #a29bfe, #6c5ce7);
        }

        .bar-fill.research {
            background: linear-gradient(90deg, #74b9ff, #0984e3);
        }

        .research-panel {
            background: rgba(108, 92, 231, 0.1);
            border-left: 4px solid #6c5ce7;
            padding: 20px;
            border-radius: 0 15px 15px 0;
            margin-bottom: 25px;
        }

        .research-panel h3 {
            color: #6c5ce7;
            margin-bottom: 15px;
        }

        .study-card {
            background: rgba(0, 0, 0, 0.2);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
        }

        .study-card:last-child {
            margin-bottom: 0;
        }

        .study-author {
            color: #a29bfe;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .study-finding {
            color: #ccc;
            font-size: 0.95rem;
        }

        .highlight {
            color: #fd79a8;
            font-weight: bold;
        }

        .applications-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 15px;
        }

        .app-card {
            background: rgba(162, 155, 254, 0.1);
            border: 1px solid rgba(162, 155, 254, 0.3);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }

        .app-icon {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .app-title {
            color: #a29bfe;
            font-weight: bold;
            margin-bottom: 5px;
            font-size: 0.9rem;
        }

        .app-desc {
            font-size: 0.8rem;
            color: #888;
        }

        .magic-trick {
            background: rgba(0, 0, 0, 0.4);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            margin-top: 20px;
        }

        .trick-title {
            color: #a29bfe;
            margin-bottom: 15px;
        }

        .cards-animation {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 20px 0;
        }

        .trick-card {
            width: 80px;
            height: 110px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            color: #fff;
            transition: transform 0.5s;
        }

        .trick-card.flip {
            transform: rotateY(180deg);
        }
    </style>
</head>
<body>
    <div class="container">
        <a href="index.html" class="back-link">‚Üê Back to Surprising Paradoxes</a>

        <header>
            <h1>Choice Blindness</h1>
            <p class="subtitle">You don't know why you chose what you chose</p>
        </header>

        <div class="intro-panel">
            <h2>üé≠ The Magic Trick That Reveals Your Mind</h2>
            <p>
                Imagine choosing between two faces‚Äîthe one you find more attractive. Easy, right? Now imagine
                the experimenter secretly <em>swaps your choice</em> and asks you to explain why you picked
                <strong>the face you didn't actually choose</strong>. Surely you'd notice? In Johansson et al.'s
                famous 2005 study, <span class="highlight">only 13% detected the swap</span>. The rest?
                They confidently explained why they preferred a face they had actually rejected‚Äîinventing
                reasons from thin air. This is <strong>Choice Blindness</strong>: we don't have privileged
                access to our own decisions. We think we know why we choose things. We're wrong.
            </p>
        </div>

        <div class="main-grid">
            <div class="panel">
                <h3>üÉè The Face Choice Experiment</h3>

                <div id="experimentSection">
                    <div class="trial-display">
                        <div class="trial-counter" id="trialCounter">Trial 1 of 6</div>
                        <p style="color: #888; margin-bottom: 15px;">Which face do you find more attractive?</p>

                        <div class="choice-pair" id="choicePair">
                            <!-- Faces generated dynamically -->
                        </div>
                    </div>

                    <div class="explanation-section" id="explanationSection">
                        <div class="explanation-prompt">Why did you choose this face?</div>
                        <div class="chosen-display">
                            <div class="chosen-face" id="chosenFace">üòä</div>
                            <div class="chosen-text">Your choice</div>
                        </div>
                        <textarea class="explanation-input" id="explanationInput" placeholder="Describe what made this face more attractive to you..."></textarea>
                        <button class="submit-btn" id="nextBtn" onclick="submitExplanation()">Submit & Continue</button>
                    </div>
                </div>

                <div class="results-panel" id="resultsPanel">
                    <div class="result-header">
                        <div class="result-title">Your Detection Rate</div>
                        <div class="detection-rate" id="detectionRate">0%</div>
                        <div class="detection-label">of swaps detected</div>
                    </div>

                    <div class="stats-grid">
                        <div class="stat-box">
                            <div class="stat-value" id="totalSwaps">0</div>
                            <div class="stat-label">Swaps Attempted</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-value" id="swapsDetected">0</div>
                            <div class="stat-label">Swaps Detected</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-value" id="confabulations">0</div>
                            <div class="stat-label">Confabulations</div>
                        </div>
                    </div>

                    <div class="comparison-bar">
                        <h4 style="color: #a29bfe; margin-bottom: 15px;">Detection Rate Comparison</h4>
                        <div class="bar-row">
                            <div class="bar-label">
                                <span>You</span>
                                <span id="yourRate">0%</span>
                            </div>
                            <div class="bar-container">
                                <div class="bar-fill you" id="yourBar" style="width: 0%;"></div>
                            </div>
                        </div>
                        <div class="bar-row">
                            <div class="bar-label">
                                <span>Research Average</span>
                                <span>13%</span>
                            </div>
                            <div class="bar-container">
                                <div class="bar-fill research" style="width: 13%;">13%</div>
                            </div>
                        </div>
                    </div>

                    <div id="trialReviews" style="margin-top: 20px;">
                        <h4 style="color: #a29bfe; margin-bottom: 15px;">Trial-by-Trial Review</h4>
                    </div>
                </div>
            </div>

            <div class="panel">
                <h3>üß† How the Trick Works</h3>

                <div class="magic-trick">
                    <div class="trick-title">The Johansson Card Trick (2005)</div>
                    <div class="cards-animation">
                        <div class="trick-card" id="card1">üë©</div>
                        <div class="trick-card" id="card2">üë©‚Äçü¶∞</div>
                    </div>
                    <p style="color: #888; font-size: 0.9rem;">
                        Participants held two face photos. After choosing, the experimenter used sleight of hand
                        to swap the photos. The participant then explained their "choice"‚Äîwhich was actually the
                        face they had rejected!
                    </p>
                    <button class="submit-btn" onclick="demonstrateTrick()" style="margin-top: 15px; width: auto; padding: 10px 30px;">
                        Watch the Swap
                    </button>
                </div>

                <div style="background: rgba(253, 121, 168, 0.1); border: 1px solid rgba(253, 121, 168, 0.3); padding: 15px; border-radius: 10px; margin-top: 20px;">
                    <h4 style="color: #fd79a8; margin-bottom: 10px;">üé™ Confabulation in Action</h4>
                    <p style="color: #888; font-size: 0.9rem;">
                        When asked why they chose a face they didn't actually choose, participants said things like:
                        <br><br>
                        <em>"I like her earrings"</em> (the original choice had no earrings)<br>
                        <em>"She looks friendlier"</em> (they had rated the other face as friendlier)<br>
                        <em>"I prefer blondes"</em> (their actual choice was brunette)<br><br>
                        The brain doesn't access memories‚Äîit <strong>constructs plausible stories</strong>.
                    </p>
                </div>

                <div style="background: rgba(0, 0, 0, 0.3); border-radius: 10px; padding: 20px; margin-top: 20px;">
                    <h4 style="color: #a29bfe; margin-bottom: 15px;">Beyond Faces: It Works Everywhere</h4>
                    <div style="display: grid; gap: 10px;">
                        <div style="display: flex; align-items: center; gap: 10px; padding: 10px; background: rgba(255,255,255,0.05); border-radius: 8px;">
                            <span style="font-size: 1.5rem;">üçì</span>
                            <span style="color: #ccc; font-size: 0.9rem;"><strong>Jam tasting:</strong> People explained preferences for jams they'd rated lowest</span>
                        </div>
                        <div style="display: flex; align-items: center; gap: 10px; padding: 10px; background: rgba(255,255,255,0.05); border-radius: 8px;">
                            <span style="font-size: 1.5rem;">üó≥Ô∏è</span>
                            <span style="color: #ccc; font-size: 0.9rem;"><strong>Political opinions:</strong> Voters defended positions opposite to what they stated</span>
                        </div>
                        <div style="display: flex; align-items: center; gap: 10px; padding: 10px; background: rgba(255,255,255,0.05); border-radius: 8px;">
                            <span style="font-size: 1.5rem;">üíä</span>
                            <span style="color: #ccc; font-size: 0.9rem;"><strong>Moral judgments:</strong> People justified moral stances they disagreed with</span>
                        </div>
                        <div style="display: flex; align-items: center; gap: 10px; padding: 10px; background: rgba(255,255,255,0.05); border-radius: 8px;">
                            <span style="font-size: 1.5rem;">üõçÔ∏è</span>
                            <span style="color: #ccc; font-size: 0.9rem;"><strong>Consumer products:</strong> Shoppers explained choices for items they rejected</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="research-panel">
            <h3>üìö The Science of Not Knowing Your Own Mind</h3>

            <div class="study-card">
                <div class="study-author">Johansson, Hall, Sikstr√∂m & Olsson (2005) - Lund University</div>
                <div class="study-finding">
                    The landmark discovery. 120 participants chose between pairs of female faces. Using a card-magic
                    technique, researchers swapped the choice on some trials. Only <span class="highlight">13% of
                    swaps were detected</span>‚Äîand even then, detection was often uncertain ("Wait, is this...?").
                    Participants gave detailed explanations for choices they never made, citing features that only
                    existed on the non-chosen face!
                </div>
            </div>

            <div class="study-card">
                <div class="study-author">Hall et al. (2010) - "Magic at the Marketplace"</div>
                <div class="study-finding">
                    Extended to consumer behavior at a supermarket. Shoppers tasted two jams and two teas, chose
                    their favorite, then tasted again while explaining. On swapped trials, <span class="highlight">
                    fewer than 33% detected the switch</span>. Most elaborated reasons for preferring a flavor they
                    had actually ranked lower. Real-world decision-making is just as blind.
                </div>
            </div>

            <div class="study-card">
                <div class="study-author">Hall, Johansson & Strandberg (2012) - Political Choice Blindness</div>
                <div class="study-finding">
                    Swedish voters completed a survey, then discussed their answers‚Äîbut some answers were secretly
                    reversed. <span class="highlight">Only 22% detected manipulations</span> to their stated political
                    positions. Participants defended positions they had explicitly disagreed with, often using
                    sophisticated arguments. Some even said the (reversed) view made them reconsider their vote!
                </div>
            </div>

            <div class="study-card">
                <div class="study-author">Nisbett & Wilson (1977) - "Telling More Than We Can Know"</div>
                <div class="study-finding">
                    The theoretical foundation. People have <span class="highlight">little or no introspective access</span>
                    to their cognitive processes. When asked why they did something, they don't retrieve the actual cause‚Äîthey
                    construct a plausible explanation based on implicit theories. We're not reporters of our mental states;
                    we're narrators inventing stories to explain our behavior.
                </div>
            </div>
        </div>

        <div class="panel" style="margin-bottom: 25px;">
            <h3>üåç Implications for Everyday Life</h3>
            <div class="applications-grid">
                <div class="app-card">
                    <div class="app-icon">‚öñÔ∏è</div>
                    <div class="app-title">Eyewitness Testimony</div>
                    <div class="app-desc">Witnesses confidently describe details they never actually observed</div>
                </div>
                <div class="app-card">
                    <div class="app-icon">üíº</div>
                    <div class="app-title">Job Interviews</div>
                    <div class="app-desc">Candidates invent reasons for choices made on instinct</div>
                </div>
                <div class="app-card">
                    <div class="app-icon">üó≥Ô∏è</div>
                    <div class="app-title">Political Opinions</div>
                    <div class="app-desc">Voters defend positions they don't actually hold</div>
                </div>
                <div class="app-card">
                    <div class="app-icon">‚ù§Ô∏è</div>
                    <div class="app-title">Relationship Choices</div>
                    <div class="app-desc">"Why do you love them?" may be post-hoc rationalization</div>
                </div>
                <div class="app-card">
                    <div class="app-icon">üõí</div>
                    <div class="app-title">Consumer Research</div>
                    <div class="app-desc">Focus groups reveal stories, not actual decision processes</div>
                </div>
                <div class="app-card">
                    <div class="app-icon">üßò</div>
                    <div class="app-title">Self-Knowledge</div>
                    <div class="app-desc">Our confident self-narratives may be elaborate fictions</div>
                </div>
            </div>
        </div>

        <div class="intro-panel">
            <h2>üß† The Narrator in Your Head</h2>
            <p>
                Choice blindness reveals something profound: the voice in your head that explains your choices
                isn't accessing memories of decisions‚Äîit's <em>making up stories</em> that sound plausible.
                When you say "I chose this because..." you're not reporting a fact; you're constructing a
                narrative on the fly.<br><br>
                This doesn't mean your choices are random. It means the <strong>reasons you give</strong> for
                your choices are often post-hoc rationalizations rather than the actual causes. Your brain
                makes decisions through complex, largely unconscious processes. Then the "narrator" steps in
                to explain why, creating a coherent story that may have little to do with reality.<br><br>
                The paradox: we experience ourselves as unified, rational agents who know our own minds. But
                choice blindness suggests we're more like press secretaries‚Äîconfidently explaining decisions
                that were made elsewhere, for reasons we don't truly understand.
            </p>
        </div>
    </div>

    <script>
        // Experiment state
        let currentTrial = 0;
        const totalTrials = 6;
        let trials = [];
        let currentPair = null;
        let selectedIndex = null;
        let swapTrials = [1, 3, 5]; // Which trials will have swaps

        // Face pairs (emoji representations)
        const facePairs = [
            ['üòä', 'üôÇ'],
            ['üòÑ', 'üòÉ'],
            ['ü§ó', '‚ò∫Ô∏è'],
            ['üòÅ', 'üòÄ'],
            ['ü•∞', 'üòç'],
            ['üòå', 'üôÉ']
        ];

        const faceDescriptions = [
            ['warm smile', 'gentle expression'],
            ['bright eyes', 'friendly look'],
            ['open expression', 'calm demeanor'],
            ['cheerful grin', 'happy face'],
            ['loving look', 'admiring gaze'],
            ['peaceful smile', 'playful tilt']
        ];

        function initExperiment() {
            currentTrial = 0;
            trials = [];
            showTrial();
        }

        function showTrial() {
            currentTrial++;
            if (currentTrial > totalTrials) {
                showResults();
                return;
            }

            document.getElementById('trialCounter').textContent = `Trial ${currentTrial} of ${totalTrials}`;
            document.getElementById('explanationSection').classList.remove('visible');

            currentPair = facePairs[currentTrial - 1];
            selectedIndex = null;

            const pairContainer = document.getElementById('choicePair');
            pairContainer.innerHTML = `
                <div class="choice-card" onclick="selectChoice(0)">
                    <div class="face-placeholder">${currentPair[0]}</div>
                    <div class="choice-label">Face A</div>
                    <div class="swap-badge">SWAPPED</div>
                </div>
                <div class="choice-card" onclick="selectChoice(1)">
                    <div class="face-placeholder">${currentPair[1]}</div>
                    <div class="choice-label">Face B</div>
                    <div class="swap-badge">SWAPPED</div>
                </div>
            `;
        }

        function selectChoice(index) {
            selectedIndex = index;

            const cards = document.querySelectorAll('.choice-card');
            cards.forEach((card, i) => {
                card.classList.toggle('selected', i === index);
            });

            // Show explanation section after a brief delay
            setTimeout(() => {
                const isSwapTrial = swapTrials.includes(currentTrial);
                let displayedChoice = selectedIndex;

                // On swap trials, show the OTHER face
                if (isSwapTrial) {
                    displayedChoice = 1 - selectedIndex;
                }

                document.getElementById('chosenFace').textContent = currentPair[displayedChoice];
                document.getElementById('explanationSection').classList.add('visible');
                document.getElementById('explanationInput').value = '';
                document.getElementById('explanationInput').focus();
            }, 500);
        }

        function submitExplanation() {
            const explanation = document.getElementById('explanationInput').value.trim();
            if (!explanation) {
                alert('Please provide an explanation for your choice.');
                return;
            }

            const isSwapTrial = swapTrials.includes(currentTrial);

            trials.push({
                trial: currentTrial,
                originalChoice: selectedIndex,
                displayedChoice: isSwapTrial ? 1 - selectedIndex : selectedIndex,
                wasSwapped: isSwapTrial,
                explanation: explanation,
                faces: [...currentPair],
                // In a real experiment, we'd ask "Did you notice anything?" to detect
                // For this demo, we'll assume no detection (matching research rates)
                detected: false
            });

            showTrial();
        }

        function showResults() {
            document.getElementById('experimentSection').style.display = 'none';
            document.getElementById('resultsPanel').classList.add('visible');

            const swappedTrials = trials.filter(t => t.wasSwapped);
            const detected = swappedTrials.filter(t => t.detected).length;
            const confabulations = swappedTrials.filter(t => !t.detected).length;

            const detectionRate = swappedTrials.length > 0 ?
                Math.round(detected / swappedTrials.length * 100) : 0;

            document.getElementById('detectionRate').textContent = detectionRate + '%';
            document.getElementById('totalSwaps').textContent = swappedTrials.length;
            document.getElementById('swapsDetected').textContent = detected;
            document.getElementById('confabulations').textContent = confabulations;

            document.getElementById('yourRate').textContent = detectionRate + '%';
            document.getElementById('yourBar').style.width = detectionRate + '%';

            // Show trial reviews
            const reviewsContainer = document.getElementById('trialReviews');
            trials.forEach(trial => {
                const review = document.createElement('div');
                review.className = 'trial-review';

                const actualChoice = trial.faces[trial.originalChoice];
                const displayedChoice = trial.faces[trial.displayedChoice];

                review.innerHTML = `
                    <div class="trial-review-header">
                        <span class="trial-number">Trial ${trial.trial}</span>
                        <span class="trial-status ${trial.wasSwapped ? 'swapped' : 'normal'}">
                            ${trial.wasSwapped ? 'üîÑ Swapped' : '‚úì Normal'}
                        </span>
                    </div>
                    <div class="trial-choices">
                        <div class="mini-choice">
                            <span class="mini-face">${actualChoice}</span>
                            <span>You chose</span>
                        </div>
                        ${trial.wasSwapped ? `
                        <div class="mini-choice" style="background: rgba(255, 118, 117, 0.1);">
                            <span class="mini-face">${displayedChoice}</span>
                            <span>Shown instead</span>
                        </div>
                        ` : ''}
                    </div>
                    <div class="explanation-review">"${trial.explanation}"</div>
                    ${trial.wasSwapped ? `
                    <div class="confabulation-alert">
                        ‚ö†Ô∏è You explained your preference for a face you didn't actually choose!
                    </div>
                    ` : ''}
                `;

                reviewsContainer.appendChild(review);
            });
        }

        function demonstrateTrick() {
            const card1 = document.getElementById('card1');
            const card2 = document.getElementById('card2');

            // Animate the swap
            card1.style.transition = 'transform 0.5s';
            card2.style.transition = 'transform 0.5s';

            card1.style.transform = 'translateX(100px) rotateY(180deg)';
            card2.style.transform = 'translateX(-100px) rotateY(180deg)';

            setTimeout(() => {
                // Swap the content
                const temp = card1.textContent;
                card1.textContent = card2.textContent;
                card2.textContent = temp;

                card1.style.transform = 'translateX(0) rotateY(0)';
                card2.style.transform = 'translateX(0) rotateY(0)';
            }, 500);
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            initExperiment();
        });
    </script>
    <script src="../assets/js/enhance.js" defer></script>
</body>
</html>
