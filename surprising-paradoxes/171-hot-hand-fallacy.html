<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Hot Hand Fallacy - Surprising Paradoxes</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            color: #e8e8e8;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
        }

        h1 {
            font-size: 2.2rem;
            background: linear-gradient(135deg, #ff6b35, #f7931e, #ffd23f);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
        }

        .subtitle {
            color: #aaa;
            font-size: 1.1rem;
        }

        .back-link {
            display: inline-block;
            color: #ff6b35;
            text-decoration: none;
            margin-bottom: 20px;
            transition: transform 0.2s;
        }

        .back-link:hover {
            transform: translateX(-5px);
        }

        /* Coin Flip Stage */
        .flip-stage {
            background: linear-gradient(180deg, #1a2a1a 0%, #0d1a0d 100%);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 25px;
            border: 2px solid #ff6b35;
        }

        .stage-title {
            text-align: center;
            font-size: 1.3rem;
            color: #ff6b35;
            margin-bottom: 20px;
        }

        /* Sequence Display */
        .sequence-container {
            background: rgba(0,0,0,0.3);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            min-height: 120px;
        }

        .sequence-label {
            color: #888;
            font-size: 0.9rem;
            margin-bottom: 10px;
        }

        .sequence {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
        }

        .flip-result {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .flip-result.heads {
            background: linear-gradient(135deg, #ffd700, #ffb700);
            color: #1a1a2e;
        }

        .flip-result.tails {
            background: linear-gradient(135deg, #c0c0c0, #a0a0a0);
            color: #1a1a2e;
        }

        .flip-result.streak {
            box-shadow: 0 0 10px #ff6b35;
            transform: scale(1.1);
        }

        /* Stats Panel */
        .stats-panel {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .stat-box {
            background: rgba(0,0,0,0.3);
            border-radius: 10px;
            padding: 15px;
            text-align: center;
        }

        .stat-value {
            font-size: 1.8rem;
            font-weight: bold;
            color: #ff6b35;
        }

        .stat-label {
            color: #888;
            font-size: 0.8rem;
        }

        /* Controls */
        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 25px;
            font-size: 1rem;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: default;
        }

        .btn-flip {
            background: linear-gradient(135deg, #ff6b35, #f7931e);
            color: white;
        }

        .btn-auto {
            background: linear-gradient(135deg, #9b59b6, #8e44ad);
            color: white;
        }

        .btn-reset {
            background: linear-gradient(135deg, #34495e, #2c3e50);
            color: white;
        }

        .btn:hover:not(:disabled) {
            transform: scale(1.05);
            box-shadow: 0 5px 20px rgba(0,0,0,0.3);
        }

        /* Streak Analysis */
        .analysis-box {
            background: linear-gradient(135deg, rgba(255,107,53,0.1), rgba(247,147,30,0.1));
            border: 1px solid rgba(255,107,53,0.3);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
        }

        .analysis-title {
            color: #ff6b35;
            font-size: 1.2rem;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .streak-chart {
            display: flex;
            align-items: flex-end;
            justify-content: center;
            gap: 10px;
            height: 150px;
            margin-bottom: 20px;
            padding: 10px;
            background: rgba(0,0,0,0.2);
            border-radius: 10px;
        }

        .streak-bar-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
        }

        .streak-bar {
            width: 40px;
            background: linear-gradient(180deg, #ff6b35, #f7931e);
            border-radius: 5px 5px 0 0;
            transition: height 0.5s ease;
            display: flex;
            align-items: flex-start;
            justify-content: center;
            padding-top: 5px;
            color: white;
            font-size: 0.8rem;
            font-weight: bold;
        }

        .streak-bar.expected {
            background: linear-gradient(180deg, #3498db, #2980b9);
            opacity: 0.6;
        }

        .streak-label {
            color: #888;
            font-size: 0.75rem;
        }

        .chart-legend {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-top: 10px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.85rem;
            color: #aaa;
        }

        .legend-color {
            width: 20px;
            height: 12px;
            border-radius: 3px;
        }

        .legend-color.actual { background: linear-gradient(90deg, #ff6b35, #f7931e); }
        .legend-color.expected { background: linear-gradient(90deg, #3498db, #2980b9); opacity: 0.6; }

        /* The Paradox Box */
        .paradox-box {
            background: linear-gradient(135deg, rgba(231,76,60,0.1), rgba(192,57,43,0.1));
            border: 1px solid rgba(231,76,60,0.3);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
        }

        .paradox-title {
            color: #e74c3c;
            font-size: 1.2rem;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .paradox-content {
            line-height: 1.7;
            color: #ccc;
        }

        .timeline {
            margin-top: 20px;
            padding-left: 20px;
            border-left: 3px solid #e74c3c;
        }

        .timeline-item {
            margin-bottom: 15px;
            padding-left: 15px;
        }

        .timeline-year {
            color: #e74c3c;
            font-weight: bold;
        }

        /* Psychology Box */
        .psychology-box {
            background: linear-gradient(135deg, rgba(155,89,182,0.1), rgba(142,68,173,0.1));
            border: 1px solid rgba(155,89,182,0.3);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
        }

        .psychology-title {
            color: #9b59b6;
            font-size: 1.2rem;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .bias-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .bias-item {
            background: rgba(0,0,0,0.2);
            border-radius: 10px;
            padding: 15px;
        }

        .bias-item h4 {
            color: #9b59b6;
            margin-bottom: 8px;
            font-size: 1rem;
        }

        .bias-item p {
            color: #aaa;
            font-size: 0.9rem;
            line-height: 1.5;
        }

        /* Twist Box */
        .twist-box {
            background: linear-gradient(135deg, rgba(39,174,96,0.1), rgba(46,204,113,0.1));
            border: 1px solid rgba(39,174,96,0.3);
            border-radius: 15px;
            padding: 25px;
        }

        .twist-title {
            color: #27ae60;
            font-size: 1.2rem;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .twist-content {
            line-height: 1.7;
            color: #ccc;
        }

        .highlight {
            color: #ff6b35;
            font-weight: bold;
        }

        .highlight-green {
            color: #27ae60;
            font-weight: bold;
        }

        /* Basketball Demo */
        .basketball-demo {
            background: rgba(0,0,0,0.3);
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
        }

        .court {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 5px;
            flex-wrap: wrap;
            margin-bottom: 15px;
        }

        .shot {
            width: 25px;
            height: 25px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
        }

        .shot.made {
            background: #27ae60;
        }

        .shot.missed {
            background: #e74c3c;
        }

        .shot.hot-streak {
            box-shadow: 0 0 8px #ffd700;
        }

        @media (max-width: 600px) {
            .flip-result { width: 25px; height: 25px; font-size: 0.7rem; }
            .streak-bar { width: 30px; }
            .stats-panel { grid-template-columns: repeat(2, 1fr); }
        }
    </style>
</head>
<body>
    <div class="container">
        <a href="index.html" class="back-link">‚Üê Back to Paradoxes</a>

        <header>
            <h1>üèÄ The Hot Hand Fallacy</h1>
            <p class="subtitle">Do streaks predict future success, or do we just see patterns in randomness?</p>
        </header>

        <!-- Coin Flip Stage -->
        <div class="flip-stage">
            <div class="stage-title">ü™ô Generate Random Sequences - Can You Spot the "Hot Hand"?</div>

            <div class="sequence-container">
                <div class="sequence-label">Flip Sequence (streaks of 3+ highlighted):</div>
                <div class="sequence" id="sequence"></div>
            </div>

            <div class="stats-panel">
                <div class="stat-box">
                    <div class="stat-value" id="totalFlips">0</div>
                    <div class="stat-label">Total Flips</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" id="headsCount">0</div>
                    <div class="stat-label">Heads</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" id="longestStreak">0</div>
                    <div class="stat-label">Longest Streak</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" id="streakCount">0</div>
                    <div class="stat-label">Streaks (3+)</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" id="afterHeads">--</div>
                    <div class="stat-label">P(H) After Heads</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" id="afterTails">--</div>
                    <div class="stat-label">P(H) After Tails</div>
                </div>
            </div>

            <div class="controls">
                <button class="btn btn-flip" id="flipBtn" onclick="flipCoin()">ü™ô Flip Coin</button>
                <button class="btn btn-auto" id="autoBtn" onclick="toggleAuto()">‚ö° Auto (100)</button>
                <button class="btn btn-reset" onclick="resetAll()">üîÑ Reset</button>
            </div>
        </div>

        <!-- Streak Analysis -->
        <div class="analysis-box">
            <div class="analysis-title">üìä Streak Distribution: Your Flips vs. Expected</div>

            <div class="streak-chart" id="streakChart">
                <!-- Bars generated by JS -->
            </div>

            <div class="chart-legend">
                <div class="legend-item">
                    <div class="legend-color actual"></div>
                    <span>Your Streaks</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color expected"></div>
                    <span>Expected (Random)</span>
                </div>
            </div>

            <p style="text-align: center; margin-top: 15px; color: #aaa; font-size: 0.9rem;">
                A fair coin produces streaks naturally. In 100 flips, expect ~25 runs of 2+, ~12 runs of 3+, ~6 runs of 4+.
            </p>
        </div>

        <!-- The Paradox -->
        <div class="paradox-box">
            <div class="paradox-title">üéØ The 1985 Study That Changed Everything</div>
            <div class="paradox-content">
                <p>In 1985, psychologists <span class="highlight">Gilovich, Vallone, and Tversky</span> analyzed
                thousands of basketball shots from the Philadelphia 76ers and Cornell varsity teams.</p>

                <p style="margin-top: 15px;"><strong>Their shocking finding:</strong> Players were
                <span class="highlight">no more likely to make a shot after making previous shots</span>.
                The "hot hand" appeared to be a cognitive illusion‚Äîwe see patterns in pure randomness.</p>

                <div class="basketball-demo">
                    <div class="court" id="basketballCourt">
                        <!-- Generated by JS -->
                    </div>
                    <p style="text-align: center; color: #888; font-size: 0.85rem;">
                        üü¢ Made | üî¥ Missed | ‚ú® = "Hot streak" (3+ makes)
                    </p>
                    <div style="text-align: center; margin-top: 10px;">
                        <button class="btn btn-flip" onclick="generateShooting()">üèÄ Generate Shooting Sequence</button>
                    </div>
                </div>

                <div class="timeline" style="margin-top: 25px;">
                    <div class="timeline-item">
                        <span class="timeline-year">1985</span> ‚Äî Gilovich, Tversky & Vallone publish "The Hot Hand in Basketball"
                    </div>
                    <div class="timeline-item">
                        <span class="timeline-year">30 years</span> ‚Äî The finding becomes textbook psychology
                    </div>
                    <div class="timeline-item">
                        <span class="timeline-year">2015</span> ‚Äî Miller & Sanjurjo find a <span class="highlight-green">statistical flaw</span>...
                    </div>
                </div>
            </div>
        </div>

        <!-- Psychology -->
        <div class="psychology-box">
            <div class="psychology-title">üß† Why We Believe in Streaks</div>
            <div class="bias-grid">
                <div class="bias-item">
                    <h4>üîç Clustering Illusion</h4>
                    <p>We perceive meaningful patterns in random clusters. Streaks feel significant even when they're statistically expected.</p>
                </div>
                <div class="bias-item">
                    <h4>üìè Law of Small Numbers</h4>
                    <p>We expect small samples to represent large populations. A player's last 5 shots feel predictive of the next 5.</p>
                </div>
                <div class="bias-item">
                    <h4>‚úÖ Confirmation Bias</h4>
                    <p>We remember the streaks that continued and forget those that didn't. The "cold" shooter who hit the next shot is forgotten.</p>
                </div>
                <div class="bias-item">
                    <h4>üé≤ Representativeness</h4>
                    <p>Random sequences should "look random" to us‚Äîalternating often. Real randomness has more streaks than we expect.</p>
                </div>
            </div>
        </div>

        <!-- The Twist -->
        <div class="twist-box">
            <div class="twist-title">üîÑ Plot Twist: The Hot Hand Might Be REAL!</div>
            <div class="twist-content">
                <p>In 2015, economists <span class="highlight-green">Joshua Miller and Adam Sanjurjo</span> discovered
                a subtle but crucial flaw in the original study's methodology.</p>

                <p style="margin-top: 15px;"><strong>The Problem:</strong> When you select shots "after a made shot"
                from a finite sequence, you're introducing a <span class="highlight-green">selection bias</span>.
                The expected value of "success rate after success" in a truly random sequence is actually
                <span class="highlight">less than 50%</span>, not equal to 50%!</p>

                <p style="margin-top: 15px;">When they corrected for this bias, the Philadelphia 76ers data
                actually showed <span class="highlight-green">evidence FOR the hot hand</span>‚Äîplayers really
                were more likely to make shots during streaks!</p>

                <p style="margin-top: 20px; padding: 15px; background: rgba(39,174,96,0.2); border-radius: 10px;">
                    <strong>The Paradox:</strong> For 30 years, the "hot hand fallacy" was itself a fallacy!
                    The original researchers were fooled by a statistical artifact, while players and coaches
                    who believed in momentum were right all along.
                </p>

                <p style="margin-top: 15px; color: #888; font-style: italic;">
                    "It's OK to believe in the hot hand... you can believe in the magic and mystery of momentum
                    in basketball and life in general, while still maintaining your intellectual respectability."
                    ‚Äî Scientific American, 2017
                </p>
            </div>
        </div>
    </div>

    <script>
        // State
        let flips = [];
        let isAutoRunning = false;
        let autoInterval = null;

        // DOM elements
        const sequenceEl = document.getElementById('sequence');
        const totalFlipsEl = document.getElementById('totalFlips');
        const headsCountEl = document.getElementById('headsCount');
        const longestStreakEl = document.getElementById('longestStreak');
        const streakCountEl = document.getElementById('streakCount');
        const afterHeadsEl = document.getElementById('afterHeads');
        const afterTailsEl = document.getElementById('afterTails');

        function flipCoin() {
            const result = Math.random() < 0.5 ? 'H' : 'T';
            flips.push(result);
            updateDisplay();
        }

        function updateDisplay() {
            // Clear and rebuild sequence display
            sequenceEl.innerHTML = '';

            // Find streaks
            const streaks = findStreaks(flips);

            flips.forEach((flip, i) => {
                const el = document.createElement('div');
                el.className = `flip-result ${flip === 'H' ? 'heads' : 'tails'}`;
                el.textContent = flip;

                // Check if part of a streak
                if (streaks.some(s => i >= s.start && i <= s.end)) {
                    el.classList.add('streak');
                }

                sequenceEl.appendChild(el);
            });

            // Update stats
            totalFlipsEl.textContent = flips.length;
            headsCountEl.textContent = flips.filter(f => f === 'H').length;

            // Longest streak
            let longest = 0;
            let current = 1;
            for (let i = 1; i < flips.length; i++) {
                if (flips[i] === flips[i-1]) {
                    current++;
                    longest = Math.max(longest, current);
                } else {
                    current = 1;
                }
            }
            if (flips.length > 0 && longest === 0) longest = 1;
            longestStreakEl.textContent = longest;

            // Streak count (3+)
            streakCountEl.textContent = streaks.length;

            // P(H) after H and after T
            let headsAfterHeads = 0;
            let totalAfterHeads = 0;
            let headsAfterTails = 0;
            let totalAfterTails = 0;

            for (let i = 1; i < flips.length; i++) {
                if (flips[i-1] === 'H') {
                    totalAfterHeads++;
                    if (flips[i] === 'H') headsAfterHeads++;
                } else {
                    totalAfterTails++;
                    if (flips[i] === 'H') headsAfterTails++;
                }
            }

            afterHeadsEl.textContent = totalAfterHeads > 0 ?
                (headsAfterHeads / totalAfterHeads * 100).toFixed(0) + '%' : '--';
            afterTailsEl.textContent = totalAfterTails > 0 ?
                (headsAfterTails / totalAfterTails * 100).toFixed(0) + '%' : '--';

            updateStreakChart();
        }

        function findStreaks(arr, minLength = 3) {
            const streaks = [];
            let start = 0;

            for (let i = 1; i <= arr.length; i++) {
                if (i === arr.length || arr[i] !== arr[i-1]) {
                    const length = i - start;
                    if (length >= minLength) {
                        streaks.push({ start, end: i - 1, length, type: arr[start] });
                    }
                    start = i;
                }
            }

            return streaks;
        }

        function updateStreakChart() {
            const chart = document.getElementById('streakChart');
            chart.innerHTML = '';

            // Count streaks of different lengths
            const streakCounts = { 2: 0, 3: 0, 4: 0, 5: 0, '6+': 0 };

            let start = 0;
            for (let i = 1; i <= flips.length; i++) {
                if (i === flips.length || flips[i] !== flips[i-1]) {
                    const length = i - start;
                    if (length >= 2 && length <= 5) {
                        streakCounts[length]++;
                    } else if (length >= 6) {
                        streakCounts['6+']++;
                    }
                    start = i;
                }
            }

            // Expected counts for n flips
            const n = flips.length;
            const expected = {
                2: n > 0 ? n * 0.25 : 0,  // ~25% of flips start streak of 2
                3: n > 0 ? n * 0.125 : 0,
                4: n > 0 ? n * 0.0625 : 0,
                5: n > 0 ? n * 0.03125 : 0,
                '6+': n > 0 ? n * 0.03125 : 0
            };

            const maxVal = Math.max(
                ...Object.values(streakCounts),
                ...Object.values(expected),
                1
            );

            Object.keys(streakCounts).forEach(len => {
                const container = document.createElement('div');
                container.className = 'streak-bar-container';

                // Actual bar
                const actualBar = document.createElement('div');
                actualBar.className = 'streak-bar';
                actualBar.style.height = (streakCounts[len] / maxVal * 100) + 'px';
                actualBar.textContent = streakCounts[len];

                // Expected bar (behind)
                const expectedBar = document.createElement('div');
                expectedBar.className = 'streak-bar expected';
                expectedBar.style.height = (expected[len] / maxVal * 100) + 'px';
                expectedBar.style.position = 'absolute';
                expectedBar.style.left = '50%';
                expectedBar.style.transform = 'translateX(-50%)';

                const wrapper = document.createElement('div');
                wrapper.style.position = 'relative';
                wrapper.style.display = 'flex';
                wrapper.style.alignItems = 'flex-end';
                wrapper.style.justifyContent = 'center';
                wrapper.style.height = '120px';
                wrapper.appendChild(expectedBar);
                wrapper.appendChild(actualBar);

                container.appendChild(wrapper);

                const label = document.createElement('div');
                label.className = 'streak-label';
                label.textContent = len === '6+' ? '6+' : `${len}`;
                container.appendChild(label);

                chart.appendChild(container);
            });
        }

        function toggleAuto() {
            const btn = document.getElementById('autoBtn');

            if (isAutoRunning) {
                clearInterval(autoInterval);
                isAutoRunning = false;
                btn.textContent = '‚ö° Auto (100)';
            } else {
                isAutoRunning = true;
                btn.textContent = '‚èπÔ∏è Stop';

                let count = 0;
                autoInterval = setInterval(() => {
                    flipCoin();
                    count++;
                    if (count >= 100) {
                        clearInterval(autoInterval);
                        isAutoRunning = false;
                        btn.textContent = '‚ö° Auto (100)';
                    }
                }, 30);
            }
        }

        function resetAll() {
            flips = [];
            if (isAutoRunning) {
                clearInterval(autoInterval);
                isAutoRunning = false;
                document.getElementById('autoBtn').textContent = '‚ö° Auto (100)';
            }
            updateDisplay();
        }

        // Basketball demo
        function generateShooting() {
            const court = document.getElementById('basketballCourt');
            court.innerHTML = '';

            const shots = [];
            const shootingPct = 0.45; // 45% shooter

            for (let i = 0; i < 50; i++) {
                shots.push(Math.random() < shootingPct ? 'made' : 'missed');
            }

            // Find "hot streaks" (3+ makes)
            const hotSpots = new Set();
            let streak = 0;
            let streakStart = 0;

            for (let i = 0; i < shots.length; i++) {
                if (shots[i] === 'made') {
                    if (streak === 0) streakStart = i;
                    streak++;
                } else {
                    if (streak >= 3) {
                        for (let j = streakStart; j < i; j++) {
                            hotSpots.add(j);
                        }
                    }
                    streak = 0;
                }
            }
            if (streak >= 3) {
                for (let j = streakStart; j < shots.length; j++) {
                    hotSpots.add(j);
                }
            }

            shots.forEach((shot, i) => {
                const el = document.createElement('div');
                el.className = `shot ${shot}`;
                if (hotSpots.has(i)) {
                    el.classList.add('hot-streak');
                }
                el.textContent = shot === 'made' ? '‚úì' : '‚úó';
                court.appendChild(el);
            });
        }

        // Initialize
        updateDisplay();
        generateShooting();
    </script>
    <script src="../assets/js/enhance.js" defer></script>
</body>
</html>
