<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Gaze Heuristic - How Outfielders Catch Fly Balls</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Georgia', serif;
            background: linear-gradient(135deg, #1a3a1a 0%, #0d2818 50%, #1a2e1a 100%);
            color: #e0e0e0;
            min-height: 100vh;
            padding: 20px;
            line-height: 1.6;
        }
        .container { max-width: 1200px; margin: 0 auto; }
        header { text-align: center; margin-bottom: 30px; }
        .back-link {
            color: #ff6b6b;
            text-decoration: none;
            margin-bottom: 20px;
            display: inline-block;
        }
        h1 {
            font-size: 2.3rem;
            background: linear-gradient(135deg, #2ecc71, #27ae60, #1abc9c);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
        }
        .subtitle {
            font-size: 1rem;
            color: #a9dfbf;
            max-width: 850px;
            margin: 0 auto;
        }

        .main-grid {
            display: grid;
            grid-template-columns: 1fr 320px;
            gap: 25px;
            margin-bottom: 30px;
        }
        @media (max-width: 900px) {
            .main-grid { grid-template-columns: 1fr; }
        }

        .panel {
            background: rgba(255,255,255,0.05);
            border-radius: 15px;
            padding: 20px;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .field-container {
            position: relative;
            width: 100%;
            aspect-ratio: 1.5;
            border-radius: 12px;
            overflow: hidden;
            margin-bottom: 15px;
        }
        #fieldCanvas {
            width: 100%;
            height: 100%;
        }

        .angle-display {
            display: flex;
            justify-content: center;
            gap: 30px;
            padding: 15px;
            background: rgba(0,0,0,0.3);
            border-radius: 10px;
            margin-bottom: 15px;
        }
        .angle-item {
            text-align: center;
        }
        .angle-label {
            font-size: 0.8rem;
            color: #888;
            margin-bottom: 5px;
        }
        .angle-value {
            font-size: 1.8rem;
            font-weight: bold;
        }
        .angle-value.constant { color: #2ecc71; }
        .angle-value.changing { color: #e74c3c; }

        .status-bar {
            padding: 12px 15px;
            border-radius: 8px;
            text-align: center;
            margin-bottom: 15px;
            font-weight: bold;
        }
        .status-waiting { background: rgba(52,152,219,0.2); color: #5dade2; }
        .status-tracking { background: rgba(46,204,113,0.2); color: #58d68d; }
        .status-caught { background: rgba(46,204,113,0.4); color: #2ecc71; }
        .status-missed { background: rgba(231,76,60,0.3); color: #e74c3c; }

        .btn {
            width: 100%;
            padding: 14px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1rem;
            margin-bottom: 10px;
            transition: all 0.3s;
        }
        .btn-primary {
            background: linear-gradient(135deg, #2ecc71, #27ae60);
            color: #fff;
        }
        .btn-secondary {
            background: rgba(255,255,255,0.1);
            color: #a9dfbf;
        }
        .btn:hover { transform: translateY(-2px); }
        .btn:disabled { opacity: 0.5; cursor: not-allowed; transform: none; }

        .mode-toggle {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }
        .mode-btn {
            flex: 1;
            padding: 12px 8px;
            border: none;
            border-radius: 8px;
            background: rgba(255,255,255,0.1);
            color: #a9dfbf;
            cursor: pointer;
            font-size: 0.85rem;
            transition: all 0.3s;
        }
        .mode-btn.active {
            background: linear-gradient(135deg, #2ecc71, #27ae60);
            color: #fff;
        }

        .explanation-box {
            background: linear-gradient(135deg, rgba(46,204,113,0.15), rgba(39,174,96,0.08));
            border: 1px solid rgba(46,204,113,0.3);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
        }
        .explanation-box h4 {
            color: #2ecc71;
            margin-bottom: 10px;
        }
        .explanation-box p {
            font-size: 0.9rem;
            color: #a9dfbf;
        }

        .stats-panel {
            background: rgba(0,0,0,0.2);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
        }
        .stats-panel h4 {
            color: #2ecc71;
            margin-bottom: 12px;
        }
        .stat-row {
            display: flex;
            justify-content: space-between;
            font-size: 0.9rem;
            margin-bottom: 8px;
        }
        .stat-value {
            color: #a9dfbf;
            font-weight: bold;
        }

        .rule-box {
            background: rgba(241,196,15,0.15);
            border: 1px solid rgba(241,196,15,0.4);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
        }
        .rule-box h4 {
            color: #f1c40f;
            margin-bottom: 8px;
        }
        .rule-text {
            font-size: 1.1rem;
            color: #f9e79f;
            font-style: italic;
            text-align: center;
        }

        .control-group {
            margin-bottom: 15px;
        }
        .control-group label {
            display: block;
            color: #a9dfbf;
            margin-bottom: 5px;
            font-size: 0.9rem;
        }
        .control-group input[type="range"] {
            width: 100%;
        }

        .research-section {
            background: rgba(255,255,255,0.03);
            border-radius: 15px;
            padding: 25px;
            margin-top: 30px;
            border: 1px solid rgba(255,255,255,0.08);
        }
        .research-section h2 {
            color: #2ecc71;
            margin-bottom: 20px;
            font-size: 1.5rem;
        }
        .research-section h3 {
            color: #a9dfbf;
            margin: 20px 0 10px;
            font-size: 1.15rem;
        }
        .research-section p {
            margin-bottom: 12px;
            color: #c0c0c0;
        }
        .key-point {
            background: rgba(46,204,113,0.15);
            border-left: 3px solid #2ecc71;
            padding: 12px 15px;
            margin: 15px 0;
            border-radius: 0 8px 8px 0;
        }
        .quote {
            font-style: italic;
            border-left: 3px solid #a9dfbf;
            padding-left: 15px;
            margin: 15px 0;
            color: #a0a0a0;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <a href="index.html" class="back-link">‚Üê Back to Surprising Paradoxes</a>
            <h1>The Gaze Heuristic</h1>
            <p class="subtitle">How do outfielders catch fly balls? Not by calculating trajectories‚Äîthey use a brilliantly simple rule: keep the ball at a constant angle in your vision, and you'll arrive exactly where it lands!</p>
        </header>

        <div class="main-grid">
            <div class="panel">
                <div class="field-container">
                    <canvas id="fieldCanvas"></canvas>
                </div>

                <div class="angle-display">
                    <div class="angle-item">
                        <div class="angle-label">Gaze Angle</div>
                        <div class="angle-value constant" id="gazeAngle">‚Äî¬∞</div>
                    </div>
                    <div class="angle-item">
                        <div class="angle-label">Angle Change</div>
                        <div class="angle-value" id="angleChange">‚Äî</div>
                    </div>
                    <div class="angle-item">
                        <div class="angle-label">Distance to Ball</div>
                        <div class="angle-value" id="distanceToBall">‚Äî</div>
                    </div>
                </div>

                <div class="status-bar status-waiting" id="statusBar">
                    Press "Hit Ball" to start!
                </div>

                <button class="btn btn-primary" id="hitBall">‚öæ Hit Ball</button>
                <button class="btn btn-secondary" id="resetField">Reset Field</button>
            </div>

            <div class="panel">
                <h3 style="color: #2ecc71; margin-bottom: 15px;">Catching Strategy</h3>

                <div class="mode-toggle">
                    <button class="mode-btn active" id="modeGaze">Gaze Heuristic</button>
                    <button class="mode-btn" id="modeCalc">Calculate Trajectory</button>
                    <button class="mode-btn" id="modeManual">Manual Control</button>
                </div>

                <div class="rule-box">
                    <h4>The Simple Rule</h4>
                    <p class="rule-text" id="ruleText">"Keep the angle of gaze constant‚Äîrun so the ball stays at the same angle in your vision."</p>
                </div>

                <div class="explanation-box" id="explanationBox">
                    <h4>Gaze Heuristic Mode</h4>
                    <p>The outfielder ignores velocity, distance, wind, and spin. They only track ONE thing: the angle to the ball. If the angle increases, run back. If it decreases, run forward. Keep it constant ‚Üí catch the ball!</p>
                </div>

                <div class="control-group">
                    <label>Ball Hit Power: <span id="powerValue">70</span>%</label>
                    <input type="range" id="hitPower" min="30" max="100" value="70">
                </div>

                <div class="control-group">
                    <label>Hit Angle: <span id="hitAngleValue">45</span>¬∞</label>
                    <input type="range" id="hitAngle" min="20" max="70" value="45">
                </div>

                <div class="stats-panel">
                    <h4>Session Statistics</h4>
                    <div class="stat-row">
                        <span>Balls caught:</span>
                        <span class="stat-value" id="caught">0</span>
                    </div>
                    <div class="stat-row">
                        <span>Balls missed:</span>
                        <span class="stat-value" id="missed">0</span>
                    </div>
                    <div class="stat-row">
                        <span>Gaze heuristic catches:</span>
                        <span class="stat-value" id="gazeCatches">0</span>
                    </div>
                    <div class="stat-row">
                        <span>Calculation catches:</span>
                        <span class="stat-value" id="calcCatches">0</span>
                    </div>
                </div>

                <div class="stats-panel">
                    <h4>Who Uses This?</h4>
                    <ul style="font-size: 0.85rem; color: #a9dfbf; margin-left: 15px;">
                        <li>Baseball outfielders</li>
                        <li>Dogs catching frisbees</li>
                        <li>Hawks intercepting prey</li>
                        <li>Bats catching insects</li>
                        <li>Sidewinder missiles</li>
                        <li>Soccer goalkeepers</li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="research-section">
            <h2>The Brilliance of Simple Rules</h2>

            <p>How does a baseball outfielder catch a fly ball? The intuitive answer is: by solving complex physics equations to predict where the ball will land, then running to that spot. But that's wrong. Humans can't do that math in real-time‚Äîand they don't need to.</p>

            <h3>The Gaze Heuristic</h3>

            <p>McLeod and Dienes (1996) discovered that skilled players use a remarkably simple rule:</p>

            <div class="key-point">
                <strong>The Rule:</strong> Fixate your gaze on the ball. Start running. Adjust your speed so the angle of gaze remains constant.
                <br><br>
                If the angle is increasing ‚Üí run backward<br>
                If the angle is decreasing ‚Üí run forward<br>
                If the angle is constant ‚Üí you'll arrive exactly when the ball does!
            </div>

            <h3>Why Does This Work?</h3>

            <p>The mathematics is elegant. When you maintain a constant angle to a moving target while moving yourself, you're implicitly solving the interception problem. The path you take is curved‚Äînot a straight line to the landing spot‚Äîbut it's self-correcting and works even when wind or spin affects the ball's trajectory.</p>

            <p>Crucially, the player ignores almost all available information:</p>
            <ul style="margin: 10px 0 10px 30px; color: #c0c0c0;">
                <li>Initial velocity of the ball ‚ùå</li>
                <li>Distance to the ball ‚ùå</li>
                <li>Angle of the hit ‚ùå</li>
                <li>Wind conditions ‚ùå</li>
                <li>Ball spin ‚ùå</li>
                <li>Angle of gaze ‚úì (the ONLY thing that matters!)</li>
            </ul>

            <h3>Gigerenzer's "Ecological Rationality"</h3>

            <p>Gerd Gigerenzer uses the gaze heuristic as a prime example of "ecological rationality"‚Äîthe idea that simple heuristics, when matched to the right environment, can outperform complex calculations.</p>

            <div class="quote">
                "We have to get over the illusion that complex problems need complex solutions. Most outfielders rely on the gaze heuristic without being able to explain how they catch a ball. Their behavior is intuitive, not consciously deliberative."<br>
                ‚Äî Gerd Gigerenzer
            </div>

            <h3>Beyond Baseball: Universal Interception</h3>

            <p>The gaze heuristic wasn't invented by baseball players. It's a solution that evolution discovered independently across species:</p>

            <p><strong>Dogs catching frisbees:</strong> Studies show dogs don't run to where the frisbee will land‚Äîthey adjust their path to keep the frisbee at a constant visual angle, producing curved running paths.</p>

            <p><strong>Hawks intercepting prey:</strong> Predatory birds maintain a constant angle to their prey, allowing interception without trajectory calculation.</p>

            <p><strong>Bats catching insects:</strong> Echolocation combined with the gaze heuristic allows bats to intercept moving insects in complete darkness.</p>

            <p><strong>Sidewinder missiles:</strong> Some missile guidance systems use the same principle‚Äîthey don't predict where the target will be; they continuously adjust to maintain intercept angle.</p>

            <h3>The Curved Path Mystery</h3>

            <p>One counterintuitive finding: outfielders following the gaze heuristic don't run in straight lines. They run in curves! Early researchers thought this was inefficient‚Äîwhy not run directly to the landing spot?</p>

            <div class="key-point">
                <strong>The Insight:</strong> The curved path IS the optimal solution when you don't know (and can't calculate) the landing spot. By maintaining constant angle, you're continuously correcting for uncertainty. If the ball's trajectory changes mid-flight (due to wind, for example), you automatically adjust‚Äîsomething a "run straight to predicted spot" strategy can't do.
            </div>

            <h3>Implications for AI and Robotics</h3>

            <p>The gaze heuristic challenges assumptions in artificial intelligence. Early AI tried to give robots complex physics models to catch balls. Modern approaches often work better using simple heuristics that react to visual feedback rather than calculate trajectories.</p>

            <p>This exemplifies a broader lesson: sometimes the "smart" solution isn't more computation‚Äîit's less. The right simple rule, applied in the right context, can outperform sophisticated calculation.</p>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('fieldCanvas');
        const ctx = canvas.getContext('2d');

        // Game state
        let mode = 'gaze'; // 'gaze', 'calc', 'manual'
        let gameState = 'waiting'; // 'waiting', 'flying', 'caught', 'missed'

        // Ball state
        let ball = { x: 0, y: 0, z: 0, vx: 0, vy: 0, vz: 0 };
        let landingX = 0;

        // Player state
        let player = { x: 0, y: 0 };
        let playerPath = [];

        // Physics
        let gravity = 0.15;
        let hitPower = 70;
        let hitAngle = 45;

        // Stats
        let stats = { caught: 0, missed: 0, gazeCatches: 0, calcCatches: 0 };

        // Field dimensions
        let fieldWidth, fieldHeight;
        const homeX = 80;

        function resizeCanvas() {
            const rect = canvas.parentElement.getBoundingClientRect();
            canvas.width = rect.width;
            canvas.height = rect.width / 1.5;
            fieldWidth = canvas.width;
            fieldHeight = canvas.height;

            // Reset player position
            player.x = homeX + 150;
            player.y = fieldHeight * 0.7;
        }

        function calculateGazeAngle() {
            if (ball.z <= 0) return 0;
            const dx = ball.x - player.x;
            const dy = ball.y - player.y;
            const horizontalDist = Math.sqrt(dx * dx + dy * dy);
            return Math.atan2(ball.z, horizontalDist) * 180 / Math.PI;
        }

        function hitBall() {
            if (gameState === 'flying') return;

            gameState = 'flying';
            playerPath = [{ x: player.x, y: player.y }];

            // Initial ball position (at home plate)
            ball.x = homeX;
            ball.y = fieldHeight * 0.85;
            ball.z = 5;

            // Calculate velocity based on power and angle
            const power = hitPower / 100;
            const angleRad = hitAngle * Math.PI / 180;
            const speed = 8 + power * 12;

            ball.vx = speed * Math.cos(angleRad) * 0.9;
            ball.vy = -speed * Math.cos(angleRad) * 0.3;
            ball.vz = speed * Math.sin(angleRad);

            // Pre-calculate landing position for 'calc' mode
            let simBall = { ...ball };
            while (simBall.z > 0) {
                simBall.x += simBall.vx;
                simBall.y += simBall.vy;
                simBall.z += simBall.vz;
                simBall.vz -= gravity;
            }
            landingX = simBall.x;

            // Reset player for fair comparison
            player.x = homeX + 150;
            player.y = fieldHeight * 0.7;

            updateStatus('Tracking ball...', 'status-tracking');
        }

        function updatePlayer() {
            if (gameState !== 'flying') return;

            const playerSpeed = 4;

            if (mode === 'gaze') {
                // GAZE HEURISTIC: Keep angle constant
                const currentAngle = calculateGazeAngle();
                const targetAngle = 42; // Sweet spot angle

                // If angle too high, ball is going over -> run back
                // If angle too low, ball is falling short -> run forward
                const angleDiff = currentAngle - targetAngle;

                if (Math.abs(angleDiff) > 0.5) {
                    // Move to correct the angle
                    const direction = angleDiff > 0 ? 1 : -1;
                    player.x += direction * playerSpeed;
                }

                // Also adjust y slightly for realism
                const dx = ball.x - player.x;
                if (Math.abs(dx) > 10) {
                    player.y += (ball.y - player.y) * 0.02;
                }

            } else if (mode === 'calc') {
                // CALCULATION MODE: Run straight to landing spot
                const dx = landingX - player.x;
                const landingY = ball.y + (landingX - ball.x) * (ball.vy / ball.vx);
                const dy = landingY - player.y;
                const dist = Math.sqrt(dx * dx + dy * dy);

                if (dist > 5) {
                    player.x += (dx / dist) * playerSpeed;
                    player.y += (dy / dist) * playerSpeed;
                }

            } else if (mode === 'manual') {
                // MANUAL MODE: Arrow keys (handled by keydown)
            }

            // Record path
            playerPath.push({ x: player.x, y: player.y });
        }

        function updateBall() {
            if (gameState !== 'flying') return;

            ball.x += ball.vx;
            ball.y += ball.vy;
            ball.z += ball.vz;
            ball.vz -= gravity;

            // Air resistance
            ball.vx *= 0.998;
            ball.vy *= 0.998;

            // Check if ball landed
            if (ball.z <= 0) {
                ball.z = 0;
                checkCatch();
            }
        }

        function checkCatch() {
            const dx = ball.x - player.x;
            const dy = ball.y - player.y;
            const dist = Math.sqrt(dx * dx + dy * dy);

            if (dist < 30) {
                gameState = 'caught';
                stats.caught++;
                if (mode === 'gaze') stats.gazeCatches++;
                if (mode === 'calc') stats.calcCatches++;
                updateStatus('CAUGHT! üéâ', 'status-caught');
            } else {
                gameState = 'missed';
                stats.missed++;
                updateStatus(`Missed by ${Math.round(dist)}px`, 'status-missed');
            }

            updateStats();
        }

        function updateStatus(text, className) {
            const bar = document.getElementById('statusBar');
            bar.textContent = text;
            bar.className = 'status-bar ' + className;
        }

        function updateStats() {
            document.getElementById('caught').textContent = stats.caught;
            document.getElementById('missed').textContent = stats.missed;
            document.getElementById('gazeCatches').textContent = stats.gazeCatches;
            document.getElementById('calcCatches').textContent = stats.calcCatches;
        }

        function drawField() {
            ctx.clearRect(0, 0, fieldWidth, fieldHeight);

            // Sky gradient
            const skyGrad = ctx.createLinearGradient(0, 0, 0, fieldHeight * 0.4);
            skyGrad.addColorStop(0, '#1a3a5c');
            skyGrad.addColorStop(1, '#2d5a7b');
            ctx.fillStyle = skyGrad;
            ctx.fillRect(0, 0, fieldWidth, fieldHeight * 0.4);

            // Field gradient
            const fieldGrad = ctx.createLinearGradient(0, fieldHeight * 0.4, 0, fieldHeight);
            fieldGrad.addColorStop(0, '#2d5a2d');
            fieldGrad.addColorStop(1, '#1a3a1a');
            ctx.fillStyle = fieldGrad;
            ctx.fillRect(0, fieldHeight * 0.4, fieldWidth, fieldHeight * 0.6);

            // Grass pattern
            ctx.strokeStyle = 'rgba(46, 204, 113, 0.1)';
            ctx.lineWidth = 1;
            for (let y = fieldHeight * 0.4; y < fieldHeight; y += 20) {
                ctx.beginPath();
                ctx.moveTo(0, y);
                ctx.lineTo(fieldWidth, y);
                ctx.stroke();
            }

            // Home plate
            ctx.fillStyle = '#f5f5f5';
            ctx.beginPath();
            ctx.moveTo(homeX, fieldHeight * 0.85 - 10);
            ctx.lineTo(homeX + 10, fieldHeight * 0.85);
            ctx.lineTo(homeX, fieldHeight * 0.85 + 10);
            ctx.lineTo(homeX - 10, fieldHeight * 0.85);
            ctx.closePath();
            ctx.fill();

            // Player path
            if (playerPath.length > 1) {
                ctx.strokeStyle = mode === 'gaze' ? 'rgba(46, 204, 113, 0.6)' :
                                 mode === 'calc' ? 'rgba(52, 152, 219, 0.6)' :
                                 'rgba(241, 196, 15, 0.6)';
                ctx.lineWidth = 3;
                ctx.setLineDash([5, 5]);
                ctx.beginPath();
                ctx.moveTo(playerPath[0].x, playerPath[0].y);
                for (let i = 1; i < playerPath.length; i++) {
                    ctx.lineTo(playerPath[i].x, playerPath[i].y);
                }
                ctx.stroke();
                ctx.setLineDash([]);
            }

            // Draw predicted landing spot in calc mode
            if (mode === 'calc' && gameState === 'flying') {
                ctx.fillStyle = 'rgba(52, 152, 219, 0.5)';
                ctx.beginPath();
                const landingY = ball.y + (landingX - ball.x) * (ball.vy / ball.vx);
                ctx.arc(landingX, landingY, 15, 0, Math.PI * 2);
                ctx.fill();
                ctx.strokeStyle = '#3498db';
                ctx.lineWidth = 2;
                ctx.stroke();
            }

            // Gaze line
            if (gameState === 'flying' && mode === 'gaze') {
                ctx.strokeStyle = 'rgba(46, 204, 113, 0.4)';
                ctx.lineWidth = 2;
                ctx.setLineDash([10, 10]);
                ctx.beginPath();
                ctx.moveTo(player.x, player.y);
                ctx.lineTo(ball.x, ball.y - ball.z * 3);
                ctx.stroke();
                ctx.setLineDash([]);
            }

            // Player (outfielder)
            ctx.fillStyle = '#e74c3c';
            ctx.beginPath();
            ctx.arc(player.x, player.y, 12, 0, Math.PI * 2);
            ctx.fill();
            ctx.fillStyle = '#fff';
            ctx.font = '10px sans-serif';
            ctx.textAlign = 'center';
            ctx.fillText('üß¢', player.x, player.y + 4);

            // Ball with shadow
            if (gameState === 'flying' || gameState === 'caught' || gameState === 'missed') {
                // Shadow on ground
                const shadowY = ball.y;
                const shadowSize = 5 + ball.z / 10;
                ctx.fillStyle = 'rgba(0, 0, 0, 0.3)';
                ctx.beginPath();
                ctx.ellipse(ball.x, shadowY, shadowSize, shadowSize / 2, 0, 0, Math.PI * 2);
                ctx.fill();

                // Ball (higher z = higher on screen)
                const ballY = ball.y - ball.z * 3;
                const ballSize = 8 + ball.z / 20;

                ctx.fillStyle = '#f5f5f5';
                ctx.beginPath();
                ctx.arc(ball.x, ballY, ballSize, 0, Math.PI * 2);
                ctx.fill();
                ctx.strokeStyle = '#c0392b';
                ctx.lineWidth = 2;
                ctx.stroke();
            }

            // Update angle display
            if (gameState === 'flying') {
                const angle = calculateGazeAngle();
                document.getElementById('gazeAngle').textContent = angle.toFixed(1) + '¬∞';

                // Calculate angle change
                if (playerPath.length > 10) {
                    const prevAngle = Math.atan2(ball.z, Math.sqrt(
                        (ball.x - playerPath[playerPath.length - 10].x) ** 2 +
                        (ball.y - playerPath[playerPath.length - 10].y) ** 2
                    )) * 180 / Math.PI;
                    const change = angle - prevAngle;

                    const changeEl = document.getElementById('angleChange');
                    if (Math.abs(change) < 0.3) {
                        changeEl.textContent = 'CONSTANT ‚úì';
                        changeEl.className = 'angle-value constant';
                    } else {
                        changeEl.textContent = (change > 0 ? '+' : '') + change.toFixed(1) + '¬∞';
                        changeEl.className = 'angle-value changing';
                    }
                }

                // Distance to ball
                const dist = Math.sqrt((ball.x - player.x) ** 2 + (ball.y - player.y) ** 2 + ball.z ** 2);
                document.getElementById('distanceToBall').textContent = Math.round(dist) + 'px';
            }
        }

        function gameLoop() {
            updateBall();
            updatePlayer();
            drawField();
            requestAnimationFrame(gameLoop);
        }

        function setMode(newMode) {
            mode = newMode;
            document.querySelectorAll('.mode-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById('mode' + newMode.charAt(0).toUpperCase() + newMode.slice(1)).classList.add('active');

            const explanations = {
                gaze: {
                    title: 'Gaze Heuristic Mode',
                    text: 'The outfielder ignores velocity, distance, wind, and spin. They only track ONE thing: the angle to the ball. If the angle increases, run back. If it decreases, run forward. Keep it constant ‚Üí catch the ball!'
                },
                calc: {
                    title: 'Calculate Trajectory Mode',
                    text: 'The outfielder calculates exactly where the ball will land and runs in a straight line to that spot. This requires solving physics equations‚Äîpossible for computers, but not how humans actually do it!'
                },
                manual: {
                    title: 'Manual Control Mode',
                    text: 'YOU control the outfielder! Use arrow keys to move. Try to catch the ball using your own strategy. Can you match the gaze heuristic?'
                }
            };

            const rules = {
                gaze: '"Keep the angle of gaze constant‚Äîrun so the ball stays at the same angle in your vision."',
                calc: '"Calculate the landing spot from initial velocity and angle, then run straight there."',
                manual: '"Use arrow keys (‚Üê ‚Üí ‚Üë ‚Üì) to move the outfielder and catch the ball!"'
            };

            const exp = explanations[newMode];
            document.querySelector('#explanationBox h4').textContent = exp.title;
            document.querySelector('#explanationBox p').textContent = exp.text;
            document.getElementById('ruleText').textContent = rules[newMode];
        }

        function resetField() {
            gameState = 'waiting';
            playerPath = [];
            player.x = homeX + 150;
            player.y = fieldHeight * 0.7;
            ball.z = 0;
            updateStatus('Press "Hit Ball" to start!', 'status-waiting');
            document.getElementById('gazeAngle').textContent = '‚Äî¬∞';
            document.getElementById('angleChange').textContent = '‚Äî';
            document.getElementById('distanceToBall').textContent = '‚Äî';
        }

        // Event listeners
        document.getElementById('hitBall').addEventListener('click', hitBall);
        document.getElementById('resetField').addEventListener('click', resetField);
        document.getElementById('modeGaze').addEventListener('click', () => setMode('gaze'));
        document.getElementById('modeCalc').addEventListener('click', () => setMode('calc'));
        document.getElementById('modeManual').addEventListener('click', () => setMode('manual'));

        document.getElementById('hitPower').addEventListener('input', function() {
            hitPower = parseInt(this.value);
            document.getElementById('powerValue').textContent = this.value;
        });

        document.getElementById('hitAngle').addEventListener('input', function() {
            hitAngle = parseInt(this.value);
            document.getElementById('hitAngleValue').textContent = this.value;
        });

        // Manual control
        document.addEventListener('keydown', (e) => {
            if (mode !== 'manual' || gameState !== 'flying') return;

            const speed = 8;
            switch (e.key) {
                case 'ArrowLeft': player.x -= speed; break;
                case 'ArrowRight': player.x += speed; break;
                case 'ArrowUp': player.y -= speed; break;
                case 'ArrowDown': player.y += speed; break;
            }
        });

        // Initialize
        window.addEventListener('resize', resizeCanvas);
        resizeCanvas();
        gameLoop();
    </script>
    <script src="../assets/js/enhance.js" defer></script>
</body>
</html>
