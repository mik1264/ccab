<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Peter Principle | Surprising Paradoxes</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            min-height: 100vh;
            color: #e8e8e8;
            overflow-x: hidden;
        }

        .back-link {
            position: fixed;
            top: 20px;
            left: 20px;
            color: #64b5f6;
            text-decoration: none;
            font-size: 14px;
            opacity: 0.8;
            transition: opacity 0.3s;
            z-index: 100;
        }

        .back-link:hover {
            opacity: 1;
        }

        .container {
            max-width: 950px;
            margin: 0 auto;
            padding: 60px 20px 40px;
        }

        h1 {
            text-align: center;
            font-size: 2.5em;
            margin-bottom: 10px;
            background: linear-gradient(135deg, #ff9800, #f44336);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .subtitle {
            text-align: center;
            color: #aaa;
            margin-bottom: 40px;
            font-size: 1.1em;
        }

        .intro-box {
            background: rgba(255, 152, 0, 0.1);
            border: 1px solid rgba(255, 152, 0, 0.3);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 40px;
        }

        .intro-box h2 {
            color: #ff9800;
            margin-bottom: 15px;
        }

        .intro-box p {
            line-height: 1.7;
            color: #ccc;
        }

        .quote-box {
            background: rgba(244, 67, 54, 0.1);
            border-left: 4px solid #f44336;
            padding: 20px;
            margin: 25px 0;
            font-style: italic;
            color: #bbb;
        }

        .quote-author {
            margin-top: 10px;
            color: #888;
            font-style: normal;
            font-size: 0.9em;
        }

        /* Simulation Section */
        .simulation-section {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 40px;
        }

        .simulation-section h2 {
            color: #64b5f6;
            margin-bottom: 15px;
            text-align: center;
        }

        .simulation-description {
            text-align: center;
            color: #aaa;
            margin-bottom: 25px;
        }

        /* Org Chart */
        .org-chart {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
            margin: 20px 0;
        }

        .org-level {
            display: flex;
            justify-content: center;
            gap: 10px;
            flex-wrap: wrap;
        }

        .org-level-label {
            position: absolute;
            left: -100px;
            font-size: 0.8em;
            color: #888;
            width: 90px;
            text-align: right;
        }

        .employee {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5em;
            transition: all 0.5s;
            cursor: help;
            position: relative;
        }

        .employee.competent {
            background: linear-gradient(135deg, #4caf50, #2e7d32);
            box-shadow: 0 0 15px rgba(76, 175, 80, 0.5);
        }

        .employee.struggling {
            background: linear-gradient(135deg, #ff9800, #f57c00);
            box-shadow: 0 0 15px rgba(255, 152, 0, 0.5);
        }

        .employee.incompetent {
            background: linear-gradient(135deg, #f44336, #c62828);
            box-shadow: 0 0 15px rgba(244, 67, 54, 0.5);
        }

        .employee.empty {
            background: rgba(255, 255, 255, 0.1);
            border: 2px dashed rgba(255, 255, 255, 0.3);
        }

        .employee-tooltip {
            display: none;
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.9);
            padding: 10px;
            border-radius: 8px;
            white-space: nowrap;
            font-size: 0.75em;
            z-index: 10;
        }

        .employee:hover .employee-tooltip {
            display: block;
        }

        /* Level Labels */
        .level-labels {
            display: flex;
            flex-direction: column;
            gap: 50px;
            position: absolute;
            left: 10px;
        }

        .level-row {
            display: flex;
            align-items: center;
            gap: 20px;
            position: relative;
        }

        .level-name {
            min-width: 100px;
            text-align: right;
            color: #888;
            font-size: 0.85em;
        }

        /* Controls */
        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 25px 0;
            flex-wrap: wrap;
        }

        .control-btn {
            padding: 12px 25px;
            border-radius: 25px;
            border: none;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.3s;
        }

        .control-btn.primary {
            background: linear-gradient(135deg, #4caf50, #2e7d32);
            color: white;
        }

        .control-btn.secondary {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }

        .control-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .control-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        /* Stats Panel */
        .stats-panel {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 15px;
            margin: 25px 0;
        }

        .stat-card {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            padding: 15px;
            text-align: center;
        }

        .stat-value {
            font-size: 2em;
            font-weight: bold;
        }

        .stat-value.green { color: #4caf50; }
        .stat-value.orange { color: #ff9800; }
        .stat-value.red { color: #f44336; }

        .stat-label {
            color: #888;
            font-size: 0.85em;
            margin-top: 5px;
        }

        /* Year Counter */
        .year-counter {
            text-align: center;
            margin: 20px 0;
            font-size: 1.2em;
            color: #64b5f6;
        }

        /* Speed Control */
        .speed-control {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
            margin: 15px 0;
        }

        .speed-slider {
            width: 150px;
            height: 8px;
            -webkit-appearance: none;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 4px;
            outline: none;
        }

        .speed-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 20px;
            height: 20px;
            background: #64b5f6;
            border-radius: 50%;
            cursor: pointer;
        }

        /* Result Box */
        .result-box {
            background: rgba(244, 67, 54, 0.1);
            border: 1px solid rgba(244, 67, 54, 0.3);
            border-radius: 15px;
            padding: 25px;
            margin-top: 25px;
            opacity: 0;
            transition: opacity 0.5s;
            text-align: center;
        }

        .result-box.visible {
            opacity: 1;
        }

        .result-box h3 {
            color: #f44336;
            margin-bottom: 15px;
        }

        .result-box p {
            color: #bbb;
            line-height: 1.7;
        }

        /* Book Section */
        .book-section {
            background: rgba(156, 39, 176, 0.1);
            border: 1px solid rgba(156, 39, 176, 0.3);
            border-radius: 15px;
            padding: 25px;
            margin-top: 40px;
        }

        .book-section h2 {
            color: #ce93d8;
            margin-bottom: 20px;
        }

        .book-info {
            display: flex;
            gap: 25px;
            flex-wrap: wrap;
        }

        .book-cover {
            width: 150px;
            height: 220px;
            background: linear-gradient(135deg, #4a148c, #7b1fa2);
            border-radius: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 15px;
            flex-shrink: 0;
        }

        .book-cover h4 {
            color: white;
            font-size: 1.1em;
            margin-bottom: 10px;
        }

        .book-cover p {
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.85em;
        }

        .book-details {
            flex: 1;
            min-width: 200px;
        }

        .book-details p {
            color: #bbb;
            line-height: 1.7;
        }

        .author-cards {
            display: flex;
            gap: 15px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .author-card {
            flex: 1;
            min-width: 150px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            padding: 15px;
            text-align: center;
        }

        .author-card h4 {
            color: #ce93d8;
            margin-bottom: 5px;
        }

        .author-card p {
            color: #888;
            font-size: 0.85em;
        }

        /* Corollaries */
        .corollaries {
            background: rgba(0, 150, 136, 0.1);
            border: 1px solid rgba(0, 150, 136, 0.3);
            border-radius: 15px;
            padding: 25px;
            margin-top: 40px;
        }

        .corollaries h2 {
            color: #4db6ac;
            margin-bottom: 20px;
        }

        .corollary-list {
            list-style: none;
        }

        .corollary-list li {
            padding: 15px;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 10px;
            margin-bottom: 10px;
        }

        .corollary-list li h4 {
            color: #4db6ac;
            margin-bottom: 5px;
        }

        .corollary-list li p {
            color: #aaa;
            font-size: 0.95em;
        }

        /* Real World */
        .real-world {
            margin-top: 40px;
        }

        .real-world h2 {
            color: #ff9800;
            margin-bottom: 25px;
            text-align: center;
        }

        .examples-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .example-card {
            background: rgba(255, 152, 0, 0.1);
            border: 1px solid rgba(255, 152, 0, 0.3);
            border-radius: 15px;
            padding: 20px;
            transition: transform 0.3s;
        }

        .example-card:hover {
            transform: translateY(-5px);
        }

        .example-icon {
            font-size: 2.5em;
            margin-bottom: 15px;
        }

        .example-card h3 {
            color: #ffb74d;
            margin-bottom: 10px;
        }

        .example-card p {
            color: #bbb;
            font-size: 0.95em;
            line-height: 1.6;
        }

        /* Solutions */
        .solutions {
            background: rgba(33, 150, 243, 0.1);
            border: 1px solid rgba(33, 150, 243, 0.3);
            border-radius: 15px;
            padding: 25px;
            margin-top: 40px;
        }

        .solutions h2 {
            color: #64b5f6;
            margin-bottom: 20px;
        }

        .solution-list {
            list-style: none;
        }

        .solution-list li {
            padding: 15px;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 10px;
            margin-bottom: 10px;
            display: flex;
            align-items: flex-start;
            gap: 15px;
        }

        .solution-icon {
            font-size: 1.5em;
            flex-shrink: 0;
        }

        .solution-content h4 {
            color: #64b5f6;
            margin-bottom: 5px;
        }

        .solution-content p {
            color: #aaa;
            font-size: 0.95em;
        }

        /* Legend */
        .legend {
            display: flex;
            justify-content: center;
            gap: 25px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9em;
            color: #aaa;
        }

        .legend-dot {
            width: 16px;
            height: 16px;
            border-radius: 50%;
        }

        .legend-dot.green { background: #4caf50; }
        .legend-dot.orange { background: #ff9800; }
        .legend-dot.red { background: #f44336; }

        @media (max-width: 600px) {
            h1 {
                font-size: 1.8em;
            }

            .employee {
                width: 45px;
                height: 45px;
                font-size: 1.2em;
            }

            .book-info {
                flex-direction: column;
                align-items: center;
            }
        }
    </style>
</head>
<body>
    <a href="index.html" class="back-link">‚Üê Back to Paradoxes</a>

    <div class="container">
        <h1>üìä The Peter Principle</h1>
        <p class="subtitle">Everyone rises to their level of incompetence</p>

        <div class="intro-box">
            <h2>The Paradox</h2>
            <p>
                In any hierarchy, employees are promoted based on performance in their <em>current</em> role.
                A great salesperson becomes a sales manager. A brilliant engineer becomes an engineering lead.
                But skills don't always transfer! The promotion continues until they reach a position where
                they are <strong>no longer competent</strong>‚Äîand there they stay, unable to earn another promotion.
            </p>
            <div class="quote-box">
                "In a hierarchy, every employee tends to rise to his level of incompetence."
                <div class="quote-author">‚Äî Laurence J. Peter, The Peter Principle (1969)</div>
            </div>
        </div>

        <div class="simulation-section">
            <h2>üè¢ Corporate Hierarchy Simulation</h2>
            <p class="simulation-description">
                Watch employees climb the corporate ladder based on their performance. Green = competent, Orange = struggling, Red = incompetent.
            </p>

            <div class="legend">
                <div class="legend-item">
                    <div class="legend-dot green"></div>
                    <span>Competent (performs well)</span>
                </div>
                <div class="legend-item">
                    <div class="legend-dot orange"></div>
                    <span>Struggling (borderline)</span>
                </div>
                <div class="legend-item">
                    <div class="legend-dot red"></div>
                    <span>Incompetent (stuck)</span>
                </div>
            </div>

            <div class="org-chart" id="orgChart">
                <!-- Generated by JavaScript -->
            </div>

            <div class="year-counter">
                Year: <span id="yearCounter">0</span>
            </div>

            <div class="stats-panel">
                <div class="stat-card">
                    <div class="stat-value green" id="competentCount">0</div>
                    <div class="stat-label">Competent</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value orange" id="strugglingCount">0</div>
                    <div class="stat-label">Struggling</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value red" id="incompetentCount">0</div>
                    <div class="stat-label">Incompetent</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="promotionCount" style="color: #64b5f6;">0</div>
                    <div class="stat-label">Promotions</div>
                </div>
            </div>

            <div class="speed-control">
                <span style="color: #aaa;">Speed:</span>
                <input type="range" class="speed-slider" id="speedSlider" min="100" max="1000" value="500">
                <span style="color: #aaa;" id="speedLabel">Medium</span>
            </div>

            <div class="controls">
                <button class="control-btn primary" id="startBtn">Start Simulation</button>
                <button class="control-btn secondary" id="stepBtn">Step Forward</button>
                <button class="control-btn secondary" id="resetBtn">Reset</button>
            </div>

            <div class="result-box" id="resultBox">
                <h3>üéØ Peter's Prediction Confirmed!</h3>
                <p id="resultText">
                    After multiple years, a significant portion of the organization is now stuck at their
                    level of incompetence. Work gets done by those who haven't yet reached their limit!
                </p>
            </div>
        </div>

        <div class="corollaries">
            <h2>üìú Peter's Corollaries</h2>
            <ul class="corollary-list">
                <li>
                    <h4>Corollary 1: The Saturation Point</h4>
                    <p>"In time, every post tends to be occupied by an employee who is incompetent to carry out its duties."</p>
                </li>
                <li>
                    <h4>Corollary 2: Work Gets Done By...</h4>
                    <p>"Work is accomplished by those employees who have not yet reached their level of incompetence."</p>
                </li>
                <li>
                    <h4>Corollary 3: Super-Incompetence</h4>
                    <p>Super-competence is more objectionable than incompetence‚Äîthe system cannot tolerate those who disrupt it from below.</p>
                </li>
                <li>
                    <h4>Corollary 4: Creative Incompetence</h4>
                    <p>The wise employee may deliberately avoid promotion to stay in a role where they are competent and happy.</p>
                </li>
            </ul>
        </div>

        <div class="book-section">
            <h2>üìö The 1969 Satire That Became Science</h2>
            <div class="book-info">
                <div class="book-cover">
                    <h4>THE PETER PRINCIPLE</h4>
                    <p>Why Things Always Go Wrong</p>
                    <p style="margin-top: 15px; font-size: 0.75em;">1969</p>
                </div>
                <div class="book-details">
                    <p>
                        Laurence J. Peter and Raymond Hull wrote their book as satire‚Äîa humorous critique of
                        organizational bureaucracy. But readers recognized the truth in it. The book became a
                        bestseller, and "Peter Principle" entered the business lexicon.
                    </p>
                    <p style="margin-top: 15px;">
                        In 2018, researchers at the National Bureau of Economic Research analyzed 214 firms
                        and 53,000 sales employees. They found strong evidence: <strong>the best salespeople
                        were most likely to be promoted to manager, but they became the worst managers.</strong>
                        Sales performance was negatively correlated with managerial performance.
                    </p>
                    <div class="author-cards">
                        <div class="author-card">
                            <h4>Laurence J. Peter</h4>
                            <p>1919-1990</p>
                            <p>Canadian educator</p>
                        </div>
                        <div class="author-card">
                            <h4>Raymond Hull</h4>
                            <p>1919-1985</p>
                            <p>Playwright & author</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="real-world">
            <h2>üåç The Peter Principle in Action</h2>
            <div class="examples-grid">
                <div class="example-card">
                    <div class="example-icon">üë®‚Äçüíº</div>
                    <h3>Star Sales ‚Üí Bad Manager</h3>
                    <p>
                        A top salesperson becomes sales manager. But selling (individual skill) differs
                        from managing (coaching, delegating, motivating). They miss their sales numbers
                        and can't develop their team.
                    </p>
                </div>
                <div class="example-card">
                    <div class="example-icon">üíª</div>
                    <h3>Great Coder ‚Üí Weak Lead</h3>
                    <p>
                        The best programmer gets promoted to tech lead. But writing code differs from
                        project management, stakeholder communication, and code review. The team stalls.
                    </p>
                </div>
                <div class="example-card">
                    <div class="example-icon">üéì</div>
                    <h3>Excellent Teacher ‚Üí Poor Admin</h3>
                    <p>
                        An inspiring teacher becomes principal. But classroom magic doesn't translate
                        to budgets, policies, and politics. The school suffers while they struggle.
                    </p>
                </div>
                <div class="example-card">
                    <div class="example-icon">‚öïÔ∏è</div>
                    <h3>Skilled Surgeon ‚Üí Ineffective Chief</h3>
                    <p>
                        A renowned surgeon becomes department head. Technical brilliance doesn't
                        prepare them for administration, conflict resolution, or institutional politics.
                    </p>
                </div>
                <div class="example-card">
                    <div class="example-icon">üè≠</div>
                    <h3>Factory Worker ‚Üí Failing Supervisor</h3>
                    <p>
                        The most productive worker gets promoted to supervisor. But doing the work
                        well is different from teaching, scheduling, and managing conflict.
                    </p>
                </div>
                <div class="example-card">
                    <div class="example-icon">‚öΩ</div>
                    <h3>Star Athlete ‚Üí Mediocre Coach</h3>
                    <p>
                        Natural talent doesn't teach well. Michael Jordan struggled as a team owner.
                        Wayne Gretzky had a losing coaching record. Playing ‚â† leading.
                    </p>
                </div>
            </div>
        </div>

        <div class="solutions">
            <h2>üõ†Ô∏è Fighting the Peter Principle</h2>
            <ul class="solution-list">
                <li>
                    <span class="solution-icon">üéØ</span>
                    <div class="solution-content">
                        <h4>Promote Based on Future-Role Skills</h4>
                        <p>Assess candidates for the competencies needed in the new role, not just
                        performance in the current one. Use simulations and assessments.</p>
                    </div>
                </li>
                <li>
                    <span class="solution-icon">üîÑ</span>
                    <div class="solution-content">
                        <h4>Allow "Demotions" Without Stigma</h4>
                        <p>Create culture where returning to a previous role isn't failure‚Äîit's finding
                        the right fit. Some companies call it "right-sizing your role."</p>
                    </div>
                </li>
                <li>
                    <span class="solution-icon">üìà</span>
                    <div class="solution-content">
                        <h4>Create Parallel Career Tracks</h4>
                        <p>Let excellent engineers stay engineers at high pay without forcing them
                        into management. Technical Fellow tracks honor expertise.</p>
                    </div>
                </li>
                <li>
                    <span class="solution-icon">üß™</span>
                    <div class="solution-content">
                        <h4>Trial Promotions</h4>
                        <p>Offer temporary or "acting" roles before permanent promotion. If it doesn't
                        work, return without embarrassment.</p>
                    </div>
                </li>
                <li>
                    <span class="solution-icon">üéì</span>
                    <div class="solution-content">
                        <h4>Train Before Promoting</h4>
                        <p>Invest in management training before promotion, not after. Don't assume
                        high performers automatically know how to lead.</p>
                    </div>
                </li>
            </ul>
        </div>
    </div>

    <script>
        // Organization structure
        const levels = [
            { name: 'CEO', slots: 1 },
            { name: 'VP', slots: 2 },
            { name: 'Director', slots: 4 },
            { name: 'Manager', slots: 8 },
            { name: 'Senior', slots: 12 },
            { name: 'Junior', slots: 16 }
        ];

        let employees = [];
        let year = 0;
        let promotions = 0;
        let isRunning = false;
        let intervalId = null;

        const emojis = ['üë§', 'üë©', 'üë®', 'üßë', 'üë±', 'üë©‚Äçü¶∞', 'üë®‚Äçü¶≥', 'üßî'];

        function initializeOrg() {
            employees = [];

            levels.forEach((level, levelIndex) => {
                for (let i = 0; i < level.slots; i++) {
                    // Everyone starts competent at entry level
                    const skillCap = 3 + Math.random() * 4; // Caps at level 3-7
                    employees.push({
                        id: employees.length,
                        level: levelIndex,
                        slot: i,
                        emoji: emojis[Math.floor(Math.random() * emojis.length)],
                        skillCap: skillCap,
                        yearsInRole: 0,
                        status: levelIndex >= skillCap ? 'incompetent' : (levelIndex >= skillCap - 1 ? 'struggling' : 'competent')
                    });
                }
            });

            year = 0;
            promotions = 0;
            renderOrg();
            updateStats();
        }

        function renderOrg() {
            const chart = document.getElementById('orgChart');
            chart.innerHTML = '';

            levels.forEach((level, levelIndex) => {
                const levelDiv = document.createElement('div');
                levelDiv.className = 'org-level';

                const levelEmployees = employees.filter(e => e.level === levelIndex);

                for (let i = 0; i < level.slots; i++) {
                    const emp = levelEmployees.find(e => e.slot === i);
                    const empDiv = document.createElement('div');

                    if (emp) {
                        empDiv.className = `employee ${emp.status}`;
                        empDiv.innerHTML = `
                            ${emp.emoji}
                            <div class="employee-tooltip">
                                ${level.name} | Skill Cap: Level ${Math.floor(emp.skillCap)}<br>
                                Years in role: ${emp.yearsInRole}
                            </div>
                        `;
                    } else {
                        empDiv.className = 'employee empty';
                    }

                    levelDiv.appendChild(empDiv);
                }

                chart.appendChild(levelDiv);
            });
        }

        function simulateYear() {
            year++;
            document.getElementById('yearCounter').textContent = year;

            // Increment years in role
            employees.forEach(e => e.yearsInRole++);

            // Process promotions (competent employees can be promoted)
            for (let level = 1; level < levels.length; level++) {
                const vacancies = levels[level - 1].slots -
                    employees.filter(e => e.level === level - 1).length;

                if (vacancies > 0) {
                    // Find competent employees at lower level to promote
                    const candidates = employees.filter(e =>
                        e.level === level &&
                        e.status === 'competent' &&
                        e.yearsInRole >= 2
                    );

                    candidates.slice(0, vacancies).forEach(emp => {
                        promoteEmployee(emp);
                    });
                }
            }

            // Some competent people at top of their level get promoted if space
            for (let level = levels.length - 1; level > 0; level--) {
                const promotableLevel = level - 1;
                const currentSlots = employees.filter(e => e.level === promotableLevel).length;

                if (currentSlots < levels[promotableLevel].slots) {
                    const candidates = employees.filter(e =>
                        e.level === level &&
                        e.status === 'competent' &&
                        e.yearsInRole >= 2
                    );

                    if (candidates.length > 0) {
                        const lucky = candidates[Math.floor(Math.random() * candidates.length)];
                        promoteEmployee(lucky);
                    }
                }
            }

            // Hire replacements at bottom level
            const bottomLevel = levels.length - 1;
            const bottomEmployees = employees.filter(e => e.level === bottomLevel).length;
            const bottomVacancies = levels[bottomLevel].slots - bottomEmployees;

            for (let i = 0; i < bottomVacancies; i++) {
                const emptySlot = Array.from({length: levels[bottomLevel].slots}, (_, i) => i)
                    .find(slot => !employees.some(e => e.level === bottomLevel && e.slot === slot));

                if (emptySlot !== undefined) {
                    const skillCap = 3 + Math.random() * 4;
                    employees.push({
                        id: employees.length,
                        level: bottomLevel,
                        slot: emptySlot,
                        emoji: emojis[Math.floor(Math.random() * emojis.length)],
                        skillCap: skillCap,
                        yearsInRole: 0,
                        status: 'competent'
                    });
                }
            }

            renderOrg();
            updateStats();

            // Check if most of org is incompetent
            const incompetent = employees.filter(e => e.status === 'incompetent').length;
            if (incompetent >= employees.length * 0.4) {
                showResult();
            }
        }

        function promoteEmployee(emp) {
            // Find empty slot at higher level
            const newLevel = emp.level - 1;
            const newLevelEmployees = employees.filter(e => e.level === newLevel);

            if (newLevelEmployees.length < levels[newLevel].slots) {
                const emptySlot = Array.from({length: levels[newLevel].slots}, (_, i) => i)
                    .find(slot => !newLevelEmployees.some(e => e.slot === slot));

                if (emptySlot !== undefined) {
                    emp.level = newLevel;
                    emp.slot = emptySlot;
                    emp.yearsInRole = 0;
                    promotions++;

                    // Update status based on new level vs skill cap
                    if (newLevel >= emp.skillCap) {
                        emp.status = 'incompetent';
                    } else if (newLevel >= emp.skillCap - 1) {
                        emp.status = 'struggling';
                    } else {
                        emp.status = 'competent';
                    }
                }
            }
        }

        function updateStats() {
            const competent = employees.filter(e => e.status === 'competent').length;
            const struggling = employees.filter(e => e.status === 'struggling').length;
            const incompetent = employees.filter(e => e.status === 'incompetent').length;

            document.getElementById('competentCount').textContent = competent;
            document.getElementById('strugglingCount').textContent = struggling;
            document.getElementById('incompetentCount').textContent = incompetent;
            document.getElementById('promotionCount').textContent = promotions;
        }

        function showResult() {
            const incompetent = employees.filter(e => e.status === 'incompetent').length;
            const total = employees.length;
            const pct = Math.round(incompetent / total * 100);

            document.getElementById('resultText').innerHTML = `
                After ${year} years and ${promotions} promotions, <strong>${pct}%</strong> of the organization
                is now at their level of incompetence. The real work gets done by the ${100 - pct}% who
                haven't been promoted past their capabilities yet!
            `;
            document.getElementById('resultBox').classList.add('visible');

            if (isRunning) {
                stopSimulation();
            }
        }

        function startSimulation() {
            if (isRunning) return;
            isRunning = true;
            document.getElementById('startBtn').textContent = 'Pause';
            document.getElementById('startBtn').classList.remove('primary');
            document.getElementById('startBtn').classList.add('secondary');

            const speed = 1100 - parseInt(document.getElementById('speedSlider').value);
            intervalId = setInterval(simulateYear, speed);
        }

        function stopSimulation() {
            isRunning = false;
            document.getElementById('startBtn').textContent = 'Resume';
            document.getElementById('startBtn').classList.add('primary');
            document.getElementById('startBtn').classList.remove('secondary');

            if (intervalId) {
                clearInterval(intervalId);
                intervalId = null;
            }
        }

        function resetSimulation() {
            stopSimulation();
            document.getElementById('startBtn').textContent = 'Start Simulation';
            document.getElementById('resultBox').classList.remove('visible');
            initializeOrg();
        }

        // Event listeners
        document.getElementById('startBtn').addEventListener('click', () => {
            if (isRunning) {
                stopSimulation();
            } else {
                startSimulation();
            }
        });

        document.getElementById('stepBtn').addEventListener('click', () => {
            if (!isRunning) {
                simulateYear();
            }
        });

        document.getElementById('resetBtn').addEventListener('click', resetSimulation);

        document.getElementById('speedSlider').addEventListener('input', function() {
            const value = parseInt(this.value);
            const label = document.getElementById('speedLabel');

            if (value < 300) label.textContent = 'Slow';
            else if (value < 700) label.textContent = 'Medium';
            else label.textContent = 'Fast';

            if (isRunning) {
                clearInterval(intervalId);
                const speed = 1100 - value;
                intervalId = setInterval(simulateYear, speed);
            }
        });

        // Initialize
        initializeOrg();
    </script>
</body>
</html>
