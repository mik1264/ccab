<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Galileo's Paradox | Surprising Paradoxes</title>
    <style>
        :root {
            --sage: #8A9A5B;
            --moss: #606C38;
            --earth: #DDA15E;
            --cream: #FEFAE0;
            --terracotta: #BC6C25;
            --dark-moss: #3d4423;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Nunito', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, var(--cream) 0%, #F4F1DE 50%, #EDE8D5 100%);
            color: var(--dark-moss);
            min-height: 100vh;
            line-height: 1.6;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 2rem;
        }

        .back-link {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--moss);
            text-decoration: none;
            margin-bottom: 1.5rem;
            transition: color 0.3s;
        }

        .back-link:hover {
            color: var(--terracotta);
        }

        h1 {
            font-family: 'Lora', Georgia, serif;
            font-size: 2.5rem;
            color: var(--dark-moss);
            margin-bottom: 0.5rem;
        }

        .subtitle {
            color: var(--moss);
            font-size: 1.1rem;
            margin-bottom: 2rem;
        }

        .intro-box {
            background: rgba(255, 255, 255, 0.7);
            border: 1px solid rgba(138, 154, 91, 0.3);
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 2rem;
            backdrop-filter: blur(10px);
        }

        .intro-box h2 {
            font-family: 'Lora', Georgia, serif;
            color: var(--moss);
            margin-bottom: 1rem;
        }

        .intro-box p {
            margin-bottom: 1rem;
        }

        .sim-container {
            background: rgba(255, 255, 255, 0.8);
            border: 1px solid rgba(138, 154, 91, 0.3);
            border-radius: 20px;
            padding: 2rem;
            margin-bottom: 2rem;
            backdrop-filter: blur(10px);
        }

        .sim-header {
            text-align: center;
            margin-bottom: 1.5rem;
        }

        .sim-header h3 {
            font-family: 'Lora', Georgia, serif;
            color: var(--moss);
            font-size: 1.3rem;
        }

        /* Bijection visualization */
        .bijection-viz {
            display: flex;
            flex-direction: column;
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .number-row {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .row-label {
            width: 140px;
            font-weight: bold;
            color: var(--moss);
            text-align: right;
            flex-shrink: 0;
        }

        .numbers-container {
            display: flex;
            gap: 0.5rem;
            overflow-x: auto;
            padding: 0.5rem;
            flex-grow: 1;
        }

        .number-box {
            min-width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 10px;
            font-weight: bold;
            font-size: 1.1rem;
            transition: all 0.3s;
            flex-shrink: 0;
        }

        .number-box.natural {
            background: linear-gradient(135deg, var(--sage), var(--moss));
            color: white;
        }

        .number-box.square {
            background: linear-gradient(135deg, var(--earth), var(--terracotta));
            color: white;
        }

        .number-box.highlighted {
            transform: scale(1.15);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        .number-box.faded {
            opacity: 0.3;
        }

        /* Arrow connections */
        .arrows-container {
            position: relative;
            height: 60px;
            margin: -0.5rem 0;
        }

        .arrow-svg {
            width: 100%;
            height: 100%;
            overflow: visible;
        }

        .arrow-path {
            fill: none;
            stroke: var(--terracotta);
            stroke-width: 2;
            opacity: 0.6;
        }

        .arrow-path.active {
            opacity: 1;
            stroke-width: 3;
        }

        /* Controls */
        .controls {
            display: flex;
            justify-content: center;
            gap: 1rem;
            flex-wrap: wrap;
            margin-bottom: 1.5rem;
        }

        .controls button {
            background: linear-gradient(135deg, var(--moss), var(--dark-moss));
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s;
        }

        .controls button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(96, 108, 56, 0.4);
        }

        .controls button.active {
            background: linear-gradient(135deg, var(--terracotta), var(--earth));
        }

        /* Range slider */
        .slider-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .slider-container label {
            font-weight: bold;
            color: var(--moss);
        }

        .slider-container input[type="range"] {
            width: 200px;
            accent-color: var(--moss);
        }

        .slider-value {
            min-width: 40px;
            text-align: center;
            font-weight: bold;
            color: var(--terracotta);
        }

        /* Stats display */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.9);
            border: 1px solid rgba(138, 154, 91, 0.3);
            border-radius: 12px;
            padding: 1rem;
            text-align: center;
        }

        .stat-card .label {
            color: var(--moss);
            font-size: 0.85rem;
            margin-bottom: 0.5rem;
        }

        .stat-card .value {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--dark-moss);
        }

        .stat-card .value.natural {
            color: var(--moss);
        }

        .stat-card .value.square {
            color: var(--terracotta);
        }

        /* Density comparison */
        .density-section {
            background: rgba(255, 255, 255, 0.7);
            border: 1px solid rgba(138, 154, 91, 0.3);
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }

        .density-section h3 {
            font-family: 'Lora', Georgia, serif;
            color: var(--moss);
            margin-bottom: 1rem;
        }

        .density-bars {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .density-bar-row {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .density-label {
            width: 120px;
            font-weight: bold;
            color: var(--dark-moss);
        }

        .density-bar-container {
            flex-grow: 1;
            height: 30px;
            background: rgba(0, 0, 0, 0.1);
            border-radius: 15px;
            overflow: hidden;
            position: relative;
        }

        .density-bar {
            height: 100%;
            border-radius: 15px;
            transition: width 0.5s ease-out;
        }

        .density-bar.natural {
            background: linear-gradient(90deg, var(--sage), var(--moss));
        }

        .density-bar.square {
            background: linear-gradient(90deg, var(--earth), var(--terracotta));
        }

        .density-percent {
            min-width: 60px;
            text-align: right;
            font-weight: bold;
        }

        /* Paradox box */
        .paradox-box {
            background: linear-gradient(135deg, rgba(188, 108, 37, 0.15), rgba(221, 161, 94, 0.1));
            border: 2px solid var(--terracotta);
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }

        .paradox-box h3 {
            font-family: 'Lora', Georgia, serif;
            color: var(--terracotta);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .paradox-box p {
            margin-bottom: 1rem;
        }

        .paradox-box strong {
            color: var(--terracotta);
        }

        /* Two observations */
        .observations {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        @media (max-width: 700px) {
            .observations {
                grid-template-columns: 1fr;
            }
        }

        .observation-card {
            background: rgba(255, 255, 255, 0.8);
            border-radius: 16px;
            padding: 1.5rem;
            border-left: 4px solid;
        }

        .observation-card.intuitive {
            border-color: var(--moss);
        }

        .observation-card.counter {
            border-color: var(--terracotta);
        }

        .observation-card h4 {
            margin-bottom: 0.75rem;
        }

        .observation-card.intuitive h4 {
            color: var(--moss);
        }

        .observation-card.counter h4 {
            color: var(--terracotta);
        }

        .observation-card p {
            font-size: 0.95rem;
        }

        /* Historical section */
        .history-section {
            background: rgba(255, 255, 255, 0.7);
            border: 1px solid rgba(138, 154, 91, 0.3);
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }

        .history-section h3 {
            font-family: 'Lora', Georgia, serif;
            color: var(--moss);
            margin-bottom: 1rem;
        }

        .timeline {
            position: relative;
            padding-left: 30px;
        }

        .timeline::before {
            content: '';
            position: absolute;
            left: 8px;
            top: 0;
            bottom: 0;
            width: 2px;
            background: linear-gradient(to bottom, var(--moss), var(--terracotta));
        }

        .timeline-item {
            position: relative;
            margin-bottom: 1.5rem;
            padding-left: 20px;
        }

        .timeline-item::before {
            content: '';
            position: absolute;
            left: -26px;
            top: 5px;
            width: 12px;
            height: 12px;
            background: var(--sage);
            border-radius: 50%;
            border: 2px solid white;
        }

        .timeline-item .year {
            font-weight: bold;
            color: var(--terracotta);
            margin-bottom: 0.3rem;
        }

        /* Quote */
        .quote-box {
            background: rgba(96, 108, 56, 0.15);
            border-left: 4px solid var(--sage);
            padding: 1.5rem;
            margin: 2rem 0;
            font-style: italic;
        }

        .quote-box .author {
            margin-top: 0.5rem;
            text-align: right;
            color: var(--moss);
            font-style: normal;
            font-weight: bold;
        }

        /* Resolution box */
        .resolution-box {
            background: rgba(138, 154, 91, 0.15);
            border: 2px solid var(--sage);
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }

        .resolution-box h3 {
            font-family: 'Lora', Georgia, serif;
            color: var(--moss);
            margin-bottom: 1rem;
        }

        /* Infinite sequence animation */
        .infinite-scroll {
            height: 60px;
            overflow: hidden;
            position: relative;
            background: rgba(0, 0, 0, 0.05);
            border-radius: 10px;
            margin: 1rem 0;
        }

        .scroll-content {
            display: flex;
            gap: 0.5rem;
            animation: scroll-left 20s linear infinite;
            padding: 5px;
        }

        @keyframes scroll-left {
            0% { transform: translateX(0); }
            100% { transform: translateX(-50%); }
        }

        .scroll-number {
            min-width: 45px;
            height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            font-weight: bold;
            flex-shrink: 0;
        }

        .scroll-number.natural {
            background: var(--moss);
            color: white;
        }

        .scroll-number.square {
            background: var(--terracotta);
            color: white;
        }

        /* Mobile adjustments */
        @media (max-width: 600px) {
            h1 { font-size: 1.8rem; }
            .container { padding: 1rem; }
            .number-box { min-width: 40px; height: 40px; font-size: 0.9rem; }
            .row-label { width: 100px; font-size: 0.85rem; }
        }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Lora:wght@400;500;600;700&family=Nunito:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="container">
        <a href="index.html" class="back-link">‚Üê Back to Paradoxes</a>

        <h1>üî¢ Galileo's Paradox</h1>
        <p class="subtitle">How can a proper subset be the same size as the whole set?</p>

        <div class="intro-box">
            <h2>The Discovery (1638)</h2>
            <p>
                In his final scientific work, <em>Two New Sciences</em>, Galileo Galilei discovered something
                deeply troubling about infinity. Consider the <strong>natural numbers</strong> (1, 2, 3, 4, 5, ...)
                and the <strong>perfect squares</strong> (1, 4, 9, 16, 25, ...).
            </p>
            <p>
                Every perfect square is a natural number, but not every natural number is a perfect square.
                So there must be <em>fewer</em> squares than naturals... right? Yet Galileo found a way to
                pair them up perfectly, one-to-one, suggesting they have the <em>same</em> size!
            </p>
        </div>

        <div class="sim-container">
            <div class="sim-header">
                <h3>The Bijection: Perfect Pairing</h3>
                <p style="color: var(--moss); margin-top: 0.5rem;">Each natural number n maps to exactly one square n¬≤</p>
            </div>

            <div class="slider-container">
                <label>Numbers shown:</label>
                <input type="range" id="rangeSlider" min="5" max="20" value="10">
                <span class="slider-value" id="sliderValue">10</span>
            </div>

            <div class="bijection-viz" id="bijectionViz">
                <div class="number-row">
                    <div class="row-label">Natural Numbers</div>
                    <div class="numbers-container" id="naturalsRow"></div>
                </div>

                <div class="arrows-container">
                    <svg class="arrow-svg" id="arrowsSvg"></svg>
                </div>

                <div class="number-row">
                    <div class="row-label">Perfect Squares</div>
                    <div class="numbers-container" id="squaresRow"></div>
                </div>
            </div>

            <div class="controls">
                <button id="btnAnimate">‚ñ∂ Animate Pairing</button>
                <button id="btnHighlight">üîç Highlight Pair</button>
                <button id="btnReset">‚Ü∫ Reset</button>
            </div>

            <div class="stats-grid">
                <div class="stat-card">
                    <div class="label">Natural Numbers</div>
                    <div class="value natural" id="statNaturals">10</div>
                </div>
                <div class="stat-card">
                    <div class="label">Perfect Squares</div>
                    <div class="value square" id="statSquares">10</div>
                </div>
                <div class="stat-card">
                    <div class="label">Bijective Pairs</div>
                    <div class="value" id="statPairs">10</div>
                </div>
                <div class="stat-card">
                    <div class="label">Unmapped Numbers?</div>
                    <div class="value">0</div>
                </div>
            </div>
        </div>

        <div class="density-section">
            <h3>The Vanishing Density</h3>
            <p style="margin-bottom: 1rem;">As we look at larger ranges, squares become increasingly sparse among all numbers:</p>

            <div class="density-bars">
                <div class="density-bar-row">
                    <div class="density-label">Up to 100:</div>
                    <div class="density-bar-container">
                        <div class="density-bar natural" style="width: 100%;"></div>
                    </div>
                    <div class="density-percent">100 nums</div>
                </div>
                <div class="density-bar-row">
                    <div class="density-label"></div>
                    <div class="density-bar-container">
                        <div class="density-bar square" style="width: 10%;"></div>
                    </div>
                    <div class="density-percent">10 squares (10%)</div>
                </div>

                <div class="density-bar-row">
                    <div class="density-label">Up to 10,000:</div>
                    <div class="density-bar-container">
                        <div class="density-bar natural" style="width: 100%;"></div>
                    </div>
                    <div class="density-percent">10,000 nums</div>
                </div>
                <div class="density-bar-row">
                    <div class="density-label"></div>
                    <div class="density-bar-container">
                        <div class="density-bar square" style="width: 1%;"></div>
                    </div>
                    <div class="density-percent">100 squares (1%)</div>
                </div>

                <div class="density-bar-row">
                    <div class="density-label">Up to 1,000,000:</div>
                    <div class="density-bar-container">
                        <div class="density-bar natural" style="width: 100%;"></div>
                    </div>
                    <div class="density-percent">1M nums</div>
                </div>
                <div class="density-bar-row">
                    <div class="density-label"></div>
                    <div class="density-bar-container">
                        <div class="density-bar square" style="width: 0.1%;"></div>
                    </div>
                    <div class="density-percent">1,000 squares (0.1%)</div>
                </div>
            </div>

            <p style="margin-top: 1rem; color: var(--moss); text-align: center;">
                <strong>Pattern:</strong> Up to N, there are ‚àöN perfect squares ‚Äî only <span id="densityFormula">1/‚àöN</span> of all numbers!
            </p>
        </div>

        <div class="observations">
            <div class="observation-card intuitive">
                <h4>üßÆ Intuitive Argument</h4>
                <p>
                    The squares are a <strong>proper subset</strong> of the naturals.
                    Some numbers are squares (1, 4, 9...) while others are not (2, 3, 5, 6, 7, 8...).
                    Therefore, there must be <em>more</em> natural numbers than squares.
                </p>
            </div>
            <div class="observation-card counter">
                <h4>üîó Counter-Argument</h4>
                <p>
                    Every natural n pairs with exactly one square n¬≤.
                    Every square n¬≤ pairs with exactly one natural ‚àön¬≤.
                    <strong>No leftovers on either side!</strong>
                    Therefore, they must be the <em>same size</em>.
                </p>
            </div>
        </div>

        <div class="paradox-box">
            <h3>‚ö†Ô∏è The Paradox</h3>
            <p>
                Both arguments seem valid, yet they reach opposite conclusions! How can the perfect
                squares be <strong>fewer</strong> (they're a proper subset with vanishing density)
                and yet <strong>equal</strong> (they have a one-to-one correspondence)?
            </p>
            <p>
                Galileo's solution was radical: he concluded that <strong>concepts like "greater than,"
                "less than," and "equal to" simply don't apply to infinite sets</strong> the way they
                do to finite ones. Infinity breaks our normal intuitions about quantity.
            </p>
        </div>

        <div class="quote-box">
            "The totality of all numbers is infinite, and the number of squares is infinite,
            and the number of their roots is infinite; neither is the number of squares less
            than the totality of all numbers, nor the latter greater than the former."
            <div class="author">‚Äî Galileo Galilei, Two New Sciences (1638)</div>
        </div>

        <div class="history-section">
            <h3>The Path to Resolution</h3>
            <div class="timeline">
                <div class="timeline-item">
                    <div class="year">1638</div>
                    <div class="desc">Galileo discovers the paradox, concludes that infinity defies ordinary comparison.</div>
                </div>
                <div class="timeline-item">
                    <div class="year">1851</div>
                    <div class="desc">Bolzano uses one-to-one correspondence to define when infinite sets are "equinumerous."</div>
                </div>
                <div class="timeline-item">
                    <div class="year">1874-1891</div>
                    <div class="desc">Georg Cantor develops set theory, defines cardinality, and proves different sizes of infinity exist.</div>
                </div>
                <div class="timeline-item">
                    <div class="year">Today</div>
                    <div class="desc">Bijection-based comparison is standard. Both sets have cardinality ‚Ñµ‚ÇÄ (aleph-null).</div>
                </div>
            </div>
        </div>

        <div class="resolution-box">
            <h3>‚ú® Cantor's Resolution</h3>
            <p>
                Georg Cantor resolved the paradox by redefining what it means for infinite sets to have
                "the same size." Two sets are <strong>equinumerous</strong> if and only if there exists
                a one-to-one correspondence (bijection) between them.
            </p>
            <p style="margin-top: 1rem;">
                By this definition, the paradox dissolves: <strong>both arguments are correct!</strong>
            </p>
            <ul style="margin-top: 1rem; margin-left: 1.5rem;">
                <li>The squares ARE a proper subset (true for any two infinite sets that can be mapped).</li>
                <li>The squares ARE equinumerous with the naturals (both have cardinality ‚Ñµ‚ÇÄ).</li>
            </ul>
            <p style="margin-top: 1rem;">
                The key insight: <strong>An infinite set can be put into one-to-one correspondence with
                a proper subset of itself.</strong> This is actually the <em>defining property</em> of
                infinite sets (Dedekind's definition).
            </p>
        </div>

        <div class="intro-box" style="background: rgba(138, 154, 91, 0.15); border-color: var(--moss);">
            <h2>Infinite Sequences Side by Side</h2>
            <p>Watch both infinite sequences flow eternally, perfectly matched:</p>

            <div class="infinite-scroll">
                <div class="scroll-content" id="infiniteNaturals"></div>
            </div>

            <div class="infinite-scroll">
                <div class="scroll-content" id="infiniteSquares"></div>
            </div>

            <p style="text-align: center; margin-top: 1rem; color: var(--moss);">
                No matter how far you go, every natural number has its square partner, and vice versa.
            </p>
        </div>

        <div class="intro-box">
            <h2>Why This Matters</h2>
            <p>
                Galileo's paradox was the first clear demonstration that infinity behaves in ways
                fundamentally different from finite quantities. This paved the way for:
            </p>
            <ul style="margin-left: 1.5rem; margin-top: 1rem;">
                <li><strong>Cantor's set theory</strong> ‚Äî the foundation of modern mathematics</li>
                <li><strong>Hilbert's Hotel paradox</strong> ‚Äî infinity can always accommodate more</li>
                <li><strong>Different sizes of infinity</strong> ‚Äî ‚Ñµ‚ÇÄ &lt; 2^‚Ñµ‚ÇÄ (naturals vs reals)</li>
                <li><strong>Measure theory</strong> ‚Äî how to quantify infinite sets sensibly</li>
            </ul>
        </div>
    </div>

    <script>
        const rangeSlider = document.getElementById('rangeSlider');
        const sliderValue = document.getElementById('sliderValue');
        const naturalsRow = document.getElementById('naturalsRow');
        const squaresRow = document.getElementById('squaresRow');
        const arrowsSvg = document.getElementById('arrowsSvg');
        const statNaturals = document.getElementById('statNaturals');
        const statSquares = document.getElementById('statSquares');
        const statPairs = document.getElementById('statPairs');
        const btnAnimate = document.getElementById('btnAnimate');
        const btnHighlight = document.getElementById('btnHighlight');
        const btnReset = document.getElementById('btnReset');

        let count = 10;
        let highlightIndex = 0;
        let animating = false;

        function createNumbers() {
            naturalsRow.innerHTML = '';
            squaresRow.innerHTML = '';

            for (let i = 1; i <= count; i++) {
                const natBox = document.createElement('div');
                natBox.className = 'number-box natural';
                natBox.textContent = i;
                natBox.dataset.index = i;
                naturalsRow.appendChild(natBox);

                const sqBox = document.createElement('div');
                sqBox.className = 'number-box square';
                sqBox.textContent = i * i;
                sqBox.dataset.index = i;
                squaresRow.appendChild(sqBox);
            }

            // Add ellipsis
            const ellipsis1 = document.createElement('div');
            ellipsis1.className = 'number-box natural';
            ellipsis1.textContent = '...';
            ellipsis1.style.background = 'transparent';
            ellipsis1.style.color = 'var(--moss)';
            naturalsRow.appendChild(ellipsis1);

            const ellipsis2 = document.createElement('div');
            ellipsis2.className = 'number-box square';
            ellipsis2.textContent = '...';
            ellipsis2.style.background = 'transparent';
            ellipsis2.style.color = 'var(--terracotta)';
            squaresRow.appendChild(ellipsis2);

            updateStats();
            drawArrows();
        }

        function drawArrows() {
            const natBoxes = naturalsRow.querySelectorAll('.number-box:not(:last-child)');
            const sqBoxes = squaresRow.querySelectorAll('.number-box:not(:last-child)');

            if (natBoxes.length === 0) return;

            const containerRect = arrowsSvg.parentElement.getBoundingClientRect();
            arrowsSvg.innerHTML = '';

            // Only draw arrows for visible/highlighted items to reduce clutter
            const maxArrows = Math.min(count, 8);

            for (let i = 0; i < maxArrows; i++) {
                const natRect = natBoxes[i].getBoundingClientRect();
                const sqRect = sqBoxes[i].getBoundingClientRect();

                const startX = natRect.left - containerRect.left + natRect.width / 2;
                const startY = 0;
                const endX = sqRect.left - containerRect.left + sqRect.width / 2;
                const endY = 60;

                const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
                const midY = 30;
                path.setAttribute('d', `M ${startX} ${startY} Q ${startX} ${midY} ${endX} ${endY}`);
                path.setAttribute('class', 'arrow-path');
                path.dataset.index = i + 1;
                arrowsSvg.appendChild(path);
            }
        }

        function updateStats() {
            statNaturals.textContent = count;
            statSquares.textContent = count;
            statPairs.textContent = count;
        }

        function highlightPair(index) {
            // Clear all highlights
            document.querySelectorAll('.number-box').forEach(box => {
                box.classList.remove('highlighted', 'faded');
            });
            document.querySelectorAll('.arrow-path').forEach(path => {
                path.classList.remove('active');
            });

            // Fade non-highlighted
            document.querySelectorAll('.number-box').forEach(box => {
                if (parseInt(box.dataset.index) !== index) {
                    box.classList.add('faded');
                }
            });

            // Highlight the pair
            const natBox = naturalsRow.querySelector(`[data-index="${index}"]`);
            const sqBox = squaresRow.querySelector(`[data-index="${index}"]`);
            if (natBox) natBox.classList.add('highlighted');
            if (sqBox) sqBox.classList.add('highlighted');

            // Highlight arrow
            const arrow = arrowsSvg.querySelector(`[data-index="${index}"]`);
            if (arrow) arrow.classList.add('active');
        }

        function clearHighlights() {
            document.querySelectorAll('.number-box').forEach(box => {
                box.classList.remove('highlighted', 'faded');
            });
            document.querySelectorAll('.arrow-path').forEach(path => {
                path.classList.remove('active');
            });
        }

        async function animatePairing() {
            if (animating) return;
            animating = true;
            btnAnimate.textContent = '‚è∏ Animating...';

            for (let i = 1; i <= count && animating; i++) {
                highlightPair(i);
                await new Promise(r => setTimeout(r, 500));
            }

            if (animating) {
                clearHighlights();
            }
            animating = false;
            btnAnimate.textContent = '‚ñ∂ Animate Pairing';
        }

        // Event listeners
        rangeSlider.addEventListener('input', () => {
            count = parseInt(rangeSlider.value);
            sliderValue.textContent = count;
            createNumbers();
        });

        btnAnimate.addEventListener('click', () => {
            if (animating) {
                animating = false;
                btnAnimate.textContent = '‚ñ∂ Animate Pairing';
                clearHighlights();
            } else {
                animatePairing();
            }
        });

        btnHighlight.addEventListener('click', () => {
            highlightIndex = (highlightIndex % count) + 1;
            highlightPair(highlightIndex);
        });

        btnReset.addEventListener('click', () => {
            animating = false;
            highlightIndex = 0;
            clearHighlights();
            btnAnimate.textContent = '‚ñ∂ Animate Pairing';
        });

        window.addEventListener('resize', () => {
            clearHighlights();
            drawArrows();
        });

        // Create infinite scroll content
        function createInfiniteScroll() {
            const naturalsScroll = document.getElementById('infiniteNaturals');
            const squaresScroll = document.getElementById('infiniteSquares');

            // Create enough elements for smooth looping
            for (let repeat = 0; repeat < 2; repeat++) {
                for (let i = 1; i <= 30; i++) {
                    const natBox = document.createElement('div');
                    natBox.className = 'scroll-number natural';
                    natBox.textContent = i + repeat * 30;
                    naturalsScroll.appendChild(natBox);

                    const sqBox = document.createElement('div');
                    sqBox.className = 'scroll-number square';
                    sqBox.textContent = Math.pow(i + repeat * 30, 2);
                    squaresScroll.appendChild(sqBox);
                }
            }
        }

        // Initialize
        createNumbers();
        createInfiniteScroll();
    </script>
    <script src="../assets/js/enhance.js" defer></script>
</body>
</html>
