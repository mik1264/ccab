<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Benford's Law - The First Digit Phenomenon</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Georgia', serif;
            background: linear-gradient(135deg, #0d2137 0%, #1a3a52 50%, #0d2137 100%);
            color: #e0e0e0;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
        }

        .back-link {
            display: inline-block;
            color: #64b5f6;
            text-decoration: none;
            margin-bottom: 20px;
            font-size: 0.95rem;
            opacity: 0.8;
            transition: opacity 0.3s;
        }

        .back-link:hover {
            opacity: 1;
        }

        h1 {
            font-size: 2.4rem;
            background: linear-gradient(135deg, #4fc3f7, #29b6f6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
        }

        .subtitle {
            font-size: 1.1rem;
            color: #90caf9;
            max-width: 750px;
            margin: 0 auto;
            line-height: 1.6;
        }

        .main-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .panel {
            background: rgba(30, 60, 90, 0.6);
            border-radius: 15px;
            padding: 25px;
            border: 1px solid rgba(100, 180, 246, 0.3);
        }

        .panel h2 {
            color: #4fc3f7;
            font-size: 1.3rem;
            margin-bottom: 15px;
        }

        .dataset-selector {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }

        .dataset-btn {
            padding: 10px 18px;
            background: rgba(79, 195, 247, 0.2);
            border: 1px solid rgba(79, 195, 247, 0.5);
            color: #4fc3f7;
            border-radius: 20px;
            cursor: pointer;
            font-family: inherit;
            font-size: 0.9rem;
            transition: all 0.3s;
        }

        .dataset-btn:hover {
            background: rgba(79, 195, 247, 0.3);
        }

        .dataset-btn.active {
            background: #4fc3f7;
            color: #0d2137;
        }

        .chart-area {
            height: 300px;
            background: rgba(15, 40, 65, 0.6);
            border-radius: 10px;
            padding: 20px;
            position: relative;
        }

        .bar-chart {
            display: flex;
            justify-content: space-around;
            align-items: flex-end;
            height: 220px;
        }

        .bar-group {
            display: flex;
            flex-direction: column;
            align-items: center;
            flex: 1;
        }

        .bar-pair {
            display: flex;
            gap: 3px;
            align-items: flex-end;
            height: 180px;
        }

        .bar {
            width: 25px;
            border-radius: 3px 3px 0 0;
            transition: height 0.5s ease-out;
            position: relative;
        }

        .bar.expected {
            background: rgba(79, 195, 247, 0.4);
            border: 1px dashed #4fc3f7;
        }

        .bar.actual {
            background: linear-gradient(180deg, #4fc3f7, #0288d1);
        }

        .bar-value {
            position: absolute;
            top: -22px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.75rem;
            white-space: nowrap;
            color: #90caf9;
        }

        .bar-label {
            margin-top: 8px;
            font-size: 1rem;
            color: #4fc3f7;
            font-weight: bold;
        }

        .legend {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-top: 15px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
            color: #90caf9;
        }

        .legend-box {
            width: 20px;
            height: 15px;
            border-radius: 3px;
        }

        .legend-box.expected {
            background: rgba(79, 195, 247, 0.4);
            border: 1px dashed #4fc3f7;
        }

        .legend-box.actual {
            background: linear-gradient(180deg, #4fc3f7, #0288d1);
        }

        .formula-box {
            background: rgba(15, 40, 65, 0.8);
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            margin: 20px 0;
        }

        .formula {
            font-family: 'Courier New', monospace;
            font-size: 1.3rem;
            color: #4fc3f7;
        }

        .formula-desc {
            color: #90caf9;
            font-size: 0.9rem;
            margin-top: 10px;
        }

        .expected-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.9rem;
            margin: 15px 0;
        }

        .expected-table th,
        .expected-table td {
            padding: 10px;
            text-align: center;
            border-bottom: 1px solid rgba(100, 180, 246, 0.2);
        }

        .expected-table th {
            background: rgba(15, 40, 65, 0.6);
            color: #4fc3f7;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-top: 20px;
        }

        .stat-box {
            background: rgba(15, 40, 65, 0.6);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }

        .stat-value {
            font-size: 1.4rem;
            color: #4fc3f7;
            font-weight: bold;
        }

        .stat-label {
            color: #90caf9;
            font-size: 0.85rem;
            margin-top: 5px;
        }

        .conformity {
            text-align: center;
            padding: 15px;
            border-radius: 10px;
            margin-top: 15px;
            font-size: 1.1rem;
        }

        .conformity.good {
            background: rgba(76, 175, 80, 0.3);
            color: #81c784;
        }

        .conformity.suspect {
            background: rgba(255, 193, 7, 0.3);
            color: #ffd54f;
        }

        .conformity.bad {
            background: rgba(244, 67, 54, 0.3);
            color: #e57373;
        }

        .insight-box {
            background: linear-gradient(135deg, rgba(79, 195, 247, 0.2), rgba(41, 182, 246, 0.1));
            border-left: 4px solid #4fc3f7;
            padding: 20px;
            border-radius: 0 10px 10px 0;
            margin: 20px 0;
        }

        .insight-box h3 {
            color: #4fc3f7;
            margin-bottom: 10px;
        }

        .explanation {
            background: rgba(30, 60, 90, 0.4);
            border-radius: 15px;
            padding: 25px;
            margin-top: 30px;
        }

        .explanation h2 {
            color: #4fc3f7;
            margin-bottom: 15px;
        }

        .explanation p {
            color: #b0cbe8;
            line-height: 1.8;
            margin-bottom: 15px;
        }

        .fraud-alert {
            background: rgba(244, 67, 54, 0.2);
            border: 1px solid rgba(244, 67, 54, 0.5);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }

        .fraud-alert h3 {
            color: #e57373;
            margin-bottom: 10px;
        }

        @media (max-width: 900px) {
            .main-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <a href="index.html" class="back-link">‚Üê Back to Surprising Paradoxes</a>
            <h1>Benford's Law</h1>
            <p class="subtitle">In natural datasets, the digit 1 appears as the first digit ~30% of the time‚Äînot 11% as you'd expect. This "first-digit phenomenon" is used to detect fraud!</p>
        </header>

        <div class="main-grid">
            <div class="panel">
                <h2>üìä First Digit Distribution</h2>

                <div class="dataset-selector">
                    <button class="dataset-btn active" data-set="populations">üåç World Populations</button>
                    <button class="dataset-btn" data-set="fibonacci">üî¢ Fibonacci</button>
                    <button class="dataset-btn" data-set="powers">‚ö° Powers of 2</button>
                    <button class="dataset-btn" data-set="random">üé≤ Random (Uniform)</button>
                    <button class="dataset-btn" data-set="fraud">‚ö†Ô∏è Fake Data</button>
                </div>

                <div class="chart-area">
                    <div class="bar-chart" id="barChart"></div>
                </div>

                <div class="legend">
                    <div class="legend-item">
                        <div class="legend-box expected"></div>
                        <span>Benford Expected</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-box actual"></div>
                        <span>Actual Data</span>
                    </div>
                </div>

                <div class="conformity" id="conformity">
                    ‚úì Data follows Benford's Law
                </div>
            </div>

            <div class="panel">
                <h2>üìê The Formula</h2>

                <div class="formula-box">
                    <div class="formula">P(d) = log‚ÇÅ‚ÇÄ(1 + 1/d)</div>
                    <div class="formula-desc">
                        Probability that first digit is d (where d = 1, 2, ..., 9)
                    </div>
                </div>

                <table class="expected-table">
                    <tr>
                        <th>Digit</th>
                        <th>1</th>
                        <th>2</th>
                        <th>3</th>
                        <th>4</th>
                        <th>5</th>
                        <th>6</th>
                        <th>7</th>
                        <th>8</th>
                        <th>9</th>
                    </tr>
                    <tr>
                        <td style="color: #4fc3f7;">Expected</td>
                        <td>30.1%</td>
                        <td>17.6%</td>
                        <td>12.5%</td>
                        <td>9.7%</td>
                        <td>7.9%</td>
                        <td>6.7%</td>
                        <td>5.8%</td>
                        <td>5.1%</td>
                        <td>4.6%</td>
                    </tr>
                </table>

                <div class="stats-grid">
                    <div class="stat-box">
                        <div class="stat-value" id="dataSize">0</div>
                        <div class="stat-label">Numbers Analyzed</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-value" id="chiSquare">0.00</div>
                        <div class="stat-label">Chi-Square (œá¬≤)</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-value" id="mostFreq">-</div>
                        <div class="stat-label">Most Common Digit</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-value" id="leastFreq">-</div>
                        <div class="stat-label">Least Common Digit</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="insight-box">
            <h3>üîç Why Does This Happen?</h3>
            <p>
                Numbers that grow multiplicatively (populations, stock prices, physical constants) spend more 
                "time" at lower first digits. Think about it: to go from 1,000 to 2,000, you must pass through 
                1,001, 1,002, ... 1,999‚Äîall starting with 1! But going from 9,000 to 10,000 is quick. 
                Logarithmic scaling means <strong>1 "occupies" more of the number line</strong> than 9.
            </p>
        </div>

        <div class="fraud-alert">
            <h3>üö® Fraud Detection Application</h3>
            <p style="color: #e0b0a8; line-height: 1.7;">
                Accountants and forensic analysts use Benford's Law to detect fabricated data. 
                Human-generated fake numbers tend to be too "uniform"‚Äîpeople spread digits evenly because 
                it "feels random." But real financial data, tax returns, and expense reports follow Benford's Law.
                Deviations are red flags! (Click "Fake Data" above to see what suspicious data looks like.)
            </p>
        </div>

        <div class="explanation">
            <h2>The History</h2>

            <p>
                In <strong>1881</strong>, astronomer Simon Newcomb noticed that logarithm tables had worn pages 
                at the front (numbers starting with 1) but pristine pages at the back. He derived the formula 
                but nobody cared.
            </p>

            <p>
                In <strong>1938</strong>, physicist Frank Benford rediscovered it and tested it on 20 diverse 
                datasets: river lengths, populations, physical constants, baseball statistics. It worked 
                everywhere! He got the credit (and the name).
            </p>

            <p>
                <strong>Requirements for Benford's Law to apply:</strong>
            </p>
            <ul style="color: #b0cbe8; margin-left: 20px; line-height: 2;">
                <li>Data spans multiple orders of magnitude (10s, 100s, 1000s, ...)</li>
                <li>Data arises from multiplicative processes or power laws</li>
                <li>Large enough sample (at least 100+ numbers)</li>
                <li>NOT assigned numbers (jersey numbers, phone numbers, ZIP codes)</li>
            </ul>

            <p style="margin-top: 20px; font-style: italic; color: #8aa8c8;">
                Benford's Law analysis is admissible as evidence in federal courts (USA) for detecting 
                accounting fraud and has been used in major cases including Enron.
            </p>
        </div>
    </div>

    <script>
        // Benford expected probabilities
        const benford = [0, 0.301, 0.176, 0.125, 0.097, 0.079, 0.067, 0.058, 0.051, 0.046];

        // Datasets
        const datasets = {
            populations: generatePopulations(500),
            fibonacci: generateFibonacci(200),
            powers: generatePowers(300),
            random: generateUniform(500),
            fraud: generateFakeData(500)
        };

        function generatePopulations(n) {
            // Simulate population-like data (log-normal)
            const data = [];
            for (let i = 0; i < n; i++) {
                const logVal = 3 + Math.random() * 6; // 1,000 to 1,000,000,000
                data.push(Math.floor(Math.pow(10, logVal)));
            }
            return data;
        }

        function generateFibonacci(n) {
            const fib = [1, 1];
            for (let i = 2; i < n; i++) {
                fib.push(fib[i-1] + fib[i-2]);
            }
            return fib;
        }

        function generatePowers(n) {
            const data = [];
            for (let i = 1; i <= n; i++) {
                data.push(Math.pow(2, i % 60)); // Powers of 2
                data.push(Math.pow(3, i % 40)); // Powers of 3
            }
            return data;
        }

        function generateUniform(n) {
            // Truly uniform random - VIOLATES Benford
            const data = [];
            for (let i = 0; i < n; i++) {
                data.push(Math.floor(Math.random() * 9000) + 1000);
            }
            return data;
        }

        function generateFakeData(n) {
            // Human-generated "random" looking data - too uniform
            const data = [];
            for (let i = 0; i < n; i++) {
                // Humans tend to avoid 1 and spread evenly
                const firstDigit = Math.floor(Math.random() * 9) + 1;
                const rest = Math.floor(Math.random() * 900) + 100;
                data.push(parseInt(firstDigit + '' + rest));
            }
            return data;
        }

        function getFirstDigit(num) {
            const str = Math.abs(num).toString();
            for (const char of str) {
                if (char >= '1' && char <= '9') return parseInt(char);
            }
            return 1;
        }

        function analyzeData(data) {
            const counts = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
            for (const num of data) {
                const d = getFirstDigit(num);
                counts[d]++;
            }
            return counts;
        }

        function calculateChiSquare(observed, expected, n) {
            let chi = 0;
            for (let d = 1; d <= 9; d++) {
                const o = observed[d];
                const e = expected[d] * n;
                chi += Math.pow(o - e, 2) / e;
            }
            return chi;
        }

        function updateChart(datasetName) {
            const data = datasets[datasetName];
            const counts = analyzeData(data);
            const n = data.length;

            const chart = document.getElementById('barChart');
            chart.innerHTML = '';

            const maxPercent = Math.max(
                ...counts.slice(1).map(c => c / n),
                0.301
            ) * 100;

            for (let d = 1; d <= 9; d++) {
                const actualPercent = (counts[d] / n) * 100;
                const expectedPercent = benford[d] * 100;

                const group = document.createElement('div');
                group.className = 'bar-group';

                const pair = document.createElement('div');
                pair.className = 'bar-pair';

                // Expected bar
                const expBar = document.createElement('div');
                expBar.className = 'bar expected';
                expBar.style.height = (expectedPercent / maxPercent * 160) + 'px';
                const expVal = document.createElement('span');
                expVal.className = 'bar-value';
                expVal.textContent = expectedPercent.toFixed(1) + '%';
                expBar.appendChild(expVal);

                // Actual bar
                const actBar = document.createElement('div');
                actBar.className = 'bar actual';
                actBar.style.height = (actualPercent / maxPercent * 160) + 'px';
                const actVal = document.createElement('span');
                actVal.className = 'bar-value';
                actVal.textContent = actualPercent.toFixed(1) + '%';
                actBar.appendChild(actVal);

                pair.appendChild(expBar);
                pair.appendChild(actBar);

                const label = document.createElement('div');
                label.className = 'bar-label';
                label.textContent = d;

                group.appendChild(pair);
                group.appendChild(label);
                chart.appendChild(group);
            }

            // Update stats
            document.getElementById('dataSize').textContent = n.toLocaleString();

            const chi = calculateChiSquare(counts, benford, n);
            document.getElementById('chiSquare').textContent = chi.toFixed(2);

            // Find most/least common
            let maxD = 1, minD = 1;
            for (let d = 2; d <= 9; d++) {
                if (counts[d] > counts[maxD]) maxD = d;
                if (counts[d] < counts[minD]) minD = d;
            }
            document.getElementById('mostFreq').textContent = maxD + ' (' + ((counts[maxD]/n)*100).toFixed(1) + '%)';
            document.getElementById('leastFreq').textContent = minD + ' (' + ((counts[minD]/n)*100).toFixed(1) + '%)';

            // Conformity indicator
            const conformity = document.getElementById('conformity');
            // Critical value for chi-square with 8 df at 0.05 is 15.51
            if (chi < 15.51) {
                conformity.className = 'conformity good';
                conformity.innerHTML = '‚úì Data follows Benford\'s Law (œá¬≤ < 15.51)';
            } else if (chi < 25) {
                conformity.className = 'conformity suspect';
                conformity.innerHTML = '‚ö†Ô∏è Marginal conformity - investigate further';
            } else {
                conformity.className = 'conformity bad';
                conformity.innerHTML = '‚ùå Data VIOLATES Benford\'s Law - possible fraud indicator!';
            }
        }

        // Event listeners
        document.querySelectorAll('.dataset-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.dataset-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                updateChart(btn.dataset.set);
            });
        });

        // Initialize
        updateChart('populations');
    </script>
    <script src="../assets/js/enhance.js" defer></script>
</body>
</html>
