<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dicke Superradiance - Surprising Paradoxes</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Georgia', serif;
            background: linear-gradient(135deg, #0a0a12 0%, #1a1a2e 50%, #0f0f1a 100%);
            color: #e0e0e0;
            min-height: 100vh;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        header {
            text-align: center;
            margin-bottom: 40px;
        }

        .back-link {
            display: inline-block;
            color: #f4a261;
            text-decoration: none;
            margin-bottom: 20px;
            font-size: 0.95rem;
            transition: color 0.3s;
        }

        .back-link:hover { color: #e9c46a; }

        h1 {
            font-size: 2.5rem;
            color: #e9c46a;
            margin-bottom: 15px;
            text-shadow: 0 0 40px rgba(233, 196, 106, 0.3);
        }

        .subtitle {
            font-size: 1.2rem;
            color: #8ecae6;
            font-style: italic;
        }

        .visualization-container {
            background: rgba(0, 0, 0, 0.4);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 40px;
            border: 1px solid rgba(233, 196, 106, 0.2);
        }

        .dual-canvas {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .canvas-panel {
            background: #000;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
        }

        .canvas-panel h3 {
            color: #e9c46a;
            margin-bottom: 10px;
            font-size: 1rem;
        }

        canvas {
            border-radius: 5px;
            background: #000;
        }

        .stats-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 15px;
        }

        .stat-box {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }

        .stat-box .label {
            font-size: 0.85rem;
            color: #8ecae6;
            margin-bottom: 5px;
        }

        .stat-box .value {
            font-size: 1.5rem;
            color: #e9c46a;
            font-weight: bold;
        }

        .controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .control-group {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 10px;
        }

        .control-group label {
            display: block;
            margin-bottom: 8px;
            color: #e9c46a;
            font-size: 0.9rem;
        }

        .control-group input[type="range"] {
            width: 100%;
            margin-bottom: 5px;
        }

        .control-group .value {
            text-align: right;
            font-size: 0.8rem;
            color: #8ecae6;
        }

        .btn-group {
            display: flex;
            gap: 10px;
            margin-top: 20px;
            justify-content: center;
        }

        .btn {
            padding: 12px 25px;
            border: 1px solid rgba(233, 196, 106, 0.5);
            background: rgba(233, 196, 106, 0.1);
            color: #e9c46a;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.95rem;
        }

        .btn:hover {
            background: rgba(233, 196, 106, 0.25);
        }

        .btn.active {
            background: rgba(233, 196, 106, 0.3);
            border-color: #e9c46a;
        }

        .chart-container {
            background: #000;
            border-radius: 10px;
            padding: 15px;
            margin-top: 20px;
        }

        .chart-container h3 {
            color: #e9c46a;
            margin-bottom: 10px;
            text-align: center;
        }

        .essay {
            line-height: 1.9;
            font-size: 1.1rem;
        }

        .essay h2 {
            color: #e9c46a;
            margin: 40px 0 20px;
            font-size: 1.6rem;
            border-bottom: 1px solid rgba(233, 196, 106, 0.3);
            padding-bottom: 10px;
        }

        .essay h3 {
            color: #f4a261;
            margin: 30px 0 15px;
            font-size: 1.3rem;
        }

        .essay p {
            margin-bottom: 20px;
            text-align: justify;
        }

        .equation {
            background: rgba(142, 202, 230, 0.1);
            padding: 20px;
            margin: 25px 0;
            border-radius: 10px;
            text-align: center;
            font-family: 'Courier New', monospace;
            color: #8ecae6;
            font-size: 1.1rem;
            overflow-x: auto;
        }

        .highlight-box {
            background: linear-gradient(135deg, rgba(233, 196, 106, 0.1), rgba(244, 162, 97, 0.1));
            border-left: 4px solid #e9c46a;
            padding: 20px;
            margin: 25px 0;
            border-radius: 0 10px 10px 0;
        }

        .highlight-box strong {
            color: #e9c46a;
        }

        .comparison-table {
            width: 100%;
            margin: 25px 0;
            border-collapse: collapse;
        }

        .comparison-table th, .comparison-table td {
            padding: 12px 15px;
            text-align: center;
            border: 1px solid rgba(142, 202, 230, 0.3);
        }

        .comparison-table th {
            background: rgba(142, 202, 230, 0.15);
            color: #8ecae6;
        }

        .comparison-table td {
            background: rgba(0, 0, 0, 0.3);
        }

        .sources {
            background: rgba(0, 0, 0, 0.3);
            padding: 25px;
            border-radius: 10px;
            margin-top: 40px;
        }

        .sources h3 {
            color: #e9c46a;
            margin-bottom: 15px;
        }

        .sources ul {
            list-style: none;
        }

        .sources li {
            margin-bottom: 10px;
        }

        .sources a {
            color: #8ecae6;
            text-decoration: none;
        }

        .sources a:hover {
            text-decoration: underline;
        }

        @media (max-width: 700px) {
            .dual-canvas {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <a href="index.html" class="back-link">← Back to Surprising Paradoxes</a>
            <h1>Dicke Superradiance</h1>
            <p class="subtitle">When N atoms emit together, intensity scales as N² not N</p>
        </header>

        <div class="visualization-container">
            <div class="dual-canvas">
                <div class="canvas-panel">
                    <h3>Independent Emission (Intensity ~ N)</h3>
                    <canvas id="independentCanvas" width="350" height="300"></canvas>
                </div>
                <div class="canvas-panel">
                    <h3>Superradiant Emission (Intensity ~ N²)</h3>
                    <canvas id="superradiantCanvas" width="350" height="300"></canvas>
                </div>
            </div>

            <div class="stats-row">
                <div class="stat-box">
                    <div class="label">Independent Intensity</div>
                    <div class="value" id="indepIntensity">0</div>
                </div>
                <div class="stat-box">
                    <div class="label">Superradiant Intensity</div>
                    <div class="value" id="superIntensity">0</div>
                </div>
            </div>

            <div class="chart-container">
                <h3>Emission Pulse Comparison</h3>
                <canvas id="pulseChart" width="700" height="200"></canvas>
            </div>

            <div class="controls">
                <div class="control-group">
                    <label>Number of Atoms (N)</label>
                    <input type="range" id="atomCount" min="2" max="50" step="1" value="16">
                    <div class="value"><span id="atomValue">16</span> atoms</div>
                </div>

                <div class="control-group">
                    <label>Initial Excitation</label>
                    <input type="range" id="excitation" min="0.5" max="1" step="0.05" value="1">
                    <div class="value"><span id="exciteValue">100</span>%</div>
                </div>

                <div class="control-group">
                    <label>Emission Rate</label>
                    <input type="range" id="emissionRate" min="0.5" max="3" step="0.1" value="1">
                    <div class="value"><span id="rateValue">1.0</span>x</div>
                </div>
            </div>

            <div class="btn-group">
                <button class="btn" onclick="resetSimulation()">Reset</button>
                <button class="btn" id="playBtn" onclick="togglePlay()">Pause</button>
                <button class="btn" onclick="triggerBurst()">Trigger Burst</button>
            </div>
        </div>

        <article class="essay">
            <h2>The Power of Cooperation</h2>

            <p>
                Imagine a choir of atoms, each capable of emitting a photon of light. If they emit
                independently—randomly, at different times and with random phases—the total intensity
                is simply the sum of individual contributions: <strong>I = N</strong>. This is what
                happens in an ordinary light bulb or LED.
            </p>

            <p>
                But in 1954, Robert H. Dicke discovered something remarkable: if these atoms are
                close together (within a wavelength of light) and emit <em>in phase</em>, the total
                intensity scales as <strong>I = N²</strong>. For 100 atoms, that's not 100 times
                brighter—it's 10,000 times brighter!
            </p>

            <div class="highlight-box">
                <strong>The Paradox:</strong> The atoms don't individually emit more light. Each one
                still emits just one photon. But cooperative emission produces a coherent burst
                that's N times more intense than the sum of individual emissions. The whole vastly
                exceeds the sum of its parts.
            </div>

            <h2>Why N² Instead of N?</h2>

            <p>
                Think of each atom as a tiny radio antenna. If N antennas broadcast at random times
                with random phases, their electromagnetic waves partially cancel. The <em>average</em>
                power detected is proportional to N.
            </p>

            <p>
                But if all N antennas broadcast in perfect synchronization—same phase, same timing—the
                electric fields <strong>add coherently</strong>. The combined electric field is N times
                larger. Since intensity is proportional to the <em>square</em> of the electric field:
            </p>

            <div class="equation">
                E<sub>total</sub> = N × E<sub>single</sub><br><br>
                I = E² ∝ N²
            </div>

            <h3>The Superradiant Pulse</h3>

            <p>
                Superradiance produces not just brighter light, but <strong>faster</strong> light.
                The atoms radiate their stored energy N times faster than they would independently.
                The result is a short, intense burst rather than a slow glow.
            </p>

            <table class="comparison-table">
                <tr>
                    <th>Property</th>
                    <th>Independent Emission</th>
                    <th>Superradiance</th>
                </tr>
                <tr>
                    <td>Peak Intensity</td>
                    <td>∝ N</td>
                    <td>∝ N²</td>
                </tr>
                <tr>
                    <td>Decay Time</td>
                    <td>τ (natural lifetime)</td>
                    <td>τ/N (N times faster)</td>
                </tr>
                <tr>
                    <td>Total Energy</td>
                    <td>N × ℏω</td>
                    <td>N × ℏω (same!)</td>
                </tr>
                <tr>
                    <td>Coherence</td>
                    <td>Incoherent (random phases)</td>
                    <td>Coherent (in-phase)</td>
                </tr>
            </table>

            <h2>How Atoms Self-Synchronize</h2>

            <p>
                The most remarkable aspect of Dicke superradiance is that it happens <em>spontaneously</em>.
                Start with N excited atoms in random states. As they begin to emit, the photons they
                create establish a common electromagnetic field. This field acts back on all atoms,
                gradually synchronizing their phases.
            </p>

            <p>
                It's like a crowd of people clapping—initially random, but as they hear each other,
                they spontaneously synchronize into rhythmic applause. Except here, the synchronization
                happens at optical frequencies, across billions of oscillations per second.
            </p>

            <h3>The Dicke States</h3>

            <p>
                Dicke introduced special quantum states |j, m⟩ to describe the collective behavior.
                The quantum number j measures total cooperativity (maximum j = N/2), while m counts
                the excitation level (from +j for all excited to -j for all ground state).
            </p>

            <p>
                Superradiance happens when the system cascades down the "Dicke ladder" from |j, +j⟩
                to |j, -j⟩, emitting photons at each step. The emission rate peaks dramatically
                at m = 0, when half the atoms are excited—this is where the macroscopic dipole
                moment is maximum.
            </p>

            <h2>No Entanglement Required!</h2>

            <p>
                For decades, physicists debated whether Dicke superradiance requires quantum
                entanglement between atoms. In 2023, Johannes Schachenmayer and colleagues proved
                definitively that <strong>no entanglement is involved</strong>.
            </p>

            <p>
                Superradiance emerges from <em>classical correlations</em> in atomic phases, not
                from the quantum spookiness of entanglement. This makes it robust and easier to
                achieve experimentally. It's quantum mechanics, but the cooperative enhancement
                comes from wave interference, not quantum weirdness.
            </p>

            <h2>Applications and Observations</h2>

            <h3>Lasers Without Mirrors</h3>

            <p>
                Superradiance can generate laser-like coherent light without a resonant cavity.
                "Mirrorless lasers" based on superradiance have been demonstrated in atomic gases
                and solid-state materials. They offer ultrafast pulses and spectral purity.
            </p>

            <h3>Astrophysical Masers</h3>

            <p>
                Superradiance may explain the intense, coherent microwave emission from astrophysical
                masers in star-forming regions and around black holes. Clouds of OH and H₂O molecules
                in space can achieve the density required for collective emission.
            </p>

            <h3>Quantum Computing</h3>

            <p>
                Understanding superradiance helps design quantum computers. Arrays of superconducting
                qubits can exhibit superradiant decay, which affects coherence times. Controlling
                this collective behavior is crucial for building reliable quantum gates.
            </p>

            <div class="highlight-box">
                <strong>The Deep Insight:</strong> Dicke superradiance reveals that quantum systems
                can exhibit emergent collective behavior vastly exceeding individual capabilities.
                N atoms together aren't just N times as bright—they're N² times brighter when
                synchronized. Cooperation multiplies; coherence amplifies.
            </div>

            <div class="sources">
                <h3>Sources & Further Reading</h3>
                <ul>
                    <li><a href="https://www.nature.com/articles/s41467-022-29805-4">Universality of Dicke superradiance - Nature Communications</a></li>
                    <li><a href="https://physics.aps.org/articles/v18/s118">Superradiance Without Entanglement - APS Physics</a></li>
                    <li><a href="https://www.nature.com/articles/ncomms6186">Observation of Dicke superradiance - Nature Communications</a></li>
                    <li><a href="https://opg.optica.org/josab/abstract.cfm?uri=josab-33-7-C80">Dicke superradiance in solids - JOSA B</a></li>
                    <li><a href="https://www.science.org/doi/abs/10.1126/science.1176695">The Super of Superradiance - Science</a></li>
                    <li><a href="https://pmc.ncbi.nlm.nih.gov/articles/PMC7473565/">Dicke model - PMC</a></li>
                </ul>
            </div>
        </article>
    </div>

    <script>
        // Canvas setup
        const indepCanvas = document.getElementById('independentCanvas');
        const superCanvas = document.getElementById('superradiantCanvas');
        const pulseCanvas = document.getElementById('pulseChart');

        const indepCtx = indepCanvas.getContext('2d');
        const superCtx = superradiantCanvas.getContext('2d');
        const pulseCtx = pulseCanvas.getContext('2d');

        // High DPI support
        function setupCanvas(canvas, ctx) {
            const dpr = window.devicePixelRatio || 1;
            const rect = canvas.getBoundingClientRect();
            canvas.width = rect.width * dpr;
            canvas.height = rect.height * dpr;
            ctx.scale(dpr, dpr);
            canvas.style.width = rect.width + 'px';
            canvas.style.height = rect.height + 'px';
            return { width: rect.width, height: rect.height };
        }

        const indepSize = setupCanvas(indepCanvas, indepCtx);
        const superSize = setupCanvas(superCanvas, superCtx);
        const pulseSize = setupCanvas(pulseCanvas, pulseCtx);

        // Parameters
        let atomCount = 16;
        let excitation = 1.0;
        let emissionRate = 1.0;
        let playing = true;
        let time = 0;

        // Atoms state
        let independentAtoms = [];
        let superradiantAtoms = [];

        // Pulse history
        let indepPulse = [];
        let superPulse = [];
        const pulseLength = 200;

        // Photon particles
        let indepPhotons = [];
        let superPhotons = [];

        // Initialize controls
        const atomSlider = document.getElementById('atomCount');
        const exciteSlider = document.getElementById('excitation');
        const rateSlider = document.getElementById('emissionRate');

        atomSlider.addEventListener('input', (e) => {
            atomCount = parseInt(e.target.value);
            document.getElementById('atomValue').textContent = atomCount;
            initAtoms();
        });

        exciteSlider.addEventListener('input', (e) => {
            excitation = parseFloat(e.target.value);
            document.getElementById('exciteValue').textContent = Math.round(excitation * 100);
        });

        rateSlider.addEventListener('input', (e) => {
            emissionRate = parseFloat(e.target.value);
            document.getElementById('rateValue').textContent = emissionRate.toFixed(1);
        });

        function initAtoms() {
            independentAtoms = [];
            superradiantAtoms = [];
            indepPhotons = [];
            superPhotons = [];

            // Grid layout for atoms
            const cols = Math.ceil(Math.sqrt(atomCount));
            const rows = Math.ceil(atomCount / cols);
            const spacingX = (indepSize.width - 60) / (cols + 1);
            const spacingY = (indepSize.height - 60) / (rows + 1);

            for (let i = 0; i < atomCount; i++) {
                const col = i % cols;
                const row = Math.floor(i / cols);
                const x = 30 + spacingX * (col + 1);
                const y = 30 + spacingY * (row + 1);

                // Independent atoms - random phases
                independentAtoms.push({
                    x: x,
                    y: y,
                    excited: Math.random() < excitation,
                    phase: Math.random() * Math.PI * 2,
                    decayTime: Math.random() * 5 + 1 // Random decay
                });

                // Superradiant atoms - synchronized phases
                superradiantAtoms.push({
                    x: x,
                    y: y,
                    excited: Math.random() < excitation,
                    phase: 0, // All in phase
                    collectivePhase: 0
                });
            }
        }

        function resetSimulation() {
            time = 0;
            indepPulse = [];
            superPulse = [];
            initAtoms();
        }

        function togglePlay() {
            playing = !playing;
            document.getElementById('playBtn').textContent = playing ? 'Pause' : 'Play';
        }

        function triggerBurst() {
            // Re-excite all atoms for a new burst
            independentAtoms.forEach(a => {
                a.excited = Math.random() < excitation;
                a.decayTime = Math.random() * 5 + 1;
            });
            superradiantAtoms.forEach(a => {
                a.excited = Math.random() < excitation;
            });
        }

        function drawAtom(ctx, atom, isSuperradiant) {
            const radius = 8;

            // Glow effect when excited
            if (atom.excited) {
                const glow = ctx.createRadialGradient(atom.x, atom.y, 0, atom.x, atom.y, 25);
                glow.addColorStop(0, 'rgba(255, 200, 50, 0.6)');
                glow.addColorStop(1, 'rgba(255, 200, 50, 0)');
                ctx.fillStyle = glow;
                ctx.beginPath();
                ctx.arc(atom.x, atom.y, 25, 0, Math.PI * 2);
                ctx.fill();
            }

            // Atom body
            ctx.beginPath();
            ctx.arc(atom.x, atom.y, radius, 0, Math.PI * 2);
            ctx.fillStyle = atom.excited ? '#ffcc00' : '#444';
            ctx.fill();
            ctx.strokeStyle = atom.excited ? '#ff9900' : '#666';
            ctx.lineWidth = 2;
            ctx.stroke();

            // Phase indicator (for superradiant)
            if (isSuperradiant && atom.excited) {
                const phaseX = Math.cos(atom.collectivePhase) * 12;
                const phaseY = Math.sin(atom.collectivePhase) * 12;
                ctx.beginPath();
                ctx.moveTo(atom.x, atom.y);
                ctx.lineTo(atom.x + phaseX, atom.y + phaseY);
                ctx.strokeStyle = '#00ff88';
                ctx.lineWidth = 2;
                ctx.stroke();
            }
        }

        function drawPhoton(ctx, photon) {
            ctx.beginPath();
            ctx.arc(photon.x, photon.y, photon.size, 0, Math.PI * 2);
            ctx.fillStyle = `rgba(255, 255, 100, ${photon.alpha})`;
            ctx.fill();
        }

        function updateIndependent(dt) {
            let intensity = 0;

            independentAtoms.forEach(atom => {
                if (atom.excited) {
                    // Random decay
                    atom.decayTime -= dt * emissionRate;
                    if (atom.decayTime <= 0) {
                        atom.excited = false;
                        // Emit photon in random direction
                        const angle = Math.random() * Math.PI * 2;
                        indepPhotons.push({
                            x: atom.x,
                            y: atom.y,
                            vx: Math.cos(angle) * 3,
                            vy: Math.sin(angle) * 3,
                            size: 3,
                            alpha: 1
                        });
                        intensity += 1;
                    }
                }
            });

            // Update photons
            indepPhotons.forEach(p => {
                p.x += p.vx;
                p.y += p.vy;
                p.alpha -= 0.02;
            });
            indepPhotons = indepPhotons.filter(p => p.alpha > 0);

            return intensity;
        }

        function updateSuperradiant(dt) {
            // Count excited atoms
            let excitedCount = superradiantAtoms.filter(a => a.excited).length;
            let intensity = 0;

            if (excitedCount > 0) {
                // Superradiant decay rate scales with N (remaining)
                const decayProb = dt * emissionRate * 0.05 * excitedCount;

                // Collective emission
                superradiantAtoms.forEach(atom => {
                    if (atom.excited) {
                        atom.collectivePhase += dt * 5 * emissionRate;

                        if (Math.random() < decayProb) {
                            atom.excited = false;
                            // Emit photon - coherent direction (mostly forward)
                            const angle = atom.collectivePhase + (Math.random() - 0.5) * 0.5;
                            superPhotons.push({
                                x: atom.x,
                                y: atom.y,
                                vx: Math.cos(angle) * 4,
                                vy: Math.sin(angle) * 4,
                                size: 4 + Math.sqrt(excitedCount) * 0.5,
                                alpha: 1
                            });
                            // Intensity scales with current N
                            intensity += excitedCount;
                        }
                    }
                });
            }

            // Update photons
            superPhotons.forEach(p => {
                p.x += p.vx;
                p.y += p.vy;
                p.alpha -= 0.015;
            });
            superPhotons = superPhotons.filter(p => p.alpha > 0);

            return intensity;
        }

        function drawPulseChart() {
            pulseCtx.fillStyle = '#000';
            pulseCtx.fillRect(0, 0, pulseSize.width, pulseSize.height);

            // Draw grid
            pulseCtx.strokeStyle = 'rgba(255, 255, 255, 0.1)';
            pulseCtx.lineWidth = 1;
            for (let i = 0; i < 5; i++) {
                const y = 20 + i * (pulseSize.height - 40) / 4;
                pulseCtx.beginPath();
                pulseCtx.moveTo(50, y);
                pulseCtx.lineTo(pulseSize.width - 20, y);
                pulseCtx.stroke();
            }

            // Labels
            pulseCtx.font = '11px Georgia';
            pulseCtx.fillStyle = '#888';
            pulseCtx.textAlign = 'right';
            pulseCtx.fillText('Intensity', 45, 25);
            pulseCtx.textAlign = 'center';
            pulseCtx.fillText('Time', pulseSize.width / 2, pulseSize.height - 5);

            const maxIntensity = Math.max(...indepPulse, ...superPulse, atomCount * atomCount * 0.5);

            // Draw independent pulse
            if (indepPulse.length > 1) {
                pulseCtx.beginPath();
                indepPulse.forEach((val, i) => {
                    const x = 50 + (i / pulseLength) * (pulseSize.width - 70);
                    const y = pulseSize.height - 30 - (val / maxIntensity) * (pulseSize.height - 60);
                    if (i === 0) pulseCtx.moveTo(x, y);
                    else pulseCtx.lineTo(x, y);
                });
                pulseCtx.strokeStyle = '#4CAF50';
                pulseCtx.lineWidth = 2;
                pulseCtx.stroke();
            }

            // Draw superradiant pulse
            if (superPulse.length > 1) {
                pulseCtx.beginPath();
                superPulse.forEach((val, i) => {
                    const x = 50 + (i / pulseLength) * (pulseSize.width - 70);
                    const y = pulseSize.height - 30 - (val / maxIntensity) * (pulseSize.height - 60);
                    if (i === 0) pulseCtx.moveTo(x, y);
                    else pulseCtx.lineTo(x, y);
                });
                pulseCtx.strokeStyle = '#e9c46a';
                pulseCtx.lineWidth = 2;
                pulseCtx.stroke();
            }

            // Legend
            pulseCtx.fillStyle = '#4CAF50';
            pulseCtx.fillRect(pulseSize.width - 150, 15, 15, 10);
            pulseCtx.fillStyle = '#888';
            pulseCtx.textAlign = 'left';
            pulseCtx.fillText('Independent', pulseSize.width - 130, 23);

            pulseCtx.fillStyle = '#e9c46a';
            pulseCtx.fillRect(pulseSize.width - 150, 30, 15, 10);
            pulseCtx.fillStyle = '#888';
            pulseCtx.fillText('Superradiant', pulseSize.width - 130, 38);
        }

        function animate() {
            if (playing) {
                time += 0.016;

                // Update both systems
                const indepI = updateIndependent(0.016);
                const superI = updateSuperradiant(0.016);

                // Record pulse data
                indepPulse.push(indepI);
                superPulse.push(superI);
                if (indepPulse.length > pulseLength) indepPulse.shift();
                if (superPulse.length > pulseLength) superPulse.shift();

                // Calculate current intensities
                const recentIndep = indepPulse.slice(-20).reduce((a, b) => a + b, 0);
                const recentSuper = superPulse.slice(-20).reduce((a, b) => a + b, 0);

                document.getElementById('indepIntensity').textContent = Math.round(recentIndep);
                document.getElementById('superIntensity').textContent = Math.round(recentSuper);
            }

            // Clear canvases
            indepCtx.fillStyle = '#0a0a12';
            indepCtx.fillRect(0, 0, indepSize.width, indepSize.height);

            superCtx.fillStyle = '#0a0a12';
            superCtx.fillRect(0, 0, superSize.width, superSize.height);

            // Draw atoms
            independentAtoms.forEach(a => drawAtom(indepCtx, a, false));
            superradiantAtoms.forEach(a => drawAtom(superCtx, a, true));

            // Draw photons
            indepPhotons.forEach(p => drawPhoton(indepCtx, p));
            superPhotons.forEach(p => drawPhoton(superCtx, p));

            // Draw labels
            indepCtx.font = '12px Georgia';
            indepCtx.fillStyle = '#4CAF50';
            indepCtx.textAlign = 'left';
            const excitedIndep = independentAtoms.filter(a => a.excited).length;
            indepCtx.fillText(`Excited: ${excitedIndep}/${atomCount}`, 10, indepSize.height - 10);

            superCtx.font = '12px Georgia';
            superCtx.fillStyle = '#e9c46a';
            superCtx.textAlign = 'left';
            const excitedSuper = superradiantAtoms.filter(a => a.excited).length;
            superCtx.fillText(`Excited: ${excitedSuper}/${atomCount}`, 10, superSize.height - 10);
            superCtx.fillText(`N² = ${atomCount * atomCount}`, 10, superSize.height - 25);

            // Draw pulse chart
            drawPulseChart();

            requestAnimationFrame(animate);
        }

        // Initialize
        initAtoms();
        animate();
    </script>
    <script src="../assets/js/enhance.js" defer></script>
</body>
</html>
