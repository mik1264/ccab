<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Diderot Effect - One Purchase Triggers Many</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Georgia', serif;
            background: linear-gradient(135deg, #4a1942 0%, #1a0a18 100%);
            color: #e0e0e0;
            min-height: 100vh;
            padding: 20px;
        }
        .container { max-width: 1000px; margin: 0 auto; }
        header { text-align: center; margin-bottom: 30px; }
        .back-link { color: #e879f9; text-decoration: none; margin-bottom: 20px; display: inline-block; }
        h1 {
            font-size: 2.4rem;
            background: linear-gradient(135deg, #e879f9, #a855f7);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
        }
        .subtitle { font-size: 1.1rem; color: #b080a0; max-width: 800px; margin: 0 auto; line-height: 1.6; }

        .experiment-container {
            background: rgba(100, 50, 90, 0.4);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
        }
        .experiment-container h2 { color: #e879f9; margin-bottom: 20px; text-align: center; }

        .story-section {
            background: rgba(80, 40, 70, 0.6);
            border-radius: 12px;
            padding: 25px;
            margin: 20px 0;
        }
        .story-section h3 { color: #e879f9; margin-bottom: 15px; }
        .story-text {
            font-style: italic;
            line-height: 1.8;
            color: #d0b0c0;
            border-left: 3px solid #e879f9;
            padding-left: 20px;
        }

        .room-visualization {
            background: rgba(60, 30, 55, 0.8);
            border-radius: 12px;
            padding: 25px;
            margin: 25px 0;
            position: relative;
        }
        .room-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin: 20px 0;
        }
        .item-card {
            background: rgba(80, 40, 70, 0.6);
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            transition: all 0.5s ease;
            border: 2px solid transparent;
        }
        .item-card.old {
            opacity: 0.6;
            filter: grayscale(0.5);
        }
        .item-card.new {
            border-color: #e879f9;
            background: rgba(232, 121, 249, 0.2);
            transform: scale(1.05);
        }
        .item-card.upgraded {
            border-color: #22c55e;
            background: rgba(34, 197, 94, 0.2);
        }
        .item-icon { font-size: 2.5rem; margin-bottom: 10px; }
        .item-name { font-weight: bold; margin-bottom: 5px; }
        .item-status { font-size: 0.8rem; color: #888; }
        .item-price { font-size: 0.85rem; color: #e879f9; margin-top: 5px; }

        .cascade-controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 25px 0;
        }
        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .btn:hover { transform: translateY(-2px); }
        .btn-primary {
            background: linear-gradient(135deg, #e879f9, #a855f7);
            color: white;
        }
        .btn-secondary {
            background: rgba(100, 50, 90, 0.8);
            color: #e879f9;
            border: 2px solid #e879f9;
        }

        .total-display {
            text-align: center;
            margin: 25px 0;
            padding: 20px;
            background: rgba(80, 40, 70, 0.5);
            border-radius: 10px;
        }
        .total-label { color: #b080a0; margin-bottom: 10px; }
        .total-value { font-size: 3rem; font-weight: bold; color: #e879f9; }
        .original-item { font-size: 0.9rem; color: #888; margin-top: 10px; }

        .chain-viz {
            background: rgba(60, 30, 55, 0.8);
            border-radius: 12px;
            padding: 25px;
            margin: 25px 0;
        }
        .chain-viz h3 { text-align: center; color: #e879f9; margin-bottom: 20px; }
        .chain-container {
            display: flex;
            align-items: center;
            justify-content: center;
            flex-wrap: wrap;
            gap: 10px;
        }
        .chain-item {
            background: rgba(100, 50, 90, 0.6);
            padding: 15px 20px;
            border-radius: 10px;
            text-align: center;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.5s ease;
        }
        .chain-item.visible {
            opacity: 1;
            transform: translateY(0);
        }
        .chain-arrow {
            font-size: 1.5rem;
            color: #e879f9;
            opacity: 0;
            transition: opacity 0.5s ease;
        }
        .chain-arrow.visible { opacity: 1; }

        .insight-box {
            background: linear-gradient(135deg, rgba(232, 121, 249, 0.2), rgba(168, 85, 247, 0.2));
            border-left: 4px solid #e879f9;
            padding: 20px;
            border-radius: 0 12px 12px 0;
            margin: 25px 0;
        }
        .insight-box h4 { color: #e879f9; margin-bottom: 10px; }

        .examples-section {
            background: rgba(80, 40, 70, 0.5);
            border-radius: 12px;
            padding: 25px;
            margin: 25px 0;
        }
        .examples-section h3 { color: #e879f9; margin-bottom: 20px; }
        .example-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 15px;
        }
        .example-card {
            background: rgba(60, 30, 55, 0.8);
            padding: 20px;
            border-radius: 10px;
        }
        .example-trigger {
            color: #e879f9;
            font-weight: bold;
            margin-bottom: 8px;
        }
        .example-cascade {
            color: #999;
            font-size: 0.9rem;
            line-height: 1.6;
        }

        .mechanism-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        .mechanism-card {
            background: rgba(80, 40, 70, 0.5);
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }
        .mechanism-icon { font-size: 2.5rem; margin-bottom: 10px; }
        .mechanism-card h4 { color: #e879f9; margin-bottom: 8px; }
        .mechanism-card p { font-size: 0.9rem; color: #999; }

        .counter-section {
            background: rgba(34, 197, 94, 0.1);
            border: 2px solid rgba(34, 197, 94, 0.3);
            border-radius: 12px;
            padding: 25px;
            margin: 25px 0;
        }
        .counter-section h3 { color: #22c55e; margin-bottom: 15px; }
        .counter-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 15px;
        }
        .counter-item {
            background: rgba(34, 197, 94, 0.1);
            padding: 15px;
            border-radius: 8px;
        }
        .counter-item h4 { color: #22c55e; font-size: 0.95rem; margin-bottom: 5px; }
        .counter-item p { font-size: 0.85rem; color: #888; }

        .stats-row {
            display: flex;
            justify-content: center;
            gap: 40px;
            margin: 30px 0;
        }
        .stat-box { text-align: center; }
        .stat-value { font-size: 3rem; font-weight: bold; color: #e879f9; }
        .stat-label { color: #999; margin-top: 5px; }

        .slider-container {
            margin: 20px 0;
            text-align: center;
        }
        .slider-label { margin-bottom: 10px; color: #b080a0; }
        .slider {
            width: 80%;
            -webkit-appearance: none;
            height: 8px;
            background: rgba(100, 50, 90, 0.5);
            border-radius: 4px;
            outline: none;
        }
        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 24px;
            height: 24px;
            background: #e879f9;
            border-radius: 50%;
            cursor: pointer;
        }

        /* Shopping Simulation Styles */
        .shopping-sim {
            background: rgba(60, 30, 55, 0.8);
            border-radius: 15px;
            padding: 30px;
            margin: 30px 0;
        }
        .shopping-sim h2 { color: #e879f9; text-align: center; margin-bottom: 20px; }
        .shopping-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            flex-wrap: wrap;
            gap: 15px;
        }
        .budget-display {
            background: rgba(100, 50, 90, 0.5);
            padding: 15px 25px;
            border-radius: 10px;
            text-align: center;
        }
        .budget-label { color: #b080a0; font-size: 0.9rem; }
        .budget-value { font-size: 2rem; font-weight: bold; color: #22c55e; }
        .budget-value.warning { color: #f59e0b; }
        .budget-value.danger { color: #ef4444; }
        .cart-summary {
            background: rgba(100, 50, 90, 0.5);
            padding: 15px 25px;
            border-radius: 10px;
            text-align: center;
        }
        .cart-count { font-size: 2rem; font-weight: bold; color: #e879f9; }
        .satisfaction-meter {
            background: rgba(100, 50, 90, 0.5);
            padding: 15px 25px;
            border-radius: 10px;
            min-width: 200px;
        }
        .satisfaction-bar {
            height: 20px;
            background: rgba(50, 25, 45, 0.8);
            border-radius: 10px;
            overflow: hidden;
            margin-top: 8px;
        }
        .satisfaction-fill {
            height: 100%;
            background: linear-gradient(90deg, #ef4444, #f59e0b, #22c55e);
            transition: width 0.5s ease;
            border-radius: 10px;
        }
        .store-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 15px;
            margin: 25px 0;
        }
        .store-item {
            background: rgba(80, 40, 70, 0.6);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            cursor: pointer;
        }
        .store-item:hover:not(.owned):not(.locked) {
            transform: translateY(-5px);
            border-color: #e879f9;
            box-shadow: 0 10px 30px rgba(232, 121, 249, 0.3);
        }
        .store-item.owned {
            border-color: #22c55e;
            background: rgba(34, 197, 94, 0.2);
            cursor: default;
        }
        .store-item.locked {
            opacity: 0.4;
            cursor: not-allowed;
        }
        .store-item.recommended {
            border-color: #f59e0b;
            animation: pulse-recommend 2s infinite;
        }
        @keyframes pulse-recommend {
            0%, 100% { box-shadow: 0 0 0 0 rgba(245, 158, 11, 0.4); }
            50% { box-shadow: 0 0 20px 10px rgba(245, 158, 11, 0.2); }
        }
        .store-item-icon { font-size: 2.5rem; margin-bottom: 10px; }
        .store-item-name { font-weight: bold; color: #e0e0e0; margin-bottom: 5px; }
        .store-item-price { color: #e879f9; font-size: 1.1rem; }
        .store-item-tag {
            display: inline-block;
            padding: 3px 10px;
            border-radius: 15px;
            font-size: 0.75rem;
            margin-top: 8px;
        }
        .tag-owned { background: #22c55e; color: white; }
        .tag-recommended { background: #f59e0b; color: white; }
        .tag-locked { background: #666; color: #ccc; }
        .shopping-log {
            background: rgba(50, 25, 45, 0.8);
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            max-height: 200px;
            overflow-y: auto;
        }
        .shopping-log h4 { color: #e879f9; margin-bottom: 15px; }
        .log-entry {
            padding: 8px 0;
            border-bottom: 1px solid rgba(100, 50, 90, 0.3);
            font-size: 0.9rem;
            opacity: 0;
            animation: fadeInLog 0.5s forwards;
        }
        @keyframes fadeInLog {
            to { opacity: 1; }
        }
        .log-entry:last-child { border-bottom: none; }
        .log-purchase { color: #ef4444; }
        .log-trigger { color: #f59e0b; font-style: italic; }
        .log-satisfaction { color: #22c55e; }

        /* Cascade Tree Visualization */
        .cascade-tree {
            background: rgba(60, 30, 55, 0.8);
            border-radius: 15px;
            padding: 30px;
            margin: 30px 0;
        }
        .cascade-tree h2 { color: #e879f9; text-align: center; margin-bottom: 10px; }
        .cascade-tree-subtitle { text-align: center; color: #b080a0; margin-bottom: 25px; }
        .tree-container {
            position: relative;
            min-height: 400px;
            overflow: hidden;
        }
        .tree-svg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }
        .tree-svg line {
            stroke: #e879f9;
            stroke-width: 2;
            stroke-dasharray: 5, 5;
            opacity: 0;
            transition: opacity 0.5s ease;
        }
        .tree-svg line.visible { opacity: 0.6; }
        .tree-node {
            position: absolute;
            background: rgba(100, 50, 90, 0.8);
            border: 2px solid #e879f9;
            border-radius: 50%;
            width: 80px;
            height: 80px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            opacity: 0;
            transform: scale(0);
            transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            cursor: pointer;
        }
        .tree-node.visible {
            opacity: 1;
            transform: scale(1);
        }
        .tree-node.root {
            background: linear-gradient(135deg, #e879f9, #a855f7);
            width: 100px;
            height: 100px;
        }
        .tree-node-icon { font-size: 1.5rem; }
        .tree-node-price { font-size: 0.7rem; color: #ccc; margin-top: 2px; }
        .tree-node.root .tree-node-price { color: white; }
        .tree-controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 20px;
        }
        .scenario-select {
            padding: 10px 20px;
            background: rgba(100, 50, 90, 0.5);
            border: 2px solid #e879f9;
            color: #e0e0e0;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
        }
        .scenario-select option { background: #2a1428; }
        .tree-stats {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-top: 25px;
            flex-wrap: wrap;
        }
        .tree-stat {
            text-align: center;
            background: rgba(80, 40, 70, 0.5);
            padding: 15px 25px;
            border-radius: 10px;
        }
        .tree-stat-value { font-size: 1.8rem; font-weight: bold; color: #e879f9; }
        .tree-stat-label { color: #999; font-size: 0.85rem; }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <a href="index.html" class="back-link">‚Üê Back to Paradoxes</a>
            <h1>The Diderot Effect</h1>
            <p class="subtitle">Buy ONE nice thing, and suddenly EVERYTHING else looks shabby. The new purchase triggers a cascade of upgrades until your wallet is empty and your taste is refined.</p>
        </header>

        <div class="story-section">
            <h3>üìú The Original Story (1769)</h3>
            <div class="story-text">
                "I was absolute master of my old dressing gown, but I have become a slave to my new one.
                The scarlet robe made my old straw chair look ridiculous... so I replaced it with a leather armchair.
                The leather armchair made my cheap prints look vulgar... so I hung elegant Vernet engravings.
                The engravings shamed my old desk... so I bought an expensive writing table.
                Before I knew it, I was in debt‚Äîa PHILOSOPHER in debt!‚Äîand my simple study had become
                an elegant prison that no longer felt like home."
                <br><br>‚Äî Denis Diderot, "Regrets on Parting with My Old Dressing Gown"
            </div>
        </div>

        <div class="experiment-container">
            <h2>üè† Experience Diderot's Study</h2>

            <div class="room-visualization">
                <div class="room-grid" id="roomGrid">
                    <div class="item-card old" id="item-robe">
                        <div class="item-icon">üß•</div>
                        <div class="item-name">Dressing Gown</div>
                        <div class="item-status" id="status-robe">Old & Comfortable</div>
                        <div class="item-price" id="price-robe">$0 (owned)</div>
                    </div>
                    <div class="item-card old" id="item-chair">
                        <div class="item-icon">ü™ë</div>
                        <div class="item-name">Chair</div>
                        <div class="item-status" id="status-chair">Worn straw chair</div>
                        <div class="item-price" id="price-chair">$0 (owned)</div>
                    </div>
                    <div class="item-card old" id="item-art">
                        <div class="item-icon">üñºÔ∏è</div>
                        <div class="item-name">Wall Art</div>
                        <div class="item-status" id="status-art">Cheap prints</div>
                        <div class="item-price" id="price-art">$0 (owned)</div>
                    </div>
                    <div class="item-card old" id="item-desk">
                        <div class="item-icon">üìù</div>
                        <div class="item-name">Desk</div>
                        <div class="item-status" id="status-desk">Simple wooden desk</div>
                        <div class="item-price" id="price-desk">$0 (owned)</div>
                    </div>
                    <div class="item-card old" id="item-lamp">
                        <div class="item-icon">üí°</div>
                        <div class="item-name">Lamp</div>
                        <div class="item-status" id="status-lamp">Plain candle holder</div>
                        <div class="item-price" id="price-lamp">$0 (owned)</div>
                    </div>
                    <div class="item-card old" id="item-rug">
                        <div class="item-icon">üß∂</div>
                        <div class="item-name">Rug</div>
                        <div class="item-status" id="status-rug">Threadbare carpet</div>
                        <div class="item-price" id="price-rug">$0 (owned)</div>
                    </div>
                    <div class="item-card old" id="item-curtains">
                        <div class="item-icon">ü™ü</div>
                        <div class="item-name">Curtains</div>
                        <div class="item-status" id="status-curtains">Faded fabric</div>
                        <div class="item-price" id="price-curtains">$0 (owned)</div>
                    </div>
                    <div class="item-card old" id="item-books">
                        <div class="item-icon">üìö</div>
                        <div class="item-name">Bookshelf</div>
                        <div class="item-status" id="status-books">Cramped shelf</div>
                        <div class="item-price" id="price-books">$0 (owned)</div>
                    </div>
                </div>

                <div class="cascade-controls">
                    <button class="btn btn-primary" onclick="receiveGift()">üéÅ Receive the Scarlet Robe</button>
                    <button class="btn btn-secondary" onclick="resetRoom()">üîÑ Reset Room</button>
                </div>

                <div class="total-display">
                    <div class="total-label">Total Spent on "Upgrades"</div>
                    <div class="total-value" id="totalSpent">$0</div>
                    <div class="original-item" id="triggerNote">The robe was a free gift...</div>
                </div>
            </div>
        </div>

        <div class="chain-viz">
            <h3>üîó Watch the Cascade Unfold</h3>
            <div class="chain-container" id="chainContainer">
                <div class="chain-item" id="chain-0">üéÅ Free Robe</div>
                <span class="chain-arrow" id="arrow-0">‚Üí</span>
                <div class="chain-item" id="chain-1">$200 Chair</div>
                <span class="chain-arrow" id="arrow-1">‚Üí</span>
                <div class="chain-item" id="chain-2">$500 Art</div>
                <span class="chain-arrow" id="arrow-2">‚Üí</span>
                <div class="chain-item" id="chain-3">$800 Desk</div>
                <span class="chain-arrow" id="arrow-3">‚Üí</span>
                <div class="chain-item" id="chain-4">$150 Lamp</div>
                <span class="chain-arrow" id="arrow-4">‚Üí</span>
                <div class="chain-item" id="chain-5">$600 Rug</div>
                <span class="chain-arrow" id="arrow-5">‚Üí</span>
                <div class="chain-item" id="chain-6">$300 Curtains</div>
                <span class="chain-arrow" id="arrow-6">‚Üí</span>
                <div class="chain-item" id="chain-7">$400 Bookshelf</div>
            </div>
            <p style="text-align: center; margin-top: 20px; color: #888;">
                A FREE gift ‚Üí $2,950 in "necessary" upgrades
            </p>
        </div>

        <div class="examples-section">
            <h3>üåç Modern Diderot Spirals</h3>
            <div class="example-grid">
                <div class="example-card">
                    <div class="example-trigger">üì± New iPhone</div>
                    <div class="example-cascade">
                        ‚Üí New case ($50) ‚Üí AirPods ($200) ‚Üí Apple Watch ($400)
                        ‚Üí New laptop "for ecosystem" ($1500) ‚Üí iCloud storage ($120/yr)
                    </div>
                </div>
                <div class="example-card">
                    <div class="example-trigger">üèãÔ∏è Gym Membership</div>
                    <div class="example-cascade">
                        ‚Üí Workout clothes ($150) ‚Üí Running shoes ($150)
                        ‚Üí Protein powder ($40/mo) ‚Üí Fitness tracker ($300) ‚Üí Home equipment ($500)
                    </div>
                </div>
                <div class="example-card">
                    <div class="example-trigger">üè† New Couch</div>
                    <div class="example-cascade">
                        ‚Üí New coffee table ($400) ‚Üí New rug ($300)
                        ‚Üí New throw pillows ($150) ‚Üí New curtains ($200) ‚Üí New paint ($400)
                    </div>
                </div>
                <div class="example-card">
                    <div class="example-trigger">üì∏ Nice Camera</div>
                    <div class="example-cascade">
                        ‚Üí Extra lens ($500) ‚Üí Camera bag ($100) ‚Üí Tripod ($150)
                        ‚Üí Editing software ($300) ‚Üí Faster computer ($1500)
                    </div>
                </div>
                <div class="example-card">
                    <div class="example-trigger">üöó New Car</div>
                    <div class="example-cascade">
                        ‚Üí Premium car wash membership ($30/mo) ‚Üí Floor mats ($100)
                        ‚Üí Garage organization ($500) ‚Üí Better driveway ($3000)
                    </div>
                </div>
                <div class="example-card">
                    <div class="example-trigger">üëî Designer Shirt</div>
                    <div class="example-cascade">
                        ‚Üí Matching pants ($150) ‚Üí New shoes ($200)
                        ‚Üí New belt ($80) ‚Üí Watch to match ($500) ‚Üí New wallet ($150)
                    </div>
                </div>
            </div>
        </div>

        <div class="experiment-container">
            <h2>üß† Why Does This Happen?</h2>

            <div class="mechanism-grid">
                <div class="mechanism-card">
                    <div class="mechanism-icon">üîó</div>
                    <h4>Unity Seeking</h4>
                    <p>We crave coherence. Mismatched possessions create cognitive dissonance‚Äîour brain wants harmony.</p>
                </div>
                <div class="mechanism-card">
                    <div class="mechanism-icon">üìà</div>
                    <h4>Upward Comparison</h4>
                    <p>The new item sets a higher standard. Everything else is judged against this new benchmark.</p>
                </div>
                <div class="mechanism-card">
                    <div class="mechanism-icon">üé≠</div>
                    <h4>Identity Expression</h4>
                    <p>Possessions signal who we are. The new item suggests a new identity‚Äîone that needs supporting props.</p>
                </div>
                <div class="mechanism-card">
                    <div class="mechanism-icon">üëÅÔ∏è</div>
                    <h4>Heightened Noticing</h4>
                    <p>The new purchase makes you SEE your surroundings differently. Flaws you ignored suddenly demand attention.</p>
                </div>
            </div>
        </div>

        <div class="insight-box">
            <h4>üõí Retail Knows This</h4>
            <p style="line-height: 1.7;">
                <strong>IKEA's room displays</strong> aren't random‚Äîthey trigger Diderot spirals by showing how
                coordinated items look together. <strong>Fashion "collections"</strong> are designed to be
                incomplete without matching pieces. <strong>"Starter kits"</strong> seed future purchases.
                <strong>Tech ecosystems</strong> (Apple, Google) lock you in by making external products feel "foreign."
                The goal: make one purchase feel incomplete until you buy the whole system.
            </p>
        </div>

        <div class="counter-section">
            <h3>üõ°Ô∏è Breaking the Spiral</h3>
            <div class="counter-list">
                <div class="counter-item">
                    <h4>Wait 30 Days</h4>
                    <p>The "necessity" often fades. Initial contrast-driven urgency calms down.</p>
                </div>
                <div class="counter-item">
                    <h4>One In, One Out</h4>
                    <p>For every new item, remove one. Prevents accumulation spirals.</p>
                </div>
                <div class="counter-item">
                    <h4>Intentional Imperfection</h4>
                    <p>The Japanese "wabi-sabi" aesthetic embraces age and wear. Mismatch becomes charm.</p>
                </div>
                <div class="counter-item">
                    <h4>Set Category Budgets</h4>
                    <p>Pre-define what you'll spend on each area. Makes spirals hit limits.</p>
                </div>
                <div class="counter-item">
                    <h4>Avoid Trigger Purchases</h4>
                    <p>Recognize which items start spirals for YOU. Avoid upgrading anchors.</p>
                </div>
                <div class="counter-item">
                    <h4>Appreciate What Works</h4>
                    <p>Your old items functioned fine yesterday. The robe didn't change their utility.</p>
                </div>
            </div>
        </div>

        <div class="stats-row">
            <div class="stat-box">
                <div class="stat-value">1769</div>
                <div class="stat-label">Diderot wrote his essay</div>
            </div>
            <div class="stat-box">
                <div class="stat-value">1988</div>
                <div class="stat-label">Grant McCracken named it</div>
            </div>
            <div class="stat-box">
                <div class="stat-value">‚àû</div>
                <div class="stat-label">Times we've all done it</div>
            </div>
        </div>

        <!-- Shopping Simulation -->
        <div class="shopping-sim">
            <h2>üõí Interactive Shopping Simulation</h2>
            <p style="text-align: center; color: #b080a0; margin-bottom: 20px;">
                Start with a $500 budget. Make ONE purchase and watch how "recommendations" cascade...
            </p>

            <div class="shopping-header">
                <div class="budget-display">
                    <div class="budget-label">Budget Remaining</div>
                    <div class="budget-value" id="budgetValue">$500</div>
                </div>
                <div class="satisfaction-meter">
                    <div class="budget-label">Room Coherence</div>
                    <div class="satisfaction-bar">
                        <div class="satisfaction-fill" id="satisfactionFill" style="width: 80%"></div>
                    </div>
                </div>
                <div class="cart-summary">
                    <div class="budget-label">Items Bought</div>
                    <div class="cart-count" id="cartCount">0</div>
                </div>
            </div>

            <div class="store-grid" id="storeGrid"></div>

            <div class="cascade-controls">
                <button class="btn btn-secondary" onclick="resetShopping()">üîÑ Reset Shopping</button>
            </div>

            <div class="shopping-log">
                <h4>üìù Purchase Log</h4>
                <div id="shoppingLog">
                    <div class="log-entry">Welcome! Your room is simple but functional. Pick an item to start...</div>
                </div>
            </div>
        </div>

        <!-- Cascade Tree Visualization -->
        <div class="cascade-tree">
            <h2>üå≥ Purchase Cascade Tree</h2>
            <p class="cascade-tree-subtitle">Select a trigger purchase and watch how it branches into a spending tree</p>

            <div class="tree-controls">
                <select class="scenario-select" id="scenarioSelect" onchange="changeScenario()">
                    <option value="phone">üì± New Smartphone</option>
                    <option value="couch">üõãÔ∏è Designer Couch</option>
                    <option value="camera">üì∑ Professional Camera</option>
                    <option value="car">üöó New Car</option>
                    <option value="outfit">üëî Designer Outfit</option>
                </select>
                <button class="btn btn-primary" onclick="animateTree()">‚ñ∂Ô∏è Animate Cascade</button>
                <button class="btn btn-secondary" onclick="resetTree()">üîÑ Reset</button>
            </div>

            <div class="tree-container" id="treeContainer">
                <svg class="tree-svg" id="treeSvg"></svg>
            </div>

            <div class="tree-stats">
                <div class="tree-stat">
                    <div class="tree-stat-value" id="triggerCost">$0</div>
                    <div class="tree-stat-label">Trigger Purchase</div>
                </div>
                <div class="tree-stat">
                    <div class="tree-stat-value" id="cascadeTotal">$0</div>
                    <div class="tree-stat-label">Cascade Total</div>
                </div>
                <div class="tree-stat">
                    <div class="tree-stat-value" id="multiplier">0x</div>
                    <div class="tree-stat-label">Spending Multiplier</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const items = [
            { id: 'robe', name: 'Dressing Gown', oldStatus: 'Old & Comfortable', newStatus: 'Elegant Scarlet Robe', price: 0, isGift: true },
            { id: 'chair', name: 'Chair', oldStatus: 'Worn straw chair', newStatus: 'Leather Armchair', price: 200 },
            { id: 'art', name: 'Wall Art', oldStatus: 'Cheap prints', newStatus: 'Vernet Engravings', price: 500 },
            { id: 'desk', name: 'Desk', oldStatus: 'Simple wooden desk', newStatus: 'Inlaid Writing Table', price: 800 },
            { id: 'lamp', name: 'Lamp', oldStatus: 'Plain candle holder', newStatus: 'Gilded Candelabra', price: 150 },
            { id: 'rug', name: 'Rug', oldStatus: 'Threadbare carpet', newStatus: 'Persian Carpet', price: 600 },
            { id: 'curtains', name: 'Curtains', oldStatus: 'Faded fabric', newStatus: 'Damask Drapes', price: 300 },
            { id: 'books', name: 'Bookshelf', oldStatus: 'Cramped shelf', newStatus: 'Mahogany Bookcase', price: 400 }
        ];

        let currentStep = -1;
        let totalSpent = 0;

        function receiveGift() {
            if (currentStep >= items.length - 1) return;

            currentStep++;
            const item = items[currentStep];
            const card = document.getElementById('item-' + item.id);

            // Update card appearance
            card.classList.remove('old');
            card.classList.add(currentStep === 0 ? 'new' : 'upgraded');

            // Update status and price
            document.getElementById('status-' + item.id).textContent = item.newStatus;
            if (item.isGift) {
                document.getElementById('price-' + item.id).textContent = 'FREE GIFT!';
            } else {
                document.getElementById('price-' + item.id).textContent = '$' + item.price;
                totalSpent += item.price;
            }

            // Update total
            document.getElementById('totalSpent').textContent = '$' + totalSpent.toLocaleString();

            // Update chain visualization
            const chainItem = document.getElementById('chain-' + currentStep);
            chainItem.classList.add('visible');
            if (currentStep > 0) {
                document.getElementById('arrow-' + (currentStep - 1)).classList.add('visible');
            }

            // Update trigger note
            if (currentStep === 0) {
                document.getElementById('triggerNote').textContent = 'The robe was a free gift...';
            } else if (currentStep === items.length - 1) {
                document.getElementById('triggerNote').textContent = 'All from a FREE gift! Diderot was right.';
            } else {
                document.getElementById('triggerNote').textContent = 'But the robe made everything else look shabby...';
            }

            // Schedule next upgrade if auto-playing
            if (currentStep < items.length - 1 && currentStep > 0) {
                // Don't auto-continue, let user click
            }
        }

        function resetRoom() {
            currentStep = -1;
            totalSpent = 0;

            items.forEach(item => {
                const card = document.getElementById('item-' + item.id);
                card.classList.remove('new', 'upgraded');
                card.classList.add('old');
                document.getElementById('status-' + item.id).textContent = item.oldStatus;
                document.getElementById('price-' + item.id).textContent = '$0 (owned)';
            });

            document.getElementById('totalSpent').textContent = '$0';
            document.getElementById('triggerNote').textContent = 'The robe was a free gift...';

            // Reset chain
            for (let i = 0; i < items.length; i++) {
                document.getElementById('chain-' + i).classList.remove('visible');
                if (i < items.length - 1) {
                    document.getElementById('arrow-' + i).classList.remove('visible');
                }
            }
        }

        // ==========================================
        // SHOPPING SIMULATION
        // ==========================================
        const storeItems = [
            { id: 'desk-lamp', icon: 'üí°', name: 'Modern Desk Lamp', price: 45, category: 'lighting', triggers: ['desk', 'plant'] },
            { id: 'desk', icon: 'ü™ë', name: 'Minimalist Desk', price: 180, category: 'furniture', triggers: ['chair', 'desk-lamp', 'monitor-stand'] },
            { id: 'chair', icon: 'ü™ë', name: 'Ergonomic Chair', price: 250, category: 'furniture', triggers: ['desk', 'footrest'] },
            { id: 'monitor-stand', icon: 'üñ•Ô∏è', name: 'Monitor Stand', price: 35, category: 'tech', triggers: ['cable-box', 'desk-lamp'] },
            { id: 'cable-box', icon: 'üì¶', name: 'Cable Management', price: 25, category: 'tech', triggers: ['monitor-stand'] },
            { id: 'plant', icon: 'ü™¥', name: 'Designer Plant', price: 40, category: 'decor', triggers: ['planter', 'shelf'] },
            { id: 'planter', icon: 'üè∫', name: 'Ceramic Planter', price: 55, category: 'decor', triggers: ['plant', 'shelf'] },
            { id: 'shelf', icon: 'üìö', name: 'Floating Shelf', price: 65, category: 'furniture', triggers: ['books', 'plant'] },
            { id: 'books', icon: 'üìñ', name: 'Coffee Table Books', price: 80, category: 'decor', triggers: ['shelf', 'coffee-table'] },
            { id: 'coffee-table', icon: 'ü™µ', name: 'Coffee Table', price: 150, category: 'furniture', triggers: ['rug', 'coasters'] },
            { id: 'rug', icon: 'üß∂', name: 'Area Rug', price: 120, category: 'decor', triggers: ['coffee-table', 'curtains'] },
            { id: 'curtains', icon: 'ü™ü', name: 'Linen Curtains', price: 90, category: 'decor', triggers: ['rug'] },
            { id: 'coasters', icon: 'üçµ', name: 'Marble Coasters', price: 30, category: 'decor', triggers: ['coffee-table'] },
            { id: 'footrest', icon: 'ü¶∂', name: 'Footrest', price: 60, category: 'furniture', triggers: ['chair'] },
            { id: 'art', icon: 'üñºÔ∏è', name: 'Wall Art Print', price: 75, category: 'decor', triggers: ['frame', 'shelf'] },
            { id: 'frame', icon: 'ü™û', name: 'Gallery Frame', price: 45, category: 'decor', triggers: ['art'] }
        ];

        let shoppingBudget = 500;
        let ownedItems = new Set();
        let recommendedItems = new Set();
        let purchaseLog = [];

        function initShopping() {
            const grid = document.getElementById('storeGrid');
            grid.innerHTML = '';

            storeItems.forEach(item => {
                const div = document.createElement('div');
                div.className = 'store-item';
                div.id = 'store-' + item.id;
                div.innerHTML = `
                    <div class="store-item-icon">${item.icon}</div>
                    <div class="store-item-name">${item.name}</div>
                    <div class="store-item-price">$${item.price}</div>
                `;
                div.onclick = () => purchaseItem(item);
                grid.appendChild(div);
            });
            updateShoppingUI();
        }

        function purchaseItem(item) {
            if (ownedItems.has(item.id) || shoppingBudget < item.price) return;

            // Make purchase
            shoppingBudget -= item.price;
            ownedItems.add(item.id);
            recommendedItems.delete(item.id);

            // Log purchase
            addLogEntry(`üí∏ Bought ${item.name} for $${item.price}`, 'log-purchase');

            // Trigger recommendations
            item.triggers.forEach(triggerId => {
                if (!ownedItems.has(triggerId) && !recommendedItems.has(triggerId)) {
                    recommendedItems.add(triggerId);
                    const triggered = storeItems.find(i => i.id === triggerId);
                    if (triggered) {
                        setTimeout(() => {
                            addLogEntry(`üéØ "${item.name}" makes you notice ${triggered.name}...`, 'log-trigger');
                        }, 500);
                    }
                }
            });

            updateShoppingUI();
        }

        function updateShoppingUI() {
            // Update budget
            const budgetEl = document.getElementById('budgetValue');
            budgetEl.textContent = '$' + shoppingBudget;
            budgetEl.className = 'budget-value';
            if (shoppingBudget < 100) budgetEl.classList.add('danger');
            else if (shoppingBudget < 200) budgetEl.classList.add('warning');

            // Update cart count
            document.getElementById('cartCount').textContent = ownedItems.size;

            // Update satisfaction (coherence drops when you have recommended items you haven't bought)
            const coherence = Math.max(20, 100 - (recommendedItems.size * 15));
            document.getElementById('satisfactionFill').style.width = coherence + '%';

            // Update store items
            storeItems.forEach(item => {
                const el = document.getElementById('store-' + item.id);
                el.className = 'store-item';

                // Remove old tags
                const oldTag = el.querySelector('.store-item-tag');
                if (oldTag) oldTag.remove();

                if (ownedItems.has(item.id)) {
                    el.classList.add('owned');
                    el.innerHTML += '<span class="store-item-tag tag-owned">‚úì Owned</span>';
                } else if (shoppingBudget < item.price) {
                    el.classList.add('locked');
                    el.innerHTML += '<span class="store-item-tag tag-locked">Can\'t afford</span>';
                } else if (recommendedItems.has(item.id)) {
                    el.classList.add('recommended');
                    el.innerHTML += '<span class="store-item-tag tag-recommended">You need this!</span>';
                }
            });
        }

        function addLogEntry(text, className) {
            const log = document.getElementById('shoppingLog');
            const entry = document.createElement('div');
            entry.className = 'log-entry ' + className;
            entry.textContent = text;
            log.insertBefore(entry, log.firstChild.nextSibling);

            // Keep log manageable
            while (log.children.length > 15) {
                log.removeChild(log.lastChild);
            }
        }

        function resetShopping() {
            shoppingBudget = 500;
            ownedItems.clear();
            recommendedItems.clear();
            document.getElementById('shoppingLog').innerHTML = '<div class="log-entry">Welcome! Your room is simple but functional. Pick an item to start...</div>';
            initShopping();
        }

        // ==========================================
        // CASCADE TREE VISUALIZATION
        // ==========================================
        const cascadeScenarios = {
            phone: {
                trigger: { icon: 'üì±', name: 'iPhone', price: 1000 },
                branches: [
                    { icon: 'üéß', name: 'AirPods', price: 250, children: [
                        { icon: 'üì¶', name: 'Case', price: 30 }
                    ]},
                    { icon: '‚åö', name: 'Apple Watch', price: 400, children: [
                        { icon: 'üîå', name: 'Charger', price: 30 },
                        { icon: 'üìø', name: 'Bands', price: 50 }
                    ]},
                    { icon: 'üíª', name: 'MacBook', price: 1500, children: [
                        { icon: 'üéí', name: 'Bag', price: 100 },
                        { icon: 'üñ±Ô∏è', name: 'Mouse', price: 80 }
                    ]},
                    { icon: '‚òÅÔ∏è', name: 'iCloud+', price: 120 }
                ]
            },
            couch: {
                trigger: { icon: 'üõãÔ∏è', name: 'Designer Couch', price: 2000 },
                branches: [
                    { icon: 'ü™µ', name: 'Coffee Table', price: 400, children: [
                        { icon: 'üçµ', name: 'Coasters', price: 40 }
                    ]},
                    { icon: 'üß∂', name: 'Area Rug', price: 300, children: [] },
                    { icon: 'üõãÔ∏è', name: 'Throw Pillows', price: 150, children: [] },
                    { icon: 'ü™ü', name: 'Curtains', price: 200, children: [] },
                    { icon: 'üé®', name: 'New Paint', price: 400, children: [] }
                ]
            },
            camera: {
                trigger: { icon: 'üì∑', name: 'Pro Camera', price: 2500 },
                branches: [
                    { icon: 'üî≠', name: 'Zoom Lens', price: 800, children: [
                        { icon: 'üß≥', name: 'Lens Case', price: 60 }
                    ]},
                    { icon: 'üéí', name: 'Camera Bag', price: 150, children: [] },
                    { icon: 'üìê', name: 'Tripod', price: 200, children: [] },
                    { icon: 'üíæ', name: 'SD Cards', price: 100, children: [] },
                    { icon: 'üñ•Ô∏è', name: 'Editing PC', price: 1800, children: [
                        { icon: 'üì∫', name: 'Monitor', price: 400 }
                    ]}
                ]
            },
            car: {
                trigger: { icon: 'üöó', name: 'New Car', price: 35000 },
                branches: [
                    { icon: 'üßΩ', name: 'Car Wash Sub', price: 360, children: [] },
                    { icon: 'ü™§', name: 'Floor Mats', price: 150, children: [] },
                    { icon: 'üè†', name: 'Garage Org', price: 500, children: [
                        { icon: 'üõ†Ô∏è', name: 'Tool Chest', price: 200 }
                    ]},
                    { icon: 'üõ£Ô∏è', name: 'New Driveway', price: 5000, children: [] }
                ]
            },
            outfit: {
                trigger: { icon: 'üëî', name: 'Designer Shirt', price: 200 },
                branches: [
                    { icon: 'üëñ', name: 'Matching Pants', price: 180, children: [] },
                    { icon: 'üëû', name: 'Dress Shoes', price: 250, children: [
                        { icon: 'üß¥', name: 'Shoe Care', price: 40 }
                    ]},
                    { icon: 'üéÄ', name: 'Belt', price: 100, children: [] },
                    { icon: '‚åö', name: 'Watch', price: 500, children: [] },
                    { icon: 'üëõ', name: 'Wallet', price: 150, children: [] }
                ]
            }
        };

        let currentScenario = 'phone';
        let treeNodes = [];
        let animationStep = 0;

        function changeScenario() {
            currentScenario = document.getElementById('scenarioSelect').value;
            resetTree();
        }

        function resetTree() {
            animationStep = 0;
            treeNodes = [];
            const container = document.getElementById('treeContainer');
            const svg = document.getElementById('treeSvg');

            // Clear existing nodes (except SVG)
            Array.from(container.children).forEach(child => {
                if (child.id !== 'treeSvg') child.remove();
            });
            svg.innerHTML = '';

            buildTree();
            updateTreeStats(0, 0);
        }

        function buildTree() {
            const scenario = cascadeScenarios[currentScenario];
            const container = document.getElementById('treeContainer');
            const svg = document.getElementById('treeSvg');
            const containerRect = container.getBoundingClientRect();
            const centerX = containerRect.width / 2;

            // Create root node
            const rootNode = createTreeNode(scenario.trigger, centerX - 50, 20, true);
            container.appendChild(rootNode.element);
            treeNodes.push({ ...rootNode, level: 0, parent: null });

            // Create branch nodes
            const branchCount = scenario.branches.length;
            const spacing = Math.min(180, (containerRect.width - 100) / branchCount);
            const startX = centerX - ((branchCount - 1) * spacing) / 2;

            scenario.branches.forEach((branch, i) => {
                const x = startX + (i * spacing) - 40;
                const y = 150;

                const branchNode = createTreeNode(branch, x, y, false);
                container.appendChild(branchNode.element);
                treeNodes.push({ ...branchNode, level: 1, parent: 0, price: branch.price });

                // Draw line to root
                const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                line.setAttribute('x1', centerX);
                line.setAttribute('y1', 120);
                line.setAttribute('x2', x + 40);
                line.setAttribute('y2', y);
                line.setAttribute('data-level', '1');
                svg.appendChild(line);

                // Create children
                if (branch.children && branch.children.length > 0) {
                    const childSpacing = 90;
                    const childStartX = x - ((branch.children.length - 1) * childSpacing) / 2;

                    branch.children.forEach((child, j) => {
                        const cx = childStartX + (j * childSpacing);
                        const cy = 280;

                        const childNode = createTreeNode(child, cx, cy, false);
                        container.appendChild(childNode.element);
                        treeNodes.push({ ...childNode, level: 2, parent: treeNodes.length - branch.children.length + j, price: child.price });

                        // Draw line to parent
                        const childLine = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                        childLine.setAttribute('x1', x + 40);
                        childLine.setAttribute('y1', y + 80);
                        childLine.setAttribute('x2', cx + 40);
                        childLine.setAttribute('y2', cy);
                        childLine.setAttribute('data-level', '2');
                        svg.appendChild(childLine);
                    });
                }
            });
        }

        function createTreeNode(data, x, y, isRoot) {
            const node = document.createElement('div');
            node.className = 'tree-node' + (isRoot ? ' root' : '');
            node.style.left = x + 'px';
            node.style.top = y + 'px';
            node.innerHTML = `
                <div class="tree-node-icon">${data.icon}</div>
                <div class="tree-node-price">$${data.price.toLocaleString()}</div>
            `;
            node.title = data.name + ' - $' + data.price.toLocaleString();
            return { element: node, data, x, y };
        }

        function animateTree() {
            resetTree();
            const scenario = cascadeScenarios[currentScenario];
            let delay = 0;
            let runningTotal = 0;

            // Animate root
            setTimeout(() => {
                treeNodes[0].element.classList.add('visible');
                runningTotal = scenario.trigger.price;
                updateTreeStats(scenario.trigger.price, runningTotal);
            }, delay);
            delay += 500;

            // Animate level 1
            const level1Nodes = treeNodes.filter(n => n.level === 1);
            const level1Lines = document.querySelectorAll('line[data-level="1"]');

            level1Nodes.forEach((node, i) => {
                setTimeout(() => {
                    if (level1Lines[i]) level1Lines[i].classList.add('visible');
                    node.element.classList.add('visible');
                    runningTotal += node.price;
                    updateTreeStats(scenario.trigger.price, runningTotal);
                }, delay + (i * 400));
            });
            delay += level1Nodes.length * 400 + 300;

            // Animate level 2
            const level2Nodes = treeNodes.filter(n => n.level === 2);
            const level2Lines = document.querySelectorAll('line[data-level="2"]');

            level2Nodes.forEach((node, i) => {
                setTimeout(() => {
                    if (level2Lines[i]) level2Lines[i].classList.add('visible');
                    node.element.classList.add('visible');
                    runningTotal += node.price;
                    updateTreeStats(scenario.trigger.price, runningTotal);
                }, delay + (i * 300));
            });
        }

        function updateTreeStats(triggerCost, total) {
            document.getElementById('triggerCost').textContent = '$' + triggerCost.toLocaleString();
            document.getElementById('cascadeTotal').textContent = '$' + total.toLocaleString();
            const mult = triggerCost > 0 ? (total / triggerCost).toFixed(1) : '0';
            document.getElementById('multiplier').textContent = mult + 'x';
        }

        // Initialize on load
        document.addEventListener('DOMContentLoaded', () => {
            initShopping();
            setTimeout(buildTree, 100);
        });
    </script>
    <script src="../assets/js/enhance.js" defer></script>
</body>
</html>
