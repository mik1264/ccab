<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Prisoner's Dilemma - When Rationality Fails</title>
    <link href="https://fonts.googleapis.com/css2?family=Lora:wght@400;500;600;700&family=Nunito:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --prison-gray: #2c3e50;
            --cell-dark: #1a252f;
            --bars-metal: #7f8c8d;
            --cooperate-green: #27ae60;
            --defect-red: #c0392b;
            --gold: #f1c40f;
            --sage: #8A9A5B;
            --moss: #606C38;
            --cream: #FEFAE0;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Nunito', sans-serif;
            background: linear-gradient(135deg, var(--cell-dark) 0%, var(--prison-gray) 50%, #34495e 100%);
            min-height: 100vh;
            color: #ecf0f1;
            overflow-x: hidden;
        }

        /* Prison bars effect */
        .bars {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
            z-index: 0;
            opacity: 0.1;
            background: repeating-linear-gradient(
                90deg,
                transparent,
                transparent 50px,
                var(--bars-metal) 50px,
                var(--bars-metal) 55px
            );
        }

        .organic-back-link {
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 100;
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 12px 20px;
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            border-radius: 30px;
            text-decoration: none;
            color: white;
            font-weight: 500;
            transition: all 0.3s ease;
            border: 1px solid rgba(255,255,255,0.2);
        }

        .organic-back-link:hover {
            background: rgba(255,255,255,0.2);
            transform: translateX(-5px);
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 80px 20px 60px;
            position: relative;
            z-index: 1;
        }

        h1 {
            font-family: 'Lora', serif;
            font-size: 2.8rem;
            text-align: center;
            margin-bottom: 10px;
            background: linear-gradient(135deg, var(--cooperate-green), var(--defect-red));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .subtitle {
            text-align: center;
            font-size: 1.3rem;
            color: var(--gold);
            margin-bottom: 40px;
            font-weight: 500;
        }

        .card {
            background: rgba(255,255,255,0.05);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            border: 1px solid rgba(255,255,255,0.1);
        }

        h2 {
            font-family: 'Lora', serif;
            color: var(--gold);
            font-size: 1.6rem;
            margin-bottom: 20px;
        }

        p {
            line-height: 1.8;
            margin-bottom: 15px;
            color: rgba(255,255,255,0.9);
        }

        /* Payoff Matrix */
        .matrix-container {
            overflow-x: auto;
            margin: 25px 0;
        }

        .payoff-matrix {
            width: 100%;
            max-width: 500px;
            margin: 0 auto;
            border-collapse: collapse;
        }

        .payoff-matrix th, .payoff-matrix td {
            padding: 15px;
            text-align: center;
            border: 1px solid rgba(255,255,255,0.2);
        }

        .payoff-matrix th {
            background: rgba(0,0,0,0.3);
            color: var(--gold);
            font-weight: 600;
        }

        .payoff-matrix td {
            background: rgba(0,0,0,0.2);
        }

        .payoff-matrix .cooperate { color: var(--cooperate-green); }
        .payoff-matrix .defect { color: var(--defect-red); }

        .payoff {
            font-size: 1.3rem;
            font-weight: 700;
        }

        /* Game Interface */
        .game-container {
            background: rgba(0,0,0,0.4);
            border-radius: 20px;
            padding: 30px;
            margin: 30px 0;
        }

        .players-row {
            display: flex;
            justify-content: space-around;
            align-items: center;
            flex-wrap: wrap;
            gap: 30px;
            margin-bottom: 30px;
        }

        .player-panel {
            text-align: center;
            padding: 25px;
            background: rgba(255,255,255,0.05);
            border-radius: 15px;
            min-width: 200px;
            flex: 1;
        }

        .player-icon {
            font-size: 3rem;
            margin-bottom: 10px;
        }

        .player-name {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--gold);
            margin-bottom: 10px;
        }

        .player-score {
            font-size: 2rem;
            font-weight: 700;
        }

        .player-panel.you .player-score { color: var(--cooperate-green); }
        .player-panel.opponent .player-score { color: var(--defect-red); }

        .choice-buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 25px 0;
        }

        .choice-btn {
            padding: 20px 40px;
            border: 3px solid;
            border-radius: 15px;
            font-size: 1.2rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            background: transparent;
        }

        .choice-btn.cooperate {
            border-color: var(--cooperate-green);
            color: var(--cooperate-green);
        }

        .choice-btn.cooperate:hover {
            background: var(--cooperate-green);
            color: white;
            transform: scale(1.05);
        }

        .choice-btn.defect {
            border-color: var(--defect-red);
            color: var(--defect-red);
        }

        .choice-btn.defect:hover {
            background: var(--defect-red);
            color: white;
            transform: scale(1.05);
        }

        .result-display {
            text-align: center;
            padding: 20px;
            background: rgba(0,0,0,0.3);
            border-radius: 15px;
            margin: 20px 0;
            min-height: 100px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .result-text {
            font-size: 1.2rem;
            margin-bottom: 10px;
        }

        .result-payoff {
            font-size: 1.5rem;
            font-weight: 700;
        }

        .round-counter {
            text-align: center;
            font-size: 1.1rem;
            color: rgba(255,255,255,0.7);
            margin-bottom: 15px;
        }

        /* Strategy Selector */
        .strategy-selector {
            background: rgba(255,255,255,0.05);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
        }

        .strategy-selector label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: var(--gold);
        }

        .strategy-select {
            width: 100%;
            padding: 12px;
            border-radius: 10px;
            border: none;
            background: rgba(0,0,0,0.3);
            color: white;
            font-size: 1rem;
            cursor: pointer;
        }

        .strategy-select option {
            background: var(--prison-gray);
        }

        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 25px;
            font-family: 'Nunito', sans-serif;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 5px;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--gold), #d4ac0d);
            color: var(--cell-dark);
        }

        .btn-primary:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 20px rgba(241,196,15,0.4);
        }

        .btn-secondary {
            background: rgba(255,255,255,0.1);
            color: white;
            border: 2px solid rgba(255,255,255,0.3);
        }

        .btn-secondary:hover {
            background: rgba(255,255,255,0.2);
        }

        .controls-row {
            display: flex;
            justify-content: center;
            gap: 10px;
            flex-wrap: wrap;
            margin: 20px 0;
        }

        /* History */
        .history-container {
            max-height: 200px;
            overflow-y: auto;
            background: rgba(0,0,0,0.3);
            border-radius: 10px;
            padding: 15px;
            margin: 20px 0;
        }

        .history-round {
            display: flex;
            justify-content: space-between;
            padding: 8px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .history-round:last-child {
            border-bottom: none;
        }

        /* Tournament */
        .tournament-container {
            background: rgba(0,0,0,0.4);
            border-radius: 20px;
            padding: 30px;
            margin: 30px 0;
        }

        .tournament-results {
            margin: 20px 0;
        }

        .strategy-result {
            display: flex;
            align-items: center;
            padding: 15px;
            margin: 10px 0;
            background: rgba(255,255,255,0.05);
            border-radius: 10px;
        }

        .strategy-rank {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            margin-right: 15px;
        }

        .strategy-rank.gold { background: var(--gold); color: var(--cell-dark); }
        .strategy-rank.silver { background: #bdc3c7; color: var(--cell-dark); }
        .strategy-rank.bronze { background: #cd6133; color: white; }
        .strategy-rank.other { background: rgba(255,255,255,0.2); }

        .strategy-info {
            flex: 1;
        }

        .strategy-name {
            font-weight: 600;
            color: var(--gold);
        }

        .strategy-description {
            font-size: 0.85rem;
            color: rgba(255,255,255,0.7);
        }

        .strategy-score {
            font-size: 1.5rem;
            font-weight: 700;
        }

        /* Explanation cards */
        .explanation-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .explanation-card {
            background: rgba(0,0,0,0.3);
            border-radius: 15px;
            padding: 25px;
            border-left: 4px solid var(--gold);
        }

        .explanation-card h4 {
            font-family: 'Lora', serif;
            color: var(--gold);
            margin-bottom: 10px;
        }

        .explanation-card p {
            color: rgba(255,255,255,0.8);
            font-size: 0.95rem;
            margin-bottom: 0;
        }

        /* Key insight */
        .key-insight {
            background: linear-gradient(135deg, rgba(39,174,96,0.2), rgba(192,57,43,0.2));
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            border: 1px solid var(--gold);
        }

        .key-insight h3 {
            font-family: 'Lora', serif;
            color: var(--gold);
            margin-bottom: 15px;
        }

        .paradox-box {
            background: rgba(0,0,0,0.3);
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            border-left: 4px solid var(--defect-red);
        }

        .paradox-box h3 {
            color: var(--defect-red);
            margin-bottom: 15px;
        }

        @media (max-width: 600px) {
            h1 { font-size: 2rem; }
            .subtitle { font-size: 1.1rem; }
            .choice-btn { padding: 15px 25px; font-size: 1rem; }
            .player-panel { min-width: 150px; }
        }
    </style>
</head>
<body>
    <div class="bars"></div>

    <a href="index.html" class="organic-back-link">
        <span class="back-arrow">&larr;</span>
        <span class="back-text">Gallery</span>
    </a>

    <div class="container">
        <h1>The Prisoner's Dilemma</h1>
        <p class="subtitle">When Rationality Leads to Ruin</p>

        <div class="card">
            <h2>The Setup</h2>
            <p>Two criminals are arrested and held in separate cells. The police offer each a deal: betray your partner (Defect) or stay silent (Cooperate). Neither knows what the other will choose.</p>

            <div class="matrix-container">
                <table class="payoff-matrix">
                    <tr>
                        <th></th>
                        <th class="cooperate">Partner Cooperates</th>
                        <th class="defect">Partner Defects</th>
                    </tr>
                    <tr>
                        <th class="cooperate">You Cooperate</th>
                        <td><span class="payoff">-1, -1</span><br><small>Both serve 1 year</small></td>
                        <td><span class="payoff">-5, 0</span><br><small>You: 5 years, Partner: free</small></td>
                    </tr>
                    <tr>
                        <th class="defect">You Defect</th>
                        <td><span class="payoff">0, -5</span><br><small>You: free, Partner: 5 years</small></td>
                        <td><span class="payoff">-3, -3</span><br><small>Both serve 3 years</small></td>
                    </tr>
                </table>
            </div>

            <div class="paradox-box">
                <h3>The Paradox</h3>
                <p><strong>Defecting is always the rational choice</strong> for each individual. If your partner cooperates, defecting gets you freedom instead of 1 year. If your partner defects, defecting gets you 3 years instead of 5.</p>
                <p style="margin-bottom: 0;"><strong>But if both defect, both get 3 years</strong>&mdash;worse than if both had cooperated (1 year each). Individual rationality leads to collective disaster!</p>
            </div>
        </div>

        <div class="card">
            <h2>Play the Game</h2>
            <p>Play multiple rounds against different strategies. Points are inverted (higher = better):</p>

            <div class="game-container">
                <div class="strategy-selector">
                    <label>Opponent Strategy:</label>
                    <select class="strategy-select" id="strategySelect" onchange="resetGame()">
                        <option value="titForTat">Tit-for-Tat (Copies your last move)</option>
                        <option value="alwaysDefect">Always Defect</option>
                        <option value="alwaysCooperate">Always Cooperate</option>
                        <option value="random">Random (50/50)</option>
                        <option value="grudger">Grudger (Cooperates until betrayed, then always defects)</option>
                        <option value="pavlov">Pavlov (Win-stay, lose-switch)</option>
                    </select>
                </div>

                <div class="round-counter">Round: <span id="roundNumber">1</span></div>

                <div class="players-row">
                    <div class="player-panel you">
                        <div class="player-icon">&#x1F464;</div>
                        <div class="player-name">You</div>
                        <div class="player-score" id="yourScore">0</div>
                        <div>points</div>
                    </div>
                    <div class="player-panel opponent">
                        <div class="player-icon">&#x1F916;</div>
                        <div class="player-name">Opponent</div>
                        <div class="player-score" id="opponentScore">0</div>
                        <div>points</div>
                    </div>
                </div>

                <div class="choice-buttons">
                    <button class="choice-btn cooperate" onclick="makeChoice('cooperate')">
                        &#x1F91D; Cooperate
                    </button>
                    <button class="choice-btn defect" onclick="makeChoice('defect')">
                        &#x1F5E1; Defect
                    </button>
                </div>

                <div class="result-display" id="resultDisplay">
                    <div class="result-text">Make your choice...</div>
                </div>

                <div class="controls-row">
                    <button class="btn btn-secondary" onclick="resetGame()">Reset Game</button>
                    <button class="btn btn-primary" onclick="autoPlay(10)">Auto-play 10 Rounds</button>
                </div>

                <div class="history-container" id="historyContainer">
                    <div style="text-align: center; color: rgba(255,255,255,0.5);">Game history will appear here...</div>
                </div>
            </div>
        </div>

        <div class="card">
            <h2>Strategy Tournament</h2>
            <p>Run a tournament where each strategy plays against every other strategy for 100 rounds. Click to see which strategy wins!</p>

            <div class="tournament-container">
                <div class="controls-row">
                    <button class="btn btn-primary" onclick="runTournament()">Run Tournament</button>
                </div>

                <div class="tournament-results" id="tournamentResults">
                    <div style="text-align: center; color: rgba(255,255,255,0.5); padding: 30px;">
                        Click "Run Tournament" to see results...
                    </div>
                </div>
            </div>
        </div>

        <div class="card">
            <h2>Famous Strategies</h2>
            <div class="explanation-grid">
                <div class="explanation-card">
                    <h4>Tit-for-Tat</h4>
                    <p>Start by cooperating, then copy whatever the opponent did last round. Simple, forgiving, and retaliatory. Won Axelrod's famous tournament!</p>
                </div>
                <div class="explanation-card">
                    <h4>Always Defect</h4>
                    <p>Never cooperate. Maximizes individual gain against naive cooperators, but mutual defection is suboptimal.</p>
                </div>
                <div class="explanation-card">
                    <h4>Always Cooperate</h4>
                    <p>Always cooperate regardless. Maximizes mutual benefit but is easily exploited by defectors.</p>
                </div>
                <div class="explanation-card">
                    <h4>Grudger (Grim Trigger)</h4>
                    <p>Cooperate until the opponent defects once, then defect forever. Punishes betrayal harshly but can't forgive mistakes.</p>
                </div>
                <div class="explanation-card">
                    <h4>Pavlov (Win-Stay, Lose-Switch)</h4>
                    <p>If the outcome was good (CC or DC), repeat your move. If bad (CD or DD), switch. Learns from outcomes.</p>
                </div>
                <div class="explanation-card">
                    <h4>Random</h4>
                    <p>Flip a coin each round. Unpredictable but doesn't exploit patterns or build cooperation.</p>
                </div>
            </div>
        </div>

        <div class="card">
            <h2>Real-World Applications</h2>
            <div class="explanation-grid">
                <div class="explanation-card">
                    <h4>Arms Races</h4>
                    <p>Nations would be safer if none armed. But each has incentive to arm regardless of what others do. Result: everyone arms, everyone less safe.</p>
                </div>
                <div class="explanation-card">
                    <h4>Climate Change</h4>
                    <p>All countries benefit from emissions cuts. But each has incentive to free-ride on others' efforts. Result: insufficient action.</p>
                </div>
                <div class="explanation-card">
                    <h4>Price Wars</h4>
                    <p>Companies could profit more by keeping prices high. But each has incentive to undercut. Result: race to the bottom.</p>
                </div>
                <div class="explanation-card">
                    <h4>Workplace Politics</h4>
                    <p>Teams work better when everyone shares credit. But individuals have incentive to claim credit. Result: dysfunction.</p>
                </div>
            </div>
        </div>

        <div class="key-insight">
            <h3>The Deeper Lesson</h3>
            <p>The Prisoner's Dilemma reveals a profound truth: <strong>individual rationality can lead to collective irrationality</strong>. What's best for each person isn't best for everyone.</p>
            <p style="margin-top: 15px;">Solutions require changing the game itself: repeated interaction (building trust), communication, enforceable agreements, or changing incentives. The invisible hand doesn't always work&mdash;sometimes it picks everyone's pocket.</p>
        </div>

        <div class="card">
            <h2>Axelrod's Tournament (1980)</h2>
            <p>Political scientist Robert Axelrod invited game theorists to submit strategies for an iterated Prisoner's Dilemma tournament. The surprise winner?</p>

            <div class="paradox-box" style="border-left-color: var(--cooperate-green);">
                <h3 style="color: var(--cooperate-green);">Tit-for-Tat Won!</h3>
                <p>The simplest strategy submitted&mdash;just 4 lines of code&mdash;beat complex strategies from renowned experts. It succeeded by being:</p>
                <ul style="margin-left: 20px; margin-top: 10px;">
                    <li><strong>Nice:</strong> Never defects first</li>
                    <li><strong>Retaliatory:</strong> Punishes defection immediately</li>
                    <li><strong>Forgiving:</strong> Returns to cooperation after punishment</li>
                    <li><strong>Clear:</strong> Opponents can understand and adapt to it</li>
                </ul>
            </div>

            <p>This finding influenced fields from evolutionary biology to international relations. Cooperation can emerge even among self-interested actors&mdash;if the game repeats and reputation matters.</p>
        </div>
    </div>

    <script>
        // Game state
        let yourScore = 0;
        let opponentScore = 0;
        let round = 1;
        let history = [];
        let opponentHistory = [];

        // Payoffs (higher = better, inverted from prison years)
        const payoffs = {
            'cooperate-cooperate': [3, 3],
            'cooperate-defect': [0, 5],
            'defect-cooperate': [5, 0],
            'defect-defect': [1, 1]
        };

        function getOpponentMove(strategy) {
            switch(strategy) {
                case 'alwaysDefect':
                    return 'defect';
                case 'alwaysCooperate':
                    return 'cooperate';
                case 'random':
                    return Math.random() > 0.5 ? 'cooperate' : 'defect';
                case 'titForTat':
                    return history.length === 0 ? 'cooperate' : history[history.length - 1];
                case 'grudger':
                    return history.includes('defect') ? 'defect' : 'cooperate';
                case 'pavlov':
                    if (history.length === 0) return 'cooperate';
                    const lastYou = history[history.length - 1];
                    const lastOpp = opponentHistory[opponentHistory.length - 1];
                    // Win-stay, lose-switch
                    if ((lastOpp === 'cooperate' && lastYou === 'cooperate') ||
                        (lastOpp === 'cooperate' && lastYou === 'defect')) {
                        return lastYou; // Stay with what worked
                    } else {
                        return lastYou === 'cooperate' ? 'defect' : 'cooperate'; // Switch
                    }
                default:
                    return 'cooperate';
            }
        }

        function makeChoice(yourChoice) {
            const strategy = document.getElementById('strategySelect').value;
            const oppChoice = getOpponentMove(strategy);

            const key = yourChoice + '-' + oppChoice;
            const [yourPoints, oppPoints] = payoffs[key];

            yourScore += yourPoints;
            opponentScore += oppPoints;

            history.push(yourChoice);
            opponentHistory.push(oppChoice);

            // Update display
            document.getElementById('yourScore').textContent = yourScore;
            document.getElementById('opponentScore').textContent = opponentScore;

            const resultDisplay = document.getElementById('resultDisplay');
            const yourAction = yourChoice === 'cooperate' ? '&#x1F91D; Cooperated' : '&#x1F5E1; Defected';
            const oppAction = oppChoice === 'cooperate' ? '&#x1F91D; Cooperated' : '&#x1F5E1; Defected';

            resultDisplay.innerHTML = `
                <div class="result-text">
                    You ${yourAction} | Opponent ${oppAction}
                </div>
                <div class="result-payoff">
                    You: +${yourPoints} | Opponent: +${oppPoints}
                </div>
            `;

            // Update history
            updateHistory();

            round++;
            document.getElementById('roundNumber').textContent = round;
        }

        function updateHistory() {
            const container = document.getElementById('historyContainer');
            let html = '';

            for (let i = history.length - 1; i >= Math.max(0, history.length - 10); i--) {
                const yourMove = history[i] === 'cooperate' ? '&#x1F91D;' : '&#x1F5E1;';
                const oppMove = opponentHistory[i] === 'cooperate' ? '&#x1F91D;' : '&#x1F5E1;';
                const key = history[i] + '-' + opponentHistory[i];
                const [yourPts, oppPts] = payoffs[key];

                html += `
                    <div class="history-round">
                        <span>Round ${i + 1}</span>
                        <span>You: ${yourMove} (+${yourPts})</span>
                        <span>Opp: ${oppMove} (+${oppPts})</span>
                    </div>
                `;
            }

            container.innerHTML = html || '<div style="text-align: center; color: rgba(255,255,255,0.5);">No history yet...</div>';
        }

        function resetGame() {
            yourScore = 0;
            opponentScore = 0;
            round = 1;
            history = [];
            opponentHistory = [];

            document.getElementById('yourScore').textContent = '0';
            document.getElementById('opponentScore').textContent = '0';
            document.getElementById('roundNumber').textContent = '1';
            document.getElementById('resultDisplay').innerHTML = '<div class="result-text">Make your choice...</div>';
            document.getElementById('historyContainer').innerHTML = '<div style="text-align: center; color: rgba(255,255,255,0.5);">Game history will appear here...</div>';
        }

        function autoPlay(rounds) {
            for (let i = 0; i < rounds; i++) {
                const choice = Math.random() > 0.5 ? 'cooperate' : 'defect';
                makeChoice(choice);
            }
        }

        // Tournament
        const strategies = {
            'Tit-for-Tat': (myHist, oppHist) => oppHist.length === 0 ? 'C' : oppHist[oppHist.length - 1],
            'Always Defect': () => 'D',
            'Always Cooperate': () => 'C',
            'Random': () => Math.random() > 0.5 ? 'C' : 'D',
            'Grudger': (myHist, oppHist) => oppHist.includes('D') ? 'D' : 'C',
            'Pavlov': (myHist, oppHist) => {
                if (myHist.length === 0) return 'C';
                const lastMe = myHist[myHist.length - 1];
                const lastOpp = oppHist[oppHist.length - 1];
                if ((lastMe === 'C' && lastOpp === 'C') || (lastMe === 'D' && lastOpp === 'D')) {
                    return lastMe;
                }
                return lastMe === 'C' ? 'D' : 'C';
            }
        };

        const tournamentPayoffs = {
            'C-C': [3, 3],
            'C-D': [0, 5],
            'D-C': [5, 0],
            'D-D': [1, 1]
        };

        function playMatch(strat1, strat2, rounds = 100) {
            let hist1 = [], hist2 = [];
            let score1 = 0, score2 = 0;

            for (let i = 0; i < rounds; i++) {
                const move1 = strat1(hist1, hist2);
                const move2 = strat2(hist2, hist1);

                const key = move1 + '-' + move2;
                const [pts1, pts2] = tournamentPayoffs[key];

                score1 += pts1;
                score2 += pts2;
                hist1.push(move1);
                hist2.push(move2);
            }

            return [score1, score2];
        }

        function runTournament() {
            const names = Object.keys(strategies);
            const scores = {};
            names.forEach(n => scores[n] = 0);

            // Each strategy plays against each other
            for (let i = 0; i < names.length; i++) {
                for (let j = 0; j < names.length; j++) {
                    const [score1, score2] = playMatch(strategies[names[i]], strategies[names[j]]);
                    scores[names[i]] += score1;
                    scores[names[j]] += score2;
                }
            }

            // Sort by score
            const sorted = names.sort((a, b) => scores[b] - scores[a]);

            // Display results
            const container = document.getElementById('tournamentResults');
            let html = '';

            sorted.forEach((name, i) => {
                const rankClass = i === 0 ? 'gold' : i === 1 ? 'silver' : i === 2 ? 'bronze' : 'other';
                const descriptions = {
                    'Tit-for-Tat': 'Copies opponent\'s last move',
                    'Always Defect': 'Never cooperates',
                    'Always Cooperate': 'Always cooperates',
                    'Random': '50/50 each round',
                    'Grudger': 'Cooperates until betrayed',
                    'Pavlov': 'Win-stay, lose-switch'
                };

                html += `
                    <div class="strategy-result">
                        <div class="strategy-rank ${rankClass}">${i + 1}</div>
                        <div class="strategy-info">
                            <div class="strategy-name">${name}</div>
                            <div class="strategy-description">${descriptions[name]}</div>
                        </div>
                        <div class="strategy-score">${scores[name]}</div>
                    </div>
                `;
            });

            container.innerHTML = html;
        }
    </script>
</body>
</html>
