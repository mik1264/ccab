<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aharonov-Bohm Effect: Potentials Are Real | Surprising Paradoxes</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: linear-gradient(135deg, #080510 0%, #150820 50%, #0a0515 100%);
            color: #e0e0e0;
            min-height: 100vh;
            overflow-x: hidden;
        }
        .back-link {
            position: fixed;
            top: 20px;
            left: 20px;
            color: #cc88ff;
            text-decoration: none;
            font-size: 1rem;
            z-index: 100;
            padding: 8px 16px;
            background: rgba(0,0,0,0.5);
            border-radius: 20px;
            transition: all 0.3s ease;
        }
        .back-link:hover {
            background: rgba(180, 100, 255, 0.2);
            transform: translateX(-3px);
        }
        header {
            text-align: center;
            padding: 80px 20px 30px;
        }
        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            background: linear-gradient(135deg, #aa66ff, #cc88ff, #eeccff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .subtitle {
            color: #9977aa;
            font-size: 1.2rem;
            max-width: 700px;
            margin: 0 auto;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        .demo-section {
            display: grid;
            grid-template-columns: 1fr 320px;
            gap: 30px;
            margin-bottom: 40px;
        }
        @media (max-width: 900px) {
            .demo-section {
                grid-template-columns: 1fr;
            }
        }
        .canvas-container {
            background: linear-gradient(145deg, #080510, #150820);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 10px 40px rgba(150,50,200,0.2);
        }
        canvas {
            display: block;
            width: 100%;
            border-radius: 10px;
        }
        .controls {
            background: linear-gradient(145deg, #100815, #1a0c28);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 40px rgba(150,50,200,0.2);
        }
        .phase-display {
            text-align: center;
            padding: 15px;
            background: rgba(150, 80, 200, 0.15);
            border-radius: 10px;
            margin-bottom: 20px;
        }
        .phase-display .phase {
            font-size: 2rem;
            font-weight: bold;
            color: #cc88ff;
            text-shadow: 0 0 15px rgba(200, 100, 255, 0.5);
        }
        .phase-display .label {
            font-size: 0.85rem;
            color: #9977aa;
            margin-top: 5px;
        }
        .info-panel {
            background: rgba(150, 50, 200, 0.12);
            border: 1px solid rgba(180, 100, 255, 0.3);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
        }
        .info-panel h3 {
            color: #cc88ff;
            font-size: 0.95rem;
            margin-bottom: 12px;
            border-bottom: 1px solid rgba(180, 100, 255, 0.2);
            padding-bottom: 8px;
        }
        .info-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 0.85rem;
        }
        .info-label { color: #9977aa; }
        .info-value {
            color: #fff;
            font-family: 'Consolas', monospace;
        }
        .info-value.field { color: #88ff88; }
        .info-value.potential { color: #ffaa66; }
        .control-group {
            margin-bottom: 20px;
        }
        .control-group label {
            display: block;
            margin-bottom: 8px;
            color: #cc88ff;
            font-size: 0.9rem;
        }
        .control-group input[type="range"] {
            width: 100%;
            height: 6px;
            border-radius: 3px;
            background: #1a0c28;
            outline: none;
            -webkit-appearance: none;
        }
        .control-group input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: linear-gradient(135deg, #aa66ff, #8844cc);
            cursor: pointer;
        }
        .value-display {
            text-align: right;
            font-size: 0.85rem;
            color: #aaa;
            margin-top: 5px;
        }
        button {
            width: 100%;
            padding: 12px;
            border: none;
            border-radius: 8px;
            background: linear-gradient(135deg, #8844cc, #6622aa);
            color: white;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 10px;
        }
        button:hover {
            background: linear-gradient(135deg, #aa66ee, #8844cc);
            transform: translateY(-2px);
        }
        button.active {
            background: linear-gradient(135deg, #cc88ff, #aa66dd);
            box-shadow: 0 0 15px rgba(200, 100, 255, 0.4);
        }
        .comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-bottom: 15px;
        }
        .comparison-box {
            padding: 12px;
            border-radius: 8px;
            text-align: center;
            font-size: 0.85rem;
        }
        .comparison-box.field {
            background: rgba(100, 255, 100, 0.1);
            border: 1px solid rgba(100, 255, 100, 0.3);
        }
        .comparison-box.field .value { color: #88ff88; }
        .comparison-box.potential {
            background: rgba(255, 150, 50, 0.1);
            border: 1px solid rgba(255, 150, 50, 0.3);
        }
        .comparison-box.potential .value { color: #ffaa66; }
        .essay {
            background: linear-gradient(145deg, #080510, #150820);
            border-radius: 15px;
            padding: 40px;
            line-height: 1.8;
            box-shadow: 0 10px 40px rgba(150,50,200,0.2);
        }
        .essay h2 {
            color: #cc88ff;
            margin: 30px 0 15px;
            font-size: 1.5rem;
        }
        .essay h2:first-child { margin-top: 0; }
        .essay p {
            margin-bottom: 15px;
            color: #c0b8d0;
        }
        .essay strong { color: #ddaaff; }
        .essay em { color: #ffcc88; font-style: italic; }
        .highlight-box {
            background: rgba(150, 50, 200, 0.15);
            border-left: 4px solid #cc88ff;
            padding: 20px;
            margin: 25px 0;
            border-radius: 0 10px 10px 0;
        }
        .highlight-box.paradox {
            background: rgba(200, 80, 255, 0.1);
            border-left-color: #ff88cc;
        }
        .formula {
            text-align: center;
            padding: 20px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            margin: 20px 0;
            font-family: 'Times New Roman', serif;
            font-size: 1.3rem;
            color: #ddaaff;
        }
        .sources {
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #2a1a3a;
        }
        .sources h3 {
            color: #9977aa;
            margin-bottom: 15px;
        }
        .sources ul {
            list-style: none;
        }
        .sources li {
            margin-bottom: 10px;
        }
        .sources a {
            color: #9966bb;
            text-decoration: none;
        }
        .sources a:hover {
            color: #cc88ff;
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <a href="index.html" class="back-link">← Back to Paradoxes</a>

    <header>
        <h1>Aharonov-Bohm Effect</h1>
        <p class="subtitle">Electrons feel electromagnetic potentials even where fields are zero—proving potentials are physically real</p>
    </header>

    <div class="container">
        <div class="demo-section">
            <div class="canvas-container">
                <canvas id="canvas"></canvas>
            </div>
            <div class="controls">
                <div class="phase-display">
                    <div class="phase" id="phaseValue">π/2</div>
                    <div class="label">Phase Shift (Δφ)</div>
                </div>

                <div class="comparison">
                    <div class="comparison-box field">
                        <div class="label">Magnetic Field B</div>
                        <div class="value" id="fieldValue">0 T (outside)</div>
                    </div>
                    <div class="comparison-box potential">
                        <div class="label">Vector Potential A</div>
                        <div class="value" id="potentialValue">≠ 0</div>
                    </div>
                </div>

                <div class="info-panel">
                    <h3>The Paradox</h3>
                    <div class="info-row">
                        <span class="info-label">B outside solenoid</span>
                        <span class="info-value field">Zero!</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">A outside solenoid</span>
                        <span class="info-value potential">Non-zero</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Phase shift</span>
                        <span class="info-value" id="shiftValue">Observed!</span>
                    </div>
                </div>

                <div class="control-group">
                    <label>Magnetic Flux (Φ)</label>
                    <input type="range" id="flux" min="0" max="4" value="2" step="0.1">
                    <div class="value-display" id="fluxDisplay">2.0 Φ₀</div>
                </div>

                <div class="control-group">
                    <label>Electron Speed</label>
                    <input type="range" id="speed" min="0.5" max="2" value="1" step="0.1">
                    <div class="value-display" id="speedDisplay">1.0×</div>
                </div>

                <button id="toggleBtn" class="active">⏸ Pause</button>
                <button id="showPotentialBtn">Show Vector Potential Field</button>
            </div>
        </div>

        <div class="essay">
            <h2>The Paradox: Affected by Nothing?</h2>
            <p>
                Classical electromagnetism says that forces on charged particles come from <strong>electric
                and magnetic fields</strong> (E and B). The <em>potentials</em> (φ and A) are just
                mathematical conveniences—useful for calculations but not "real" in themselves.
                Change the potential by adding a constant? No physical effect.
            </p>

            <div class="highlight-box paradox">
                <strong>The Aharonov-Bohm Prediction:</strong> In 1959, Yakir Aharonov and David Bohm
                showed that quantum mechanics disagrees. Even in regions where E = 0 and B = 0,
                the potentials can cause measurable effects. The vector potential A is physically real,
                not just a mathematical tool.
            </div>

            <h2>The Setup: A Shielded Solenoid</h2>
            <p>
                Consider a long solenoid carrying electric current. Inside, there's a uniform magnetic
                field B. Outside, the field is <strong>exactly zero</strong>—the solenoid's design
                confines the field perfectly. Classical physics says nothing outside should "know"
                about the magnetic field inside.
            </p>
            <p>
                But the vector potential A, which satisfies B = ∇ × A, extends outside the solenoid
                even where B = 0. It circles around the solenoid, and its line integral around any
                closed path equals the enclosed magnetic flux.
            </p>

            <div class="formula">
                ∮ A · dl = Φ = ∫∫ B · dS
            </div>

            <h2>The Experiment: Two-Path Interference</h2>
            <p>
                Split an electron beam into two paths that go around opposite sides of the shielded
                solenoid, then recombine them on a detector screen. The electrons never enter the
                region with non-zero B—they stay entirely in the field-free zone outside.
            </p>
            <p>
                Classical physics predicts: no phase difference between paths (no force acted on
                either beam). The interference pattern should be independent of the enclosed flux.
            </p>
            <p>
                <strong>Quantum mechanics predicts:</strong> the phase difference depends on the
                enclosed flux Φ. The interference pattern shifts when you change the current in
                the solenoid—even though the electrons never encounter any magnetic field!
            </p>

            <div class="formula">
                Δφ = (e/ℏ) × Φ = (e/ℏ) × ∮ A · dl
            </div>

            <h2>Experimental Confirmation</h2>
            <p>
                The effect was definitively confirmed by Akira Tonomura and colleagues in 1986.
                Using electron holography and a superconducting shield to guarantee zero magnetic
                field leakage, they observed the predicted interference shifts. The results matched
                quantum mechanics exactly.
            </p>

            <div class="highlight-box">
                <strong>Physical Reality of Potentials:</strong> The Aharonov-Bohm effect proves
                that electromagnetic potentials are not merely computational aids. They carry
                physical information that affects particle behavior even where the fields they
                generate are absent. This is a uniquely quantum phenomenon with no classical analog.
            </div>

            <h2>Deep Implications</h2>
            <p>
                <strong>Non-locality:</strong> The electron's behavior depends on the enclosed flux—
                information from a region it never visits. This is a form of quantum non-locality,
                though it doesn't allow faster-than-light signaling.
            </p>
            <p>
                <strong>Gauge invariance:</strong> Classical gauge freedom (ability to add gradients
                to A without changing physics) becomes more subtle in quantum mechanics. While gauge
                invariance holds for observables, the potential itself carries physical content.
            </p>
            <p>
                <strong>Topological effects:</strong> The AB effect depends on the <em>topology</em>
                of the electron paths—whether they enclose flux or not. This connects to modern
                ideas in topological quantum matter and gauge theories.
            </p>

            <h2>Beyond Magnetism</h2>
            <p>
                Similar effects exist for electric potentials (Aharonov-Bohm electric effect) and
                even gravitational potentials (gravitational AB effect). The principle generalizes:
                in quantum mechanics, potentials—not just fields—are the fundamental physical quantities.
            </p>

            <div class="sources">
                <h3>Sources & Further Reading</h3>
                <ul>
                    <li><a href="https://en.wikipedia.org/wiki/Aharonov–Bohm_effect">Wikipedia: Aharonov-Bohm Effect</a></li>
                    <li><a href="https://pmc.ncbi.nlm.nih.gov/articles/PMC4323049/">PMC: The Aharonov-Bohm Effect and Electron Phase Microscopy</a></li>
                    <li><a href="https://www.nature.com/articles/srep19996">Nature: Experimental Proposal to Test the Vector Potential</a></li>
                    <li><a href="https://aapt.scitation.org/doi/10.1119/1.5115499">Am. J. Phys.: Magnetic AB Effects and Quantum Phase Shift</a></li>
                </ul>
            </div>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');

        // High DPI setup
        const dpr = window.devicePixelRatio || 1;
        const rect = canvas.getBoundingClientRect();
        canvas.width = rect.width * dpr;
        canvas.height = rect.width * 0.8 * dpr;
        canvas.style.height = rect.width * 0.8 + 'px';
        ctx.scale(dpr, dpr);

        const width = rect.width;
        const height = rect.width * 0.8;
        const centerX = width / 2;
        const centerY = height / 2;

        // State
        let time = 0;
        let running = true;
        let showPotential = false;
        let flux = 2.0;
        let electronSpeed = 1.0;

        // Electron paths
        let electrons = [];
        const solenoidRadius = 40;
        const pathRadius = 100;

        // Controls
        const fluxSlider = document.getElementById('flux');
        const speedSlider = document.getElementById('speed');
        const toggleBtn = document.getElementById('toggleBtn');
        const showPotentialBtn = document.getElementById('showPotentialBtn');

        fluxSlider.addEventListener('input', e => {
            flux = parseFloat(e.target.value);
            document.getElementById('fluxDisplay').textContent = flux.toFixed(1) + ' Φ₀';
            updatePhaseDisplay();
        });

        speedSlider.addEventListener('input', e => {
            electronSpeed = parseFloat(e.target.value);
            document.getElementById('speedDisplay').textContent = electronSpeed.toFixed(1) + '×';
        });

        toggleBtn.addEventListener('click', () => {
            running = !running;
            toggleBtn.textContent = running ? '⏸ Pause' : '▶ Play';
            toggleBtn.classList.toggle('active', running);
        });

        showPotentialBtn.addEventListener('click', () => {
            showPotential = !showPotential;
            showPotentialBtn.classList.toggle('active', showPotential);
        });

        function updatePhaseDisplay() {
            const phaseShift = flux * Math.PI;
            const displayValue = (phaseShift / Math.PI).toFixed(2) + 'π';
            document.getElementById('phaseValue').textContent = displayValue;
        }

        class Electron {
            constructor(path) {
                this.path = path; // 'upper' or 'lower'
                this.progress = 0;
                this.active = false;
                this.trail = [];
            }

            reset() {
                this.progress = 0;
                this.active = true;
                this.trail = [];
            }

            getPosition() {
                const t = this.progress;
                const startX = centerX - 150;
                const endX = centerX + 150;

                if (t < 0.2) {
                    // Approaching
                    const localT = t / 0.2;
                    return {
                        x: startX + localT * (centerX - pathRadius - startX),
                        y: centerY
                    };
                } else if (t < 0.8) {
                    // Going around solenoid
                    const localT = (t - 0.2) / 0.6;
                    const angle = this.path === 'upper'
                        ? Math.PI - localT * Math.PI
                        : Math.PI + localT * Math.PI;
                    return {
                        x: centerX + Math.cos(angle) * pathRadius,
                        y: centerY + Math.sin(angle) * pathRadius
                    };
                } else {
                    // Leaving
                    const localT = (t - 0.8) / 0.2;
                    return {
                        x: centerX + pathRadius + localT * (endX - centerX - pathRadius),
                        y: centerY
                    };
                }
            }

            update() {
                if (!this.active) return;

                this.progress += 0.005 * electronSpeed;

                const pos = this.getPosition();
                this.trail.push({ x: pos.x, y: pos.y, age: 0 });

                // Age and trim trail
                this.trail = this.trail.map(p => ({ ...p, age: p.age + 1 }))
                    .filter(p => p.age < 50);

                if (this.progress >= 1) {
                    this.active = false;
                }
            }

            draw(ctx) {
                if (!this.active && this.trail.length === 0) return;

                // Draw trail
                this.trail.forEach(p => {
                    const alpha = Math.max(0, 1 - p.age / 50);
                    ctx.fillStyle = this.path === 'upper'
                        ? `rgba(100, 200, 255, ${alpha * 0.5})`
                        : `rgba(255, 150, 100, ${alpha * 0.5})`;
                    ctx.beginPath();
                    ctx.arc(p.x, p.y, 2, 0, Math.PI * 2);
                    ctx.fill();
                });

                if (!this.active) return;

                // Draw electron
                const pos = this.getPosition();
                const color = this.path === 'upper' ? '#44ccff' : '#ffaa66';

                // Glow
                const glow = ctx.createRadialGradient(pos.x, pos.y, 0, pos.x, pos.y, 15);
                glow.addColorStop(0, color);
                glow.addColorStop(0.5, color.replace('ff', '88'));
                glow.addColorStop(1, 'transparent');
                ctx.fillStyle = glow;
                ctx.beginPath();
                ctx.arc(pos.x, pos.y, 15, 0, Math.PI * 2);
                ctx.fill();

                // Core
                ctx.fillStyle = '#fff';
                ctx.beginPath();
                ctx.arc(pos.x, pos.y, 4, 0, Math.PI * 2);
                ctx.fill();
            }
        }

        // Initialize electrons
        function initElectrons() {
            electrons = [
                new Electron('upper'),
                new Electron('lower')
            ];
        }

        function drawVectorPotential() {
            if (!showPotential) return;

            // Draw vector potential field lines (circles around solenoid)
            ctx.strokeStyle = 'rgba(255, 180, 100, 0.3)';
            ctx.lineWidth = 1;

            for (let r = solenoidRadius + 20; r < 200; r += 20) {
                ctx.beginPath();
                ctx.arc(centerX, centerY, r, 0, Math.PI * 2);
                ctx.stroke();

                // Direction arrows
                for (let i = 0; i < 8; i++) {
                    const angle = i * Math.PI / 4 + time * 0.01;
                    const ax = centerX + Math.cos(angle) * r;
                    const ay = centerY + Math.sin(angle) * r;

                    // Arrow tangent to circle (counterclockwise)
                    const arrowAngle = angle + Math.PI / 2;
                    const arrowLen = 8;

                    ctx.fillStyle = 'rgba(255, 180, 100, 0.5)';
                    ctx.beginPath();
                    ctx.moveTo(ax + Math.cos(arrowAngle) * arrowLen, ay + Math.sin(arrowAngle) * arrowLen);
                    ctx.lineTo(ax + Math.cos(arrowAngle - 2.5) * 5, ay + Math.sin(arrowAngle - 2.5) * 5);
                    ctx.lineTo(ax + Math.cos(arrowAngle + 2.5) * 5, ay + Math.sin(arrowAngle + 2.5) * 5);
                    ctx.closePath();
                    ctx.fill();
                }
            }

            // Label
            ctx.fillStyle = 'rgba(255, 180, 100, 0.7)';
            ctx.font = '12px Segoe UI';
            ctx.textAlign = 'center';
            ctx.fillText('Vector Potential A (non-zero everywhere)', centerX, height - 40);
        }

        function drawSolenoid() {
            // Solenoid (cross-section)
            const grad = ctx.createRadialGradient(centerX, centerY, 0, centerX, centerY, solenoidRadius);
            grad.addColorStop(0, '#334455');
            grad.addColorStop(0.7, '#223344');
            grad.addColorStop(1, '#112233');
            ctx.fillStyle = grad;
            ctx.beginPath();
            ctx.arc(centerX, centerY, solenoidRadius, 0, Math.PI * 2);
            ctx.fill();

            // Coil wires
            ctx.strokeStyle = '#557788';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.arc(centerX, centerY, solenoidRadius, 0, Math.PI * 2);
            ctx.stroke();

            // Magnetic field indicator inside
            ctx.fillStyle = 'rgba(100, 255, 100, 0.3)';
            ctx.beginPath();
            ctx.arc(centerX, centerY, solenoidRadius - 5, 0, Math.PI * 2);
            ctx.fill();

            // B field dots (into page)
            ctx.fillStyle = '#88ff88';
            for (let i = 0; i < 5; i++) {
                for (let j = 0; j < 5; j++) {
                    const bx = centerX - 20 + i * 10;
                    const by = centerY - 20 + j * 10;
                    const dist = Math.sqrt((bx - centerX) ** 2 + (by - centerY) ** 2);
                    if (dist < solenoidRadius - 10) {
                        ctx.beginPath();
                        ctx.arc(bx, by, 2, 0, Math.PI * 2);
                        ctx.fill();
                    }
                }
            }

            // Labels
            ctx.fillStyle = '#88ff88';
            ctx.font = 'bold 12px Segoe UI';
            ctx.textAlign = 'center';
            ctx.fillText('B ≠ 0', centerX, centerY + 5);

            ctx.fillStyle = '#888';
            ctx.font = '11px Segoe UI';
            ctx.fillText('Solenoid', centerX, centerY + solenoidRadius + 20);
            ctx.fillText('(shielded)', centerX, centerY + solenoidRadius + 35);
        }

        function drawPaths() {
            // Upper path
            ctx.strokeStyle = 'rgba(100, 200, 255, 0.3)';
            ctx.lineWidth = 2;
            ctx.setLineDash([5, 5]);

            ctx.beginPath();
            ctx.moveTo(centerX - 150, centerY);
            ctx.lineTo(centerX - pathRadius, centerY);
            ctx.stroke();

            ctx.beginPath();
            ctx.arc(centerX, centerY, pathRadius, Math.PI, 0, true);
            ctx.stroke();

            ctx.beginPath();
            ctx.moveTo(centerX + pathRadius, centerY);
            ctx.lineTo(centerX + 150, centerY);
            ctx.stroke();

            // Lower path
            ctx.strokeStyle = 'rgba(255, 150, 100, 0.3)';
            ctx.beginPath();
            ctx.arc(centerX, centerY, pathRadius, Math.PI, 2 * Math.PI, false);
            ctx.stroke();

            ctx.setLineDash([]);

            // Path labels
            ctx.fillStyle = 'rgba(100, 200, 255, 0.7)';
            ctx.font = '12px Segoe UI';
            ctx.textAlign = 'center';
            ctx.fillText('Path 1 (upper)', centerX, centerY - pathRadius - 15);

            ctx.fillStyle = 'rgba(255, 150, 100, 0.7)';
            ctx.fillText('Path 2 (lower)', centerX, centerY + pathRadius + 25);
        }

        function drawSource() {
            // Electron source
            ctx.fillStyle = '#445566';
            ctx.fillRect(centerX - 170, centerY - 20, 30, 40);

            ctx.fillStyle = '#88aacc';
            ctx.font = '10px Segoe UI';
            ctx.textAlign = 'center';
            ctx.fillText('e⁻ source', centerX - 155, centerY + 40);
        }

        function drawDetector() {
            const detectorX = centerX + 160;

            // Detector screen
            ctx.fillStyle = '#334455';
            ctx.fillRect(detectorX - 10, centerY - 80, 20, 160);

            // Interference pattern (shifted by phase)
            const phaseShift = flux * Math.PI;
            const numFringes = 10;

            for (let i = 0; i < numFringes; i++) {
                const y = centerY - 70 + i * 14;
                const baseIntensity = Math.cos((i - numFringes / 2) * 0.8) ** 2;
                const shiftedIntensity = Math.cos((i - numFringes / 2) * 0.8 + phaseShift) ** 2;

                // Show shifted pattern
                const intensity = shiftedIntensity;
                ctx.fillStyle = `rgba(200, 150, 255, ${intensity * 0.9})`;
                ctx.fillRect(detectorX - 6, y, 12, 10);
            }

            ctx.fillStyle = '#88aacc';
            ctx.font = '10px Segoe UI';
            ctx.textAlign = 'center';
            ctx.fillText('Detector', detectorX, centerY + 100);
            ctx.fillText('(interference)', detectorX, centerY + 115);
        }

        function drawZeroFieldRegion() {
            // Indicate B = 0 outside solenoid
            ctx.strokeStyle = 'rgba(100, 255, 100, 0.2)';
            ctx.lineWidth = 1;
            ctx.setLineDash([3, 3]);
            ctx.beginPath();
            ctx.arc(centerX, centerY, solenoidRadius + 10, 0, Math.PI * 2);
            ctx.stroke();
            ctx.setLineDash([]);

            ctx.fillStyle = 'rgba(100, 255, 100, 0.4)';
            ctx.font = '11px Segoe UI';
            ctx.textAlign = 'left';
            ctx.fillText('B = 0 (everywhere outside)', centerX + solenoidRadius + 20, centerY - 50);
        }

        function animate() {
            // Clear
            ctx.fillStyle = '#080510';
            ctx.fillRect(0, 0, width, height);

            // Draw components
            drawVectorPotential();
            drawPaths();
            drawZeroFieldRegion();
            drawSolenoid();
            drawSource();
            drawDetector();

            // Update and draw electrons
            electrons.forEach(e => {
                e.update();
                e.draw(ctx);
            });

            // Launch new electrons periodically
            if (running && time % 150 === 0) {
                electrons.forEach(e => {
                    if (!e.active) e.reset();
                });
            }

            // Title
            ctx.fillStyle = '#9977aa';
            ctx.font = '14px Segoe UI';
            ctx.textAlign = 'center';
            ctx.fillText('Electrons travel through B = 0 region, yet experience phase shift from enclosed flux', width / 2, 25);

            if (running) {
                time++;
            }

            requestAnimationFrame(animate);
        }

        // Handle resize
        window.addEventListener('resize', () => {
            const rect = canvas.getBoundingClientRect();
            canvas.width = rect.width * dpr;
            canvas.height = rect.width * 0.8 * dpr;
            canvas.style.height = rect.width * 0.8 + 'px';
            ctx.scale(dpr, dpr);
        });

        initElectrons();
        updatePhaseDisplay();
        animate();
    </script>
</body>
</html>
