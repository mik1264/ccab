<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simpson's Paradox - When Data Lies</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Georgia', serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            min-height: 100vh;
            color: #e8e8f8;
            line-height: 1.8;
        }

        .back-link {
            position: fixed;
            top: 20px;
            left: 20px;
            padding: 12px 24px;
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            color: #e94560;
            text-decoration: none;
            border-radius: 30px;
            font-size: 14px;
            z-index: 1000;
            transition: all 0.3s;
            border: 1px solid rgba(233,69,96,0.3);
        }

        .back-link:hover {
            background: rgba(233,69,96,0.2);
            transform: translateX(-5px);
        }

        .container {
            max-width: 1100px;
            margin: 0 auto;
            padding: 80px 30px 60px;
        }

        header {
            text-align: center;
            margin-bottom: 50px;
        }

        h1 {
            font-size: 2.8rem;
            font-weight: 400;
            color: #e94560;
            margin-bottom: 20px;
            letter-spacing: 2px;
        }

        .subtitle {
            font-size: 1.4rem;
            color: #a8b2d1;
            font-style: italic;
        }

        .paradox-statement {
            background: linear-gradient(135deg, rgba(233,69,96,0.15) 0%, rgba(255,215,0,0.1) 100%);
            border-left: 4px solid #e94560;
            padding: 30px 40px;
            margin: 40px 0;
            border-radius: 0 20px 20px 0;
            font-size: 1.25rem;
            text-align: center;
        }

        h2 {
            font-size: 1.8rem;
            color: #e94560;
            margin: 50px 0 25px;
            font-weight: 400;
        }

        p {
            margin-bottom: 20px;
            color: #c8d0e8;
        }

        .highlight {
            color: #ffd700;
            font-weight: 600;
        }

        .danger {
            color: #e94560;
            font-weight: 600;
        }

        .simulation-container {
            background: rgba(0,0,0,0.4);
            border-radius: 20px;
            padding: 30px;
            margin: 40px 0;
            border: 1px solid rgba(233,69,96,0.2);
        }

        .sim-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .sim-title {
            font-size: 1.4rem;
            color: #e94560;
        }

        .controls {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 600;
            transition: all 0.3s;
        }

        .btn-primary {
            background: linear-gradient(135deg, #e94560 0%, #d63850 100%);
            color: white;
        }

        .btn-secondary {
            background: rgba(255,255,255,0.1);
            color: #a8b2d1;
            border: 1px solid rgba(255,255,255,0.2);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(233,69,96,0.3);
        }

        .view-toggle {
            display: flex;
            gap: 5px;
            background: rgba(0,0,0,0.3);
            padding: 5px;
            border-radius: 30px;
        }

        .view-btn {
            padding: 8px 18px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 0.85rem;
            font-weight: 600;
            background: transparent;
            color: #8892b0;
            transition: all 0.3s;
        }

        .view-btn.active {
            background: #e94560;
            color: white;
        }

        #chart-container {
            position: relative;
            height: 400px;
            margin-bottom: 20px;
        }

        #canvas {
            width: 100%;
            height: 100%;
            background: #0a1628;
            border-radius: 15px;
        }

        .data-tables {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 25px;
        }

        .data-table {
            background: rgba(255,255,255,0.05);
            border-radius: 12px;
            padding: 20px;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .table-title {
            font-size: 1.1rem;
            color: #ffd700;
            margin-bottom: 15px;
            text-align: center;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            padding: 10px;
            text-align: center;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        th {
            color: #8892b0;
            font-weight: 600;
            font-size: 0.85rem;
        }

        td {
            color: #e0e0e0;
        }

        .rate-cell {
            font-weight: 700;
            font-size: 1.1rem;
        }

        .rate-higher {
            color: #4ecdc4;
        }

        .rate-lower {
            color: #e94560;
        }

        .verdict-box {
            text-align: center;
            padding: 25px;
            border-radius: 15px;
            margin-top: 25px;
            font-size: 1.2rem;
            font-weight: 600;
        }

        .verdict-paradox {
            background: rgba(233,69,96,0.2);
            border: 2px solid #e94560;
            color: #e94560;
        }

        .explanation-box {
            background: rgba(255,215,0,0.1);
            border: 1px solid rgba(255,215,0,0.3);
            border-radius: 15px;
            padding: 25px;
            margin: 30px 0;
        }

        .explanation-box h3 {
            color: #ffd700;
            margin-bottom: 15px;
            font-size: 1.2rem;
        }

        .case-study {
            background: rgba(78,205,196,0.1);
            border: 1px solid rgba(78,205,196,0.3);
            border-radius: 15px;
            padding: 25px;
            margin: 30px 0;
        }

        .case-study h3 {
            color: #4ecdc4;
            margin-bottom: 15px;
        }

        .case-icon {
            font-size: 2rem;
            margin-bottom: 15px;
        }

        .scenario-selector {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
            margin-bottom: 25px;
        }

        .scenario-btn {
            padding: 12px 25px;
            border: 2px solid rgba(233,69,96,0.3);
            background: transparent;
            color: #a8b2d1;
            border-radius: 30px;
            cursor: pointer;
            font-size: 0.95rem;
            transition: all 0.3s;
        }

        .scenario-btn.active {
            background: #e94560;
            border-color: #e94560;
            color: white;
        }

        .scenario-btn:hover:not(.active) {
            border-color: #e94560;
            color: #e94560;
        }

        .warning-box {
            background: rgba(233,69,96,0.15);
            border: 1px solid rgba(233,69,96,0.4);
            border-radius: 15px;
            padding: 25px;
            margin: 30px 0;
        }

        .warning-box h3 {
            color: #e94560;
            margin-bottom: 15px;
        }

        footer {
            text-align: center;
            margin-top: 60px;
            padding-top: 40px;
            border-top: 1px solid rgba(255,255,255,0.1);
            color: #5a6a8a;
        }

        footer a {
            color: #e94560;
            text-decoration: none;
        }

        @media (max-width: 768px) {
            h1 { font-size: 2rem; }
            .scenario-selector { flex-direction: column; align-items: center; }
        }
    </style>
</head>
<body>
    <a href="index.html" class="back-link">‚Üê Back to Gallery</a>

    <div class="container">
        <header>
            <h1>üìä Simpson's Paradox</h1>
            <p class="subtitle">When aggregated data tells the opposite story</p>
        </header>

        <div class="paradox-statement">
            <strong>The Paradox:</strong> A trend that appears in multiple groups of data
            <span class="highlight">reverses or disappears</span> when the groups are combined.
        </div>

        <h2>The Most Dangerous Statistical Illusion</h2>
        <p>
            Imagine a new medical treatment. It works better than the old treatment for mild cases.
            It <em>also</em> works better for severe cases. Surely it must be better overall?
        </p>
        <p>
            <span class="danger">Wrong.</span> Simpson's Paradox shows us that combining data can
            create illusions that lead to catastrophically wrong decisions. This isn't a theoretical
            curiosity‚Äîit has affected real medical treatments, court cases, and policy decisions.
        </p>

        <div class="simulation-container">
            <div class="sim-header">
                <div class="sim-title">üî¨ Interactive Data Explorer</div>
                <div class="view-toggle">
                    <button class="view-btn active" data-view="separated">By Group</button>
                    <button class="view-btn" data-view="combined">Combined</button>
                </div>
            </div>

            <div class="scenario-selector">
                <button class="scenario-btn active" data-scenario="kidney">üè• Kidney Stones</button>
                <button class="scenario-btn" data-scenario="berkeley">üéì UC Berkeley</button>
                <button class="scenario-btn" data-scenario="baseball">‚öæ Baseball Batting</button>
            </div>

            <div id="chart-container">
                <canvas id="canvas"></canvas>
            </div>

            <div class="data-tables" id="data-display"></div>

            <div class="verdict-box verdict-paradox" id="verdict"></div>
        </div>

        <div class="explanation-box">
            <h3>üß† Why Does This Happen?</h3>
            <p>
                Simpson's Paradox occurs because of a <span class="highlight">lurking variable</span>
                that affects both the grouping and the outcome. When we combine groups, we lose
                information about this crucial variable.
            </p>
            <p>
                <strong>In the kidney stone example:</strong> Doctors gave Treatment A to the harder
                cases (large stones) because it was known to be more effective. Treatment B was used
                on easier cases (small stones). When we combine the data, Treatment B looks better
                only because it was used on easier patients!
            </p>
            <p>
                The paradox reveals a fundamental truth: <span class="highlight">correlation does not
                imply causation</span>. Aggregated data can hide or reverse causal relationships.
            </p>
        </div>

        <div class="case-study">
            <div class="case-icon">üè•</div>
            <h3>Case Study: Kidney Stone Treatments (1986)</h3>
            <p>
                A real medical study compared two kidney stone treatments:
            </p>
            <p>
                <strong>Treatment A (Open Surgery):</strong><br>
                ‚Ä¢ Small stones: 93% success (81/87)<br>
                ‚Ä¢ Large stones: 73% success (192/263)<br>
                ‚Ä¢ Overall: 78% success (273/350)
            </p>
            <p>
                <strong>Treatment B (Percutaneous):</strong><br>
                ‚Ä¢ Small stones: 87% success (234/270)<br>
                ‚Ä¢ Large stones: 69% success (55/80)<br>
                ‚Ä¢ Overall: 83% success (289/350)
            </p>
            <p>
                Treatment A is better for <em>both</em> small and large stones, yet Treatment B
                appears better overall! The hidden variable: Treatment A was used on more difficult
                large stone cases.
            </p>
        </div>

        <div class="case-study">
            <div class="case-icon">üéì</div>
            <h3>Case Study: UC Berkeley Admissions (1973)</h3>
            <p>
                Berkeley was sued for sex discrimination when overall data showed:
            </p>
            <p>
                <strong>Admission Rates:</strong><br>
                ‚Ä¢ Men: 44% admitted<br>
                ‚Ä¢ Women: 35% admitted
            </p>
            <p>
                But when researchers examined individual departments, they found women had
                <em>equal or higher</em> admission rates in most departments! The hidden variable:
                women applied to more competitive departments (like English), while men applied to
                less competitive ones (like Engineering).
            </p>
        </div>

        <div class="warning-box">
            <h3>‚ö†Ô∏è Real-World Dangers</h3>
            <p>
                Simpson's Paradox isn't just academic. It has led to:
            </p>
            <p>
                ‚Ä¢ <strong>Wrong medical decisions:</strong> Choosing inferior treatments based on aggregated data<br>
                ‚Ä¢ <strong>Discrimination lawsuits:</strong> Both false accusations and hidden bias<br>
                ‚Ä¢ <strong>Policy failures:</strong> Programs that help subgroups but appear to fail overall<br>
                ‚Ä¢ <strong>Sports analytics errors:</strong> Trading away valuable players based on misleading stats
            </p>
        </div>

        <h2>The Lesson</h2>
        <p>
            Always ask: <span class="highlight">"What subgroups might exist in this data?"</span>
        </p>
        <p>
            When you see aggregate statistics, remember that combining groups can create, hide, or
            reverse trends. The only defense against Simpson's Paradox is to understand the causal
            structure of your data‚Äîand to never mistake correlation for causation.
        </p>

        <footer>
            <p>
                Named after Edward H. Simpson (1951) ¬∑
                <a href="https://en.wikipedia.org/wiki/Simpson's_paradox" target="_blank">Learn more on Wikipedia</a>
            </p>
            <p style="margin-top: 15px; font-size: 0.9rem;">
                Sources:
                <a href="https://towardsdatascience.com/water-cooler-small-talk-simpsons-paradox-caf98151db0e/" target="_blank">Towards Data Science</a> ¬∑
                <a href="http://corysimon.github.io/articles/simpsons-paradox/" target="_blank">Mathemathinking</a>
            </p>
        </footer>
    </div>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');

        // Scenarios data
        const scenarios = {
            kidney: {
                title: "Kidney Stone Treatment Success Rates",
                groupA: { name: "Treatment A", color: "#4ecdc4" },
                groupB: { name: "Treatment B", color: "#e94560" },
                subgroups: [
                    { name: "Small Stones", aSuccess: 93, bSuccess: 87, aTotal: 87, bTotal: 270 },
                    { name: "Large Stones", aSuccess: 73, bSuccess: 69, aTotal: 263, bTotal: 80 }
                ],
                verdict: "Treatment A wins in BOTH subgroups, but Treatment B appears better overall!",
                explanation: "Treatment A was given to harder (large stone) cases more often."
            },
            berkeley: {
                title: "UC Berkeley Graduate Admissions 1973",
                groupA: { name: "Men", color: "#4ecdc4" },
                groupB: { name: "Women", color: "#e94560" },
                subgroups: [
                    { name: "Dept A (Easy)", aSuccess: 62, bSuccess: 82, aTotal: 825, bTotal: 108 },
                    { name: "Dept B (Easy)", aSuccess: 63, bSuccess: 68, aTotal: 560, bTotal: 25 },
                    { name: "Dept E (Hard)", aSuccess: 28, bSuccess: 24, aTotal: 191, bTotal: 393 },
                    { name: "Dept F (Hard)", aSuccess: 6, bSuccess: 7, aTotal: 373, bTotal: 341 }
                ],
                verdict: "Women had EQUAL or HIGHER rates in most departments, but appeared discriminated against overall!",
                explanation: "Women applied more to competitive departments with low acceptance rates."
            },
            baseball: {
                title: "Baseball Batting Averages",
                groupA: { name: "Player A", color: "#4ecdc4" },
                groupB: { name: "Player B", color: "#e94560" },
                subgroups: [
                    { name: "Year 1", aSuccess: 25, bSuccess: 26, aTotal: 100, bTotal: 400 },
                    { name: "Year 2", aSuccess: 33, bSuccess: 31, aTotal: 400, bTotal: 100 }
                ],
                verdict: "Player B has a HIGHER average in BOTH years, but Player A has a higher combined average!",
                explanation: "Player A played more games in the year they hit better."
            }
        };

        let currentScenario = 'kidney';
        let viewMode = 'separated';

        function resize() {
            const container = document.getElementById('chart-container');
            canvas.width = container.clientWidth;
            canvas.height = container.clientHeight;
        }
        resize();
        window.addEventListener('resize', resize);

        function calculateOverall(scenario) {
            const data = scenarios[scenario];
            let aSuccessTotal = 0, aTotalTotal = 0;
            let bSuccessTotal = 0, bTotalTotal = 0;

            data.subgroups.forEach(sg => {
                aSuccessTotal += (sg.aSuccess / 100) * sg.aTotal;
                aTotalTotal += sg.aTotal;
                bSuccessTotal += (sg.bSuccess / 100) * sg.bTotal;
                bTotalTotal += sg.bTotal;
            });

            return {
                aRate: (aSuccessTotal / aTotalTotal * 100).toFixed(1),
                bRate: (bSuccessTotal / bTotalTotal * 100).toFixed(1)
            };
        }

        function draw() {
            ctx.fillStyle = '#0a1628';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            const data = scenarios[currentScenario];
            const overall = calculateOverall(currentScenario);

            const margin = { top: 60, right: 40, bottom: 60, left: 60 };
            const chartWidth = canvas.width - margin.left - margin.right;
            const chartHeight = canvas.height - margin.top - margin.bottom;

            // Title
            ctx.fillStyle = '#e94560';
            ctx.font = 'bold 16px Georgia';
            ctx.textAlign = 'center';
            ctx.fillText(data.title, canvas.width / 2, 30);

            if (viewMode === 'separated') {
                // Draw bar chart for each subgroup
                const numGroups = data.subgroups.length;
                const groupWidth = chartWidth / numGroups;
                const barWidth = groupWidth * 0.35;
                const gap = groupWidth * 0.1;

                data.subgroups.forEach((sg, i) => {
                    const groupX = margin.left + i * groupWidth + groupWidth / 2;

                    // Group label
                    ctx.fillStyle = '#8892b0';
                    ctx.font = '12px Georgia';
                    ctx.textAlign = 'center';
                    ctx.fillText(sg.name, groupX, canvas.height - 20);

                    // Bar A
                    const aHeight = (sg.aSuccess / 100) * chartHeight;
                    const aX = groupX - barWidth - gap/2;
                    ctx.fillStyle = data.groupA.color;
                    ctx.fillRect(aX, margin.top + chartHeight - aHeight, barWidth, aHeight);

                    // Bar A label
                    ctx.fillStyle = '#fff';
                    ctx.font = 'bold 14px Georgia';
                    ctx.fillText(sg.aSuccess + '%', aX + barWidth/2, margin.top + chartHeight - aHeight - 10);

                    // Bar B
                    const bHeight = (sg.bSuccess / 100) * chartHeight;
                    const bX = groupX + gap/2;
                    ctx.fillStyle = data.groupB.color;
                    ctx.fillRect(bX, margin.top + chartHeight - bHeight, barWidth, bHeight);

                    // Bar B label
                    ctx.fillStyle = '#fff';
                    ctx.font = 'bold 14px Georgia';
                    ctx.fillText(sg.bSuccess + '%', bX + barWidth/2, margin.top + chartHeight - bHeight - 10);

                    // Winner indicator
                    if (sg.aSuccess > sg.bSuccess) {
                        ctx.fillStyle = data.groupA.color;
                        ctx.fillText('‚úì', aX + barWidth/2, margin.top + chartHeight - aHeight - 30);
                    } else if (sg.bSuccess > sg.aSuccess) {
                        ctx.fillStyle = data.groupB.color;
                        ctx.fillText('‚úì', bX + barWidth/2, margin.top + chartHeight - bHeight - 30);
                    }
                });

                // Legend
                ctx.fillStyle = data.groupA.color;
                ctx.fillRect(canvas.width - 180, 50, 20, 20);
                ctx.fillStyle = '#fff';
                ctx.font = '13px Georgia';
                ctx.textAlign = 'left';
                ctx.fillText(data.groupA.name, canvas.width - 155, 65);

                ctx.fillStyle = data.groupB.color;
                ctx.fillRect(canvas.width - 180, 80, 20, 20);
                ctx.fillStyle = '#fff';
                ctx.fillText(data.groupB.name, canvas.width - 155, 95);

            } else {
                // Combined view - show overall rates
                const barWidth = 120;
                const centerX = canvas.width / 2;

                // Bar A
                const aHeight = (parseFloat(overall.aRate) / 100) * chartHeight;
                const aX = centerX - barWidth - 40;
                ctx.fillStyle = data.groupA.color;
                ctx.fillRect(aX, margin.top + chartHeight - aHeight, barWidth, aHeight);

                ctx.fillStyle = '#fff';
                ctx.font = 'bold 24px Georgia';
                ctx.textAlign = 'center';
                ctx.fillText(overall.aRate + '%', aX + barWidth/2, margin.top + chartHeight - aHeight - 20);
                ctx.font = '14px Georgia';
                ctx.fillText(data.groupA.name, aX + barWidth/2, canvas.height - 25);

                // Bar B
                const bHeight = (parseFloat(overall.bRate) / 100) * chartHeight;
                const bX = centerX + 40;
                ctx.fillStyle = data.groupB.color;
                ctx.fillRect(bX, margin.top + chartHeight - bHeight, barWidth, bHeight);

                ctx.fillStyle = '#fff';
                ctx.font = 'bold 24px Georgia';
                ctx.fillText(overall.bRate + '%', bX + barWidth/2, margin.top + chartHeight - bHeight - 20);
                ctx.font = '14px Georgia';
                ctx.fillText(data.groupB.name, bX + barWidth/2, canvas.height - 25);

                // Winner
                if (parseFloat(overall.aRate) > parseFloat(overall.bRate)) {
                    ctx.fillStyle = data.groupA.color;
                    ctx.font = 'bold 18px Georgia';
                    ctx.fillText('WINNER', aX + barWidth/2, margin.top + chartHeight - aHeight - 50);
                } else {
                    ctx.fillStyle = data.groupB.color;
                    ctx.font = 'bold 18px Georgia';
                    ctx.fillText('WINNER', bX + barWidth/2, margin.top + chartHeight - bHeight - 50);
                }

                // Paradox notice
                ctx.fillStyle = '#ffd700';
                ctx.font = 'italic 14px Georgia';
                ctx.textAlign = 'center';
                ctx.fillText('(Combined data - the paradox is hidden!)', canvas.width / 2, canvas.height - 5);
            }
        }

        function updateDataDisplay() {
            const data = scenarios[currentScenario];
            const overall = calculateOverall(currentScenario);

            let html = `
                <div class="data-table">
                    <div class="table-title">Subgroup Breakdown</div>
                    <table>
                        <tr>
                            <th>Group</th>
                            <th>${data.groupA.name}</th>
                            <th>${data.groupB.name}</th>
                            <th>Winner</th>
                        </tr>
            `;

            data.subgroups.forEach(sg => {
                const winner = sg.aSuccess > sg.bSuccess ? data.groupA.name :
                              sg.bSuccess > sg.aSuccess ? data.groupB.name : 'Tie';
                const aClass = sg.aSuccess >= sg.bSuccess ? 'rate-higher' : 'rate-lower';
                const bClass = sg.bSuccess >= sg.aSuccess ? 'rate-higher' : 'rate-lower';
                html += `
                    <tr>
                        <td>${sg.name}</td>
                        <td class="rate-cell ${aClass}">${sg.aSuccess}%</td>
                        <td class="rate-cell ${bClass}">${sg.bSuccess}%</td>
                        <td style="color: ${winner === data.groupA.name ? data.groupA.color : data.groupB.color}">${winner}</td>
                    </tr>
                `;
            });

            html += `
                    </table>
                </div>
                <div class="data-table">
                    <div class="table-title">Combined (Overall)</div>
                    <table>
                        <tr>
                            <th></th>
                            <th>${data.groupA.name}</th>
                            <th>${data.groupB.name}</th>
                        </tr>
                        <tr>
                            <td>Overall Rate</td>
                            <td class="rate-cell ${parseFloat(overall.aRate) >= parseFloat(overall.bRate) ? 'rate-higher' : 'rate-lower'}">${overall.aRate}%</td>
                            <td class="rate-cell ${parseFloat(overall.bRate) >= parseFloat(overall.aRate) ? 'rate-higher' : 'rate-lower'}">${overall.bRate}%</td>
                        </tr>
                        <tr>
                            <td colspan="3" style="padding-top: 15px; color: #ffd700;">
                                <strong>Overall Winner:</strong> ${parseFloat(overall.aRate) > parseFloat(overall.bRate) ? data.groupA.name : data.groupB.name}
                            </td>
                        </tr>
                    </table>
                </div>
            `;

            document.getElementById('data-display').innerHTML = html;

            // Update verdict
            document.getElementById('verdict').innerHTML = `
                üö® ${data.verdict}<br>
                <span style="font-size: 0.9rem; font-weight: normal; opacity: 0.8;">
                    Hidden variable: ${data.explanation}
                </span>
            `;
        }

        // View toggle
        document.querySelectorAll('.view-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.view-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                viewMode = this.dataset.view;
                draw();
            });
        });

        // Scenario selector
        document.querySelectorAll('.scenario-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.scenario-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                currentScenario = this.dataset.scenario;
                draw();
                updateDataDisplay();
            });
        });

        // Initial draw
        draw();
        updateDataDisplay();
    </script>
</body>
</html>
