<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Acoustic Levitation - Floating on Sound | Surprising Paradoxes</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Georgia', serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f0f23 100%);
            color: #e8e8ff;
            min-height: 100vh;
            overflow-x: hidden;
        }

        .back-link {
            position: fixed;
            top: 20px;
            left: 20px;
            color: #7c4dff;
            text-decoration: none;
            font-size: 14px;
            z-index: 1000;
            padding: 8px 16px;
            background: rgba(26, 26, 46, 0.9);
            border-radius: 20px;
            border: 1px solid rgba(124, 77, 255, 0.3);
            transition: all 0.3s ease;
        }

        .back-link:hover {
            background: rgba(124, 77, 255, 0.2);
            border-color: #7c4dff;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 80px 20px 40px;
        }

        header {
            text-align: center;
            margin-bottom: 40px;
        }

        h1 {
            font-size: 2.5em;
            background: linear-gradient(135deg, #7c4dff, #b388ff, #ea80fc);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
        }

        .subtitle {
            color: #b388ff;
            font-size: 1.2em;
            font-style: italic;
        }

        .paradox-box {
            background: linear-gradient(135deg, rgba(124, 77, 255, 0.15), rgba(234, 128, 252, 0.1));
            border: 2px solid rgba(124, 77, 255, 0.4);
            border-radius: 15px;
            padding: 25px;
            margin: 30px 0;
            text-align: center;
        }

        .paradox-box h3 {
            color: #ea80fc;
            margin-bottom: 15px;
            font-size: 1.4em;
        }

        .paradox-box p {
            font-size: 1.15em;
            line-height: 1.7;
            color: #e1bee7;
        }

        .simulation-area {
            display: grid;
            grid-template-columns: 1fr 320px;
            gap: 30px;
            margin: 40px 0;
        }

        @media (max-width: 1000px) {
            .simulation-area {
                grid-template-columns: 1fr;
            }
        }

        .canvas-container {
            background: rgba(0, 0, 0, 0.4);
            border-radius: 15px;
            padding: 20px;
            border: 1px solid rgba(124, 77, 255, 0.2);
        }

        canvas {
            display: block;
            width: 100%;
            border-radius: 10px;
            background: #0a0a15;
        }

        .controls {
            background: rgba(26, 26, 46, 0.8);
            border-radius: 15px;
            padding: 25px;
            border: 1px solid rgba(124, 77, 255, 0.2);
        }

        .controls h3 {
            color: #7c4dff;
            margin-bottom: 20px;
            font-size: 1.2em;
            border-bottom: 1px solid rgba(124, 77, 255, 0.3);
            padding-bottom: 10px;
        }

        .control-group {
            margin-bottom: 20px;
        }

        .control-group label {
            display: block;
            color: #b388ff;
            margin-bottom: 8px;
            font-size: 0.95em;
        }

        .control-group input[type="range"] {
            width: 100%;
            height: 8px;
            -webkit-appearance: none;
            background: linear-gradient(90deg, #4a148c, #7b1fa2, #9c27b0);
            border-radius: 4px;
            outline: none;
        }

        .control-group input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 20px;
            height: 20px;
            background: #ea80fc;
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 0 10px rgba(234, 128, 252, 0.5);
        }

        .db-meter {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            padding: 12px;
            margin-top: 10px;
        }

        .db-bar {
            height: 20px;
            background: linear-gradient(90deg, #4caf50, #ffeb3b, #ff9800, #f44336);
            border-radius: 4px;
            position: relative;
        }

        .db-marker {
            position: absolute;
            top: -18px;
            font-size: 0.7em;
            color: #9e9e9e;
        }

        .db-level {
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            position: absolute;
            right: 0;
            top: 0;
            transition: width 0.3s ease;
        }

        .preset-buttons {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }

        .preset-btn {
            padding: 12px 8px;
            font-size: 0.85em;
            border: 1px solid rgba(124, 77, 255, 0.5);
            background: rgba(26, 26, 46, 0.8);
            color: #e8e8ff;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .preset-btn.active {
            background: linear-gradient(135deg, rgba(124, 77, 255, 0.3), rgba(234, 128, 252, 0.2));
            border-color: #ea80fc;
        }

        .preset-btn:hover {
            background: rgba(124, 77, 255, 0.2);
        }

        .stats-panel {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            padding: 15px;
            margin-top: 20px;
        }

        .stat-row {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid rgba(124, 77, 255, 0.1);
            font-size: 0.9em;
        }

        .stat-row:last-child {
            border-bottom: none;
        }

        .stat-label {
            color: #9575cd;
        }

        .stat-value {
            color: #ea80fc;
            font-weight: bold;
        }

        .node-legend {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 15px;
            font-size: 0.85em;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .legend-marker {
            width: 20px;
            height: 4px;
            border-radius: 2px;
        }

        .legend-marker.node {
            background: rgba(100, 255, 218, 0.8);
        }

        .legend-marker.antinode {
            background: rgba(255, 138, 101, 0.8);
        }

        .essay {
            background: rgba(26, 26, 46, 0.6);
            border-radius: 15px;
            padding: 40px;
            margin-top: 40px;
            line-height: 1.9;
        }

        .essay h2 {
            color: #7c4dff;
            margin: 30px 0 20px;
            font-size: 1.5em;
        }

        .essay h2:first-child {
            margin-top: 0;
        }

        .essay p {
            margin-bottom: 20px;
            color: #d1c4e9;
            text-align: justify;
        }

        .essay strong {
            color: #ea80fc;
        }

        .essay em {
            color: #b388ff;
            font-style: italic;
        }

        .highlight-stat {
            display: inline-block;
            background: linear-gradient(135deg, rgba(234, 128, 252, 0.2), rgba(124, 77, 255, 0.2));
            padding: 2px 10px;
            border-radius: 4px;
            color: #ce93d8;
            font-weight: bold;
        }

        .application-cards {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin: 30px 0;
        }

        @media (max-width: 768px) {
            .application-cards {
                grid-template-columns: 1fr;
            }
        }

        .app-card {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            border: 1px solid rgba(124, 77, 255, 0.2);
        }

        .app-card h4 {
            color: #7c4dff;
            margin-bottom: 10px;
        }

        .app-card p {
            font-size: 0.9em;
            color: #78909c;
            margin: 0;
        }

        .app-icon {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        footer {
            text-align: center;
            padding: 40px 20px;
            color: #5e35b1;
            font-size: 0.9em;
        }

        footer a {
            color: #7c4dff;
        }
    </style>
</head>
<body>
    <a href="index.html" class="back-link">‚Üê Back to Paradoxes</a>

    <div class="container">
        <header>
            <h1>üîä Acoustic Levitation</h1>
            <p class="subtitle">Defying Gravity with Invisible Sound Waves</p>
        </header>

        <div class="paradox-box">
            <h3>üéµ The Sound Paradox</h3>
            <p>
                Sound is invisible, intangible, weightless. Yet at <strong>150+ decibels</strong>, ultrasound
                can hold physical objects suspended in mid-air, defying gravity through pure acoustic
                radiation pressure. The particles float at <strong>pressure nodes</strong>‚Äîthe calmest
                points in a storm of invisible vibration. What we can't see or feel becomes strong enough
                to balance the weight of matter itself.
            </p>
        </div>

        <div class="simulation-area">
            <div class="canvas-container">
                <canvas id="levitationCanvas"></canvas>
                <div class="node-legend">
                    <div class="legend-item">
                        <div class="legend-marker node"></div>
                        <span>Pressure Nodes (particles float here)</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-marker antinode"></div>
                        <span>Pressure Antinodes</span>
                    </div>
                </div>
            </div>

            <div class="controls">
                <h3>üéõÔ∏è Ultrasound Transducer</h3>

                <div class="control-group">
                    <label>Sound Intensity: <span id="intensityValue">155</span> dB</label>
                    <input type="range" id="intensitySlider" min="100" max="165" value="155">
                    <div class="db-meter">
                        <div class="db-bar">
                            <span class="db-marker" style="left: 0%">100</span>
                            <span class="db-marker" style="left: 33%">120</span>
                            <span class="db-marker" style="left: 66%">140</span>
                            <span class="db-marker" style="left: 100%">165</span>
                            <div class="db-level" id="dbLevel" style="width: 15%;"></div>
                        </div>
                    </div>
                </div>

                <div class="control-group">
                    <label>Frequency: <span id="freqValue">40</span> kHz</label>
                    <input type="range" id="freqSlider" min="20" max="80" value="40">
                </div>

                <div class="control-group">
                    <label>Particle Type</label>
                    <div class="preset-buttons">
                        <button class="preset-btn active" data-type="styrofoam">üîµ Styrofoam</button>
                        <button class="preset-btn" data-type="water">üíß Water Drop</button>
                        <button class="preset-btn" data-type="insect">üêú Small Insect</button>
                        <button class="preset-btn" data-type="chip">üíæ Microchip</button>
                    </div>
                </div>

                <div class="stats-panel">
                    <div class="stat-row">
                        <span class="stat-label">Levitation Force</span>
                        <span class="stat-value" id="force">0.5 mN</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Wavelength (Œª)</span>
                        <span class="stat-value" id="wavelength">8.5 mm</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Node Spacing</span>
                        <span class="stat-value" id="nodeSpacing">4.25 mm</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Particle Status</span>
                        <span class="stat-value" id="status">Levitating</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="essay">
            <h2>When Sound Becomes a Force</h2>
            <p>
                We think of sound as insubstantial‚Äîvibrations in air that tickle our eardrums but
                couldn't possibly push against anything solid. This intuition is correct at normal
                volumes. But increase the intensity to <span class="highlight-stat">150+ decibels</span>‚Äî
                well beyond the threshold of pain, into territory that would cause instant hearing
                damage‚Äîand sound transforms from a sensation into a <strong>physical force</strong>.
                This acoustic radiation pressure, arising from nonlinear effects in the wave propagation,
                becomes powerful enough to counteract gravity itself.
            </p>

            <h2>The Standing Wave Trap</h2>
            <p>
                Acoustic levitation works by creating a <strong>standing wave</strong> between a
                transducer (sound source) and a reflector. When the emitted wave and its reflection
                interfere, they form a stationary pattern of alternating <em>nodes</em> (minimum
                pressure fluctuation) and <em>antinodes</em> (maximum pressure fluctuation). The
                distance between adjacent nodes is exactly <strong>half the wavelength</strong>.
                For a typical 40 kHz ultrasonic levitator, the wavelength is about 8.5 mm, placing
                nodes approximately 4.25 mm apart.
            </p>

            <h2>Why Particles Float at Nodes</h2>
            <p>
                Here's where the physics becomes counterintuitive. You might expect particles to be
                pushed toward high-pressure regions. Instead, they settle at the <strong>pressure
                nodes</strong>‚Äîthe calm eyes in the acoustic storm. Why? The acoustic radiation
                force doesn't simply push particles toward high pressure. It arises from the
                <em>gradient</em> of the acoustic energy density. At nodes, particles are in a
                stable equilibrium: any displacement is met with a restoring force pushing them
                back. On Earth, gravity shifts this equilibrium slightly <em>below</em> each node,
                where the upward acoustic force exactly balances the downward gravitational pull.
            </p>

            <div class="application-cards">
                <div class="app-card">
                    <div class="app-icon">üíä</div>
                    <h4>Pharmaceutical</h4>
                    <p>Processing drugs without container contamination. Suspending reactive chemicals in pure sound.</p>
                </div>
                <div class="app-card">
                    <div class="app-icon">üõ∞Ô∏è</div>
                    <h4>Microgravity</h4>
                    <p>Containerless processing in space. Growing perfect crystals without container effects.</p>
                </div>
                <div class="app-card">
                    <div class="app-icon">üî¨</div>
                    <h4>Research</h4>
                    <p>Studying liquid drops, chemical reactions, and material properties without surface contact.</p>
                </div>
            </div>

            <h2>The Ultrasonic Regime</h2>
            <p>
                Most acoustic levitators operate in the <strong>ultrasonic</strong> range‚Äîfrequencies
                above 20 kHz, beyond human hearing. This isn't coincidental. Higher frequencies mean
                shorter wavelengths, which mean closer node spacing and the ability to levitate
                smaller objects. A 40 kHz transducer produces nodes about 4 mm apart; an 80 kHz
                device halves this to 2 mm. The inaudibility is a bonus‚Äîat 150 dB, audible sound
                would be not just painful but dangerous. Instead, these powerful ultrasonic fields
                operate in eerie silence.
            </p>

            <h2>What Can Be Levitated?</h2>
            <p>
                Early acoustic levitators could only suspend tiny, light particles‚Äîpolystyrene beads,
                small water droplets. Modern multi-transducer arrays have expanded the possibilities
                dramatically. Researchers have levitated <strong>small insects</strong> (alive and
                unharmed, though probably confused), <strong>water droplets</strong> several millimeters
                across, <strong>pharmaceutical compounds</strong>, and even small <strong>electronic
                components</strong>. The limit is set by the acoustic force competing with gravity:
                too heavy, and no practical sound intensity can lift it.
            </p>

            <h2>From Parlor Trick to Tool</h2>
            <p>
                What began as a laboratory curiosity has become a practical technology. Pharmaceutical
                companies use acoustic levitation to process drugs without container contamination.
                Materials scientists study the properties of liquids suspended in sound‚Äîno walls to
                affect crystallization, surface tension, or chemical reactions. In space, where
                microgravity already provides levitation, acoustic manipulation offers precise control
                over positioning without physical contact. The invisible becomes not just visible in
                its effects, but <em>useful</em>‚Äîa reminder that the insubstantial forces all around
                us can, when properly harnessed, hold matter itself aloft.
            </p>
        </div>

        <footer>
            <p>
                Sources:
                <a href="https://en.wikipedia.org/wiki/Acoustic_levitation">Wikipedia</a> |
                <a href="https://science.howstuffworks.com/acoustic-levitation.htm">HowStuffWorks</a> |
                <a href="https://pubs.aip.org/aapt/ajp/article/89/4/383/1057857/Acoustic-levitation-and-the-acoustic-radiation">American Journal of Physics</a>
            </p>
        </footer>
    </div>

    <script>
        const canvas = document.getElementById('levitationCanvas');
        const ctx = canvas.getContext('2d');
        const dpr = window.devicePixelRatio || 1;

        // Parameters
        let intensity = 155;
        let frequency = 40;
        let particleType = 'styrofoam';
        let time = 0;

        // Particle types
        const particleTypes = {
            styrofoam: { size: 8, density: 0.05, color: '#64b5f6', name: 'Styrofoam Bead' },
            water: { size: 6, density: 1.0, color: '#4fc3f7', name: 'Water Droplet' },
            insect: { size: 10, density: 0.3, color: '#8d6e63', name: 'Small Insect' },
            chip: { size: 7, density: 2.0, color: '#78909c', name: 'Microchip' }
        };

        // Levitated particles
        let particles = [];

        function resizeCanvas() {
            const rect = canvas.parentElement.getBoundingClientRect();
            const size = rect.width - 40;
            canvas.width = size * dpr;
            canvas.height = size * 0.8 * dpr;
            canvas.style.width = size + 'px';
            canvas.style.height = size * 0.8 + 'px';
            ctx.scale(dpr, dpr);
        }

        resizeCanvas();
        window.addEventListener('resize', () => {
            ctx.setTransform(1, 0, 0, 1, 0, 0);
            resizeCanvas();
            initParticles();
        });

        function getWavelength() {
            // Speed of sound in air ‚âà 343 m/s
            const speedOfSound = 343;
            return (speedOfSound / (frequency * 1000)) * 1000; // in mm
        }

        function getNodeSpacing() {
            return getWavelength() / 2;
        }

        function getLevitationForce() {
            // Rough approximation based on intensity
            const baseForce = 0.1;
            const intensityFactor = Math.pow(10, (intensity - 100) / 20);
            return (baseForce * intensityFactor).toFixed(2);
        }

        function canLevitate() {
            const force = parseFloat(getLevitationForce());
            const particle = particleTypes[particleType];
            const weight = particle.density * Math.pow(particle.size / 10, 3);
            return force > weight * 0.5;
        }

        function initParticles() {
            const w = canvas.width / dpr;
            const h = canvas.height / dpr;

            particles = [];
            const nodeSpacing = h / 8; // Visual spacing
            const numNodes = 5;

            // Create particles at node positions
            for (let i = 1; i <= numNodes; i++) {
                const nodeY = (i / (numNodes + 1)) * h * 0.7 + h * 0.15;
                const particleInfo = particleTypes[particleType];

                particles.push({
                    x: w / 2 + (Math.random() - 0.5) * 40,
                    y: nodeY,
                    targetY: nodeY,
                    vx: 0,
                    vy: 0,
                    size: particleInfo.size,
                    phase: Math.random() * Math.PI * 2
                });
            }
        }

        function drawStandingWave(w, h) {
            const wavelengthPx = h / 4;
            const amplitude = 30 * (intensity / 165);

            // Draw wave from both directions
            ctx.lineWidth = 2;

            // Incident wave (from bottom)
            ctx.beginPath();
            ctx.strokeStyle = 'rgba(124, 77, 255, 0.3)';
            for (let y = 0; y < h; y += 2) {
                const phase = (y / wavelengthPx) * Math.PI * 2 - time * 0.1;
                const x = w / 2 + Math.sin(phase) * amplitude;
                if (y === 0) ctx.moveTo(x, y);
                else ctx.lineTo(x, y);
            }
            ctx.stroke();

            // Reflected wave (from top)
            ctx.beginPath();
            ctx.strokeStyle = 'rgba(234, 128, 252, 0.3)';
            for (let y = 0; y < h; y += 2) {
                const phase = (y / wavelengthPx) * Math.PI * 2 + time * 0.1;
                const x = w / 2 + Math.sin(phase) * amplitude;
                if (y === 0) ctx.moveTo(x, y);
                else ctx.lineTo(x, y);
            }
            ctx.stroke();

            // Standing wave (sum)
            ctx.beginPath();
            ctx.strokeStyle = 'rgba(179, 136, 255, 0.6)';
            ctx.lineWidth = 3;
            for (let y = 0; y < h; y += 2) {
                const envelope = Math.sin((y / wavelengthPx) * Math.PI * 2);
                const oscillation = Math.cos(time * 0.1);
                const x = w / 2 + envelope * oscillation * amplitude * 1.5;
                if (y === 0) ctx.moveTo(x, y);
                else ctx.lineTo(x, y);
            }
            ctx.stroke();

            // Mark nodes and antinodes
            const numNodes = 8;
            for (let i = 0; i <= numNodes; i++) {
                const y = (i / numNodes) * h;
                const isNode = i % 2 === 1;

                if (isNode) {
                    // Node - minimum pressure variation
                    ctx.beginPath();
                    ctx.arc(w / 2, y, 4, 0, Math.PI * 2);
                    ctx.fillStyle = 'rgba(100, 255, 218, 0.8)';
                    ctx.fill();

                    // Node line
                    ctx.beginPath();
                    ctx.moveTo(w / 2 - 50, y);
                    ctx.lineTo(w / 2 + 50, y);
                    ctx.strokeStyle = 'rgba(100, 255, 218, 0.3)';
                    ctx.lineWidth = 1;
                    ctx.setLineDash([5, 5]);
                    ctx.stroke();
                    ctx.setLineDash([]);
                } else {
                    // Antinode - maximum pressure variation
                    const oscillation = Math.abs(Math.cos(time * 0.1));
                    ctx.beginPath();
                    ctx.arc(w / 2, y, 3 + oscillation * 3, 0, Math.PI * 2);
                    ctx.fillStyle = 'rgba(255, 138, 101, 0.6)';
                    ctx.fill();
                }
            }
        }

        function drawTransducerAndReflector(w, h) {
            // Bottom transducer
            ctx.fillStyle = '#37474f';
            ctx.fillRect(w / 2 - 60, h - 25, 120, 25);

            // Transducer details
            ctx.fillStyle = '#455a64';
            ctx.fillRect(w / 2 - 50, h - 20, 100, 15);

            // Emission indicator
            const pulseSize = 5 + Math.sin(time * 0.2) * 3;
            ctx.beginPath();
            ctx.arc(w / 2, h - 30, pulseSize, 0, Math.PI * 2);
            ctx.fillStyle = `rgba(234, 128, 252, ${0.5 + Math.sin(time * 0.2) * 0.3})`;
            ctx.fill();

            // Top reflector
            ctx.fillStyle = '#37474f';
            ctx.fillRect(w / 2 - 70, 0, 140, 15);

            ctx.fillStyle = '#78909c';
            ctx.fillRect(w / 2 - 60, 5, 120, 8);

            // Labels
            ctx.fillStyle = 'rgba(255, 255, 255, 0.5)';
            ctx.font = '11px Georgia';
            ctx.textAlign = 'center';
            ctx.fillText('Ultrasonic Transducer', w / 2, h - 5);
            ctx.fillText('Reflector', w / 2, 28);
        }

        function drawParticles(w, h) {
            const particle = particleTypes[particleType];
            const levitating = canLevitate();

            particles.forEach((p, idx) => {
                // Update physics
                if (levitating) {
                    // Stable levitation with small oscillations
                    const wobble = Math.sin(time * 0.05 + p.phase) * 2;
                    const drift = Math.sin(time * 0.02 + idx) * 3;

                    p.x += (w / 2 + drift - p.x) * 0.05;
                    p.y += (p.targetY + wobble - p.y) * 0.1;
                } else {
                    // Fall down
                    p.vy += 0.3;
                    p.y += p.vy;

                    if (p.y > h - 30 - p.size) {
                        p.y = h - 30 - p.size;
                        p.vy *= -0.3;
                    }
                }

                // Draw particle
                const gradient = ctx.createRadialGradient(
                    p.x - p.size * 0.3, p.y - p.size * 0.3, 0,
                    p.x, p.y, p.size
                );

                gradient.addColorStop(0, 'rgba(255, 255, 255, 0.9)');
                gradient.addColorStop(0.5, particle.color);
                gradient.addColorStop(1, particle.color);

                ctx.beginPath();
                ctx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
                ctx.fillStyle = gradient;
                ctx.fill();

                // Glow effect when levitating
                if (levitating) {
                    ctx.beginPath();
                    ctx.arc(p.x, p.y, p.size + 5, 0, Math.PI * 2);
                    const glowIntensity = 0.2 + Math.sin(time * 0.1 + p.phase) * 0.1;
                    ctx.fillStyle = `rgba(234, 128, 252, ${glowIntensity})`;
                    ctx.fill();
                }
            });
        }

        function drawPressureField(w, h) {
            // Draw pressure intensity visualization
            const wavelengthPx = h / 4;
            const oscillation = Math.cos(time * 0.1);

            for (let y = 30; y < h - 30; y += 10) {
                const envelope = Math.abs(Math.sin((y / wavelengthPx) * Math.PI * 2));
                const pressure = envelope * oscillation * (intensity / 165);
                const barWidth = Math.abs(pressure) * 30;

                ctx.fillStyle = pressure > 0 ?
                    `rgba(255, 138, 101, ${Math.abs(pressure) * 0.3})` :
                    `rgba(100, 255, 218, ${Math.abs(pressure) * 0.3})`;

                ctx.fillRect(w / 2 - barWidth, y - 2, barWidth * 2, 4);
            }
        }

        function updateStats() {
            const wavelength = getWavelength();
            const nodeSpacing = getNodeSpacing();
            const force = getLevitationForce();
            const levitating = canLevitate();

            document.getElementById('wavelength').textContent = wavelength.toFixed(1) + ' mm';
            document.getElementById('nodeSpacing').textContent = nodeSpacing.toFixed(2) + ' mm';
            document.getElementById('force').textContent = force + ' mN';
            document.getElementById('status').textContent = levitating ? 'Levitating ‚úì' : 'Fallen ‚úó';
            document.getElementById('status').style.color = levitating ? '#64ffda' : '#ff8a65';

            // Update dB meter
            const dbLevel = ((165 - intensity) / 65) * 100;
            document.getElementById('dbLevel').style.width = dbLevel + '%';
        }

        function draw() {
            const w = canvas.width / dpr;
            const h = canvas.height / dpr;

            // Clear
            ctx.fillStyle = '#0a0a15';
            ctx.fillRect(0, 0, w, h);

            // Draw pressure field (background)
            drawPressureField(w, h);

            // Draw standing wave
            drawStandingWave(w, h);

            // Draw apparatus
            drawTransducerAndReflector(w, h);

            // Draw particles
            drawParticles(w, h);

            // Update stats
            updateStats();

            time++;
            requestAnimationFrame(draw);
        }

        // Event listeners
        document.getElementById('intensitySlider').addEventListener('input', (e) => {
            intensity = parseInt(e.target.value);
            document.getElementById('intensityValue').textContent = intensity;
        });

        document.getElementById('freqSlider').addEventListener('input', (e) => {
            frequency = parseInt(e.target.value);
            document.getElementById('freqValue').textContent = frequency;
        });

        document.querySelectorAll('.preset-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.preset-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                particleType = btn.dataset.type;
                initParticles();
            });
        });

        // Initialize
        initParticles();
        draw();
    </script>
</body>
</html>
