<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Cobra Effect - Surprising Paradoxes</title>
    <link href="https://fonts.googleapis.com/css2?family=Lora:wght@400;500;600;700&family=Nunito:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --sage: #8A9A5B;
            --moss: #606C38;
            --earth: #DDA15E;
            --cream: #FEFAE0;
            --terracotta: #BC6C25;
            --dark-moss: #3d4423;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Nunito', sans-serif;
            background: linear-gradient(135deg, var(--cream) 0%, #F4F1DE 50%, #EDE8D5 100%);
            min-height: 100vh;
            color: var(--dark-moss);
            line-height: 1.7;
        }

        .back-link {
            position: fixed;
            top: 20px;
            left: 20px;
            display: flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
            color: var(--moss);
            font-weight: 600;
            z-index: 100;
            background: rgba(255,255,255,0.8);
            padding: 10px 16px;
            border-radius: 25px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
        }

        .back-link:hover {
            background: var(--moss);
            color: white;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 80px 20px 40px;
        }

        h1 {
            font-family: 'Lora', serif;
            font-size: 2.8rem;
            color: var(--moss);
            text-align: center;
            margin-bottom: 10px;
        }

        .subtitle {
            text-align: center;
            font-size: 1.3rem;
            color: var(--terracotta);
            font-weight: 600;
            margin-bottom: 30px;
        }

        .section {
            background: rgba(255,255,255,0.7);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 25px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
        }

        h2 {
            font-family: 'Lora', serif;
            color: var(--moss);
            font-size: 1.6rem;
            margin-bottom: 15px;
        }

        p {
            margin-bottom: 15px;
        }

        .highlight {
            background: linear-gradient(120deg, rgba(221,161,94,0.3) 0%, rgba(221,161,94,0.3) 100%);
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: 600;
        }

        /* Story Animation */
        .story-container {
            background: linear-gradient(135deg, #2d3a1f, #1a2410);
            border-radius: 20px;
            padding: 30px;
            color: white;
            position: relative;
            overflow: hidden;
        }

        .story-header {
            text-align: center;
            margin-bottom: 20px;
        }

        .story-header h3 {
            font-family: 'Lora', serif;
            color: var(--earth);
        }

        .story-header .location {
            font-size: 0.9rem;
            opacity: 0.7;
        }

        .story-scene {
            position: relative;
            height: 250px;
            background: linear-gradient(180deg, #1a2410 0%, #2d3a1f 100%);
            border-radius: 15px;
            margin-bottom: 20px;
            overflow: hidden;
        }

        .cobra {
            position: absolute;
            font-size: 2rem;
            transition: all 0.5s ease;
            cursor: pointer;
        }

        .cobra:hover {
            transform: scale(1.2);
        }

        .coin-pile {
            position: absolute;
            bottom: 20px;
            right: 30px;
            font-size: 1.5rem;
        }

        .breeding-farm {
            position: absolute;
            bottom: 20px;
            left: 30px;
            background: rgba(139,90,43,0.5);
            padding: 10px 20px;
            border-radius: 10px;
            display: none;
        }

        .breeding-farm.visible {
            display: block;
        }

        .stats-panel {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }

        .stat-box {
            background: rgba(255,255,255,0.1);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }

        .stat-value {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--earth);
        }

        .stat-label {
            font-size: 0.85rem;
            opacity: 0.8;
        }

        .story-controls {
            display: flex;
            gap: 10px;
            justify-content: center;
        }

        .story-btn {
            padding: 12px 25px;
            border: none;
            border-radius: 25px;
            font-family: 'Nunito', sans-serif;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .story-btn.primary {
            background: var(--earth);
            color: white;
        }

        .story-btn.secondary {
            background: rgba(255,255,255,0.2);
            color: white;
        }

        .story-btn:hover {
            transform: scale(1.05);
        }

        .story-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .narrative {
            text-align: center;
            padding: 15px;
            background: rgba(0,0,0,0.3);
            border-radius: 10px;
            margin-bottom: 20px;
            min-height: 60px;
        }

        /* Simulation */
        .sim-container {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
        }

        .sim-controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .sim-btn {
            padding: 10px 20px;
            border: 2px solid var(--sage);
            border-radius: 20px;
            background: white;
            font-family: 'Nunito', sans-serif;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .sim-btn:hover {
            background: rgba(138,154,91,0.1);
        }

        .sim-btn.active {
            background: var(--moss);
            color: white;
            border-color: var(--moss);
        }

        .population-display {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            justify-content: center;
            min-height: 100px;
            padding: 20px;
            background: #f8f8f8;
            border-radius: 10px;
            margin-bottom: 15px;
        }

        .pest-icon {
            font-size: 1.5rem;
            transition: all 0.3s ease;
        }

        .pest-icon.dead {
            opacity: 0.3;
            filter: grayscale(1);
        }

        .pest-icon.bred {
            animation: pop-in 0.3s ease;
        }

        @keyframes pop-in {
            0% { transform: scale(0); }
            70% { transform: scale(1.3); }
            100% { transform: scale(1); }
        }

        /* Case Studies */
        .case-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .case-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .case-card:hover {
            border-color: var(--sage);
            transform: translateY(-3px);
        }

        .case-card.active {
            border-color: var(--moss);
            box-shadow: 0 4px 15px rgba(96,108,56,0.2);
        }

        .case-icon {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .case-title {
            font-weight: 700;
            color: var(--moss);
            margin-bottom: 5px;
        }

        .case-year {
            font-size: 0.85rem;
            color: #888;
        }

        .case-detail {
            display: none;
            background: linear-gradient(135deg, rgba(138,154,91,0.1), rgba(96,108,56,0.1));
            border-radius: 15px;
            padding: 25px;
            margin-top: 20px;
        }

        .case-detail.visible {
            display: block;
        }

        /* Goodhart's Law */
        .law-box {
            background: linear-gradient(135deg, var(--dark-moss), #2a3318);
            color: white;
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            margin: 20px 0;
        }

        .law-text {
            font-family: 'Lora', serif;
            font-size: 1.4rem;
            font-style: italic;
            margin-bottom: 15px;
        }

        .law-author {
            color: var(--earth);
            font-weight: 600;
        }

        /* Diagram */
        .flow-diagram {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
            padding: 20px;
            background: white;
            border-radius: 15px;
            margin: 20px 0;
        }

        .flow-step {
            background: var(--sage);
            color: white;
            padding: 15px 20px;
            border-radius: 10px;
            text-align: center;
            max-width: 150px;
        }

        .flow-step.bad {
            background: #ef4444;
        }

        .flow-arrow {
            font-size: 1.5rem;
            color: #888;
        }

        /* Examples Grid */
        .examples-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .example-card {
            background: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .example-icon {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .example-title {
            font-weight: 700;
            color: var(--moss);
            margin-bottom: 8px;
        }

        .example-text {
            font-size: 0.9rem;
            color: #666;
        }

        .citation {
            font-size: 0.85rem;
            color: #888;
            font-style: italic;
            margin-top: 15px;
        }

        .research-stat {
            display: inline-block;
            background: rgba(138,154,91,0.2);
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: 600;
            color: var(--moss);
            margin: 5px;
        }

        .warning-box {
            background: linear-gradient(135deg, rgba(239,68,68,0.1), rgba(239,68,68,0.2));
            border-left: 4px solid #ef4444;
            padding: 20px;
            border-radius: 0 15px 15px 0;
            margin: 20px 0;
        }

        .warning-box h3 {
            color: #dc2626;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <a href="index.html" class="back-link">
        <span>‚Üê</span>
        <span>Back to Gallery</span>
    </a>

    <div class="container">
        <h1>The Cobra Effect</h1>
        <p class="subtitle">When Solutions Make Problems Worse</p>

        <div class="section">
            <h2>The Paradox</h2>
            <p>
                In colonial India, the British government wanted to reduce the cobra population in Delhi.
                Their solution? Offer a <span class="highlight">bounty for every dead cobra</span>.
                At first, it worked brilliantly. Then something unexpected happened...
            </p>
            <p>
                <strong>People started breeding cobras for the income.</strong> When the government
                discovered this and cancelled the program, the breeders released their now-worthless
                snakes. The cobra population <em>increased</em> beyond the original level.
            </p>
        </div>

        <div class="section">
            <h2>Watch the Story Unfold</h2>
            <div class="story-container">
                <div class="story-header">
                    <span class="location">Delhi, British India, 1890s</span>
                    <h3>The Cobra Bounty Program</h3>
                </div>

                <div class="stats-panel">
                    <div class="stat-box">
                        <div class="stat-value" id="cobraCount">12</div>
                        <div class="stat-label">Wild Cobras</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-value" id="bountyPaid">0</div>
                        <div class="stat-label">Bounties Paid</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-value" id="farmCobras">0</div>
                        <div class="stat-label">Farmed Cobras</div>
                    </div>
                </div>

                <div class="story-scene" id="storyScene">
                    <!-- Cobras will be spawned here -->
                </div>

                <div class="narrative" id="narrative">
                    The British government is concerned about cobras in Delhi...
                </div>

                <div class="story-controls">
                    <button class="story-btn primary" id="nextBtn" onclick="nextPhase()">Start Bounty Program</button>
                    <button class="story-btn secondary" onclick="resetStory()">Reset</button>
                </div>
            </div>
        </div>

        <div class="section">
            <h2>The Pattern</h2>
            <div class="flow-diagram">
                <div class="flow-step">Problem: Too many pests</div>
                <span class="flow-arrow">‚Üí</span>
                <div class="flow-step">Solution: Pay bounty per pest</div>
                <span class="flow-arrow">‚Üí</span>
                <div class="flow-step">People kill pests for $</div>
                <span class="flow-arrow">‚Üí</span>
                <div class="flow-step bad">People BREED pests for $</div>
                <span class="flow-arrow">‚Üí</span>
                <div class="flow-step bad">Program cancelled, pests released</div>
            </div>
        </div>

        <div class="section">
            <div class="law-box">
                <p class="law-text">
                    "When a measure becomes a target, it ceases to be a good measure."
                </p>
                <p class="law-author">‚Äî Goodhart's Law (Charles Goodhart, 1975)</p>
            </div>
            <p>
                The Cobra Effect is a dramatic example of <strong>perverse incentives</strong>‚Äîwhen
                reward structures produce the opposite of intended results. The measure (dead cobras)
                became the target, so people optimized for it in unexpected ways.
            </p>
        </div>

        <div class="section">
            <h2>More Examples</h2>
            <div class="case-grid">
                <div class="case-card" onclick="showCase('hanoi')">
                    <div class="case-icon">üêÄ</div>
                    <div class="case-title">Hanoi Rat Tails</div>
                    <div class="case-year">1902, French Vietnam</div>
                </div>
                <div class="case-card" onclick="showCase('pigs')">
                    <div class="case-icon">üêó</div>
                    <div class="case-title">Fort Benning Pigs</div>
                    <div class="case-year">2007, Georgia USA</div>
                </div>
                <div class="case-card" onclick="showCase('wells')">
                    <div class="case-icon">üè¶</div>
                    <div class="case-title">Wells Fargo Accounts</div>
                    <div class="case-year">2016, USA</div>
                </div>
                <div class="case-card" onclick="showCase('endangered')">
                    <div class="case-icon">ü¶Ö</div>
                    <div class="case-title">Endangered Species Act</div>
                    <div class="case-year">1973-present, USA</div>
                </div>
            </div>

            <div class="case-detail" id="caseDetail">
                <div id="caseContent"></div>
            </div>
        </div>

        <div class="section">
            <h2>Run Your Own Bounty Program</h2>
            <div class="sim-container">
                <p style="text-align: center; margin-bottom: 15px;">
                    You're a colonial administrator. Click to run each month of your bounty program:
                </p>

                <div class="sim-controls">
                    <button class="sim-btn" onclick="simMonth('honest')">Honest Hunters Month</button>
                    <button class="sim-btn" onclick="simMonth('gaming')">Gaming Begins...</button>
                    <button class="sim-btn" onclick="simMonth('cancel')">Cancel Program!</button>
                    <button class="sim-btn" onclick="resetSim()">Reset</button>
                </div>

                <div class="population-display" id="pestPopulation">
                    <!-- Pests rendered here -->
                </div>

                <div style="text-align: center;">
                    <span class="research-stat">Wild: <span id="simWild">15</span></span>
                    <span class="research-stat">Farmed: <span id="simFarmed">0</span></span>
                    <span class="research-stat">Bounties: $<span id="simBounty">0</span></span>
                </div>
            </div>
        </div>

        <div class="section">
            <div class="warning-box">
                <h3>Modern Cobra Effects</h3>
                <p>
                    <strong>Healthcare:</strong> Paying for treatments (not prevention) incentivizes
                    ignoring conditions until they require expensive intervention.
                </p>
                <p>
                    <strong>Education:</strong> Teaching to standardized tests produces students who
                    ace tests but lack deeper understanding.
                </p>
                <p>
                    <strong>Software:</strong> Rewarding lines of code written incentivizes verbose,
                    inefficient code over elegant solutions.
                </p>
            </div>
        </div>

        <div class="section">
            <h2>How to Avoid It</h2>
            <div class="examples-grid">
                <div class="example-card">
                    <div class="example-icon">üéØ</div>
                    <div class="example-title">Keep It Simple</div>
                    <div class="example-text">Complex incentives create more loopholes to exploit</div>
                </div>
                <div class="example-card">
                    <div class="example-icon">ü§î</div>
                    <div class="example-title">Outsmart Yourself</div>
                    <div class="example-text">Before implementing, try to game your own system</div>
                </div>
                <div class="example-card">
                    <div class="example-icon">üìä</div>
                    <div class="example-title">Multiple Metrics</div>
                    <div class="example-text">Single measures are easy to game; use several</div>
                </div>
                <div class="example-card">
                    <div class="example-icon">üëÅÔ∏è</div>
                    <div class="example-title">Monitor Behavior</div>
                    <div class="example-text">Watch for unexpected adaptations and adjust</div>
                </div>
            </div>
            <p class="citation">
                Term coined by economist Horst Siebert (2001). Historical accuracy of the cobra
                story is disputed‚Äîbut the pattern is well-documented in many verified cases.
            </p>
        </div>
    </div>

    <script>
        // Story Animation
        let phase = 0;
        let cobras = [];
        let wildCount = 12;
        let farmCount = 0;
        let bountyCount = 0;

        function initStory() {
            const scene = document.getElementById('storyScene');
            scene.innerHTML = '';
            cobras = [];

            for (let i = 0; i < 12; i++) {
                createCobra(scene, true);
            }
        }

        function createCobra(scene, isWild) {
            const cobra = document.createElement('span');
            cobra.className = 'cobra';
            cobra.textContent = 'üêç';
            cobra.style.left = Math.random() * 80 + 5 + '%';
            cobra.style.top = Math.random() * 70 + 10 + '%';
            cobra.dataset.wild = isWild;
            scene.appendChild(cobra);
            cobras.push(cobra);
            return cobra;
        }

        function nextPhase() {
            phase++;
            const btn = document.getElementById('nextBtn');
            const narrative = document.getElementById('narrative');
            const scene = document.getElementById('storyScene');

            switch(phase) {
                case 1:
                    narrative.innerHTML = '<strong>Phase 1:</strong> Bounty announced! Citizens start hunting cobras for reward money...';
                    btn.textContent = 'Continue (Hunting)';
                    // Remove some cobras
                    for (let i = 0; i < 5; i++) {
                        if (cobras.length > 0) {
                            const c = cobras.pop();
                            c.style.opacity = '0';
                            setTimeout(() => c.remove(), 500);
                            wildCount--;
                            bountyCount++;
                        }
                    }
                    updateStats();
                    break;

                case 2:
                    narrative.innerHTML = '<strong>Phase 2:</strong> More cobras killed. The program seems to be working!';
                    btn.textContent = 'Continue (Success?)';
                    for (let i = 0; i < 4; i++) {
                        if (cobras.length > 0) {
                            const c = cobras.pop();
                            c.style.opacity = '0';
                            setTimeout(() => c.remove(), 500);
                            wildCount--;
                            bountyCount++;
                        }
                    }
                    updateStats();
                    break;

                case 3:
                    narrative.innerHTML = '<strong>Phase 3:</strong> Entrepreneurs realize... why hunt when you can BREED? Cobra farms appear!';
                    btn.textContent = 'Continue (Uh oh...)';
                    // Add farm
                    const farm = document.createElement('div');
                    farm.className = 'breeding-farm visible';
                    farm.innerHTML = 'üè† Cobra Farm<br>üêçüêçüêçüêçüêç';
                    scene.appendChild(farm);
                    farmCount = 20;
                    bountyCount += 15;
                    updateStats();
                    break;

                case 4:
                    narrative.innerHTML = '<strong>Phase 4:</strong> Government discovers the fraud! Program cancelled immediately.';
                    btn.textContent = 'Continue (Aftermath)';
                    const farms = scene.querySelectorAll('.breeding-farm');
                    farms.forEach(f => f.innerHTML = 'üè† <s>Cobra Farm</s><br>CLOSED');
                    updateStats();
                    break;

                case 5:
                    narrative.innerHTML = '<strong>Phase 5:</strong> Worthless farm cobras released into the wild. Population EXPLODES!';
                    btn.textContent = 'See Final Result';
                    // Release all farm cobras
                    for (let i = 0; i < 20; i++) {
                        setTimeout(() => {
                            createCobra(scene, true);
                            wildCount++;
                            updateStats();
                        }, i * 100);
                    }
                    farmCount = 0;
                    break;

                case 6:
                    narrative.innerHTML = `<strong>RESULT:</strong> Started with 12 cobras. Ended with ${wildCount} cobras.
                        Paid ${bountyCount} bounties. The solution made the problem WORSE!`;
                    btn.textContent = 'Restart';
                    btn.onclick = resetStory;
                    break;
            }
        }

        function updateStats() {
            document.getElementById('cobraCount').textContent = wildCount;
            document.getElementById('bountyPaid').textContent = bountyCount;
            document.getElementById('farmCobras').textContent = farmCount;
        }

        function resetStory() {
            phase = 0;
            wildCount = 12;
            farmCount = 0;
            bountyCount = 0;
            updateStats();
            document.getElementById('narrative').textContent = 'The British government is concerned about cobras in Delhi...';
            document.getElementById('nextBtn').textContent = 'Start Bounty Program';
            document.getElementById('nextBtn').onclick = nextPhase;
            initStory();
        }

        // Case Studies
        const caseData = {
            hanoi: {
                title: 'üêÄ The Hanoi Rat Massacre',
                content: `
                    <p><strong>1902, French Colonial Hanoi:</strong> To combat rat infestations in the
                    new sewer system, the French offered a bounty for each rat tail delivered.</p>
                    <p>Soon, officials noticed rats running around the city... <em>without tails</em>.
                    Citizens were catching rats, cutting off their tails for the bounty, then
                    <strong>releasing them to breed more rats</strong>.</p>
                    <p>Even worse, rat farms were discovered in the countryside, breeding rats
                    specifically for tail harvesting.</p>
                    <p><span class="research-stat">Result: Rat population increased</span></p>
                `
            },
            pigs: {
                title: 'üêó Fort Benning Feral Pigs',
                content: `
                    <p><strong>2007-2008, Georgia USA:</strong> The U.S. Army offered hunters $40 per
                    pig tail to reduce the feral pig population at Fort Benning.</p>
                    <p>A study found the pig population actually <strong>INCREASED</strong> during the program:</p>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li>Hunters used feed bait, improving pig nutrition</li>
                        <li>Better-fed pigs had higher fertility and survival rates</li>
                        <li>Hunters targeted "trophy" males, leaving females to breed</li>
                    </ul>
                    <p><span class="research-stat">Documented case with academic study</span></p>
                `
            },
            wells: {
                title: 'üè¶ Wells Fargo Account Scandal',
                content: `
                    <p><strong>2016:</strong> Wells Fargo incentivized employees to open new accounts
                    for existing customers. The rewards were extremely lucrative.</p>
                    <p>The result? Employees opened <strong>3.5 million fake accounts</strong> without
                    customer authorization. They moved money between accounts, signed up customers for
                    services they didn't want, and created fake email addresses.</p>
                    <p>The "customer satisfaction" metric became the target‚Äîso employees gamed it
                    by creating customers who didn't exist.</p>
                    <p><span class="research-stat">$185M in fines, massive reputation damage</span></p>
                `
            },
            endangered: {
                title: 'ü¶Ö Shoot, Shovel, and Shut Up',
                content: `
                    <p><strong>1973-present:</strong> The U.S. Endangered Species Act restricts
                    development on land where endangered species are found.</p>
                    <p>The perverse incentive: If you find an endangered species on your property,
                    you LOSE development rights. So landowners...</p>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li>Preemptively destroy potential habitat</li>
                        <li>Quietly eliminate endangered animals they find</li>
                        <li>"Shoot, shovel, and shut up" became an informal strategy</li>
                    </ul>
                    <p>The law designed to protect species created incentives to destroy them.</p>
                `
            }
        };

        function showCase(caseId) {
            const cards = document.querySelectorAll('.case-card');
            cards.forEach(card => card.classList.remove('active'));
            event.currentTarget.classList.add('active');

            const detail = document.getElementById('caseDetail');
            const content = document.getElementById('caseContent');

            content.innerHTML = `<h3 style="color: var(--moss); margin-bottom: 15px;">${caseData[caseId].title}</h3>
                                 ${caseData[caseId].content}`;
            detail.classList.add('visible');
        }

        // Simulation
        let simWild = 15;
        let simFarmed = 0;
        let simBounty = 0;

        function renderPests() {
            const container = document.getElementById('pestPopulation');
            container.innerHTML = '';

            for (let i = 0; i < simWild; i++) {
                const pest = document.createElement('span');
                pest.className = 'pest-icon';
                pest.textContent = 'üêç';
                container.appendChild(pest);
            }

            for (let i = 0; i < simFarmed; i++) {
                const pest = document.createElement('span');
                pest.className = 'pest-icon';
                pest.textContent = 'üêç';
                pest.style.filter = 'hue-rotate(90deg)';
                pest.title = 'Farmed cobra';
                container.appendChild(pest);
            }

            document.getElementById('simWild').textContent = simWild;
            document.getElementById('simFarmed').textContent = simFarmed;
            document.getElementById('simBounty').textContent = simBounty;
        }

        function simMonth(type) {
            switch(type) {
                case 'honest':
                    // Honest hunting reduces wild population
                    const killed = Math.min(simWild, Math.floor(Math.random() * 4) + 2);
                    simWild -= killed;
                    simBounty += killed * 10;
                    break;

                case 'gaming':
                    // Gaming: kill some wild, but also breed more
                    const hunted = Math.min(simWild, Math.floor(Math.random() * 2) + 1);
                    simWild -= hunted;
                    simFarmed += Math.floor(Math.random() * 5) + 3;
                    simBounty += (hunted + simFarmed) * 10;
                    break;

                case 'cancel':
                    // Cancel: release all farmed into wild
                    simWild += simFarmed;
                    simFarmed = 0;
                    break;
            }

            renderPests();
        }

        function resetSim() {
            simWild = 15;
            simFarmed = 0;
            simBounty = 0;
            renderPests();
        }

        // Initialize
        initStory();
        renderPests();
    </script>
</body>
</html>
