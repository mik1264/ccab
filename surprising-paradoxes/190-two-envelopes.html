<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Two Envelopes Paradox - Surprising Paradoxes - CCAB</title>
    <link href="https://fonts.googleapis.com/css2?family=Lora:wght@400;500;600;700&family=Nunito:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --sage: #8A9A5B;
            --moss: #606C38;
            --earth: #DDA15E;
            --cream: #FEFAE0;
            --terracotta: #BC6C25;
            --dark-moss: #3d4423;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Nunito', sans-serif;
            background: linear-gradient(135deg, #FEFAE0 0%, #F4F1DE 50%, #EDE8D5 100%);
            min-height: 100vh;
            color: var(--dark-moss);
            line-height: 1.7;
        }
        .organic-shape {
            position: fixed;
            border-radius: 60% 40% 50% 50% / 50% 60% 40% 50%;
            opacity: 0.12;
            z-index: 0;
            animation: morph 30s ease-in-out infinite;
        }
        .shape-1 {
            width: 600px;
            height: 600px;
            background: linear-gradient(135deg, var(--sage), var(--moss));
            top: -200px;
            right: -150px;
        }
        .shape-2 {
            width: 500px;
            height: 500px;
            background: linear-gradient(135deg, var(--earth), var(--terracotta));
            bottom: -150px;
            left: -150px;
            animation-delay: -15s;
        }
        @keyframes morph {
            0%, 100% { border-radius: 60% 40% 50% 50% / 50% 60% 40% 50%; }
            25% { border-radius: 50% 60% 40% 50% / 40% 50% 60% 50%; }
            50% { border-radius: 40% 50% 60% 50% / 50% 40% 50% 60%; }
            75% { border-radius: 50% 40% 50% 60% / 60% 50% 40% 50%; }
        }
        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 40px 20px 80px;
            position: relative;
            z-index: 1;
        }
        .back-link {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            color: var(--moss);
            text-decoration: none;
            font-weight: 500;
            margin-bottom: 30px;
            padding: 10px 20px;
            background: rgba(255,255,255,0.6);
            backdrop-filter: blur(10px);
            border-radius: 30px;
            transition: all 0.3s ease;
        }
        .back-link:hover {
            background: rgba(255,255,255,0.9);
            transform: translateX(-5px);
        }
        h1 {
            font-family: 'Lora', serif;
            font-size: 2.8rem;
            font-weight: 600;
            color: var(--moss);
            margin-bottom: 20px;
            line-height: 1.2;
        }
        .subtitle {
            font-size: 1.3rem;
            color: var(--terracotta);
            margin-bottom: 40px;
            font-weight: 500;
        }
        .badge {
            display: inline-block;
            background: linear-gradient(135deg, #ffd700, #ffb700);
            color: #1a1a2e;
            padding: 6px 16px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 25px;
        }
        .card {
            background: rgba(255,255,255,0.7);
            backdrop-filter: blur(15px);
            border-radius: 24px;
            padding: 35px;
            margin-bottom: 35px;
            border: 1px solid rgba(138,154,91,0.2);
            box-shadow: 0 10px 40px rgba(0,0,0,0.08);
        }
        .card h2 {
            font-family: 'Lora', serif;
            font-size: 1.6rem;
            color: var(--moss);
            margin-bottom: 20px;
        }
        .card p {
            color: #555;
            margin-bottom: 18px;
        }
        .highlight {
            background: linear-gradient(120deg, rgba(221,161,94,0.2) 0%, rgba(221,161,94,0.1) 100%);
            padding: 3px 8px;
            border-radius: 4px;
            font-weight: 600;
            color: var(--terracotta);
        }

        /* Game Container */
        .game-container {
            background: linear-gradient(180deg, #2c3e50 0%, #1a252f 100%);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 35px;
            box-shadow: 0 15px 50px rgba(0,0,0,0.2);
        }
        .game-title {
            color: #fff;
            font-family: 'Lora', serif;
            font-size: 1.3rem;
            text-align: center;
            margin-bottom: 25px;
        }
        .envelopes {
            display: flex;
            justify-content: center;
            gap: 60px;
            margin-bottom: 30px;
        }
        .envelope {
            width: 150px;
            height: 100px;
            background: linear-gradient(135deg, #f4d03f, #e6b800);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            position: relative;
        }
        .envelope:hover {
            transform: translateY(-10px) scale(1.05);
            box-shadow: 0 20px 40px rgba(0,0,0,0.4);
        }
        .envelope.selected {
            border: 4px solid #4ecdc4;
            transform: scale(1.1);
        }
        .envelope.revealed {
            background: linear-gradient(135deg, #ffffff, #e0e0e0);
        }
        .envelope .amount {
            font-family: 'Courier New', monospace;
            font-weight: bold;
            font-size: 1.5rem;
            color: #2c3e50;
            display: none;
        }
        .envelope.revealed .amount {
            display: block;
        }
        .envelope.revealed::before {
            display: none;
        }
        .envelope::before {
            content: '?';
            font-family: 'Lora', serif;
            font-weight: bold;
            color: #8b6914;
        }
        .envelope-label {
            text-align: center;
            color: #aaa;
            margin-top: 10px;
            font-size: 0.9rem;
        }
        .game-message {
            text-align: center;
            color: #fff;
            font-size: 1.1rem;
            margin-bottom: 20px;
            min-height: 50px;
        }
        .game-message .highlight {
            color: #4ecdc4;
            font-weight: 700;
        }
        .controls {
            display: flex;
            gap: 12px;
            justify-content: center;
            flex-wrap: wrap;
        }
        .btn {
            background: linear-gradient(135deg, var(--earth) 0%, var(--terracotta) 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            font-family: 'Nunito', sans-serif;
            font-size: 0.95rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(188,108,37,0.4);
        }
        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }
        .btn-secondary {
            background: rgba(255,255,255,0.15);
        }
        .btn-secondary:hover {
            background: rgba(255,255,255,0.25);
        }
        .stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-top: 25px;
        }
        .stat-box {
            background: rgba(0,0,0,0.2);
            border-radius: 12px;
            padding: 15px;
            text-align: center;
        }
        .stat-value {
            font-size: 1.8rem;
            font-weight: 700;
            font-family: 'Courier New', monospace;
            color: #4ecdc4;
        }
        .stat-label {
            font-size: 0.8rem;
            color: rgba(255,255,255,0.6);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-top: 5px;
        }

        /* Formula box */
        .formula-box {
            background: rgba(0,0,0,0.03);
            border-radius: 12px;
            padding: 25px;
            margin: 20px 0;
            font-family: 'Courier New', monospace;
            overflow-x: auto;
        }
        .formula-line {
            margin-bottom: 10px;
            color: var(--dark-moss);
        }
        .formula-result {
            color: var(--terracotta);
            font-weight: 700;
        }

        /* Insight box */
        .insight-box {
            background: linear-gradient(135deg, rgba(138,154,91,0.15) 0%, rgba(96,108,56,0.1) 100%);
            border: 2px solid var(--sage);
            border-radius: 16px;
            padding: 25px;
            margin: 25px 0;
        }
        .insight-box h3 {
            color: var(--moss);
            font-family: 'Lora', serif;
            margin-bottom: 12px;
        }

        /* Error box */
        .error-box {
            background: linear-gradient(135deg, rgba(255,107,107,0.1) 0%, rgba(255,150,150,0.05) 100%);
            border: 2px solid #ff6b6b;
            border-radius: 16px;
            padding: 25px;
            margin: 25px 0;
        }
        .error-box h3 {
            color: #cc5555;
            font-family: 'Lora', serif;
            margin-bottom: 12px;
        }

        /* Quote */
        .quote {
            border-left: 4px solid var(--earth);
            padding-left: 25px;
            margin: 25px 0;
            font-style: italic;
            color: #666;
        }
        .quote-author {
            font-style: normal;
            font-weight: 600;
            color: var(--moss);
            margin-top: 10px;
        }

        /* Solutions grid */
        .solutions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 25px;
        }
        .solution-card {
            background: rgba(255,255,255,0.5);
            border-radius: 16px;
            padding: 25px;
        }
        .solution-card h4 {
            color: var(--moss);
            margin-bottom: 12px;
            font-family: 'Lora', serif;
        }
        .solution-card p {
            color: #555;
            font-size: 0.95rem;
        }

        .footer {
            text-align: center;
            padding-top: 30px;
            color: #888;
            font-size: 0.85rem;
        }
        .footer a { color: var(--moss); }

        @media (max-width: 600px) {
            h1 { font-size: 2rem; }
            .card { padding: 25px; }
            .envelopes { gap: 30px; }
            .envelope { width: 120px; height: 80px; }
            .stats { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div class="organic-shape shape-1"></div>
    <div class="organic-shape shape-2"></div>

    <main class="container">
        <a href="index.html" class="back-link">&#8592; Back to Paradoxes</a>

        <span class="badge">Probability Theory</span>
        <h1>The Two Envelopes Paradox</h1>
        <p class="subtitle">You're offered two envelopes. One contains twice as much as the other. Should you always switch? The math says yes... but that can't be right.</p>

        <!-- Interactive Game -->
        <div class="game-container">
            <h2 class="game-title">Play the Envelope Game</h2>

            <div class="envelopes">
                <div>
                    <div class="envelope" id="envelopeA" data-envelope="A">
                        <span class="amount" id="amountA"></span>
                    </div>
                    <div class="envelope-label">Envelope A</div>
                </div>
                <div>
                    <div class="envelope" id="envelopeB" data-envelope="B">
                        <span class="amount" id="amountB"></span>
                    </div>
                    <div class="envelope-label">Envelope B</div>
                </div>
            </div>

            <div class="game-message" id="gameMessage">
                Choose an envelope to see what's inside.
            </div>

            <div class="controls">
                <button class="btn" id="switchBtn" disabled>Switch Envelopes</button>
                <button class="btn" id="keepBtn" disabled>Keep Current</button>
                <button class="btn btn-secondary" id="newGameBtn">New Game</button>
            </div>

            <div class="stats">
                <div class="stat-box">
                    <div class="stat-value" id="gamesPlayed">0</div>
                    <div class="stat-label">Games Played</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" id="switchWins">0</div>
                    <div class="stat-label">Switch Wins</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" id="keepWins">0</div>
                    <div class="stat-label">Keep Wins</div>
                </div>
            </div>
        </div>

        <!-- The Paradox -->
        <div class="card">
            <h2>The Setup</h2>
            <p>You're presented with two identical envelopes. You're told:</p>
            <ul style="margin-left: 25px; color: #555; margin-bottom: 18px;">
                <li>One envelope contains some amount of money, call it <strong>X</strong></li>
                <li>The other envelope contains exactly <strong>2X</strong></li>
                <li>You don't know which is which</li>
            </ul>
            <p>You pick one envelope and find it contains $100. Should you switch?</p>

            <div class="insight-box">
                <h3>&#128161; The Tempting Argument</h3>
                <p>"If I have $100, the other envelope has either $50 (half) or $200 (double). There's a 50% chance of each. So the expected value of switching is:"</p>
                <div class="formula-box">
                    <div class="formula-line">E[switch] = 0.5 &#215; $50 + 0.5 &#215; $200</div>
                    <div class="formula-line">E[switch] = $25 + $100</div>
                    <div class="formula-line formula-result">E[switch] = $125</div>
                </div>
                <p>"Switching gives expected value $125 versus keeping $100. <span class="highlight">I should switch!</span>"</p>
            </div>
        </div>

        <!-- The Problem -->
        <div class="card">
            <h2>The Problem</h2>
            <p>The argument above seems to prove you should <em>always</em> switch. But consider:</p>

            <div class="error-box">
                <h3>&#9888; The Infinite Loop</h3>
                <p>If switching is always better, then after switching you should... switch again? And again? Forever?</p>
                <p>Before even opening your envelope, the argument says switching is better. But both envelopes are symmetric! How can A be better than B, when you could just as easily have picked B first?</p>
            </div>

            <p>Something is deeply wrong with the expected value calculation. But what?</p>
        </div>

        <!-- Analysis -->
        <div class="card">
            <h2>Finding the Flaw</h2>
            <p>The fallacious argument makes a subtle probability error. Let's denote:</p>
            <ul style="margin-left: 25px; color: #555; margin-bottom: 18px;">
                <li><strong>S</strong> = the smaller amount (unknown)</li>
                <li><strong>2S</strong> = the larger amount</li>
                <li><strong>Y</strong> = what you see in your envelope</li>
            </ul>

            <p><strong>The error:</strong> The argument treats "my envelope has the smaller amount" and "my envelope has the larger amount" as equally likely <em>given any specific value Y</em>.</p>

            <p>But these conditional probabilities depend on the prior distribution of S! If you see $100:</p>
            <ul style="margin-left: 25px; color: #555; margin-bottom: 18px;">
                <li>If S = $50 is more likely than S = $100, you probably have the larger envelope</li>
                <li>If S = $100 is more likely than S = $50, you probably have the smaller envelope</li>
            </ul>

            <div class="insight-box">
                <h3>&#128202; The Correct Calculation</h3>
                <p>Let p(S) be the probability distribution over possible values of S (the smaller amount).</p>
                <p>The probability you have the smaller envelope, <em>given you see Y</em>, depends on:</p>
                <div class="formula-box">
                    <div class="formula-line">P(small | see Y) &#8733; p(S = Y)</div>
                    <div class="formula-line">P(large | see Y) &#8733; p(S = Y/2)</div>
                </div>
                <p>These are generally NOT equal! The 50-50 assumption is unjustified.</p>
            </div>
        </div>

        <!-- Multiple Solutions -->
        <div class="card">
            <h2>Proposed Resolutions</h2>
            <p>Philosophers and mathematicians have offered several ways to understand this paradox:</p>

            <div class="solutions-grid">
                <div class="solution-card">
                    <h4>1. No Prior Distribution</h4>
                    <p>The problem doesn't specify how S was chosen. Without a prior, you can't compute the expected value of switching. The calculation is undefined, not 1.25X.</p>
                </div>
                <div class="solution-card">
                    <h4>2. Mixed Reference Points</h4>
                    <p>The fallacy mixes two scenarios: when your envelope has S and when it has 2S. Using "my amount" as a fixed reference point conflates different probability spaces.</p>
                </div>
                <div class="solution-card">
                    <h4>3. Improper Priors</h4>
                    <p>For the 50-50 argument to work for ALL values of Y, you'd need an "improper" probability distribution that assigns infinite total probability. Such distributions don't represent real situations.</p>
                </div>
                <div class="solution-card">
                    <h4>4. Symmetry Resolution</h4>
                    <p>By symmetry, E[other] = E[yours]. Whatever gain you might get by switching, you could equally lose. The expected value of switching is exactly what you have.</p>
                </div>
            </div>
        </div>

        <!-- The Correct View -->
        <div class="card">
            <h2>The Correct Expected Value</h2>
            <p>Let's work out the math properly. Let S be the smaller amount.</p>

            <div class="formula-box">
                <div class="formula-line">Your envelope contains: S or 2S (each with prob 1/2)</div>
                <div class="formula-line">E[your envelope] = 0.5 &#215; S + 0.5 &#215; 2S = 1.5S</div>
                <div class="formula-line">E[other envelope] = 0.5 &#215; 2S + 0.5 &#215; S = 1.5S</div>
                <div class="formula-line formula-result">E[switch] = E[keep] = 1.5S</div>
            </div>

            <p>Before opening either envelope, switching provides no advantage. You have <span class="highlight">the same expected value either way</span>.</p>

            <p>The fallacy arises when you condition on seeing a specific amount Y and incorrectly assume 50-50 odds of it being small or large. The odds depend on the unknown distribution of S.</p>
        </div>

        <!-- Variations -->
        <div class="card">
            <h2>Interesting Variations</h2>

            <p><strong>The Open Envelope Variant:</strong> What if you're allowed to open your envelope before deciding? Surprisingly, there exist strategies that do slightly better than random! If you use a threshold (switch if below $T, keep if above), you can gain an edge—but only because you're implicitly assuming a probability distribution.</p>

            <p><strong>Known Bounds:</strong> If you know the amounts are between $1 and $1000, seeing $1 means you must have the smaller envelope. Seeing $1000 means you have the larger. Intermediate values give partial information.</p>

            <p><strong>Infinite Case:</strong> If any amount is possible with equal probability, you get an "improper" distribution—like the uniform distribution over all positive numbers. This doesn't actually exist! The paradox relies on this impossibility.</p>
        </div>

        <!-- Deeper Lessons -->
        <div class="card">
            <h2>Lessons from the Paradox</h2>

            <p><strong>1. Expected value requires a distribution.</strong> You can't compute expectations without knowing (or assuming) probabilities. "I don't know" is not a license to assume 50-50.</p>

            <p><strong>2. Conditional probabilities aren't always equal.</strong> Seeing evidence changes what you should believe. The probability of holding the smaller envelope depends on what you see inside.</p>

            <p><strong>3. Symmetry is a powerful check.</strong> Before opening, the envelopes are symmetric. Any argument that favors one must be flawed—there's no asymmetric information yet!</p>

            <p><strong>4. Reference frames matter.</strong> Whether you measure expected gains in terms of S (the smaller amount), Y (what you see), or something else affects the calculation. Mixing frames causes errors.</p>

            <div class="quote">
                "The two-envelope paradox teaches us that probability calculations require careful attention to what is known, what is assumed, and how quantities are defined."
                <div class="quote-author">&#8212; Multiple authors in the philosophy of probability literature</div>
            </div>
        </div>

        <div class="footer">
            <p>Sources: <a href="https://en.wikipedia.org/wiki/Two_envelopes_problem" target="_blank">Wikipedia</a>,
            <a href="https://plato.stanford.edu/entries/paradox-envelope/" target="_blank">Stanford Encyclopedia of Philosophy</a>,
            Christensen & Utts (1992). "Bayesian resolution of the 'exchange paradox'"</p>
            <p style="margin-top: 10px;">Part of <a href="../index.html">CCAB</a> &#183; Surprising Paradoxes Collection</p>
        </div>
    </main>

    <script>
        // Game state
        let smallerAmount, largerAmount;
        let selectedEnvelope = null;
        let revealed = false;
        let stats = {
            games: 0,
            switchWins: 0,
            keepWins: 0
        };

        const envelopeA = document.getElementById('envelopeA');
        const envelopeB = document.getElementById('envelopeB');
        const amountA = document.getElementById('amountA');
        const amountB = document.getElementById('amountB');
        const gameMessage = document.getElementById('gameMessage');
        const switchBtn = document.getElementById('switchBtn');
        const keepBtn = document.getElementById('keepBtn');

        function generateGame() {
            // Random smaller amount between 10 and 100
            smallerAmount = Math.floor(Math.random() * 91) + 10;
            largerAmount = smallerAmount * 2;

            // Randomly assign to envelopes
            if (Math.random() < 0.5) {
                amountA.textContent = '$' + smallerAmount;
                amountB.textContent = '$' + largerAmount;
                envelopeA.dataset.value = smallerAmount;
                envelopeB.dataset.value = largerAmount;
            } else {
                amountA.textContent = '$' + largerAmount;
                amountB.textContent = '$' + smallerAmount;
                envelopeA.dataset.value = largerAmount;
                envelopeB.dataset.value = smallerAmount;
            }

            // Reset state
            selectedEnvelope = null;
            revealed = false;
            envelopeA.classList.remove('selected', 'revealed');
            envelopeB.classList.remove('selected', 'revealed');
            switchBtn.disabled = true;
            keepBtn.disabled = true;
            gameMessage.innerHTML = 'Choose an envelope to see what\'s inside.';
        }

        function selectEnvelope(envelope) {
            if (revealed) return;

            selectedEnvelope = envelope;

            // Show selection
            envelopeA.classList.remove('selected');
            envelopeB.classList.remove('selected');
            envelope.classList.add('selected', 'revealed');

            const amount = envelope.dataset.value;
            gameMessage.innerHTML = `You found <span class="highlight">$${amount}</span>! The other envelope has either $${Math.floor(amount/2)} or $${amount * 2}. Switch or keep?`;

            switchBtn.disabled = false;
            keepBtn.disabled = false;
            revealed = true;
        }

        function resolveGame(didSwitch) {
            const otherEnvelope = selectedEnvelope === envelopeA ? envelopeB : envelopeA;

            // Reveal other envelope
            otherEnvelope.classList.add('revealed');

            const yourAmount = parseInt(selectedEnvelope.dataset.value);
            const otherAmount = parseInt(otherEnvelope.dataset.value);

            let finalAmount, result;
            if (didSwitch) {
                finalAmount = otherAmount;
                result = otherAmount > yourAmount ? 'WON' : 'LOST';
                if (otherAmount > yourAmount) stats.switchWins++;
            } else {
                finalAmount = yourAmount;
                result = yourAmount > otherAmount ? 'WON' : 'LOST';
                if (yourAmount > otherAmount) stats.keepWins++;
            }

            stats.games++;
            updateStats();

            const action = didSwitch ? 'switched' : 'kept';
            const color = result === 'WON' ? '#4ecdc4' : '#ff6b6b';
            gameMessage.innerHTML = `You ${action} and got <span style="color: ${color}">$${finalAmount}</span>. You ${result}! (Other had $${didSwitch ? yourAmount : otherAmount})`;

            switchBtn.disabled = true;
            keepBtn.disabled = true;
        }

        function updateStats() {
            document.getElementById('gamesPlayed').textContent = stats.games;
            document.getElementById('switchWins').textContent = stats.switchWins;
            document.getElementById('keepWins').textContent = stats.keepWins;
        }

        envelopeA.addEventListener('click', () => selectEnvelope(envelopeA));
        envelopeB.addEventListener('click', () => selectEnvelope(envelopeB));

        switchBtn.addEventListener('click', () => resolveGame(true));
        keepBtn.addEventListener('click', () => resolveGame(false));

        document.getElementById('newGameBtn').addEventListener('click', generateGame);

        // Initialize
        generateGame();
    </script>
</body>
</html>
