<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Mandelbrot Set - Surprising Paradoxes</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: linear-gradient(135deg, #0a0a1a 0%, #1a0a2e 50%, #0a1a2e 100%);
            color: #e6f1ff;
            min-height: 100vh;
            overflow-x: hidden;
        }

        .back-link {
            position: fixed;
            top: 20px;
            left: 20px;
            color: #8b5cf6;
            text-decoration: none;
            font-size: 14px;
            z-index: 100;
            padding: 8px 16px;
            background: rgba(139, 92, 246, 0.1);
            border-radius: 20px;
            backdrop-filter: blur(10px);
            transition: all 0.3s;
        }

        .back-link:hover {
            background: rgba(139, 92, 246, 0.2);
        }

        header {
            text-align: center;
            padding: 60px 20px 20px;
        }

        h1 {
            font-size: clamp(1.8rem, 5vw, 2.8rem);
            background: linear-gradient(135deg, #8b5cf6, #ec4899, #06b6d4);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 15px;
        }

        .formula-display {
            font-family: 'Times New Roman', serif;
            font-size: 2rem;
            color: #ec4899;
            margin: 10px 0;
        }

        .subtitle {
            font-size: 1rem;
            color: #8892b0;
            max-width: 800px;
            margin: 0 auto;
            line-height: 1.6;
        }

        .main-container {
            display: grid;
            grid-template-columns: 1fr 280px;
            gap: 20px;
            max-width: 1400px;
            margin: 20px auto;
            padding: 0 20px;
        }

        @media (max-width: 1000px) {
            .main-container {
                grid-template-columns: 1fr;
            }
        }

        .canvas-panel {
            background: rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(139, 92, 246, 0.2);
            border-radius: 20px;
            padding: 20px;
        }

        #mandelbrotCanvas {
            width: 100%;
            height: 550px;
            background: #000;
            border-radius: 12px;
            cursor: crosshair;
        }

        .coord-bar {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
            padding: 10px;
            background: rgba(139, 92, 246, 0.1);
            border-radius: 8px;
            font-family: monospace;
            font-size: 0.8rem;
        }

        .controls-panel {
            background: rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(139, 92, 246, 0.2);
            border-radius: 20px;
            padding: 25px;
        }

        .control-section {
            margin-bottom: 20px;
        }

        .control-section h3 {
            color: #8b5cf6;
            font-size: 0.85rem;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .slider-group {
            margin: 10px 0;
        }

        .slider-group label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
            font-size: 0.8rem;
            color: #a8b2d1;
        }

        .slider-group input[type="range"] {
            width: 100%;
            height: 4px;
            -webkit-appearance: none;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 2px;
        }

        .slider-group input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 14px;
            height: 14px;
            background: linear-gradient(135deg, #8b5cf6, #ec4899);
            border-radius: 50%;
            cursor: pointer;
        }

        .color-schemes {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 6px;
        }

        .color-btn {
            padding: 8px;
            background: rgba(139, 92, 246, 0.1);
            border: 1px solid rgba(139, 92, 246, 0.3);
            border-radius: 6px;
            color: #8b5cf6;
            cursor: pointer;
            font-size: 0.75rem;
        }

        .color-btn:hover, .color-btn.active {
            background: rgba(139, 92, 246, 0.3);
        }

        .zoom-display {
            background: rgba(236, 72, 153, 0.1);
            border-radius: 10px;
            padding: 12px;
            text-align: center;
            margin: 15px 0;
        }

        .zoom-display h4 {
            color: #ec4899;
            font-size: 0.8rem;
            margin-bottom: 5px;
        }

        .zoom-value {
            font-size: 1.4rem;
            font-family: monospace;
            color: #06b6d4;
        }

        .preset-locations {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        .preset-btn {
            padding: 10px;
            background: rgba(6, 182, 212, 0.1);
            border: 1px solid rgba(6, 182, 212, 0.3);
            border-radius: 8px;
            color: #06b6d4;
            cursor: pointer;
            font-size: 0.75rem;
            text-align: left;
        }

        .preset-btn:hover {
            background: rgba(6, 182, 212, 0.3);
        }

        button {
            width: 100%;
            padding: 12px;
            font-size: 0.9rem;
            background: linear-gradient(135deg, #8b5cf6, #ec4899);
            border: none;
            border-radius: 10px;
            color: white;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            margin: 5px 0;
        }

        button:hover {
            transform: scale(1.02);
            box-shadow: 0 5px 20px rgba(139, 92, 246, 0.3);
        }

        button.secondary {
            background: linear-gradient(135deg, #06b6d4, #22d3ee);
        }

        .explanation {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.05), rgba(236, 72, 153, 0.05));
            border-radius: 20px;
            padding: 30px;
            margin: 30px auto;
            max-width: 1360px;
        }

        .explanation h2 {
            color: #8b5cf6;
            margin-bottom: 20px;
        }

        .exp-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
        }

        .exp-card {
            background: rgba(0, 0, 0, 0.3);
            padding: 20px;
            border-radius: 12px;
            border-left: 4px solid #ec4899;
        }

        .exp-card h3 {
            color: #ec4899;
            margin-bottom: 10px;
            font-size: 1rem;
        }

        .exp-card p {
            color: #a8b2d1;
            font-size: 0.9rem;
            line-height: 1.6;
        }

        footer {
            text-align: center;
            padding: 40px 20px;
            color: #495670;
            font-size: 0.85rem;
        }

        footer a {
            color: #8b5cf6;
            text-decoration: none;
        }

        .rendering {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #8b5cf6;
            font-size: 1.2rem;
            display: none;
        }
    </style>
</head>
<body>
    <a href="index.html" class="back-link">← Back to Paradoxes</a>

    <header>
        <h1>The Mandelbrot Set</h1>
        <div class="formula-display">z<sub>n+1</sub> = z<sub>n</sub>² + c</div>
        <p class="subtitle">
            One simple formula. Infinite complexity. Zoom forever and discover new patterns—
            seahorses, spirals, lightning bolts—that have been hiding in mathematics for eternity,
            waiting to be computed. The most famous fractal ever discovered.
        </p>
    </header>

    <div class="main-container">
        <div class="canvas-panel" style="position: relative;">
            <canvas id="mandelbrotCanvas"></canvas>
            <div class="rendering" id="rendering">Rendering...</div>
            <div class="coord-bar">
                <span id="coordDisplay">Click to zoom in</span>
                <span id="iterDisplay">Max iterations: 100</span>
            </div>
        </div>

        <div class="controls-panel">
            <div class="control-section">
                <h3>Iterations</h3>
                <div class="slider-group">
                    <label>
                        <span>Max iterations:</span>
                        <span id="iterValue">100</span>
                    </label>
                    <input type="range" id="iterSlider" min="50" max="500" value="100">
                </div>
            </div>

            <div class="zoom-display">
                <h4>Current Zoom</h4>
                <div class="zoom-value" id="zoomValue">1×</div>
            </div>

            <div class="control-section">
                <h3>Color Scheme</h3>
                <div class="color-schemes">
                    <button class="color-btn active" onclick="setColorScheme('classic')">Classic</button>
                    <button class="color-btn" onclick="setColorScheme('fire')">Fire</button>
                    <button class="color-btn" onclick="setColorScheme('ocean')">Ocean</button>
                    <button class="color-btn" onclick="setColorScheme('rainbow')">Rainbow</button>
                    <button class="color-btn" onclick="setColorScheme('electric')">Electric</button>
                    <button class="color-btn" onclick="setColorScheme('monochrome')">Mono</button>
                </div>
            </div>

            <div class="control-section">
                <h3>Famous Locations</h3>
                <div class="preset-locations">
                    <button class="preset-btn" onclick="goToLocation(-0.75, 0, 3)">Overview</button>
                    <button class="preset-btn" onclick="goToLocation(-0.7436447860, 0.1318252536, 0.00029)">Seahorse Valley</button>
                    <button class="preset-btn" onclick="goToLocation(-0.743643887, 0.131825904, 0.000014)">Deep Seahorse</button>
                    <button class="preset-btn" onclick="goToLocation(0.360240443, -0.100689306, 0.0003)">Elephant Valley</button>
                    <button class="preset-btn" onclick="goToLocation(-1.749, 0, 0.02)">Mini Mandelbrot</button>
                </div>
            </div>

            <button onclick="zoomOut()">
                ⊖ Zoom Out
            </button>
            <button onclick="resetView()" class="secondary">
                ↺ Reset View
            </button>
        </div>
    </div>

    <div class="explanation">
        <h2>Infinite Complexity from z² + c</h2>

        <div class="exp-grid">
            <div class="exp-card">
                <h3>The Simple Rule</h3>
                <p>For each point c in the complex plane: start with z = 0, repeatedly
                   compute z = z² + c. If z stays bounded (|z| < 2), c is IN the set (black).
                   Otherwise, color by how fast it escapes. That's it!</p>
            </div>
            <div class="exp-card">
                <h3>Self-Similarity</h3>
                <p>Zoom into the boundary and you'll find miniature copies of the whole set.
                   These "mini-Mandelbrots" appear everywhere, connected by intricate spirals
                   and tendrils. Each one is slightly different.</p>
            </div>
            <div class="exp-card">
                <h3>Connected But Infinitely Complex</h3>
                <p>The Mandelbrot set is connected—a single piece with no isolated points.
                   Yet its boundary is infinitely complex, with dimension ~2. More complex
                   than any curve, but less than a filled area.</p>
            </div>
            <div class="exp-card">
                <h3>Discovered by Computer</h3>
                <p>Benoit Mandelbrot first visualized this in 1980 at IBM. The beauty was
                   invisible until computers could iterate millions of times. Mathematics
                   had hidden this for thousands of years!</p>
            </div>
        </div>
    </div>

    <footer>
        <p>Part of <a href="index.html">Surprising Paradoxes</a> |
           First visualized by Benoit Mandelbrot (1980)</p>
    </footer>

    <script>
        const canvas = document.getElementById('mandelbrotCanvas');
        const ctx = canvas.getContext('2d');

        let centerX = -0.75;
        let centerY = 0;
        let scale = 3;
        let maxIterations = 100;
        let colorScheme = 'classic';

        const colorSchemes = {
            classic: (i, max) => {
                if (i === max) return [0, 0, 0];
                const t = i / max;
                return [
                    Math.floor(9 * (1-t) * t * t * t * 255),
                    Math.floor(15 * (1-t) * (1-t) * t * t * 255),
                    Math.floor(8.5 * (1-t) * (1-t) * (1-t) * t * 255)
                ];
            },
            fire: (i, max) => {
                if (i === max) return [0, 0, 0];
                const t = i / max;
                return [
                    Math.floor(255 * Math.min(1, t * 3)),
                    Math.floor(255 * Math.max(0, t * 3 - 1)),
                    Math.floor(255 * Math.max(0, t * 3 - 2))
                ];
            },
            ocean: (i, max) => {
                if (i === max) return [0, 0, 0];
                const t = i / max;
                return [
                    Math.floor(30 + 50 * t),
                    Math.floor(100 + 100 * Math.sin(t * Math.PI)),
                    Math.floor(150 + 105 * t)
                ];
            },
            rainbow: (i, max) => {
                if (i === max) return [0, 0, 0];
                const h = (i / max) * 360;
                return hslToRgb(h, 100, 50);
            },
            electric: (i, max) => {
                if (i === max) return [0, 0, 0];
                const t = i / max;
                return [
                    Math.floor(139 + 116 * Math.sin(t * 6)),
                    Math.floor(92 + 163 * Math.sin(t * 6 + 2)),
                    Math.floor(246)
                ];
            },
            monochrome: (i, max) => {
                if (i === max) return [0, 0, 0];
                const v = Math.floor((i / max) * 255);
                return [v, v, v];
            }
        };

        function hslToRgb(h, s, l) {
            h /= 360; s /= 100; l /= 100;
            let r, g, b;
            if (s === 0) {
                r = g = b = l;
            } else {
                const hue2rgb = (p, q, t) => {
                    if (t < 0) t += 1;
                    if (t > 1) t -= 1;
                    if (t < 1/6) return p + (q - p) * 6 * t;
                    if (t < 1/2) return q;
                    if (t < 2/3) return p + (q - p) * (2/3 - t) * 6;
                    return p;
                };
                const q = l < 0.5 ? l * (1 + s) : l + s - l * s;
                const p = 2 * l - q;
                r = hue2rgb(p, q, h + 1/3);
                g = hue2rgb(p, q, h);
                b = hue2rgb(p, q, h - 1/3);
            }
            return [Math.round(r * 255), Math.round(g * 255), Math.round(b * 255)];
        }

        function resizeCanvas() {
            const rect = canvas.getBoundingClientRect();
            canvas.width = rect.width * 2;
            canvas.height = rect.height * 2;
        }

        function mandelbrot(cx, cy, maxIter) {
            let x = 0, y = 0;
            let iteration = 0;

            while (x*x + y*y <= 4 && iteration < maxIter) {
                const xNew = x*x - y*y + cx;
                y = 2*x*y + cy;
                x = xNew;
                iteration++;
            }

            // Smooth coloring
            if (iteration < maxIter) {
                const log_zn = Math.log(x*x + y*y) / 2;
                const nu = Math.log(log_zn / Math.log(2)) / Math.log(2);
                iteration = iteration + 1 - nu;
            }

            return iteration;
        }

        function render() {
            resizeCanvas();
            const width = canvas.width;
            const height = canvas.height;

            document.getElementById('rendering').style.display = 'block';

            const imageData = ctx.createImageData(width, height);
            const data = imageData.data;

            const aspectRatio = width / height;
            const xRange = scale * aspectRatio;
            const yRange = scale;

            const xMin = centerX - xRange / 2;
            const yMin = centerY - yRange / 2;

            for (let py = 0; py < height; py++) {
                for (let px = 0; px < width; px++) {
                    const x = xMin + (px / width) * xRange;
                    const y = yMin + (py / height) * yRange;

                    const iter = mandelbrot(x, y, maxIterations);
                    const [r, g, b] = colorSchemes[colorScheme](iter, maxIterations);

                    const idx = (py * width + px) * 4;
                    data[idx] = r;
                    data[idx + 1] = g;
                    data[idx + 2] = b;
                    data[idx + 3] = 255;
                }
            }

            ctx.putImageData(imageData, 0, 0);
            document.getElementById('rendering').style.display = 'none';

            updateDisplay();
        }

        function updateDisplay() {
            const zoom = 3 / scale;
            let zoomStr;
            if (zoom >= 1000000) {
                zoomStr = (zoom / 1000000).toFixed(1) + 'M×';
            } else if (zoom >= 1000) {
                zoomStr = (zoom / 1000).toFixed(1) + 'K×';
            } else {
                zoomStr = zoom.toFixed(1) + '×';
            }
            document.getElementById('zoomValue').textContent = zoomStr;
            document.getElementById('iterDisplay').textContent = `Max iterations: ${maxIterations}`;
        }

        function goToLocation(x, y, s) {
            centerX = x;
            centerY = y;
            scale = s;
            render();
        }

        function resetView() {
            goToLocation(-0.75, 0, 3);
        }

        function zoomOut() {
            scale *= 2;
            render();
        }

        function setColorScheme(scheme) {
            colorScheme = scheme;
            document.querySelectorAll('.color-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            render();
        }

        // Click to zoom
        canvas.addEventListener('click', (e) => {
            const rect = canvas.getBoundingClientRect();
            const x = (e.clientX - rect.left) / rect.width;
            const y = (e.clientY - rect.top) / rect.height;

            const aspectRatio = canvas.width / canvas.height;
            const xRange = scale * aspectRatio;
            const yRange = scale;

            centerX = (centerX - xRange / 2) + x * xRange;
            centerY = (centerY - yRange / 2) + y * yRange;
            scale /= 2;

            render();
        });

        // Show coordinates on hover
        canvas.addEventListener('mousemove', (e) => {
            const rect = canvas.getBoundingClientRect();
            const x = (e.clientX - rect.left) / rect.width;
            const y = (e.clientY - rect.top) / rect.height;

            const aspectRatio = canvas.width / canvas.height;
            const xRange = scale * aspectRatio;
            const yRange = scale;

            const cx = (centerX - xRange / 2) + x * xRange;
            const cy = (centerY - yRange / 2) + y * yRange;

            document.getElementById('coordDisplay').textContent =
                `c = ${cx.toFixed(10)} + ${cy.toFixed(10)}i`;
        });

        // Event listeners
        document.getElementById('iterSlider').addEventListener('input', (e) => {
            maxIterations = parseInt(e.target.value);
            document.getElementById('iterValue').textContent = maxIterations;
        });

        document.getElementById('iterSlider').addEventListener('change', render);

        window.addEventListener('resize', render);

        // Initialize
        render();
    </script>
</body>
</html>
