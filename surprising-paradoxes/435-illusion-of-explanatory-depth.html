<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Illusion of Explanatory Depth | Surprising Paradoxes</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Georgia', serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            min-height: 100vh;
            color: #e8e8e8;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 40px;
            padding-top: 20px;
        }

        h1 {
            font-size: 2.2em;
            color: #ffd700;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .subtitle {
            font-size: 1.3em;
            color: #87ceeb;
            font-style: italic;
        }

        .back-link {
            position: fixed;
            top: 20px;
            left: 20px;
            color: #87ceeb;
            text-decoration: none;
            font-size: 1em;
            opacity: 0.8;
            transition: opacity 0.3s;
        }

        .back-link:hover {
            opacity: 1;
        }

        .section {
            background: rgba(255,255,255,0.05);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            border: 1px solid rgba(255,255,255,0.1);
        }

        h2 {
            color: #ffd700;
            margin-bottom: 20px;
            font-size: 1.5em;
            border-bottom: 2px solid rgba(255,215,0,0.3);
            padding-bottom: 10px;
        }

        h3 {
            color: #87ceeb;
            margin: 20px 0 15px 0;
            font-size: 1.2em;
        }

        p {
            line-height: 1.8;
            margin-bottom: 15px;
            color: #d0d0d0;
        }

        .highlight {
            color: #ffd700;
            font-weight: bold;
        }

        /* Device Grid */
        .device-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .device-card {
            background: rgba(255,255,255,0.08);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            transition: all 0.3s;
            cursor: pointer;
            border: 2px solid transparent;
        }

        .device-card:hover {
            background: rgba(255,255,255,0.12);
            transform: translateY(-3px);
        }

        .device-card.selected {
            border-color: #ffd700;
            background: rgba(255,215,0,0.1);
        }

        .device-card.rated {
            border-color: #90ee90;
        }

        .device-icon {
            font-size: 3em;
            margin-bottom: 10px;
        }

        .device-name {
            font-size: 1.1em;
            color: #fff;
            margin-bottom: 10px;
        }

        .device-rating {
            font-size: 0.9em;
            color: #888;
        }

        /* Rating Slider */
        .rating-section {
            margin: 30px 0;
            padding: 25px;
            background: rgba(255,255,255,0.05);
            border-radius: 15px;
        }

        .rating-question {
            font-size: 1.1em;
            color: #87ceeb;
            margin-bottom: 20px;
        }

        .rating-scale {
            display: flex;
            justify-content: space-between;
            margin: 20px 0;
        }

        .scale-label {
            font-size: 0.85em;
            color: #888;
            max-width: 120px;
            text-align: center;
        }

        .scale-label.left {
            text-align: left;
        }

        .scale-label.right {
            text-align: right;
        }

        input[type="range"] {
            width: 100%;
            height: 10px;
            background: rgba(255,255,255,0.1);
            border-radius: 5px;
            outline: none;
            -webkit-appearance: none;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 24px;
            height: 24px;
            background: #ffd700;
            border-radius: 50%;
            cursor: pointer;
        }

        .rating-value {
            text-align: center;
            font-size: 2.5em;
            color: #ffd700;
            margin: 20px 0;
        }

        .rating-description {
            text-align: center;
            font-size: 0.95em;
            color: #aaa;
            font-style: italic;
        }

        /* Button styles */
        .btn {
            background: linear-gradient(135deg, #ffd700 0%, #ffaa00 100%);
            color: #1a1a2e;
            border: none;
            padding: 15px 40px;
            font-size: 1.1em;
            border-radius: 30px;
            cursor: pointer;
            font-weight: bold;
            margin: 10px;
            transition: all 0.3s;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(255,215,0,0.4);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .btn.secondary {
            background: linear-gradient(135deg, #87ceeb 0%, #5fa8d3 100%);
        }

        /* Explanation Section */
        .explanation-prompt {
            background: rgba(255,255,255,0.05);
            border-radius: 15px;
            padding: 25px;
            margin: 30px 0;
        }

        .prompt-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
        }

        .prompt-icon {
            font-size: 2.5em;
        }

        .explanation-box {
            width: 100%;
            min-height: 200px;
            padding: 20px;
            font-family: inherit;
            font-size: 1em;
            background: rgba(0,0,0,0.3);
            border: 2px solid rgba(255,215,0,0.3);
            border-radius: 10px;
            color: #fff;
            resize: vertical;
        }

        .explanation-box:focus {
            outline: none;
            border-color: #ffd700;
        }

        .explanation-hints {
            margin-top: 15px;
            padding: 15px;
            background: rgba(255,215,0,0.1);
            border-radius: 10px;
        }

        .hint-list {
            list-style: none;
            color: #aaa;
            font-size: 0.9em;
        }

        .hint-list li {
            padding: 5px 0;
            padding-left: 20px;
            position: relative;
        }

        .hint-list li:before {
            content: "?";
            position: absolute;
            left: 0;
            color: #ffd700;
        }

        /* Results */
        .results-container {
            text-align: center;
        }

        .comparison-chart {
            display: flex;
            justify-content: center;
            gap: 60px;
            margin: 40px 0;
        }

        .rating-column {
            text-align: center;
        }

        .column-label {
            font-size: 1.1em;
            color: #888;
            margin-bottom: 15px;
        }

        .bar-container {
            width: 80px;
            height: 250px;
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
            position: relative;
            overflow: hidden;
            margin: 0 auto;
        }

        .bar-fill {
            position: absolute;
            bottom: 0;
            width: 100%;
            border-radius: 10px;
            transition: height 1s ease-out;
        }

        .bar-fill.before {
            background: linear-gradient(to top, #ffd700, #ffee55);
        }

        .bar-fill.after {
            background: linear-gradient(to top, #ff6b6b, #ffa07a);
        }

        .bar-value {
            font-size: 2em;
            font-weight: bold;
            margin-top: 15px;
        }

        .bar-value.before {
            color: #ffd700;
        }

        .bar-value.after {
            color: #ff6b6b;
        }

        .drop-arrow {
            font-size: 3em;
            color: #ff6b6b;
            animation: bounce 1s infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(10px); }
        }

        .drop-message {
            font-size: 1.8em;
            color: #ff6b6b;
            margin: 20px 0;
            padding: 20px;
            background: rgba(255,107,107,0.1);
            border-radius: 15px;
        }

        .insight-box {
            background: rgba(255,215,0,0.1);
            padding: 25px;
            border-radius: 15px;
            margin: 30px 0;
            border-left: 4px solid #ffd700;
        }

        /* All ratings summary */
        .all-ratings-table {
            width: 100%;
            margin: 20px 0;
            border-collapse: collapse;
        }

        .all-ratings-table th,
        .all-ratings-table td {
            padding: 12px;
            text-align: center;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .all-ratings-table th {
            color: #87ceeb;
        }

        .all-ratings-table td {
            color: #fff;
        }

        .drop-cell {
            color: #ff6b6b;
            font-weight: bold;
        }

        .drop-cell.small {
            color: #ffaa00;
        }

        /* Quote */
        .quote {
            font-style: italic;
            color: #aaa;
            border-left: 3px solid #ffd700;
            padding-left: 20px;
            margin: 25px 0;
        }

        .citation {
            font-size: 0.85em;
            color: #888;
            margin-top: 10px;
        }

        /* Info cards */
        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .info-card {
            background: rgba(255,255,255,0.05);
            padding: 20px;
            border-radius: 12px;
            border-left: 4px solid #87ceeb;
        }

        .info-card h4 {
            color: #87ceeb;
            margin-bottom: 10px;
        }

        /* Progress */
        .progress-indicator {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 20px 0;
        }

        .progress-step {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: rgba(255,255,255,0.2);
        }

        .progress-step.active {
            background: #ffd700;
        }

        .progress-step.completed {
            background: #90ee90;
        }

        .hidden {
            display: none !important;
        }

        /* Animation */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .fade-in {
            animation: fadeIn 0.5s ease-out;
        }

        .word-count {
            text-align: right;
            color: #666;
            font-size: 0.85em;
            margin-top: 10px;
        }

        .word-count.low {
            color: #ff6b6b;
        }

        .word-count.good {
            color: #90ee90;
        }
    </style>
</head>
<body>
    <a href="index.html" class="back-link">‚Üê Back to Paradoxes</a>

    <div class="container">
        <header>
            <h1>The Illusion of Explanatory Depth</h1>
            <p class="subtitle">You Understand Less Than You Think</p>
        </header>

        <!-- Introduction -->
        <div class="section" id="intro-section">
            <h2>The Comfortable Illusion</h2>
            <p>
                How well do you understand how a <span class="highlight">zipper</span> works?
                What about a <span class="highlight">toilet</span>? A <span class="highlight">bicycle</span>?
            </p>
            <p>
                Most people feel quite confident‚Äîafter all, they use these devices every day.
                But in 2002, Yale researchers <strong>Leonid Rozenblit</strong> and <strong>Frank Keil</strong>
                discovered something humbling: when people actually try to explain how everyday objects work,
                their confidence <em>plummets</em>.
            </p>
            <p>
                We confuse <span class="highlight">familiarity</span> with <span class="highlight">understanding</span>.
                The mere exposure to something creates an illusion that we comprehend its inner workings.
                This is the <strong>Illusion of Explanatory Depth</strong>‚Äîand you're about to experience it.
            </p>

            <div style="text-align: center; margin-top: 30px;">
                <button class="btn" onclick="startExperiment()">Take the Test</button>
            </div>
        </div>

        <!-- Phase 1: Initial Ratings -->
        <div class="section hidden" id="phase1-section">
            <h2>Phase 1: Rate Your Understanding</h2>
            <p>For each device below, rate how well you understand how it works‚Äînot just how to <em>use</em> it, but how it actually <em>functions</em> mechanically.</p>

            <div class="progress-indicator">
                <div class="progress-step active" id="prog1"></div>
                <div class="progress-step" id="prog2"></div>
                <div class="progress-step" id="prog3"></div>
                <div class="progress-step" id="prog4"></div>
            </div>

            <div class="device-grid" id="device-grid">
                <!-- Devices will be added dynamically -->
            </div>

            <div class="rating-section hidden" id="rating-section">
                <div class="rating-question" id="rating-question">
                    How well do you understand how a <strong id="current-device-name">device</strong> works?
                </div>

                <input type="range" min="1" max="7" value="4" id="rating-slider"
                       oninput="updateRatingDisplay()">

                <div class="rating-scale">
                    <span class="scale-label left">1 - Vague sense it exists</span>
                    <span class="scale-label right">7 - Could explain to an engineer</span>
                </div>

                <div class="rating-value" id="rating-display">4</div>
                <div class="rating-description" id="rating-desc">Moderate understanding</div>

                <div style="text-align: center; margin-top: 20px;">
                    <button class="btn" onclick="submitRating()">Confirm Rating</button>
                </div>
            </div>

            <div style="text-align: center; margin-top: 20px;" id="phase1-continue" class="hidden">
                <p style="color: #90ee90;">All devices rated!</p>
                <button class="btn" onclick="startPhase2()">Continue to Phase 2</button>
            </div>
        </div>

        <!-- Phase 2: Explanation -->
        <div class="section hidden" id="phase2-section">
            <h2>Phase 2: Explain It</h2>

            <div class="progress-indicator">
                <div class="progress-step completed" id="prog1b"></div>
                <div class="progress-step active" id="prog2b"></div>
                <div class="progress-step" id="prog3b"></div>
                <div class="progress-step" id="prog4b"></div>
            </div>

            <div class="explanation-prompt">
                <div class="prompt-header">
                    <span class="prompt-icon" id="explain-icon"></span>
                    <div>
                        <h3 style="margin: 0;">Explain: <span id="explain-device-name"></span></h3>
                        <p style="margin: 5px 0; color: #888;">Write a detailed, step-by-step explanation</p>
                    </div>
                </div>

                <p>Imagine you're explaining to someone who has never seen this device.
                Describe the <strong>mechanism</strong>‚Äîwhat happens physically when you use it?
                What parts are involved? How do they interact?</p>

                <textarea class="explanation-box" id="explanation-text"
                          placeholder="Describe how it works step by step..."
                          oninput="updateWordCount()"></textarea>
                <div class="word-count" id="word-count">0 words</div>

                <div class="explanation-hints">
                    <p style="color: #ffd700; margin-bottom: 10px;">Consider explaining:</p>
                    <ul class="hint-list" id="hint-list">
                        <!-- Hints added dynamically -->
                    </ul>
                </div>
            </div>

            <div style="text-align: center;">
                <button class="btn" id="submit-explanation-btn" onclick="submitExplanation()" disabled>
                    Submit Explanation (write at least 30 words)
                </button>
            </div>
        </div>

        <!-- Phase 3: Re-rating -->
        <div class="section hidden" id="phase3-section">
            <h2>Phase 3: Rate Again</h2>

            <div class="progress-indicator">
                <div class="progress-step completed"></div>
                <div class="progress-step completed"></div>
                <div class="progress-step active"></div>
                <div class="progress-step"></div>
            </div>

            <p>Now that you've tried to explain it, how well do you <em>actually</em> understand how a
            <strong id="rerate-device-name"></strong> works?</p>

            <div class="rating-section">
                <p style="color: #888; text-align: center; margin-bottom: 15px;">
                    Your initial rating: <strong id="initial-rating-display" style="color: #ffd700;"></strong>
                </p>

                <input type="range" min="1" max="7" value="4" id="rerate-slider"
                       oninput="updateRerateDisplay()">

                <div class="rating-scale">
                    <span class="scale-label left">1 - Vague sense it exists</span>
                    <span class="scale-label right">7 - Could explain to an engineer</span>
                </div>

                <div class="rating-value" id="rerate-display">4</div>
                <div class="rating-description" id="rerate-desc">Moderate understanding</div>
            </div>

            <div style="text-align: center;">
                <button class="btn" onclick="submitRerate()">Confirm New Rating</button>
            </div>
        </div>

        <!-- Phase 4: Results -->
        <div class="section hidden" id="results-section">
            <h2>Your Results</h2>

            <div class="progress-indicator">
                <div class="progress-step completed"></div>
                <div class="progress-step completed"></div>
                <div class="progress-step completed"></div>
                <div class="progress-step active"></div>
            </div>

            <div class="results-container">
                <h3 style="color: #87ceeb;">Understanding of <span id="result-device-name"></span></h3>

                <div class="comparison-chart">
                    <div class="rating-column">
                        <div class="column-label">Before Explaining</div>
                        <div class="bar-container">
                            <div class="bar-fill before" id="bar-before"></div>
                        </div>
                        <div class="bar-value before" id="value-before">0</div>
                    </div>

                    <div style="display: flex; flex-direction: column; justify-content: center;">
                        <div class="drop-arrow">‚Üì</div>
                    </div>

                    <div class="rating-column">
                        <div class="column-label">After Explaining</div>
                        <div class="bar-container">
                            <div class="bar-fill after" id="bar-after"></div>
                        </div>
                        <div class="bar-value after" id="value-after">0</div>
                    </div>
                </div>

                <div class="drop-message" id="drop-message">
                    <!-- Filled dynamically -->
                </div>

                <div class="insight-box" id="insight-box">
                    <!-- Filled dynamically -->
                </div>

                <h3 style="margin-top: 40px;">All Your Initial Ratings</h3>
                <p>The illusion affects different types of knowledge differently:</p>

                <table class="all-ratings-table">
                    <thead>
                        <tr>
                            <th>Device</th>
                            <th>Your Rating</th>
                            <th>Typical Drop After Explaining</th>
                        </tr>
                    </thead>
                    <tbody id="all-ratings-body">
                        <!-- Filled dynamically -->
                    </tbody>
                </table>
            </div>

            <div style="text-align: center; margin-top: 30px;">
                <button class="btn" onclick="showExplanationSection()">Why This Happens</button>
                <button class="btn secondary" onclick="restartExperiment()">Try Again</button>
            </div>
        </div>

        <!-- Explanation Section -->
        <div class="section hidden" id="explanation-section">
            <h2>The Science Behind the Illusion</h2>

            <div class="quote">
                "People feel they understand complex phenomena with far greater precision, coherence,
                and depth than they really do; they are subject to an illusion‚Äîan illusion of explanatory depth."
                <div class="citation">‚Äî Rozenblit & Keil, 2002</div>
            </div>

            <h3>Why Does This Happen?</h3>

            <div class="info-grid">
                <div class="info-card">
                    <h4>üîÑ Confusing Familiarity with Understanding</h4>
                    <p>You've used a toilet thousands of times. This repeated exposure creates a <em>feeling</em>
                    of understanding, even though you've never examined its mechanism.</p>
                </div>
                <div class="info-card">
                    <h4>üëÄ Visible Effects, Invisible Mechanisms</h4>
                    <p>You see the zipper close seamlessly. The smooth result masks the complex
                    interlocking mechanism happening at the microscopic level.</p>
                </div>
                <div class="info-card">
                    <h4>üß© Knowing Parts ‚â† Understanding Systems</h4>
                    <p>You can name parts (handle, chain, pedals) without understanding how
                    they interact to convert leg motion into forward movement.</p>
                </div>
                <div class="info-card">
                    <h4>üé≠ The Illusion of "Outsourceable" Knowledge</h4>
                    <p>We feel we "know" because we could look it up‚Äîconfusing access to
                    knowledge with possession of knowledge.</p>
                </div>
            </div>

            <h3>What's Special About Explanatory Knowledge?</h3>
            <p>
                Rozenblit and Keil found the illusion is <strong>strongest for explanatory knowledge</strong>‚Äî
                understanding <em>how</em> things work. It's much weaker for:
            </p>
            <ul style="margin: 15px 0; padding-left: 25px; line-height: 2; color: #d0d0d0;">
                <li><strong>Facts:</strong> You know if you know a capital city</li>
                <li><strong>Procedures:</strong> You know if you can tie a bowline knot</li>
                <li><strong>Narratives:</strong> You know if you remember a movie's plot</li>
            </ul>
            <p>
                But for <em>explanatory</em> knowledge, the internal complexity is hidden.
                The smooth surface of everyday objects conceals the intricate causality beneath.
            </p>

            <h3>Real-World Implications</h3>

            <div class="info-grid">
                <div class="info-card">
                    <h4>üó≥Ô∏è Political Polarization</h4>
                    <p>People feel strongly about policies (healthcare, climate) while overestimating
                    their understanding of the mechanisms. Asking people to explain policies
                    <em>reduces</em> extremism.</p>
                </div>
                <div class="info-card">
                    <h4>üíä Medical Decisions</h4>
                    <p>Patients may feel they understand treatments well enough to reject medical
                    advice, confusing familiarity with the condition for mechanistic understanding.</p>
                </div>
                <div class="info-card">
                    <h4>üíª Technology Adoption</h4>
                    <p>Users overestimate their understanding of AI, blockchain, or other technologies,
                    leading to misplaced trust or unfounded fear.</p>
                </div>
                <div class="info-card">
                    <h4>üìö Learning</h4>
                    <p>Students believe they understand material after reading it, only to fail
                    when tested. Explanation-based study strategies combat this.</p>
                </div>
            </div>

            <h3>The Cure: Explanation Attempts</h3>
            <p>
                The very act that exposes the illusion is also the cure. By attempting to explain‚Äî
                whether to others or to yourself‚Äîyou discover the gaps in your understanding.
                This is why teaching is such a powerful learning tool: the attempt to explain
                forces genuine understanding.
            </p>

            <div class="quote">
                "If you can't explain it simply, you don't understand it well enough."
                <div class="citation">‚Äî Attributed to Einstein (and demonstrated by this experiment)</div>
            </div>

            <div class="citation" style="margin-top: 30px; padding: 20px; background: rgba(255,255,255,0.03); border-radius: 10px;">
                <strong>Key Reference:</strong><br>
                Rozenblit, L., & Keil, F. (2002). The misunderstood limits of folk science: An illusion of
                explanatory depth. <em>Cognitive Science, 26</em>(5), 521-562.
            </div>

            <div style="text-align: center; margin-top: 30px;">
                <button class="btn" onclick="restartExperiment()">Experience It Again</button>
            </div>
        </div>
    </div>

    <script>
        // Devices for the experiment
        const devices = [
            {
                id: 'toilet',
                name: 'Toilet',
                icon: 'üöΩ',
                hints: [
                    'What happens when you press the flush lever?',
                    'How does the tank refill?',
                    'What creates the suction that empties the bowl?',
                    'How does it know when to stop filling?'
                ]
            },
            {
                id: 'zipper',
                name: 'Zipper',
                icon: 'ü™°',
                hints: [
                    'What shape are the individual teeth?',
                    'How does the slider interlock them?',
                    'Why does pulling down open it?',
                    'How do the teeth stay locked when closed?'
                ]
            },
            {
                id: 'bicycle',
                name: 'Bicycle',
                icon: 'üö≤',
                hints: [
                    'How does pedaling create forward motion?',
                    'What role does the chain play?',
                    'How do gears change the effort required?',
                    'How does a bicycle stay upright when moving?'
                ]
            },
            {
                id: 'lock',
                name: 'Cylinder Lock',
                icon: 'üîí',
                hints: [
                    'What are the pins inside?',
                    'Why does only the right key work?',
                    'What happens mechanically when you turn the key?',
                    'How do the pins interact with the key shape?'
                ]
            },
            {
                id: 'piano',
                name: 'Piano Key',
                icon: 'üéπ',
                hints: [
                    'What happens when you press a key?',
                    'How does a hammer hit the string?',
                    'How does it produce different volumes?',
                    'What dampens the sound when you release?'
                ]
            },
            {
                id: 'helicopter',
                name: 'Helicopter',
                icon: 'üöÅ',
                hints: [
                    'How does the rotor create lift?',
                    'How does it move forward?',
                    'Why is the tail rotor needed?',
                    'How does it hover in place?'
                ]
            }
        ];

        const ratingDescriptions = {
            1: "Almost no understanding‚Äîcouldn't explain any mechanism",
            2: "Vague awareness‚Äîknow what it does but not how",
            3: "Surface understanding‚Äîknow some parts but not how they connect",
            4: "Moderate understanding‚Äîcould give a rough explanation",
            5: "Good understanding‚Äîcould explain the main mechanism",
            6: "Detailed understanding‚Äîknow how most parts interact",
            7: "Expert level‚Äîcould explain to an engineer"
        };

        let ratings = {};
        let currentDeviceIndex = 0;
        let selectedDevice = null;
        let ratedDevices = new Set();
        let explainedDevice = null;
        let initialRating = 0;
        let finalRating = 0;

        function startExperiment() {
            document.getElementById('intro-section').classList.add('hidden');
            document.getElementById('phase1-section').classList.remove('hidden');
            document.getElementById('phase1-section').classList.add('fade-in');

            // Reset state
            ratings = {};
            ratedDevices.clear();
            selectedDevice = null;

            // Render device grid
            const grid = document.getElementById('device-grid');
            grid.innerHTML = devices.map(d => `
                <div class="device-card" id="card-${d.id}" onclick="selectDevice('${d.id}')">
                    <div class="device-icon">${d.icon}</div>
                    <div class="device-name">${d.name}</div>
                    <div class="device-rating" id="rating-label-${d.id}">Click to rate</div>
                </div>
            `).join('');
        }

        function selectDevice(deviceId) {
            if (ratedDevices.has(deviceId)) return;

            // Deselect previous
            if (selectedDevice) {
                document.getElementById(`card-${selectedDevice}`).classList.remove('selected');
            }

            selectedDevice = deviceId;
            document.getElementById(`card-${deviceId}`).classList.add('selected');

            // Show rating section
            const device = devices.find(d => d.id === deviceId);
            document.getElementById('current-device-name').textContent = device.name.toLowerCase();
            document.getElementById('rating-section').classList.remove('hidden');
            document.getElementById('rating-slider').value = 4;
            updateRatingDisplay();
        }

        function updateRatingDisplay() {
            const value = document.getElementById('rating-slider').value;
            document.getElementById('rating-display').textContent = value;
            document.getElementById('rating-desc').textContent = ratingDescriptions[value];
        }

        function submitRating() {
            if (!selectedDevice) return;

            const value = parseInt(document.getElementById('rating-slider').value);
            ratings[selectedDevice] = value;
            ratedDevices.add(selectedDevice);

            // Update card
            document.getElementById(`card-${selectedDevice}`).classList.remove('selected');
            document.getElementById(`card-${selectedDevice}`).classList.add('rated');
            document.getElementById(`rating-label-${selectedDevice}`).textContent = `Rated: ${value}/7`;

            selectedDevice = null;
            document.getElementById('rating-section').classList.add('hidden');

            // Check if all rated
            if (ratedDevices.size === devices.length) {
                document.getElementById('phase1-continue').classList.remove('hidden');
            }
        }

        function startPhase2() {
            document.getElementById('phase1-section').classList.add('hidden');
            document.getElementById('phase2-section').classList.remove('hidden');
            document.getElementById('phase2-section').classList.add('fade-in');

            // Pick random device for explanation (one with higher rating for more dramatic effect)
            const ratedArray = Object.entries(ratings);
            ratedArray.sort((a, b) => b[1] - a[1]);
            explainedDevice = devices.find(d => d.id === ratedArray[0][0]);
            initialRating = ratings[explainedDevice.id];

            document.getElementById('explain-icon').textContent = explainedDevice.icon;
            document.getElementById('explain-device-name').textContent = explainedDevice.name;

            // Add hints
            const hintList = document.getElementById('hint-list');
            hintList.innerHTML = explainedDevice.hints.map(h => `<li>${h}</li>`).join('');
        }

        function updateWordCount() {
            const text = document.getElementById('explanation-text').value;
            const words = text.trim().split(/\s+/).filter(w => w.length > 0).length;
            const countEl = document.getElementById('word-count');
            countEl.textContent = `${words} words`;

            const btn = document.getElementById('submit-explanation-btn');

            if (words >= 30) {
                countEl.classList.remove('low');
                countEl.classList.add('good');
                btn.disabled = false;
            } else {
                countEl.classList.remove('good');
                countEl.classList.add('low');
                btn.disabled = true;
            }
        }

        function submitExplanation() {
            document.getElementById('phase2-section').classList.add('hidden');
            document.getElementById('phase3-section').classList.remove('hidden');
            document.getElementById('phase3-section').classList.add('fade-in');

            document.getElementById('rerate-device-name').textContent = explainedDevice.name.toLowerCase();
            document.getElementById('initial-rating-display').textContent = `${initialRating}/7`;
            document.getElementById('rerate-slider').value = initialRating;
            updateRerateDisplay();
        }

        function updateRerateDisplay() {
            const value = document.getElementById('rerate-slider').value;
            document.getElementById('rerate-display').textContent = value;
            document.getElementById('rerate-desc').textContent = ratingDescriptions[value];
        }

        function submitRerate() {
            finalRating = parseInt(document.getElementById('rerate-slider').value);
            showResults();
        }

        function showResults() {
            document.getElementById('phase3-section').classList.add('hidden');
            document.getElementById('results-section').classList.remove('hidden');
            document.getElementById('results-section').classList.add('fade-in');

            document.getElementById('result-device-name').textContent = explainedDevice.name;
            document.getElementById('value-before').textContent = initialRating;
            document.getElementById('value-after').textContent = finalRating;

            // Animate bars
            setTimeout(() => {
                document.getElementById('bar-before').style.height = `${(initialRating / 7) * 100}%`;
                document.getElementById('bar-after').style.height = `${(finalRating / 7) * 100}%`;
            }, 100);

            // Drop message
            const drop = initialRating - finalRating;
            const dropEl = document.getElementById('drop-message');
            const insightEl = document.getElementById('insight-box');

            if (drop > 2) {
                dropEl.innerHTML = `üìâ <strong>Your rating dropped ${drop} points!</strong><br>
                    A dramatic demonstration of the illusion.`;
                insightEl.innerHTML = `<strong>You experienced the classic effect.</strong>
                    In the original experiment, ratings dropped an average of 1.5 points.
                    Your ${drop}-point drop shows just how much we overestimate our understanding
                    until we try to articulate it.`;
            } else if (drop > 0) {
                dropEl.innerHTML = `üìâ <strong>Your rating dropped ${drop} point${drop > 1 ? 's' : ''}.</strong><br>
                    You discovered gaps in your understanding.`;
                insightEl.innerHTML = `<strong>You caught the illusion!</strong>
                    Even a small drop reveals the gap between feeling you understand
                    and actually being able to explain the mechanism. This awareness
                    is the first step to genuine understanding.`;
            } else if (drop === 0) {
                dropEl.innerHTML = `<strong>Your rating stayed the same.</strong><br>
                    Perhaps you were already calibrated‚Äîor the illusion persists!`;
                dropEl.style.color = '#ffaa00';
                insightEl.innerHTML = `<strong>Two possibilities:</strong> Either you accurately assessed your
                    knowledge from the start (rare!), or the illusion is so strong that even after
                    struggling to explain, your brain insists "I knew that." Most people show a drop‚Äî
                    try with a different device!`;
            } else {
                dropEl.innerHTML = `<strong>Your rating went UP by ${-drop} point${-drop > 1 ? 's' : ''}!</strong><br>
                    An unusual result‚Äîperhaps explanation helped crystallize your knowledge.`;
                dropEl.style.color = '#90ee90';
                insightEl.innerHTML = `<strong>Interesting!</strong> Sometimes explaining actually helps organize
                    existing knowledge. But be careful‚Äîthis could also be the illusion reasserting itself
                    after the temporary humility of trying to explain. True understanding comes from
                    filling the gaps you discovered.`;
            }

            // All ratings table
            const tbody = document.getElementById('all-ratings-body');
            tbody.innerHTML = devices.map(d => {
                const rating = ratings[d.id];
                const isExplained = d.id === explainedDevice.id;
                const typicalDrop = rating >= 5 ? '~2 points' : (rating >= 3 ? '~1 point' : '~0.5 points');
                return `
                    <tr style="${isExplained ? 'background: rgba(255,215,0,0.1);' : ''}">
                        <td>${d.icon} ${d.name} ${isExplained ? '(explained)' : ''}</td>
                        <td>${rating}/7</td>
                        <td class="drop-cell ${rating < 4 ? 'small' : ''}">${typicalDrop}</td>
                    </tr>
                `;
            }).join('');
        }

        function showExplanationSection() {
            document.getElementById('results-section').classList.add('hidden');
            document.getElementById('explanation-section').classList.remove('hidden');
            document.getElementById('explanation-section').classList.add('fade-in');
            window.scrollTo(0, 0);
        }

        function restartExperiment() {
            document.getElementById('results-section').classList.add('hidden');
            document.getElementById('explanation-section').classList.add('hidden');
            document.getElementById('phase1-section').classList.add('hidden');
            document.getElementById('phase2-section').classList.add('hidden');
            document.getElementById('phase3-section').classList.add('hidden');
            document.getElementById('intro-section').classList.remove('hidden');
            document.getElementById('explanation-text').value = '';
            window.scrollTo(0, 0);
        }
    </script>
</body>
</html>
