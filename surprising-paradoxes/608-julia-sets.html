<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Julia Sets - Surprising Paradoxes</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: linear-gradient(135deg, #0a0515 0%, #150a20 100%);
            color: #e0e0e0;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
        }

        h1 {
            font-size: 2.5em;
            background: linear-gradient(135deg, #9b59b6 0%, #3498db 50%, #1abc9c 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
        }

        .subtitle {
            font-size: 1.2em;
            color: #888;
        }

        .main-content {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 20px;
        }

        @media (max-width: 1100px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }

        .canvas-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .canvas-container {
            background: #000;
            border-radius: 12px;
            overflow: hidden;
            position: relative;
        }

        .canvas-container canvas {
            display: block;
            width: 100%;
            cursor: crosshair;
        }

        .canvas-label {
            position: absolute;
            top: 10px;
            left: 10px;
            background: rgba(0,0,0,0.7);
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 0.9em;
            color: #9b59b6;
        }

        .c-indicator {
            position: absolute;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: #ff4757;
            border: 2px solid white;
            transform: translate(-50%, -50%);
            pointer-events: none;
            transition: all 0.1s;
        }

        .controls {
            background: rgba(255,255,255,0.05);
            border-radius: 12px;
            padding: 20px;
        }

        .control-section {
            margin-bottom: 25px;
        }

        .control-section h3 {
            color: #9b59b6;
            margin-bottom: 15px;
            font-size: 1.1em;
            border-bottom: 1px solid rgba(155,89,182,0.3);
            padding-bottom: 8px;
        }

        .control-row {
            margin-bottom: 15px;
        }

        .control-row label {
            display: block;
            margin-bottom: 5px;
            color: #aaa;
            font-size: 0.9em;
        }

        .control-row input[type="range"] {
            width: 100%;
            margin-bottom: 5px;
        }

        .control-row .value {
            text-align: right;
            font-family: monospace;
            color: #9b59b6;
            font-size: 0.9em;
        }

        .c-value-display {
            background: rgba(0,0,0,0.3);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            margin-bottom: 15px;
        }

        .c-value {
            font-family: monospace;
            font-size: 1.2em;
            color: #3498db;
        }

        .connection-status {
            margin-top: 8px;
            font-size: 0.9em;
        }

        .connected {
            color: #2ecc71;
        }

        .disconnected {
            color: #e74c3c;
        }

        .btn-group {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 8px;
        }

        button {
            padding: 10px 12px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.85em;
            transition: all 0.2s;
        }

        .btn-primary {
            background: linear-gradient(135deg, #9b59b6, #3498db);
            color: white;
            grid-column: span 2;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(155,89,182,0.4);
        }

        .btn-secondary {
            background: rgba(255,255,255,0.1);
            color: #e0e0e0;
            font-size: 0.75em;
        }

        .btn-secondary:hover {
            background: rgba(255,255,255,0.2);
        }

        .preset-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 6px;
        }

        .preset-btn {
            padding: 8px 6px;
            font-size: 0.7em;
        }

        .explanation {
            margin-top: 30px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
        }

        .exp-card {
            background: rgba(255,255,255,0.05);
            border-radius: 12px;
            padding: 20px;
            border-left: 4px solid #9b59b6;
        }

        .exp-card h3 {
            color: #9b59b6;
            margin-bottom: 10px;
        }

        .exp-card p {
            color: #bbb;
            line-height: 1.6;
        }

        .formula {
            background: rgba(0,0,0,0.3);
            padding: 12px;
            border-radius: 8px;
            font-family: 'Times New Roman', serif;
            font-size: 1.1em;
            text-align: center;
            margin: 10px 0;
            color: #3498db;
        }

        .back-link {
            display: inline-block;
            color: #9b59b6;
            text-decoration: none;
            margin-bottom: 20px;
            transition: transform 0.2s;
        }

        .back-link:hover {
            transform: translateX(-5px);
        }

        .loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #9b59b6;
            font-size: 0.9em;
        }

        .instructions {
            font-size: 0.8em;
            color: #888;
            margin-top: 10px;
            padding: 10px;
            background: rgba(0,0,0,0.2);
            border-radius: 8px;
        }
    </style>
</head>
<body>
    <div class="container">
        <a href="index.html" class="back-link">← Back to Paradoxes</a>

        <header>
            <h1>Julia Sets</h1>
            <p class="subtitle">An infinite family of fractals indexed by the Mandelbrot set</p>
        </header>

        <div class="main-content">
            <div class="canvas-row">
                <div class="canvas-container" id="mandelbrotContainer">
                    <canvas id="mandelbrotCanvas" width="450" height="400"></canvas>
                    <div class="canvas-label">Mandelbrot Set</div>
                    <div class="c-indicator" id="cIndicator"></div>
                    <div class="loading" id="mandelLoading" style="display: none;">Rendering...</div>
                </div>
                <div class="canvas-container">
                    <canvas id="juliaCanvas" width="450" height="400"></canvas>
                    <div class="canvas-label">Julia Set for c</div>
                    <div class="loading" id="juliaLoading" style="display: none;">Rendering...</div>
                </div>
            </div>

            <div class="controls">
                <div class="control-section">
                    <h3>Current c Value</h3>
                    <div class="c-value-display">
                        <div class="c-value">c = <span id="cReal">-0.7</span> + <span id="cImag">0.27</span>i</div>
                        <div class="connection-status" id="connectionStatus">
                            <span class="connected">● Connected Julia set</span>
                        </div>
                    </div>
                    <div class="instructions">
                        Click on the Mandelbrot set to explore different Julia sets!
                    </div>
                </div>

                <div class="control-section">
                    <h3>Famous Julia Sets</h3>
                    <div class="preset-grid">
                        <button class="btn-secondary preset-btn" data-c="-0.7,0.27">Rabbit</button>
                        <button class="btn-secondary preset-btn" data-c="-0.8,0.156">Spiral</button>
                        <button class="btn-secondary preset-btn" data-c="-0.4,0.6">Dendrite</button>
                        <button class="btn-secondary preset-btn" data-c="0.285,0.01">Seahorse</button>
                        <button class="btn-secondary preset-btn" data-c="-0.123,0.745">Basilica</button>
                        <button class="btn-secondary preset-btn" data-c="-1,0">Cantor</button>
                        <button class="btn-secondary preset-btn" data-c="0,1">Dendrite</button>
                        <button class="btn-secondary preset-btn" data-c="-0.75,0">San Marco</button>
                        <button class="btn-secondary preset-btn" data-c="0.355,0.355">Spiral</button>
                    </div>
                </div>

                <div class="control-section">
                    <h3>Iterations</h3>
                    <div class="control-row">
                        <label>Max Iterations</label>
                        <input type="range" id="iterSlider" min="50" max="500" value="150">
                        <div class="value" id="iterValue">150</div>
                    </div>
                </div>

                <div class="control-section">
                    <h3>Color Scheme</h3>
                    <div class="btn-group">
                        <button class="btn-secondary" data-color="purple">Purple</button>
                        <button class="btn-secondary" data-color="fire">Fire</button>
                        <button class="btn-secondary" data-color="ocean">Ocean</button>
                        <button class="btn-secondary" data-color="mono">Mono</button>
                    </div>
                </div>

                <div class="control-section">
                    <h3>Animation</h3>
                    <div class="btn-group">
                        <button class="btn-primary" id="animateBtn">▶ Animate Through Mandelbrot</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="explanation">
            <div class="exp-card">
                <h3>The Mandelbrot-Julia Connection</h3>
                <div class="formula">z<sub>n+1</sub> = z<sub>n</sub>² + c</div>
                <p>The Mandelbrot set and Julia sets use the same formula, but differently! For Mandelbrot, c varies (the parameter); for Julia, c is fixed and z₀ varies. Each point in the Mandelbrot set corresponds to a connected Julia set—the Mandelbrot set is a "map of Julia sets"!</p>
            </div>

            <div class="exp-card">
                <h3>Connected vs Disconnected</h3>
                <p>This is the key theorem: if c is inside the Mandelbrot set, the Julia set is connected (one piece). If c is outside, the Julia set is totally disconnected—"fractal dust" with infinitely many pieces. The Mandelbrot boundary is exactly where Julia sets transition between these states!</p>
            </div>

            <div class="exp-card">
                <h3>Gaston Julia (1893-1978)</h3>
                <p>Julia discovered these sets in 1918 without computers! He won the Grand Prix of the French Academy but his work was forgotten for 60 years. Benoit Mandelbrot rediscovered it in the 1980s when computers finally allowed visualization of these mathematical objects.</p>
            </div>

            <div class="exp-card">
                <h3>The Paradox of Variety</h3>
                <p>From a single simple formula, an uncountably infinite collection of completely different fractals emerges. Move c slightly and the Julia set transforms dramatically—from smooth curves to wild dendrites to scattered dust. How can one equation encode such infinite variety?</p>
            </div>
        </div>
    </div>

    <script>
        const mandelbrotCanvas = document.getElementById('mandelbrotCanvas');
        const juliaCanvas = document.getElementById('juliaCanvas');
        const mCtx = mandelbrotCanvas.getContext('2d');
        const jCtx = juliaCanvas.getContext('2d');
        const cIndicator = document.getElementById('cIndicator');

        // Parameters
        let cReal = -0.7;
        let cImag = 0.27;
        let maxIter = 150;
        let colorScheme = 'purple';
        let isAnimating = false;
        let animationFrame = null;

        // View bounds
        const mandelbrotBounds = { xMin: -2.5, xMax: 1, yMin: -1.25, yMax: 1.25 };
        const juliaBounds = { xMin: -2, xMax: 2, yMin: -1.5, yMax: 1.5 };

        // Color schemes
        const colorSchemes = {
            purple: (t) => {
                const r = Math.min(255, 50 + t * 150);
                const g = Math.min(255, 30 + t * 80);
                const b = Math.min(255, 100 + t * 155);
                return [r, g, b];
            },
            fire: (t) => {
                const r = Math.min(255, t * 3 * 255);
                const g = Math.min(255, Math.max(0, (t - 0.33) * 3 * 255));
                const b = Math.min(255, Math.max(0, (t - 0.66) * 3 * 255));
                return [r, g, b];
            },
            ocean: (t) => {
                const r = Math.min(255, t * 100);
                const g = Math.min(255, 100 + t * 100);
                const b = Math.min(255, 150 + t * 105);
                return [r, g, b];
            },
            mono: (t) => {
                const v = Math.min(255, t * 255);
                return [v, v, v];
            }
        };

        function mandelbrotIter(cx, cy, maxIter) {
            let x = 0, y = 0;
            let iter = 0;

            while (x*x + y*y <= 4 && iter < maxIter) {
                const xTemp = x*x - y*y + cx;
                y = 2*x*y + cy;
                x = xTemp;
                iter++;
            }

            if (iter === maxIter) return -1;
            const logZn = Math.log(x*x + y*y) / 2;
            const nu = Math.log(logZn / Math.log(2)) / Math.log(2);
            return iter + 1 - nu;
        }

        function juliaIter(zx, zy, cx, cy, maxIter) {
            let x = zx, y = zy;
            let iter = 0;

            while (x*x + y*y <= 4 && iter < maxIter) {
                const xTemp = x*x - y*y + cx;
                y = 2*x*y + cy;
                x = xTemp;
                iter++;
            }

            if (iter === maxIter) return -1;
            const logZn = Math.log(x*x + y*y) / 2;
            const nu = Math.log(logZn / Math.log(2)) / Math.log(2);
            return iter + 1 - nu;
        }

        function drawMandelbrot() {
            const width = mandelbrotCanvas.width;
            const height = mandelbrotCanvas.height;
            const imageData = mCtx.createImageData(width, height);
            const data = imageData.data;
            const getColor = colorSchemes[colorScheme];

            for (let py = 0; py < height; py++) {
                for (let px = 0; px < width; px++) {
                    const cx = mandelbrotBounds.xMin + (px / width) * (mandelbrotBounds.xMax - mandelbrotBounds.xMin);
                    const cy = mandelbrotBounds.yMin + (py / height) * (mandelbrotBounds.yMax - mandelbrotBounds.yMin);

                    const result = mandelbrotIter(cx, cy, maxIter);
                    const idx = (py * width + px) * 4;

                    if (result < 0) {
                        data[idx] = data[idx + 1] = data[idx + 2] = 0;
                    } else {
                        const t = (result % 30) / 30;
                        const [r, g, b] = getColor(t);
                        data[idx] = r;
                        data[idx + 1] = g;
                        data[idx + 2] = b;
                    }
                    data[idx + 3] = 255;
                }
            }

            mCtx.putImageData(imageData, 0, 0);
            updateCIndicator();
        }

        function drawJulia() {
            const width = juliaCanvas.width;
            const height = juliaCanvas.height;
            const imageData = jCtx.createImageData(width, height);
            const data = imageData.data;
            const getColor = colorSchemes[colorScheme];

            for (let py = 0; py < height; py++) {
                for (let px = 0; px < width; px++) {
                    const zx = juliaBounds.xMin + (px / width) * (juliaBounds.xMax - juliaBounds.xMin);
                    const zy = juliaBounds.yMin + (py / height) * (juliaBounds.yMax - juliaBounds.yMin);

                    const result = juliaIter(zx, zy, cReal, cImag, maxIter);
                    const idx = (py * width + px) * 4;

                    if (result < 0) {
                        data[idx] = data[idx + 1] = data[idx + 2] = 0;
                    } else {
                        const t = (result % 30) / 30;
                        const [r, g, b] = getColor(t);
                        data[idx] = r;
                        data[idx + 1] = g;
                        data[idx + 2] = b;
                    }
                    data[idx + 3] = 255;
                }
            }

            jCtx.putImageData(imageData, 0, 0);
        }

        function updateCIndicator() {
            const container = document.getElementById('mandelbrotContainer');
            const rect = mandelbrotCanvas.getBoundingClientRect();

            const px = ((cReal - mandelbrotBounds.xMin) / (mandelbrotBounds.xMax - mandelbrotBounds.xMin)) * rect.width;
            const py = ((cImag - mandelbrotBounds.yMin) / (mandelbrotBounds.yMax - mandelbrotBounds.yMin)) * rect.height;

            cIndicator.style.left = px + 'px';
            cIndicator.style.top = py + 'px';
        }

        function updateDisplay() {
            document.getElementById('cReal').textContent = cReal.toFixed(3);
            document.getElementById('cImag').textContent = cImag.toFixed(3);

            // Check if c is in Mandelbrot set
            const inSet = mandelbrotIter(cReal, cImag, 200) < 0;
            const status = document.getElementById('connectionStatus');
            if (inSet) {
                status.innerHTML = '<span class="connected">● Connected Julia set</span>';
            } else {
                status.innerHTML = '<span class="disconnected">● Disconnected (dust)</span>';
            }
        }

        function setC(real, imag) {
            cReal = real;
            cImag = imag;
            updateDisplay();
            updateCIndicator();
            drawJulia();
        }

        // Click on Mandelbrot to set c
        mandelbrotCanvas.addEventListener('click', (e) => {
            const rect = mandelbrotCanvas.getBoundingClientRect();
            const x = (e.clientX - rect.left) / rect.width;
            const y = (e.clientY - rect.top) / rect.height;

            const cx = mandelbrotBounds.xMin + x * (mandelbrotBounds.xMax - mandelbrotBounds.xMin);
            const cy = mandelbrotBounds.yMin + y * (mandelbrotBounds.yMax - mandelbrotBounds.yMin);

            setC(cx, cy);
        });

        // Hover preview
        mandelbrotCanvas.addEventListener('mousemove', (e) => {
            if (isAnimating) return;
            // Could add hover preview here
        });

        // Preset buttons
        document.querySelectorAll('.preset-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                const [real, imag] = btn.dataset.c.split(',').map(Number);
                setC(real, imag);
            });
        });

        // Iteration slider
        document.getElementById('iterSlider').addEventListener('input', (e) => {
            maxIter = parseInt(e.target.value);
            document.getElementById('iterValue').textContent = maxIter;
            drawMandelbrot();
            drawJulia();
        });

        // Color scheme buttons
        document.querySelectorAll('[data-color]').forEach(btn => {
            btn.addEventListener('click', () => {
                colorScheme = btn.dataset.color;
                drawMandelbrot();
                drawJulia();
            });
        });

        // Animation
        document.getElementById('animateBtn').addEventListener('click', () => {
            if (isAnimating) {
                isAnimating = false;
                document.getElementById('animateBtn').textContent = '▶ Animate Through Mandelbrot';
                return;
            }

            isAnimating = true;
            document.getElementById('animateBtn').textContent = '⏸ Stop Animation';

            let angle = 0;
            const radius = 0.75;
            const centerX = -0.5;
            const centerY = 0;

            function animStep() {
                if (!isAnimating) return;

                angle += 0.02;
                const cx = centerX + radius * Math.cos(angle);
                const cy = centerY + radius * Math.sin(angle);

                setC(cx, cy);

                animationFrame = requestAnimationFrame(animStep);
            }

            animStep();
        });

        // Window resize
        window.addEventListener('resize', updateCIndicator);

        // Initial render
        drawMandelbrot();
        drawJulia();
        updateDisplay();
    </script>
</body>
</html>
