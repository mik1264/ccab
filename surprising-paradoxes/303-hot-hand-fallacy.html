<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Hot Hand Fallacy - Are Streaks Real?</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            min-height: 100vh;
            color: #e0e0e0;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            padding: 30px 0;
        }

        h1 {
            font-size: 2.5rem;
            background: linear-gradient(135deg, #ff6b35, #f7c948);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
        }

        .subtitle {
            color: #aaa;
            font-size: 1.2rem;
            font-style: italic;
        }

        .back-link {
            position: fixed;
            top: 20px;
            left: 20px;
            color: #f7c948;
            text-decoration: none;
            font-size: 1rem;
            z-index: 100;
            background: rgba(0,0,0,0.5);
            padding: 8px 15px;
            border-radius: 20px;
        }

        .back-link:hover {
            background: rgba(247, 201, 72, 0.2);
        }

        .tabs {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .tab {
            padding: 10px 25px;
            background: rgba(255,255,255,0.1);
            border: none;
            border-radius: 25px;
            color: #aaa;
            cursor: pointer;
            font-size: 0.95rem;
            transition: all 0.3s;
        }

        .tab:hover {
            background: rgba(255,255,255,0.15);
        }

        .tab.active {
            background: linear-gradient(135deg, #ff6b35, #f7c948);
            color: #1a1a2e;
            font-weight: bold;
        }

        .panel {
            background: rgba(255,255,255,0.08);
            border-radius: 15px;
            padding: 25px;
            border: 1px solid rgba(255,255,255,0.1);
            display: none;
        }

        .panel.active {
            display: block;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 300px;
            gap: 25px;
        }

        .sequence-display {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin: 20px 0;
            justify-content: center;
        }

        .shot {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.2rem;
            transition: transform 0.2s;
        }

        .shot.made {
            background: linear-gradient(135deg, #4ade80, #22c55e);
            color: #fff;
        }

        .shot.missed {
            background: linear-gradient(135deg, #f87171, #ef4444);
            color: #fff;
        }

        .shot.pending {
            background: rgba(255,255,255,0.2);
            color: #888;
        }

        .btn {
            background: linear-gradient(135deg, #ff6b35, #f7c948);
            color: #1a1a2e;
            border: none;
            padding: 12px 30px;
            font-size: 1.1rem;
            font-weight: bold;
            border-radius: 25px;
            cursor: pointer;
            margin: 10px 5px;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(247, 201, 72, 0.3);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .btn-secondary {
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
        }

        .side-panel {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .info-card {
            background: rgba(255,255,255,0.08);
            border-radius: 15px;
            padding: 20px;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .info-card h3 {
            color: #f7c948;
            margin-bottom: 15px;
            font-size: 1.1rem;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        .stat-box {
            background: rgba(0,0,0,0.3);
            padding: 12px;
            border-radius: 8px;
            text-align: center;
        }

        .stat-value {
            font-size: 1.5rem;
            color: #f7c948;
            font-weight: bold;
        }

        .stat-label {
            font-size: 0.75rem;
            color: #888;
            margin-top: 3px;
        }

        .streak-indicator {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
        }

        .streak-indicator.hot {
            background: linear-gradient(135deg, rgba(255,107,53,0.3), rgba(247,201,72,0.3));
            border: 1px solid #f7c948;
        }

        .streak-indicator.cold {
            background: linear-gradient(135deg, rgba(99,102,241,0.3), rgba(139,92,246,0.3));
            border: 1px solid #8b5cf6;
        }

        .streak-indicator.neutral {
            background: rgba(255,255,255,0.1);
        }

        .flame-icon {
            font-size: 2rem;
        }

        .question-card {
            background: rgba(0,0,0,0.3);
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
        }

        .question-text {
            font-size: 1.2rem;
            margin-bottom: 20px;
            color: #f7c948;
        }

        .choice-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .choice-btn {
            padding: 15px 30px;
            background: rgba(255,255,255,0.1);
            border: 2px solid rgba(255,255,255,0.2);
            border-radius: 10px;
            color: #e0e0e0;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s;
        }

        .choice-btn:hover {
            background: rgba(255,255,255,0.2);
            border-color: #f7c948;
        }

        .choice-btn.correct {
            background: rgba(74, 222, 128, 0.3);
            border-color: #4ade80;
        }

        .choice-btn.incorrect {
            background: rgba(248, 113, 113, 0.3);
            border-color: #f87171;
        }

        .explanation-box {
            background: linear-gradient(135deg, rgba(99,102,241,0.2), rgba(139,92,246,0.2));
            border: 1px solid #8b5cf6;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
        }

        .coin-container {
            display: flex;
            justify-content: center;
            gap: 5px;
            flex-wrap: wrap;
            margin: 20px 0;
            max-height: 200px;
            overflow-y: auto;
            padding: 10px;
            background: rgba(0,0,0,0.2);
            border-radius: 10px;
        }

        .coin {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            font-weight: bold;
        }

        .coin.heads {
            background: #f7c948;
            color: #1a1a2e;
        }

        .coin.tails {
            background: #6366f1;
            color: #fff;
        }

        .streak-highlight {
            padding: 8px 15px;
            border-radius: 20px;
            display: inline-block;
            margin: 5px;
            font-size: 0.9rem;
        }

        .streak-highlight.long {
            background: linear-gradient(135deg, #ff6b35, #f7c948);
            color: #1a1a2e;
        }

        .probability-bar {
            height: 30px;
            background: rgba(255,255,255,0.1);
            border-radius: 15px;
            overflow: hidden;
            margin: 10px 0;
        }

        .probability-fill {
            height: 100%;
            background: linear-gradient(90deg, #ff6b35, #f7c948);
            display: flex;
            align-items: center;
            padding-left: 10px;
            font-weight: bold;
            color: #1a1a2e;
            transition: width 0.5s ease;
        }

        .basketball-court {
            background: linear-gradient(180deg, #c2410c 0%, #ea580c 100%);
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            position: relative;
            min-height: 200px;
        }

        .hoop {
            width: 60px;
            height: 60px;
            border: 4px solid #fff;
            border-radius: 50%;
            margin: 0 auto 20px;
            position: relative;
        }

        .hoop::after {
            content: '';
            position: absolute;
            bottom: -20px;
            left: 50%;
            transform: translateX(-50%);
            width: 50px;
            height: 20px;
            border: 3px solid #fff;
            border-top: none;
            border-radius: 0 0 5px 5px;
        }

        .shoot-btn {
            padding: 20px 50px;
            font-size: 1.5rem;
            margin-top: 20px;
        }

        .timeline {
            padding: 20px 0;
        }

        .timeline-item {
            display: flex;
            gap: 20px;
            margin: 15px 0;
            padding: 15px;
            background: rgba(0,0,0,0.2);
            border-radius: 10px;
            border-left: 4px solid #f7c948;
        }

        .timeline-year {
            color: #f7c948;
            font-weight: bold;
            min-width: 60px;
        }

        .timeline-content h4 {
            color: #e0e0e0;
            margin-bottom: 5px;
        }

        .timeline-content p {
            color: #888;
            font-size: 0.9rem;
        }

        .verdict-box {
            background: linear-gradient(135deg, rgba(74,222,128,0.2), rgba(34,197,94,0.2));
            border: 2px solid #4ade80;
            border-radius: 12px;
            padding: 25px;
            margin: 20px 0;
            text-align: center;
        }

        .verdict-title {
            font-size: 1.5rem;
            color: #4ade80;
            margin-bottom: 10px;
        }

        .score-display {
            font-size: 3rem;
            font-weight: bold;
            color: #f7c948;
            margin: 10px 0;
        }

        .round-counter {
            color: #888;
            font-size: 0.9rem;
            margin-bottom: 15px;
        }

        .hidden {
            display: none !important;
        }

        @media (max-width: 900px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <a href="index.html" class="back-link">‚Üê Back to Gallery</a>

    <div class="container">
        <header>
            <h1>The Hot Hand Fallacy</h1>
            <p class="subtitle">When You're on Fire... or Are You?</p>
        </header>

        <div class="tabs">
            <button class="tab active" data-tab="detect">Spot the Streak</button>
            <button class="tab" data-tab="simulate">Streak Simulator</button>
            <button class="tab" data-tab="shoot">Take Shots</button>
            <button class="tab" data-tab="history">The Twist</button>
        </div>

        <div class="main-content">
            <div>
                <!-- DETECT TAB -->
                <div class="panel active" id="detect-panel">
                    <h2 style="color: #f7c948; margin-bottom: 15px;">Can You Detect the "Hot Hand"?</h2>
                    <p>One sequence below was generated by a real basketball player with a "hot hand." The other is purely random coin flips (H=hit, T=miss). Can you tell which is which?</p>

                    <div class="round-counter" id="roundCounter">Round 1 of 10</div>

                    <div class="question-card">
                        <p style="color: #888; margin-bottom: 10px;">Sequence A:</p>
                        <div class="sequence-display" id="sequenceA"></div>
                        <p style="color: #888; margin-bottom: 10px; margin-top: 20px;">Sequence B:</p>
                        <div class="sequence-display" id="sequenceB"></div>

                        <div class="question-text">Which sequence shows the "hot hand" player?</div>
                        <div class="choice-buttons">
                            <button class="choice-btn" data-choice="A">Sequence A</button>
                            <button class="choice-btn" data-choice="B">Sequence B</button>
                            <button class="choice-btn" data-choice="same">Can't Tell / Both Random</button>
                        </div>
                    </div>

                    <div class="explanation-box hidden" id="detectExplanation">
                        <h3 style="color: #8b5cf6; margin-bottom: 10px;">The Truth</h3>
                        <p id="detectExplanationText"></p>
                    </div>

                    <div style="text-align: center;">
                        <button class="btn hidden" id="nextRound">Next Round ‚Üí</button>
                        <button class="btn hidden" id="showDetectResults">View Results</button>
                    </div>

                    <div class="verdict-box hidden" id="detectResults">
                        <div class="verdict-title">Your Detection Score</div>
                        <div class="score-display" id="finalScore">0/10</div>
                        <p id="scoreInterpretation"></p>
                    </div>
                </div>

                <!-- SIMULATE TAB -->
                <div class="panel" id="simulate-panel">
                    <h2 style="color: #f7c948; margin-bottom: 15px;">Streak Simulator</h2>
                    <p>Flip 100 fair coins and see how often "streaks" appear purely by chance. Streaks of 5+ are highlighted.</p>

                    <div style="text-align: center; margin: 20px 0;">
                        <button class="btn" id="flipCoins">Flip 100 Coins</button>
                        <button class="btn btn-secondary" id="flipMany">Flip 1000 Sets</button>
                    </div>

                    <div class="coin-container" id="coinContainer"></div>

                    <div id="streakStats" class="hidden">
                        <h3 style="color: #f7c948; margin: 20px 0 10px;">Streak Analysis</h3>
                        <div class="stats-grid">
                            <div class="stat-box">
                                <div class="stat-value" id="longestStreak">0</div>
                                <div class="stat-label">Longest Streak</div>
                            </div>
                            <div class="stat-box">
                                <div class="stat-value" id="streaksOf5">0</div>
                                <div class="stat-label">Streaks of 5+</div>
                            </div>
                            <div class="stat-box">
                                <div class="stat-value" id="streaksOf4">0</div>
                                <div class="stat-label">Streaks of 4+</div>
                            </div>
                            <div class="stat-box">
                                <div class="stat-value" id="avgExpected">‚Äî</div>
                                <div class="stat-label">Expected Longest</div>
                            </div>
                        </div>

                        <div class="explanation-box" style="margin-top: 20px;">
                            <h4 style="color: #8b5cf6;">The Math of Streaks</h4>
                            <p style="margin-top: 10px;">In 100 coin flips, you should expect:</p>
                            <ul style="margin: 10px 0 0 20px; color: #aaa;">
                                <li>A longest streak of ~7 flips (on average)</li>
                                <li>Multiple streaks of 4-5 in a row</li>
                                <li>These feel "non-random" but are perfectly normal!</li>
                            </ul>
                        </div>
                    </div>

                    <div id="manyFlipsResults" class="hidden">
                        <h3 style="color: #f7c948; margin: 20px 0 10px;">1000 Sets of 100 Flips</h3>
                        <div id="distributionChart"></div>
                        <p style="color: #888; text-align: center; margin-top: 10px;">
                            Distribution of longest streaks across 1000 simulations
                        </p>
                    </div>
                </div>

                <!-- SHOOT TAB -->
                <div class="panel" id="shoot-panel">
                    <h2 style="color: #f7c948; margin-bottom: 15px;">Take 20 Shots</h2>
                    <p>Each shot has a 50% chance of success (like a coin flip). But notice how you'll "feel" hot or cold streaks!</p>

                    <div class="basketball-court">
                        <div class="hoop"></div>
                        <div class="sequence-display" id="shotSequence"></div>

                        <div class="streak-indicator neutral" id="streakIndicator">
                            <span class="flame-icon" id="flameIcon">üèÄ</span>
                            <span id="streakText">Ready to shoot!</span>
                        </div>

                        <button class="btn shoot-btn" id="shootBtn">SHOOT!</button>
                    </div>

                    <div id="shootStats" class="stats-grid" style="margin-top: 20px;">
                        <div class="stat-box">
                            <div class="stat-value" id="shotsMade">0</div>
                            <div class="stat-label">Made</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-value" id="shotsMissed">0</div>
                            <div class="stat-label">Missed</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-value" id="currentStreak">0</div>
                            <div class="stat-label">Current Streak</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-value" id="maxStreak">0</div>
                            <div class="stat-label">Best Streak</div>
                        </div>
                    </div>

                    <div class="explanation-box hidden" id="shootExplanation">
                        <h3 style="color: #8b5cf6; margin-bottom: 10px;">Analysis of Your 20 Shots</h3>
                        <p id="shootAnalysis"></p>
                        <p style="margin-top: 15px; color: #888;">
                            Even though each shot was exactly 50%, streaks create the powerful <em>feeling</em> of being "hot" or "cold." This is why players and fans believe in the hot hand‚Äîthe experience feels real!
                        </p>
                    </div>

                    <div style="text-align: center; margin-top: 15px;">
                        <button class="btn btn-secondary hidden" id="resetShots">Try Again</button>
                    </div>
                </div>

                <!-- HISTORY TAB -->
                <div class="panel" id="history-panel">
                    <h2 style="color: #f7c948; margin-bottom: 15px;">The Hot Hand Story: A Scientific Twist</h2>

                    <div class="timeline">
                        <div class="timeline-item">
                            <div class="timeline-year">1985</div>
                            <div class="timeline-content">
                                <h4>The "Debunking"</h4>
                                <p>Gilovich, Vallone, and Tversky analyze 76ers free throws. Finding: NO evidence of hot hand beyond chance. Players who just made shots are NOT more likely to make the next one. The hot hand is declared a "cognitive illusion."</p>
                            </div>
                        </div>

                        <div class="timeline-item">
                            <div class="timeline-year">1985-2014</div>
                            <div class="timeline-content">
                                <h4>Scientific Consensus</h4>
                                <p>For 30 years, "the hot hand is a fallacy" becomes textbook knowledge. Players, coaches, and fans who believe in streaks are told they're suffering from pattern-seeking bias. The study is cited over 2,000 times.</p>
                            </div>
                        </div>

                        <div class="timeline-item" style="border-left-color: #4ade80;">
                            <div class="timeline-year">2015</div>
                            <div class="timeline-content">
                                <h4>The Statistical Discovery</h4>
                                <p>Miller & Sanjurjo find a subtle but critical flaw: <strong>selection bias</strong>. When you look at shots that followed a made shot, you're selecting from a biased sample. The math shows the original study actually found evidence FOR a small hot hand effect!</p>
                            </div>
                        </div>

                        <div class="timeline-item" style="border-left-color: #4ade80;">
                            <div class="timeline-year">2018+</div>
                            <div class="timeline-content">
                                <h4>Vindication</h4>
                                <p>Re-analysis of NBA data with corrected methods suggests a real but small hot hand effect (2-3% improved probability after makes). The players were right all along‚Äîthey could detect something the original statistics missed!</p>
                            </div>
                        </div>
                    </div>

                    <div class="explanation-box">
                        <h3 style="color: #8b5cf6;">The Selection Bias Problem</h3>
                        <p style="margin: 10px 0;">Imagine flipping a coin 3 times. If you only look at flips that came AFTER heads, you're not sampling fairly!</p>
                        <p style="margin: 10px 0;">Possible sequences: HHH, HHT, HTH, HTT, THH, THT, TTH, TTT</p>
                        <p style="margin: 10px 0;">Flips after H: From HH<strong>H</strong>, HH<strong>T</strong>, HT<strong>H</strong>, TH<strong>H</strong>, TH<strong>T</strong></p>
                        <p style="color: #f7c948;">Expected: 50% heads after heads. Actual: Only 40%! The selection creates bias.</p>
                    </div>

                    <div class="verdict-box">
                        <div class="verdict-title">The Verdict</div>
                        <p style="font-size: 1.1rem; margin: 10px 0;">
                            The hot hand appears to be <strong>real but small</strong>.
                        </p>
                        <p style="color: #888;">
                            Players' intuitions were more accurate than 30 years of scientific consensus. But the effect is subtle (~2-3%), not the dramatic streaks we perceive. Our pattern-seeking still exaggerates‚Äîwe just weren't completely wrong.
                        </p>
                    </div>
                </div>
            </div>

            <div class="side-panel">
                <div class="info-card">
                    <h3>What is the Hot Hand?</h3>
                    <p style="font-size: 0.9rem; color: #aaa; line-height: 1.6;">
                        The belief that a player who has made several shots in a row is more likely to make their next shot‚Äîthey're "on fire" or "in the zone."
                        <br><br>
                        <strong>91%</strong> of basketball fans believe in it.<br>
                        <strong>96%</strong> of players claim to experience it.
                    </p>
                </div>

                <div class="info-card">
                    <h3>Session Stats</h3>
                    <div class="stats-grid">
                        <div class="stat-box">
                            <div class="stat-value" id="detectAccuracy">‚Äî</div>
                            <div class="stat-label">Detection Rate</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-value" id="coinsFlipped">0</div>
                            <div class="stat-label">Coins Flipped</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-value" id="shotsTaken">0</div>
                            <div class="stat-label">Shots Taken</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-value" id="longestEver">0</div>
                            <div class="stat-label">Longest Streak</div>
                        </div>
                    </div>
                </div>

                <div class="info-card">
                    <h3>Key Insight</h3>
                    <p style="font-size: 0.9rem; color: #aaa; line-height: 1.6;">
                        Streaks FEEL special because our brains are pattern-seeking machines. We remember the hits and forget the misses. Even in pure randomness, impressive streaks occur regularly‚Äîbut they still trigger our "hot hand" intuition.
                    </p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Tab switching
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', () => {
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.panel').forEach(p => p.classList.remove('active'));
                tab.classList.add('active');
                document.getElementById(tab.dataset.tab + '-panel').classList.add('active');
            });
        });

        // ========== DETECT GAME ==========
        let detectRound = 0;
        let detectCorrect = 0;
        const totalRounds = 10;

        function generateSequence(length, isRandom) {
            const seq = [];
            // Both are actually random! That's the point.
            for (let i = 0; i < length; i++) {
                seq.push(Math.random() < 0.5 ? 'H' : 'M');
            }
            return seq;
        }

        function displaySequence(containerId, sequence) {
            const container = document.getElementById(containerId);
            container.innerHTML = '';
            sequence.forEach(s => {
                const shot = document.createElement('div');
                shot.className = 'shot ' + (s === 'H' ? 'made' : 'missed');
                shot.textContent = s;
                container.appendChild(shot);
            });
        }

        function newDetectRound() {
            detectRound++;
            document.getElementById('roundCounter').textContent = `Round ${detectRound} of ${totalRounds}`;

            const seqA = generateSequence(20, true);
            const seqB = generateSequence(20, true);

            displaySequence('sequenceA', seqA);
            displaySequence('sequenceB', seqB);

            // Reset UI
            document.getElementById('detectExplanation').classList.add('hidden');
            document.getElementById('nextRound').classList.add('hidden');
            document.getElementById('showDetectResults').classList.add('hidden');
            document.querySelectorAll('.choice-btn').forEach(btn => {
                btn.classList.remove('correct', 'incorrect');
                btn.disabled = false;
            });
        }

        document.querySelectorAll('.choice-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                // The correct answer is always "Can't Tell" because both are random!
                const isCorrect = btn.dataset.choice === 'same';

                if (isCorrect) {
                    btn.classList.add('correct');
                    detectCorrect++;
                } else {
                    btn.classList.add('incorrect');
                    document.querySelector('[data-choice="same"]').classList.add('correct');
                }

                document.querySelectorAll('.choice-btn').forEach(b => b.disabled = true);

                document.getElementById('detectExplanation').classList.remove('hidden');
                document.getElementById('detectExplanationText').textContent =
                    "BOTH sequences were randomly generated! There was no 'hot hand' player. " +
                    (isCorrect ?
                        "You correctly recognized that streaks appear in random data." :
                        "The streaks you saw in one sequence were just normal random variation. Our brains are wired to see patterns even where none exist.");

                if (detectRound < totalRounds) {
                    document.getElementById('nextRound').classList.remove('hidden');
                } else {
                    document.getElementById('showDetectResults').classList.remove('hidden');
                }

                document.getElementById('detectAccuracy').textContent =
                    Math.round(detectCorrect / detectRound * 100) + '%';
            });
        });

        document.getElementById('nextRound').addEventListener('click', newDetectRound);

        document.getElementById('showDetectResults').addEventListener('click', () => {
            document.getElementById('detectResults').classList.remove('hidden');
            document.getElementById('finalScore').textContent = `${detectCorrect}/${totalRounds}`;

            let interpretation;
            if (detectCorrect >= 8) {
                interpretation = "Excellent! You understand that streaks appear naturally in random sequences.";
            } else if (detectCorrect >= 5) {
                interpretation = "You're catching on. Random sequences contain more streaks than we expect.";
            } else {
                interpretation = "You fell for the pattern trap! This is exactly why the hot hand 'fallacy' was so convincing‚Äîrandom sequences look non-random to our pattern-seeking brains.";
            }
            document.getElementById('scoreInterpretation').textContent = interpretation;
        });

        // Initialize first round
        newDetectRound();

        // ========== COIN SIMULATOR ==========
        let totalCoinsFlipped = 0;

        function flipCoins(count) {
            const results = [];
            for (let i = 0; i < count; i++) {
                results.push(Math.random() < 0.5 ? 'H' : 'T');
            }
            return results;
        }

        function findStreaks(sequence) {
            let streaks = [];
            let currentStreak = 1;
            let currentType = sequence[0];

            for (let i = 1; i < sequence.length; i++) {
                if (sequence[i] === currentType) {
                    currentStreak++;
                } else {
                    if (currentStreak >= 3) {
                        streaks.push({ type: currentType, length: currentStreak, start: i - currentStreak });
                    }
                    currentStreak = 1;
                    currentType = sequence[i];
                }
            }
            if (currentStreak >= 3) {
                streaks.push({ type: currentType, length: currentStreak, start: sequence.length - currentStreak });
            }
            return streaks;
        }

        function displayCoins(results) {
            const container = document.getElementById('coinContainer');
            container.innerHTML = '';

            const streaks = findStreaks(results);
            const inStreak = new Set();
            streaks.filter(s => s.length >= 5).forEach(s => {
                for (let i = s.start; i < s.start + s.length; i++) {
                    inStreak.add(i);
                }
            });

            results.forEach((r, i) => {
                const coin = document.createElement('div');
                coin.className = 'coin ' + (r === 'H' ? 'heads' : 'tails');
                if (inStreak.has(i)) {
                    coin.style.boxShadow = '0 0 10px #f7c948';
                    coin.style.transform = 'scale(1.1)';
                }
                coin.textContent = r;
                container.appendChild(coin);
            });

            return streaks;
        }

        document.getElementById('flipCoins').addEventListener('click', () => {
            const results = flipCoins(100);
            totalCoinsFlipped += 100;
            document.getElementById('coinsFlipped').textContent = totalCoinsFlipped;

            const streaks = displayCoins(results);

            const longest = streaks.length > 0 ? Math.max(...streaks.map(s => s.length)) : 1;
            const of5 = streaks.filter(s => s.length >= 5).length;
            const of4 = streaks.filter(s => s.length >= 4).length;

            document.getElementById('longestStreak').textContent = longest;
            document.getElementById('streaksOf5').textContent = of5;
            document.getElementById('streaksOf4').textContent = of4;
            document.getElementById('avgExpected').textContent = '~7';

            if (longest > parseInt(document.getElementById('longestEver').textContent)) {
                document.getElementById('longestEver').textContent = longest;
            }

            document.getElementById('streakStats').classList.remove('hidden');
            document.getElementById('manyFlipsResults').classList.add('hidden');
        });

        document.getElementById('flipMany').addEventListener('click', () => {
            const distribution = {};
            for (let i = 0; i < 1000; i++) {
                const results = flipCoins(100);
                const streaks = findStreaks(results);
                const longest = streaks.length > 0 ? Math.max(...streaks.map(s => s.length)) : 1;
                distribution[longest] = (distribution[longest] || 0) + 1;
            }

            totalCoinsFlipped += 100000;
            document.getElementById('coinsFlipped').textContent = totalCoinsFlipped.toLocaleString();

            const chartContainer = document.getElementById('distributionChart');
            chartContainer.innerHTML = '';

            const maxCount = Math.max(...Object.values(distribution));

            for (let len = 4; len <= 12; len++) {
                const count = distribution[len] || 0;
                const width = (count / maxCount) * 100;

                chartContainer.innerHTML += `
                    <div style="margin: 8px 0;">
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <span style="width: 30px; text-align: right;">${len}:</span>
                            <div class="probability-bar" style="flex: 1;">
                                <div class="probability-fill" style="width: ${width}%;">${count}</div>
                            </div>
                            <span style="width: 50px; color: #888;">${(count/10).toFixed(1)}%</span>
                        </div>
                    </div>
                `;
            }

            document.getElementById('streakStats').classList.add('hidden');
            document.getElementById('manyFlipsResults').classList.remove('hidden');
            document.getElementById('coinContainer').innerHTML = '';
        });

        // ========== SHOOTING GAME ==========
        let shots = [];
        let currentStreakCount = 0;
        let currentStreakType = null;
        let maxStreakCount = 0;
        let totalShotsTaken = 0;

        function updateShootUI() {
            document.getElementById('shotsMade').textContent = shots.filter(s => s === 'made').length;
            document.getElementById('shotsMissed').textContent = shots.filter(s => s === 'missed').length;
            document.getElementById('currentStreak').textContent = currentStreakCount;
            document.getElementById('maxStreak').textContent = maxStreakCount;
            document.getElementById('shotsTaken').textContent = totalShotsTaken;

            const indicator = document.getElementById('streakIndicator');
            const flame = document.getElementById('flameIcon');
            const text = document.getElementById('streakText');

            if (currentStreakCount >= 4 && currentStreakType === 'made') {
                indicator.className = 'streak-indicator hot';
                flame.textContent = 'üî•';
                text.textContent = `ON FIRE! ${currentStreakCount} in a row!`;
            } else if (currentStreakCount >= 4 && currentStreakType === 'missed') {
                indicator.className = 'streak-indicator cold';
                flame.textContent = '‚ùÑÔ∏è';
                text.textContent = `Ice cold! ${currentStreakCount} misses in a row`;
            } else if (currentStreakCount >= 2 && currentStreakType === 'made') {
                indicator.className = 'streak-indicator hot';
                flame.textContent = 'üèÄ';
                text.textContent = `Getting hot! ${currentStreakCount} makes`;
            } else {
                indicator.className = 'streak-indicator neutral';
                flame.textContent = 'üèÄ';
                text.textContent = shots.length === 0 ? 'Ready to shoot!' : 'Keep shooting...';
            }
        }

        function displayShots() {
            const container = document.getElementById('shotSequence');
            container.innerHTML = '';
            shots.forEach(s => {
                const shot = document.createElement('div');
                shot.className = 'shot ' + s;
                shot.textContent = s === 'made' ? '‚úì' : '‚úó';
                container.appendChild(shot);
            });
        }

        document.getElementById('shootBtn').addEventListener('click', () => {
            if (shots.length >= 20) return;

            const made = Math.random() < 0.5;
            const result = made ? 'made' : 'missed';
            shots.push(result);
            totalShotsTaken++;

            if (result === currentStreakType) {
                currentStreakCount++;
            } else {
                currentStreakType = result;
                currentStreakCount = 1;
            }

            if (currentStreakCount > maxStreakCount) {
                maxStreakCount = currentStreakCount;
                if (maxStreakCount > parseInt(document.getElementById('longestEver').textContent)) {
                    document.getElementById('longestEver').textContent = maxStreakCount;
                }
            }

            displayShots();
            updateShootUI();

            if (shots.length >= 20) {
                document.getElementById('shootBtn').disabled = true;
                document.getElementById('shootExplanation').classList.remove('hidden');
                document.getElementById('resetShots').classList.remove('hidden');

                const made = shots.filter(s => s === 'made').length;
                const pct = Math.round(made / 20 * 100);

                document.getElementById('shootAnalysis').textContent =
                    `You made ${made}/20 shots (${pct}%). Your longest streak was ${maxStreakCount}. ` +
                    `Each shot had exactly 50% probability, but ${maxStreakCount >= 4 ? "you likely felt 'hot' during your streak!" : "streaks still influenced how you felt about your performance."}`;
            }
        });

        document.getElementById('resetShots').addEventListener('click', () => {
            shots = [];
            currentStreakCount = 0;
            currentStreakType = null;
            maxStreakCount = 0;
            displayShots();
            updateShootUI();
            document.getElementById('shootBtn').disabled = false;
            document.getElementById('shootExplanation').classList.add('hidden');
            document.getElementById('resetShots').classList.add('hidden');
        });

        updateShootUI();
    </script>
</body>
</html>
