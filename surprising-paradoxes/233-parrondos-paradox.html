<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Parrondo's Paradox - Winning with Losing Games</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Georgia', serif;
            background: linear-gradient(135deg, #1a2a1a 0%, #0d1a0d 100%);
            color: #e0e0e0;
            min-height: 100vh;
            padding: 20px;
        }
        .container { max-width: 1400px; margin: 0 auto; }
        header { text-align: center; margin-bottom: 30px; }
        .back-link { color: #90ee90; text-decoration: none; margin-bottom: 20px; display: inline-block; }
        h1 {
            font-size: 2.4rem;
            background: linear-gradient(135deg, #ff6b6b, #4ecdc4);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
        }
        .subtitle { font-size: 1.1rem; color: #90ee90; max-width: 750px; margin: 0 auto; line-height: 1.6; }
        .main-grid { display: grid; grid-template-columns: 2fr 1fr; gap: 30px; margin-bottom: 30px; }
        .panel {
            background: rgba(30, 50, 30, 0.6);
            border-radius: 15px;
            padding: 25px;
            border: 1px solid rgba(144, 238, 144, 0.3);
        }
        .panel h2 { color: #4ecdc4; font-size: 1.3rem; margin-bottom: 15px; }
        canvas { width: 100%; height: 300px; background: rgba(10, 25, 10, 0.6); border-radius: 10px; }
        .controls { display: flex; gap: 10px; margin: 20px 0; justify-content: center; flex-wrap: wrap; }
        .control-btn {
            padding: 10px 18px;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            font-family: inherit;
            font-size: 0.9rem;
            transition: all 0.3s;
        }
        .control-btn.game-a { background: #ff6b6b; color: white; }
        .control-btn.game-b { background: #feca57; color: #1a2a1a; }
        .control-btn.mixed { background: #4ecdc4; color: #1a2a1a; }
        .control-btn.random { background: #a855f7; color: white; }
        .control-btn:hover { transform: scale(1.05); }
        .results-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; margin: 20px 0; }
        .result-box { background: rgba(10, 25, 10, 0.6); padding: 15px; border-radius: 10px; text-align: center; }
        .result-value { font-size: 1.4rem; font-weight: bold; }
        .result-value.positive { color: #4ecdc4; }
        .result-value.negative { color: #ff6b6b; }
        .result-label { color: #90ee90; font-size: 0.8rem; margin-top: 5px; }
        .game-rules { background: rgba(10, 25, 10, 0.6); border-radius: 10px; padding: 15px; margin-top: 15px; }
        .game-rules h3 { color: #feca57; margin-bottom: 10px; font-size: 1rem; }
        .game-rules p { color: #b0d0b0; font-size: 0.9rem; line-height: 1.6; }
        .probability { font-weight: bold; }
        .prob-bad { color: #ff6b6b; }
        .prob-good { color: #4ecdc4; }
        .capital-display {
            text-align: center;
            padding: 20px;
            background: rgba(10, 25, 10, 0.8);
            border-radius: 10px;
            margin: 15px 0;
        }
        .capital-amount { font-size: 2.5rem; font-weight: bold; }
        .capital-amount.positive { color: #4ecdc4; }
        .capital-amount.negative { color: #ff6b6b; }
        .insight-box {
            background: linear-gradient(135deg, rgba(78, 205, 196, 0.2), rgba(254, 202, 87, 0.1));
            border-left: 4px solid #4ecdc4;
            padding: 20px;
            border-radius: 0 10px 10px 0;
            margin: 25px 0;
        }
        .insight-box h3 { color: #feca57; margin-bottom: 10px; }
        .explanation { background: rgba(30, 50, 30, 0.4); border-radius: 15px; padding: 25px; margin-top: 30px; }
        .explanation h2 { color: #4ecdc4; margin-bottom: 15px; }
        .explanation p { color: #b0d0b0; line-height: 1.8; margin-bottom: 15px; }
        @media (max-width: 900px) { .main-grid { grid-template-columns: 1fr; } .results-grid { grid-template-columns: repeat(2, 1fr); } }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <a href="index.html" class="back-link">Back to Surprising Paradoxes</a>
            <h1>Parrondo's Paradox</h1>
            <p class="subtitle">Two LOSING games combine into a WINNING strategy! Play each game alone and lose. Alternate between them... and win?!</p>
        </header>

        <div class="main-grid">
            <div class="panel">
                <h2>Capital Over Time</h2>
                <canvas id="graphCanvas"></canvas>
                <div class="controls">
                    <button class="control-btn game-a" id="playA">Play 100 Game A</button>
                    <button class="control-btn game-b" id="playB">Play 100 Game B</button>
                    <button class="control-btn mixed" id="playABB">Play ABB Pattern</button>
                    <button class="control-btn random" id="playRandom">Play Random Mix</button>
                    <button class="control-btn" style="background: #666; color: white;" id="reset">Reset</button>
                </div>
                <div class="results-grid">
                    <div class="result-box">
                        <div class="result-value" id="resultA">--</div>
                        <div class="result-label">Game A Only</div>
                    </div>
                    <div class="result-box">
                        <div class="result-value" id="resultB">--</div>
                        <div class="result-label">Game B Only</div>
                    </div>
                    <div class="result-box">
                        <div class="result-value" id="resultABB">--</div>
                        <div class="result-label">ABB Pattern</div>
                    </div>
                    <div class="result-box">
                        <div class="result-value" id="resultRandom">--</div>
                        <div class="result-label">Random Mix</div>
                    </div>
                </div>
            </div>
            <div class="panel">
                <h2>The Games</h2>
                <div class="capital-display">
                    <div>Current Capital</div>
                    <div class="capital-amount" id="capital">$0</div>
                </div>
                <div class="game-rules">
                    <h3>Game A (Biased Coin)</h3>
                    <p>Win: <span class="probability prob-bad">49.5%</span> | Lose: 50.5%<br>
                    Simple unfair coin. You lose slightly more often than you win.</p>
                </div>
                <div class="game-rules">
                    <h3>Game B (Capital-Dependent)</h3>
                    <p>If capital divisible by 3:<br>
                    Win: <span class="probability prob-bad">9.5%</span> | Lose: 90.5%<br><br>
                    Otherwise:<br>
                    Win: <span class="probability prob-good">74.5%</span> | Lose: 25.5%</p>
                </div>
                <div class="game-rules" style="background: rgba(78, 205, 196, 0.2); border: 1px solid rgba(78, 205, 196, 0.5);">
                    <h3 style="color: #4ecdc4;">The Magic</h3>
                    <p>Game A keeps capital fluctuating, AVOIDING the bad mod-3 states in Game B. The ratchet effect emerges!</p>
                </div>
            </div>
        </div>

        <div class="insight-box">
            <h3>How Can Losing + Losing = Winning?</h3>
            <p>The games are NOT independent! Game A changes your capital randomly, which affects which coin Game B uses. When alternating, Game A "rescues" you from the bad mod-3 positions that make Game B devastating. It's like a Brownian ratchet: random motion + asymmetric barrier = directed movement!</p>
        </div>

        <div class="explanation">
            <h2>The Discovery</h2>
            <p>Spanish physicist <strong>Juan Parrondo</strong> discovered this paradox in 1996 while studying Brownian ratchets - theoretical machines that extract work from random thermal fluctuations.</p>
            <p><strong>Applications:</strong> The paradox has been applied to genetics (explaining why species mix genes), finance (portfolio switching strategies), and cancer treatment (alternating chemotherapy approaches can outperform either alone).</p>
            <p><strong>The Key Insight:</strong> Two unfair games can "help" each other. Game A's randomness prevents Game B from staying in its worst states. The combination exploits correlation between the games that doesn't exist when playing either alone.</p>
            <p style="font-style: italic; color: #90a090;">Published in Nature: "Losing strategies can win by Parrondo's paradox" - a counterintuitive result that challenges our understanding of probability and game theory.</p>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('graphCanvas');
        const ctx = canvas.getContext('2d');
        
        var pA = 0.495;
        var pB_bad = 0.095;
        var pB_good = 0.745;
        
        var capital = 0;
        var history = [0];
        var games = { A: [], B: [], ABB: [], Random: [] };

        function initCanvas() {
            var dpr = window.devicePixelRatio || 1;
            var rect = canvas.getBoundingClientRect();
            canvas.width = rect.width * dpr;
            canvas.height = rect.height * dpr;
            ctx.scale(dpr, dpr);
        }

        function playGameA() {
            return Math.random() < pA ? 1 : -1;
        }

        function playGameB(cap) {
            var p = (cap % 3 === 0) ? pB_bad : pB_good;
            return Math.random() < p ? 1 : -1;
        }

        function runSimulation(type, rounds) {
            var cap = 0;
            var hist = [0];
            var gameIndex = 0;
            
            for (var i = 0; i < rounds; i++) {
                var result;
                if (type === 'A') {
                    result = playGameA();
                } else if (type === 'B') {
                    result = playGameB(cap);
                } else if (type === 'ABB') {
                    if (gameIndex % 3 === 0) {
                        result = playGameA();
                    } else {
                        result = playGameB(cap);
                    }
                    gameIndex++;
                } else if (type === 'Random') {
                    if (Math.random() < 0.5) {
                        result = playGameA();
                    } else {
                        result = playGameB(cap);
                    }
                }
                cap += result;
                hist.push(cap);
            }
            
            return { final: cap, history: hist };
        }

        function runAllSimulations() {
            var rounds = 300;
            
            games.A = runSimulation('A', rounds);
            games.B = runSimulation('B', rounds);
            games.ABB = runSimulation('ABB', rounds);
            games.Random = runSimulation('Random', rounds);
            
            updateResults();
            drawGraph();
        }

        function updateResults() {
            var resultA = document.getElementById('resultA');
            var resultB = document.getElementById('resultB');
            var resultABB = document.getElementById('resultABB');
            var resultRandom = document.getElementById('resultRandom');
            
            function formatResult(val, elem) {
                var sign = val >= 0 ? '+' : '';
                elem.textContent = sign + val;
                elem.className = 'result-value ' + (val >= 0 ? 'positive' : 'negative');
            }
            
            formatResult(games.A.final, resultA);
            formatResult(games.B.final, resultB);
            formatResult(games.ABB.final, resultABB);
            formatResult(games.Random.final, resultRandom);
        }

        function drawGraph() {
            var width = canvas.width / (window.devicePixelRatio || 1);
            var height = canvas.height / (window.devicePixelRatio || 1);
            var padding = 40;
            
            ctx.clearRect(0, 0, width, height);
            
            var allValues = games.A.history.concat(games.B.history, games.ABB.history, games.Random.history);
            var minVal = Math.min.apply(null, allValues);
            var maxVal = Math.max.apply(null, allValues);
            var range = Math.max(Math.abs(minVal), Math.abs(maxVal), 10);
            
            ctx.strokeStyle = 'rgba(144, 238, 144, 0.3)';
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.moveTo(padding, height / 2);
            ctx.lineTo(width - padding, height / 2);
            ctx.stroke();
            
            ctx.fillStyle = '#90ee90';
            ctx.font = '12px Georgia';
            ctx.textAlign = 'right';
            ctx.fillText('$0', padding - 5, height / 2 + 4);
            
            function drawLine(hist, color) {
                if (hist.length < 2) return;
                ctx.strokeStyle = color;
                ctx.lineWidth = 2;
                ctx.beginPath();
                for (var i = 0; i < hist.length; i++) {
                    var x = padding + (i / (hist.length - 1)) * (width - 2 * padding);
                    var y = height / 2 - (hist[i] / range) * (height / 2 - padding);
                    if (i === 0) ctx.moveTo(x, y);
                    else ctx.lineTo(x, y);
                }
                ctx.stroke();
            }
            
            drawLine(games.A.history, '#ff6b6b');
            drawLine(games.B.history, '#feca57');
            drawLine(games.ABB.history, '#4ecdc4');
            drawLine(games.Random.history, '#a855f7');
            
            ctx.font = 'bold 11px Georgia';
            ctx.textAlign = 'left';
            var legendY = 20;
            var items = [
                { color: '#ff6b6b', label: 'Game A' },
                { color: '#feca57', label: 'Game B' },
                { color: '#4ecdc4', label: 'ABB Mix' },
                { color: '#a855f7', label: 'Random' }
            ];
            for (var j = 0; j < items.length; j++) {
                ctx.fillStyle = items[j].color;
                ctx.fillRect(padding, legendY + j * 18, 12, 12);
                ctx.fillStyle = '#e0e0e0';
                ctx.fillText(items[j].label, padding + 18, legendY + j * 18 + 10);
            }
        }

        document.getElementById('playA').addEventListener('click', function() {
            games.A = runSimulation('A', 300);
            updateResults();
            drawGraph();
        });

        document.getElementById('playB').addEventListener('click', function() {
            games.B = runSimulation('B', 300);
            updateResults();
            drawGraph();
        });

        document.getElementById('playABB').addEventListener('click', function() {
            games.ABB = runSimulation('ABB', 300);
            updateResults();
            drawGraph();
        });

        document.getElementById('playRandom').addEventListener('click', function() {
            games.Random = runSimulation('Random', 300);
            updateResults();
            drawGraph();
        });

        document.getElementById('reset').addEventListener('click', function() {
            games = { A: { final: 0, history: [0] }, B: { final: 0, history: [0] }, ABB: { final: 0, history: [0] }, Random: { final: 0, history: [0] } };
            document.getElementById('resultA').textContent = '--';
            document.getElementById('resultB').textContent = '--';
            document.getElementById('resultABB').textContent = '--';
            document.getElementById('resultRandom').textContent = '--';
            drawGraph();
        });

        window.addEventListener('load', function() {
            initCanvas();
            runAllSimulations();
        });

        window.addEventListener('resize', function() {
            initCanvas();
            drawGraph();
        });
    </script>
    <script src="../assets/js/enhance.js" defer></script>
</body>
</html>
