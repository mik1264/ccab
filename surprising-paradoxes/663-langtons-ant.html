<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Langton's Ant - Order from Chaos</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            color: #e8e8e8;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 25px;
        }

        h1 {
            font-size: 2.2rem;
            background: linear-gradient(135deg, #e74c3c, #9b59b6, #3498db);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
        }

        .subtitle {
            color: #aaa;
            font-size: 1.1rem;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 350px;
            gap: 25px;
        }

        @media (max-width: 1100px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }

        .viz-section {
            background: rgba(255,255,255,0.05);
            border-radius: 15px;
            padding: 20px;
        }

        .canvas-container {
            display: flex;
            justify-content: center;
        }

        canvas {
            border-radius: 8px;
            background: #fff;
        }

        .controls {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            margin-top: 20px;
            padding: 15px;
            background: rgba(0,0,0,0.3);
            border-radius: 10px;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.95rem;
            font-weight: 600;
            transition: all 0.3s;
        }

        .btn-primary {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: #fff;
        }

        .btn-secondary {
            background: rgba(255,255,255,0.1);
            color: #fff;
            border: 1px solid rgba(255,255,255,0.2);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        .param-group {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px 12px;
            background: rgba(255,255,255,0.05);
            border-radius: 8px;
        }

        .param-group label {
            font-size: 0.85rem;
            color: #aaa;
        }

        .param-value {
            color: #e74c3c;
            font-weight: bold;
            min-width: 60px;
        }

        input[type="range"] {
            width: 100px;
        }

        .rule-select {
            padding: 8px;
            border-radius: 4px;
            border: 1px solid rgba(255,255,255,0.2);
            background: rgba(0,0,0,0.3);
            color: #fff;
            font-size: 0.9rem;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-top: 15px;
        }

        .stat-box {
            background: rgba(0,0,0,0.3);
            padding: 12px;
            border-radius: 8px;
            text-align: center;
        }

        .stat-label {
            font-size: 0.75rem;
            color: #888;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .stat-value {
            font-size: 1.4rem;
            font-weight: bold;
            color: #e74c3c;
        }

        .phase-indicator {
            text-align: center;
            margin-top: 15px;
            padding: 12px;
            border-radius: 8px;
            font-weight: bold;
            font-size: 1.1rem;
        }

        .phase-chaos {
            background: rgba(231, 76, 60, 0.3);
            color: #e74c3c;
        }

        .phase-highway {
            background: rgba(46, 204, 113, 0.3);
            color: #2ecc71;
        }

        .sidebar {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .exp-card {
            background: rgba(255,255,255,0.05);
            border-radius: 12px;
            padding: 18px;
            border-left: 4px solid #e74c3c;
        }

        .exp-card h3 {
            color: #e74c3c;
            margin-bottom: 10px;
            font-size: 1rem;
        }

        .exp-card p {
            color: #ccc;
            font-size: 0.9rem;
            line-height: 1.6;
        }

        .rule-display {
            background: rgba(0,0,0,0.4);
            padding: 12px;
            border-radius: 8px;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
        }

        .rule-step {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 8px 0;
            font-size: 0.85rem;
        }

        .cell-white {
            width: 20px;
            height: 20px;
            background: #fff;
            border: 1px solid #888;
        }

        .cell-black {
            width: 20px;
            height: 20px;
            background: #222;
            border: 1px solid #888;
        }

        .arrow {
            color: #e74c3c;
            font-size: 1.2rem;
        }

        .back-link {
            position: fixed;
            top: 20px;
            left: 20px;
            color: #e74c3c;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
            opacity: 0.8;
            transition: opacity 0.3s;
            z-index: 100;
        }

        .back-link:hover {
            opacity: 1;
        }

        .highlight {
            color: #3498db;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <a href="index.html" class="back-link">‚Üê Back to Paradoxes</a>

    <div class="container">
        <header>
            <h1>Langton's Ant</h1>
            <p class="subtitle">Chris Langton (1986) - Emergent Order from Simple Rules</p>
        </header>

        <div class="main-content">
            <div class="viz-section">
                <div class="canvas-container">
                    <canvas id="antCanvas" width="600" height="600"></canvas>
                </div>

                <div class="controls">
                    <button class="btn btn-primary" id="startBtn">Start</button>
                    <button class="btn btn-secondary" id="pauseBtn">Pause</button>
                    <button class="btn btn-secondary" id="stepBtn">Step √ó100</button>
                    <button class="btn btn-secondary" id="resetBtn">Reset</button>

                    <div class="param-group">
                        <label>Speed:</label>
                        <input type="range" id="speedSlider" min="1" max="1000" value="100">
                        <span class="param-value" id="speedValue">100/frame</span>
                    </div>

                    <div class="param-group">
                        <label>Rule:</label>
                        <select id="ruleSelect" class="rule-select">
                            <option value="RL" selected>RL (Classic)</option>
                            <option value="RLR">RLR</option>
                            <option value="LLRR">LLRR</option>
                            <option value="LRRL">LRRL</option>
                            <option value="RLLR">RLLR</option>
                            <option value="RRLL">RRLL</option>
                            <option value="LRRRRRLLR">LRRRRRLLR (Chaos)</option>
                            <option value="LLRRRLRLRLLR">LLRRRLRLRLLR (Square)</option>
                        </select>
                    </div>
                </div>

                <div class="stats-grid">
                    <div class="stat-box">
                        <div class="stat-label">Steps</div>
                        <div class="stat-value" id="steps">0</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-label">Black Cells</div>
                        <div class="stat-value" id="blackCells">0</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-label">Ant Direction</div>
                        <div class="stat-value" id="direction">‚Üë</div>
                    </div>
                </div>

                <div class="phase-indicator phase-chaos" id="phaseIndicator">
                    üêú Chaotic Phase - Highway emerges around step ~10,000
                </div>
            </div>

            <div class="sidebar">
                <div class="exp-card">
                    <h3>üêú The Simplest Complexity</h3>
                    <p>A virtual ant walks on an infinite grid. Just TWO rules, yet it creates <span class="highlight">emergent complexity</span> that has puzzled mathematicians for decades. After ~10,000 chaotic steps, order mysteriously appears!</p>
                </div>

                <div class="exp-card">
                    <h3>üìã The Rules</h3>
                    <div class="rule-display">
                        <div class="rule-step">
                            <div class="cell-white"></div>
                            <span class="arrow">‚Üí</span>
                            <span>Turn <b>RIGHT</b> 90¬∞, flip to black, move forward</span>
                        </div>
                        <div class="rule-step">
                            <div class="cell-black"></div>
                            <span class="arrow">‚Üí</span>
                            <span>Turn <b>LEFT</b> 90¬∞, flip to white, move forward</span>
                        </div>
                    </div>
                    <p style="margin-top: 10px; font-size: 0.8rem; color: #888;">That's it! No randomness, purely deterministic.</p>
                </div>

                <div class="exp-card">
                    <h3>üõ£Ô∏è The Highway Mystery</h3>
                    <p>After exactly <span class="highlight">~10,000 steps</span> of chaos, the ant suddenly starts building a diagonal "highway" pattern that repeats every <span class="highlight">104 steps</span> forever. Nobody has proven this always happens!</p>
                </div>

                <div class="exp-card">
                    <h3>üíª Turing Complete!</h3>
                    <p>In 2000, Gajardo et al. proved Langton's ant can compute ANYTHING a computer can. The question "does the ant build a highway?" is <span class="highlight">undecidable</span>‚Äîequivalent to the halting problem!</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('antCanvas');
        const ctx = canvas.getContext('2d');

        // Grid settings
        const gridSize = 200;
        const cellSize = canvas.width / gridSize;

        // State
        let grid = new Map(); // Only store non-white cells
        let antX = Math.floor(gridSize / 2);
        let antY = Math.floor(gridSize / 2);
        let antDir = 0; // 0=up, 1=right, 2=down, 3=left
        let steps = 0;
        let running = false;
        let stepsPerFrame = 100;
        let animationId = null;
        let rule = 'RL';
        let highwayDetected = false;

        const directions = [
            [0, -1],  // up
            [1, 0],   // right
            [0, 1],   // down
            [-1, 0]   // left
        ];

        const dirSymbols = ['‚Üë', '‚Üí', '‚Üì', '‚Üê'];

        // Colors for multi-state rules
        const stateColors = [
            '#ffffff', // 0 - white
            '#222222', // 1 - black
            '#e74c3c', // 2 - red
            '#3498db', // 3 - blue
            '#2ecc71', // 4 - green
            '#9b59b6', // 5 - purple
            '#f39c12', // 6 - orange
            '#1abc9c', // 7 - teal
            '#e91e63', // 8 - pink
            '#795548', // 9 - brown
            '#607d8b', // 10 - gray
            '#00bcd4', // 11 - cyan
        ];

        function getKey(x, y) {
            return `${x},${y}`;
        }

        function getState(x, y) {
            return grid.get(getKey(x, y)) || 0;
        }

        function setState(x, y, state) {
            const key = getKey(x, y);
            if (state === 0) {
                grid.delete(key);
            } else {
                grid.set(key, state);
            }
        }

        function step() {
            const currentState = getState(antX, antY);
            const turnChar = rule[currentState % rule.length];

            // Turn based on rule
            if (turnChar === 'R') {
                antDir = (antDir + 1) % 4;
            } else {
                antDir = (antDir + 3) % 4;
            }

            // Flip cell state
            const newState = (currentState + 1) % rule.length;
            setState(antX, antY, newState);

            // Move forward
            antX += directions[antDir][0];
            antY += directions[antDir][1];

            steps++;

            // Check for highway phase (simple heuristic)
            if (!highwayDetected && steps > 9000 && rule === 'RL') {
                // In classic RL, highway starts around 10,000
                if (steps > 10500) {
                    highwayDetected = true;
                    updatePhaseIndicator();
                }
            }
        }

        function draw() {
            ctx.fillStyle = '#ffffff';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // Calculate view bounds centered on ant
            const viewRadius = Math.floor(gridSize / 2);
            const viewX = antX - viewRadius;
            const viewY = antY - viewRadius;

            // Draw cells
            for (const [key, state] of grid) {
                const [x, y] = key.split(',').map(Number);
                const screenX = (x - viewX) * cellSize;
                const screenY = (y - viewY) * cellSize;

                if (screenX >= -cellSize && screenX < canvas.width + cellSize &&
                    screenY >= -cellSize && screenY < canvas.height + cellSize) {
                    ctx.fillStyle = stateColors[state % stateColors.length];
                    ctx.fillRect(screenX, screenY, cellSize, cellSize);
                }
            }

            // Draw ant
            const antScreenX = (antX - viewX) * cellSize + cellSize / 2;
            const antScreenY = (antY - viewY) * cellSize + cellSize / 2;

            ctx.fillStyle = '#e74c3c';
            ctx.beginPath();
            ctx.arc(antScreenX, antScreenY, cellSize * 1.5, 0, Math.PI * 2);
            ctx.fill();

            // Draw direction indicator
            ctx.fillStyle = '#fff';
            ctx.font = 'bold 12px sans-serif';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            ctx.fillText(dirSymbols[antDir], antScreenX, antScreenY);
        }

        function updateStats() {
            document.getElementById('steps').textContent = steps.toLocaleString();
            document.getElementById('blackCells').textContent = grid.size.toLocaleString();
            document.getElementById('direction').textContent = dirSymbols[antDir];
        }

        function updatePhaseIndicator() {
            const indicator = document.getElementById('phaseIndicator');
            if (highwayDetected) {
                indicator.className = 'phase-indicator phase-highway';
                indicator.textContent = 'üõ£Ô∏è Highway Phase - Repeating 104-step pattern!';
            } else {
                indicator.className = 'phase-indicator phase-chaos';
                indicator.textContent = 'üêú Chaotic Phase - Highway emerges around step ~10,000';
            }
        }

        function animate() {
            if (!running) return;

            for (let i = 0; i < stepsPerFrame; i++) {
                step();
            }

            draw();
            updateStats();

            animationId = requestAnimationFrame(animate);
        }

        function reset() {
            grid = new Map();
            antX = Math.floor(gridSize / 2);
            antY = Math.floor(gridSize / 2);
            antDir = 0;
            steps = 0;
            highwayDetected = false;
            updatePhaseIndicator();
            draw();
            updateStats();
        }

        // Event listeners
        document.getElementById('startBtn').addEventListener('click', () => {
            if (!running) {
                running = true;
                document.getElementById('startBtn').textContent = 'Running...';
                animate();
            }
        });

        document.getElementById('pauseBtn').addEventListener('click', () => {
            running = false;
            if (animationId) {
                cancelAnimationFrame(animationId);
            }
            document.getElementById('startBtn').textContent = 'Start';
        });

        document.getElementById('stepBtn').addEventListener('click', () => {
            if (!running) {
                for (let i = 0; i < 100; i++) {
                    step();
                }
                draw();
                updateStats();
            }
        });

        document.getElementById('resetBtn').addEventListener('click', () => {
            running = false;
            if (animationId) {
                cancelAnimationFrame(animationId);
            }
            document.getElementById('startBtn').textContent = 'Start';
            reset();
        });

        document.getElementById('speedSlider').addEventListener('input', (e) => {
            stepsPerFrame = parseInt(e.target.value);
            document.getElementById('speedValue').textContent = stepsPerFrame + '/frame';
        });

        document.getElementById('ruleSelect').addEventListener('change', (e) => {
            rule = e.target.value;
            reset();
        });

        // Initialize
        reset();
    </script>
    <script src="../assets/js/enhance.js" defer></script>
</body>
</html>
