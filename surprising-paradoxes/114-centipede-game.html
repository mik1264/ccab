<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>#114: The Centipede Game - When Rationality Fails</title>
    <link href="https://fonts.googleapis.com/css2?family=Lora:wght@400;500;600;700&family=Nunito:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg: #1a1a2e;
            --player1: #e63946;
            --player2: #457b9d;
            --pot: #f4a261;
            --pass: #2a9d8f;
            --take: #e76f51;
            --text: #f1faee;
            --muted: #a8dadc;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Nunito', sans-serif;
            background: linear-gradient(135deg, var(--bg) 0%, #16213e 100%);
            color: var(--text);
            min-height: 100vh;
        }
        
        .back-link {
            position: fixed;
            top: 20px;
            left: 20px;
            color: var(--pot);
            text-decoration: none;
            font-weight: 600;
            z-index: 100;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 80px 20px 40px;
        }
        
        h1 {
            font-family: 'Lora', serif;
            font-size: 2.4rem;
            text-align: center;
            margin-bottom: 0.5rem;
            background: linear-gradient(135deg, var(--player1), var(--player2));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .subtitle {
            text-align: center;
            font-size: 1.1rem;
            color: var(--muted);
            margin-bottom: 2rem;
        }
        
        .intro {
            background: rgba(255,255,255,0.05);
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 2rem;
            line-height: 1.7;
            border-left: 4px solid var(--pot);
        }
        
        .game-area {
            background: rgba(0,0,0,0.3);
            border-radius: 20px;
            padding: 2rem;
            margin: 2rem 0;
        }
        
        .centipede-track {
            display: flex;
            align-items: center;
            justify-content: center;
            flex-wrap: wrap;
            gap: 5px;
            margin: 2rem 0;
            padding: 1rem;
        }
        
        .node {
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
        }
        
        .node-circle {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 0.9rem;
            transition: all 0.3s;
            cursor: pointer;
            position: relative;
        }
        
        .node-circle.p1 {
            background: var(--player1);
        }
        
        .node-circle.p2 {
            background: var(--player2);
        }
        
        .node-circle.current {
            box-shadow: 0 0 20px currentColor;
            transform: scale(1.2);
        }
        
        .node-circle.passed {
            opacity: 0.4;
        }
        
        .node-circle.taken {
            background: var(--take) !important;
            box-shadow: 0 0 15px var(--take);
        }
        
        .node-payoff {
            font-size: 0.75rem;
            margin-top: 5px;
            color: var(--muted);
        }
        
        .arrow {
            font-size: 1.5rem;
            color: var(--pass);
            opacity: 0.5;
        }
        
        .arrow.active {
            opacity: 1;
            animation: pulse 1s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        .game-status {
            text-align: center;
            margin: 2rem 0;
        }
        
        .current-pot {
            font-size: 2.5rem;
            color: var(--pot);
            margin: 1rem 0;
        }
        
        .turn-indicator {
            font-size: 1.2rem;
            margin: 1rem 0;
        }
        
        .controls {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin: 1.5rem 0;
        }
        
        .btn {
            padding: 15px 40px;
            font-size: 1.2rem;
            font-weight: 700;
            border: none;
            border-radius: 30px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .btn-pass {
            background: var(--pass);
            color: white;
        }
        
        .btn-take {
            background: var(--take);
            color: white;
        }
        
        .btn:hover:not(:disabled) {
            transform: scale(1.05);
        }
        
        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .btn-reset {
            padding: 10px 25px;
            font-size: 1rem;
            background: rgba(255,255,255,0.1);
            color: var(--text);
            border: 2px solid var(--text);
            border-radius: 25px;
        }
        
        .mode-selector {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin: 1rem 0;
        }
        
        .mode-btn {
            padding: 8px 20px;
            border-radius: 20px;
            background: rgba(255,255,255,0.1);
            border: 2px solid transparent;
            color: var(--text);
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .mode-btn.active {
            border-color: var(--pot);
            background: rgba(244, 162, 97, 0.2);
        }
        
        .result-panel {
            background: linear-gradient(135deg, rgba(230,57,70,0.1), rgba(69,123,157,0.1));
            border: 2px solid var(--pot);
            border-radius: 16px;
            padding: 2rem;
            margin: 2rem 0;
            text-align: center;
            display: none;
        }
        
        .result-panel.visible {
            display: block;
        }
        
        .result-panel h2 {
            color: var(--pot);
            margin-bottom: 1rem;
        }
        
        .final-scores {
            display: flex;
            justify-content: center;
            gap: 3rem;
            margin: 1.5rem 0;
        }
        
        .score-box {
            padding: 1.5rem 2rem;
            border-radius: 12px;
        }
        
        .score-box.p1 {
            background: rgba(230, 57, 70, 0.3);
        }
        
        .score-box.p2 {
            background: rgba(69, 123, 157, 0.3);
        }
        
        .score-label {
            font-size: 0.9rem;
            opacity: 0.8;
        }
        
        .score-value {
            font-size: 2.5rem;
            font-weight: 700;
        }
        
        .paradox-box {
            background: rgba(255,255,255,0.05);
            border-radius: 16px;
            padding: 2rem;
            margin: 2rem 0;
        }
        
        .paradox-box h2 {
            font-family: 'Lora', serif;
            color: var(--take);
            margin-bottom: 1rem;
        }
        
        .induction-steps {
            background: rgba(0,0,0,0.3);
            border-radius: 12px;
            padding: 1.5rem;
            margin: 1rem 0;
            font-family: 'Courier New', monospace;
        }
        
        .induction-step {
            padding: 8px 0;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            display: flex;
            align-items: center;
        }
        
        .step-round {
            width: 80px;
            color: var(--muted);
        }
        
        .step-logic {
            flex: 1;
        }
        
        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 1.5rem 0;
        }
        
        .comparison-table th, .comparison-table td {
            padding: 12px;
            text-align: center;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        
        .comparison-table th {
            color: var(--pot);
        }
        
        .philosophy-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }
        
        .philosophy-card {
            background: rgba(255,255,255,0.05);
            border-radius: 12px;
            padding: 1.5rem;
            border-top: 3px solid var(--pass);
        }
        
        .philosophy-card h3 {
            color: var(--pass);
            margin-bottom: 0.75rem;
        }
        
        .citation {
            background: rgba(255,255,255,0.03);
            border-radius: 12px;
            padding: 1.5rem;
            margin-top: 2rem;
            font-size: 0.9rem;
        }
        
        .citation a {
            color: var(--muted);
        }
        
        @media (max-width: 768px) {
            h1 { font-size: 1.8rem; }
            .node-circle { width: 40px; height: 40px; font-size: 0.8rem; }
            .controls { flex-direction: column; }
        }
    </style>
</head>
<body>
    <a href="index.html" class="back-link">‚Üê Back to Paradoxes</a>
    
    <div class="container">
        <h1>The Centipede Game</h1>
        <p class="subtitle">Rational players should defect immediately. But cooperation pays MORE.</p>
        
        <div class="intro">
            <p><strong>The Setup (Rosenthal, 1981):</strong> Two players alternate turns. Each turn, you can TAKE the pot (ending the game) or PASS (doubling the pot for the other player). The pot grows: 2‚Üí4‚Üí8‚Üí16‚Üí32‚Üí64... If you pass at round N, you get the "loser's share" if your opponent takes next.</p>
            <p style="margin-top: 1rem;"><strong>The Paradox:</strong> Backward induction proves that rational players should TAKE immediately. But experiments show humans cooperate‚Äîand earn FAR more as a result!</p>
        </div>
        
        <div class="game-area">
            <h3 style="text-align: center; color: var(--muted); margin-bottom: 1rem;">The Centipede Track</h3>
            
            <div class="mode-selector">
                <button class="mode-btn active" data-mode="human">You vs AI</button>
                <button class="mode-btn" data-mode="rational">Rational AI vs AI</button>
                <button class="mode-btn" data-mode="cooperative">Cooperative AI vs AI</button>
            </div>
            
            <div class="centipede-track" id="track">
                <!-- Generated by JS -->
            </div>
            
            <div class="game-status">
                <div>Current Pot</div>
                <div class="current-pot">$<span id="potValue">4</span></div>
                <div class="turn-indicator" id="turnIndicator">
                    <span style="color: var(--player1);">‚óè</span> Player 1's turn (You)
                </div>
            </div>
            
            <div class="controls" id="humanControls">
                <button class="btn btn-pass" id="passBtn">‚úã PASS</button>
                <button class="btn btn-take" id="takeBtn">üí∞ TAKE</button>
            </div>
            
            <div style="text-align: center; margin-top: 1rem;">
                <button class="btn-reset" id="resetBtn">üîÑ New Game</button>
            </div>
        </div>
        
        <div class="result-panel" id="resultPanel">
            <h2>üéØ Game Over!</h2>
            <p id="resultMessage"></p>
            <div class="final-scores">
                <div class="score-box p1">
                    <div class="score-label">Player 1</div>
                    <div class="score-value" id="finalP1">0</div>
                </div>
                <div class="score-box p2">
                    <div class="score-label">Player 2</div>
                    <div class="score-value" id="finalP2">0</div>
                </div>
            </div>
            <p id="paradoxNote" style="color: var(--pot); margin-top: 1rem;"></p>
        </div>
        
        <div class="paradox-box">
            <h2>üîô The Backward Induction Argument</h2>
            <p>Why "rational" players should defect at round 1:</p>
            
            <div class="induction-steps">
                <div class="induction-step">
                    <span class="step-round">Round 6:</span>
                    <span class="step-logic">P2 will TAKE (64 > 32 if P1 takes next)</span>
                </div>
                <div class="induction-step">
                    <span class="step-round">Round 5:</span>
                    <span class="step-logic">P1 knows this, so TAKE now (32 > 16)</span>
                </div>
                <div class="induction-step">
                    <span class="step-round">Round 4:</span>
                    <span class="step-logic">P2 knows this, so TAKE now (16 > 8)</span>
                </div>
                <div class="induction-step">
                    <span class="step-round">Round 3:</span>
                    <span class="step-logic">P1 knows this, so TAKE now (8 > 4)</span>
                </div>
                <div class="induction-step">
                    <span class="step-round">Round 2:</span>
                    <span class="step-logic">P2 knows this, so TAKE now (4 > 2)</span>
                </div>
                <div class="induction-step" style="color: var(--take);">
                    <span class="step-round">Round 1:</span>
                    <span class="step-logic"><strong>P1 should TAKE immediately! Gets $1, P2 gets $0</strong></span>
                </div>
            </div>
            
            <table class="comparison-table">
                <tr>
                    <th>Strategy</th>
                    <th>Player 1 Gets</th>
                    <th>Player 2 Gets</th>
                    <th>Total</th>
                </tr>
                <tr>
                    <td>Rational (Take at Round 1)</td>
                    <td style="color: var(--take);">$1</td>
                    <td style="color: var(--take);">$0</td>
                    <td>$1</td>
                </tr>
                <tr>
                    <td>Full Cooperation (6 rounds)</td>
                    <td style="color: var(--pass);">$32</td>
                    <td style="color: var(--pass);">$64</td>
                    <td>$96</td>
                </tr>
            </table>
            
            <p style="text-align: center; color: var(--pot); font-size: 1.2rem; margin-top: 1rem;">
                The "rational" outcome is <strong>96x worse</strong> than cooperation!
            </p>
        </div>
        
        <div class="philosophy-grid">
            <div class="philosophy-card">
                <h3>Experimental Evidence</h3>
                <p>In lab experiments, humans typically cooperate until rounds 4-5, earning much more than backward induction predicts. Only 2-3% defect at round 1 as "rationality" demands.</p>
            </div>
            <div class="philosophy-card">
                <h3>Level-k Reasoning</h3>
                <p>Most humans reason 2-3 steps ahead, not infinitely. A "Level-2" player thinks: "My opponent might cooperate, so I should pass for now." This bounded rationality pays off!</p>
            </div>
            <div class="philosophy-card">
                <h3>Common Knowledge Problem</h3>
                <p>Backward induction requires COMMON KNOWLEDGE of rationality‚Äîeveryone knows everyone knows everyone is rational... ad infinitum. This rarely holds in practice.</p>
            </div>
            <div class="philosophy-card">
                <h3>Trust and Reputation</h3>
                <p>In repeated games, cooperation builds trust. Even in one-shot games, humans import social norms. "Irrational" cooperation may be evolutionarily adaptive.</p>
            </div>
        </div>
        
        <div class="citation">
            <strong>Sources:</strong><br>
            ‚Ä¢ Rosenthal, R. (1981). "Games of Perfect Information, Predatory Pricing, and the Chain Store Paradox"<br>
            ‚Ä¢ McKelvey & Palfrey (1992). "An Experimental Study of the Centipede Game"<br>
            ‚Ä¢ <a href="https://en.wikipedia.org/wiki/Centipede_game" target="_blank">Wikipedia: Centipede Game</a>
        </div>
    </div>
    
    <script>
        const ROUNDS = 6;
        let currentRound = 1;
        let currentPlayer = 1;
        let gameMode = 'human';
        let gameOver = false;
        
        // Payoffs: at round n, pot is 2^n. Taker gets 2^n, other gets 2^(n-1)
        function getPayoffs(round) {
            const takerGets = Math.pow(2, round);
            const otherGets = Math.pow(2, round - 1);
            return { taker: takerGets, other: otherGets };
        }
        
        function createTrack() {
            const track = document.getElementById('track');
            track.innerHTML = '';
            
            for (let i = 1; i <= ROUNDS; i++) {
                const player = i % 2 === 1 ? 1 : 2;
                const payoffs = getPayoffs(i);
                
                const node = document.createElement('div');
                node.className = 'node';
                node.innerHTML = `
                    <div class="node-circle p${player}" data-round="${i}">R${i}</div>
                    <div class="node-payoff">(${payoffs.other}, ${payoffs.taker})</div>
                `;
                track.appendChild(node);
                
                if (i < ROUNDS) {
                    const arrow = document.createElement('span');
                    arrow.className = 'arrow';
                    arrow.textContent = '‚Üí';
                    arrow.id = `arrow-${i}`;
                    track.appendChild(arrow);
                }
            }
            
            // Add final node (end of game if all pass)
            const finalNode = document.createElement('div');
            finalNode.className = 'node';
            const finalPayoffs = getPayoffs(ROUNDS);
            finalNode.innerHTML = `
                <div class="node-circle p${ROUNDS % 2 === 1 ? 2 : 1}" data-round="${ROUNDS + 1}" style="background: var(--pass);">END</div>
                <div class="node-payoff">(${finalPayoffs.taker}, ${finalPayoffs.other})</div>
            `;
            track.appendChild(finalNode);
            
            updateTrackDisplay();
        }
        
        function updateTrackDisplay() {
            const nodes = document.querySelectorAll('.node-circle');
            nodes.forEach((node, i) => {
                const round = parseInt(node.dataset.round);
                node.classList.remove('current', 'passed', 'taken');
                
                if (round < currentRound) {
                    node.classList.add('passed');
                } else if (round === currentRound && !gameOver) {
                    node.classList.add('current');
                }
            });
            
            const arrows = document.querySelectorAll('.arrow');
            arrows.forEach((arrow, i) => {
                arrow.classList.remove('active');
                if (i + 1 === currentRound - 1 && !gameOver) {
                    arrow.classList.add('active');
                }
            });
            
            // Update pot display
            const pot = Math.pow(2, currentRound + 1);
            document.getElementById('potValue').textContent = pot;
            
            // Update turn indicator
            const indicator = document.getElementById('turnIndicator');
            if (gameOver) {
                indicator.innerHTML = 'Game Over';
            } else {
                const playerColor = currentPlayer === 1 ? 'var(--player1)' : 'var(--player2)';
                const playerLabel = gameMode === 'human' && currentPlayer === 1 ? '(You)' : '(AI)';
                indicator.innerHTML = `<span style="color: ${playerColor};">‚óè</span> Player ${currentPlayer}'s turn ${playerLabel}`;
            }
        }
        
        function take() {
            if (gameOver) return;
            
            const payoffs = getPayoffs(currentRound);
            const p1Score = currentPlayer === 1 ? payoffs.taker : payoffs.other;
            const p2Score = currentPlayer === 2 ? payoffs.taker : payoffs.other;
            
            // Mark node as taken
            const node = document.querySelector(`.node-circle[data-round="${currentRound}"]`);
            node.classList.add('taken');
            
            endGame(p1Score, p2Score, `Player ${currentPlayer} took at round ${currentRound}!`);
        }
        
        function pass() {
            if (gameOver) return;
            
            currentRound++;
            
            if (currentRound > ROUNDS) {
                // Full cooperation - final payoffs
                const payoffs = getPayoffs(ROUNDS);
                const p1Score = ROUNDS % 2 === 0 ? payoffs.taker : payoffs.other;
                const p2Score = ROUNDS % 2 === 1 ? payoffs.taker : payoffs.other;
                endGame(p1Score, p2Score, 'Both players cooperated to the end!');
                return;
            }
            
            currentPlayer = currentPlayer === 1 ? 2 : 1;
            updateTrackDisplay();
            
            // AI turn
            if (gameMode !== 'human' || currentPlayer === 2) {
                setTimeout(aiTurn, 800);
            }
        }
        
        function aiTurn() {
            if (gameOver) return;
            
            if (gameMode === 'rational') {
                // Rational AI always takes at round 1
                take();
            } else if (gameMode === 'cooperative') {
                // Cooperative AI always passes
                pass();
            } else {
                // Human mode: AI opponent uses mixed strategy
                // More likely to take as rounds increase
                const takeProb = currentRound / (ROUNDS + 2);
                if (Math.random() < takeProb) {
                    take();
                } else {
                    pass();
                }
            }
        }
        
        function endGame(p1Score, p2Score, message) {
            gameOver = true;
            updateTrackDisplay();
            
            document.getElementById('passBtn').disabled = true;
            document.getElementById('takeBtn').disabled = true;
            
            const panel = document.getElementById('resultPanel');
            panel.classList.add('visible');
            document.getElementById('resultMessage').textContent = message;
            document.getElementById('finalP1').textContent = '$' + p1Score;
            document.getElementById('finalP2').textContent = '$' + p2Score;
            
            // Calculate how much was left on the table
            const maxTotal = Math.pow(2, ROUNDS) + Math.pow(2, ROUNDS - 1);
            const actualTotal = p1Score + p2Score;
            
            if (actualTotal < maxTotal * 0.5) {
                document.getElementById('paradoxNote').textContent = 
                    `Early defection! Full cooperation would have yielded $${maxTotal} total.`;
            } else if (actualTotal === maxTotal) {
                document.getElementById('paradoxNote').textContent = 
                    `Perfect cooperation! You beat "rational" play by ${maxTotal}x!`;
            }
        }
        
        function resetGame() {
            currentRound = 1;
            currentPlayer = 1;
            gameOver = false;
            
            document.getElementById('passBtn').disabled = false;
            document.getElementById('takeBtn').disabled = false;
            document.getElementById('resultPanel').classList.remove('visible');
            
            createTrack();
            
            if (gameMode !== 'human') {
                setTimeout(aiTurn, 500);
            }
        }
        
        // Event listeners
        document.getElementById('passBtn').addEventListener('click', pass);
        document.getElementById('takeBtn').addEventListener('click', take);
        document.getElementById('resetBtn').addEventListener('click', resetGame);
        
        document.querySelectorAll('.mode-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.mode-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                gameMode = btn.dataset.mode;
                
                const controls = document.getElementById('humanControls');
                controls.style.display = gameMode === 'human' ? 'flex' : 'none';
                
                resetGame();
            });
        });
        
        // Initialize
        createTrack();
    </script>
</body>
</html>
