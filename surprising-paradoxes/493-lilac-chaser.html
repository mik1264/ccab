<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Lilac Chaser - Surprising Paradoxes</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Georgia', serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #e8e8e8;
            min-height: 100vh;
            overflow-x: hidden;
        }

        .back-link {
            position: fixed;
            top: 20px;
            left: 20px;
            color: #da70d6;
            text-decoration: none;
            font-size: 1rem;
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            background: rgba(218, 112, 214, 0.1);
            border-radius: 20px;
            transition: all 0.3s ease;
        }

        .back-link:hover {
            background: rgba(218, 112, 214, 0.2);
            transform: translateX(-4px);
        }

        header {
            text-align: center;
            padding: 60px 20px 30px;
        }

        h1 {
            font-size: 2.8rem;
            color: #da70d6;
            text-shadow: 0 0 30px rgba(218, 112, 214, 0.5);
            margin-bottom: 10px;
        }

        .subtitle {
            font-size: 1.3rem;
            color: #9999aa;
            font-style: italic;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .illusion-section {
            background: rgba(30, 30, 50, 0.9);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            border: 1px solid rgba(218, 112, 214, 0.2);
        }

        .canvas-container {
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 20px 0;
        }

        canvas {
            border-radius: 10px;
            cursor: crosshair;
        }

        .instructions-box {
            background: linear-gradient(135deg, rgba(218, 112, 214, 0.15), rgba(144, 238, 144, 0.1));
            border: 2px solid #da70d6;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
            text-align: center;
        }

        .instructions-box h2 {
            color: #da70d6;
            margin-bottom: 15px;
            font-size: 1.5rem;
        }

        .instructions-box ol {
            text-align: left;
            max-width: 500px;
            margin: 0 auto;
            font-size: 1.1rem;
            line-height: 1.8;
        }

        .instructions-box li {
            margin-bottom: 8px;
        }

        .highlight-green {
            color: #90ee90;
            font-weight: bold;
        }

        .highlight-pink {
            color: #da70d6;
            font-weight: bold;
        }

        .controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 25px;
        }

        .control-group {
            background: rgba(40, 40, 70, 0.8);
            padding: 20px;
            border-radius: 12px;
        }

        .control-group label {
            display: block;
            margin-bottom: 10px;
            color: #da70d6;
            font-weight: bold;
        }

        .control-group input[type="range"] {
            width: 100%;
            height: 8px;
            border-radius: 4px;
            background: rgba(218, 112, 214, 0.3);
            appearance: none;
            cursor: pointer;
        }

        .control-group input[type="range"]::-webkit-slider-thumb {
            appearance: none;
            width: 20px;
            height: 20px;
            background: #da70d6;
            border-radius: 50%;
            cursor: pointer;
        }

        .control-value {
            text-align: center;
            font-size: 1.2rem;
            margin-top: 8px;
            color: #90ee90;
        }

        .toggle-btn {
            width: 100%;
            padding: 15px;
            font-size: 1rem;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
        }

        .toggle-btn.active {
            background: #da70d6;
            color: white;
        }

        .toggle-btn:not(.active) {
            background: rgba(218, 112, 214, 0.2);
            color: #da70d6;
            border: 1px solid #da70d6;
        }

        .toggle-btn:hover {
            transform: scale(1.02);
        }

        .stats-panel {
            display: flex;
            justify-content: center;
            gap: 40px;
            margin: 25px 0;
            flex-wrap: wrap;
        }

        .stat {
            text-align: center;
            padding: 15px 30px;
            background: rgba(40, 40, 70, 0.8);
            border-radius: 12px;
        }

        .stat-value {
            font-size: 2rem;
            color: #90ee90;
            font-weight: bold;
        }

        .stat-label {
            color: #9999aa;
            font-size: 0.9rem;
            margin-top: 5px;
        }

        .phenomena-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .phenomenon-card {
            background: rgba(40, 40, 70, 0.9);
            border-radius: 15px;
            padding: 25px;
            border-left: 4px solid;
        }

        .phenomenon-card.phi {
            border-left-color: #87ceeb;
        }

        .phenomenon-card.afterimage {
            border-left-color: #90ee90;
        }

        .phenomenon-card.troxler {
            border-left-color: #ffb347;
        }

        .phenomenon-card h3 {
            font-size: 1.3rem;
            margin-bottom: 12px;
        }

        .phenomenon-card.phi h3 { color: #87ceeb; }
        .phenomenon-card.afterimage h3 { color: #90ee90; }
        .phenomenon-card.troxler h3 { color: #ffb347; }

        .phenomenon-card p {
            color: #bbbbcc;
            line-height: 1.7;
        }

        .research-section {
            background: rgba(20, 20, 40, 0.9);
            border-radius: 20px;
            padding: 35px;
            margin-top: 30px;
            border: 1px solid rgba(218, 112, 214, 0.2);
        }

        .research-section h2 {
            color: #da70d6;
            font-size: 1.8rem;
            margin-bottom: 20px;
            text-align: center;
        }

        .research-content {
            display: grid;
            gap: 25px;
        }

        .research-item {
            padding: 20px;
            background: rgba(40, 40, 70, 0.6);
            border-radius: 12px;
        }

        .research-item h3 {
            color: #90ee90;
            margin-bottom: 12px;
            font-size: 1.2rem;
        }

        .research-item p, .research-item ul {
            color: #bbbbcc;
            line-height: 1.8;
        }

        .research-item ul {
            margin-left: 20px;
            margin-top: 10px;
        }

        .quote-box {
            background: linear-gradient(135deg, rgba(218, 112, 214, 0.1), rgba(90, 90, 120, 0.2));
            border-left: 4px solid #da70d6;
            padding: 25px;
            margin: 25px 0;
            border-radius: 0 15px 15px 0;
        }

        .quote-box p {
            font-style: italic;
            font-size: 1.2rem;
            color: #ddddee;
            margin-bottom: 10px;
        }

        .quote-box .attribution {
            color: #da70d6;
            font-style: normal;
            text-align: right;
        }

        footer {
            text-align: center;
            padding: 40px;
            color: #666;
            font-size: 0.9rem;
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 2rem;
            }

            .controls {
                grid-template-columns: 1fr;
            }

            .stats-panel {
                gap: 15px;
            }

            .stat {
                padding: 10px 20px;
            }
        }
    </style>
</head>
<body>
    <a href="index.html" class="back-link">‚Üê Back to Paradoxes</a>

    <header>
        <h1>üîÆ The Lilac Chaser</h1>
        <p class="subtitle">Three Visual Illusions in One ‚Ä¢ The "Pac-Man Illusion"</p>
    </header>

    <div class="container">
        <div class="illusion-section">
            <div class="instructions-box">
                <h2>üëÅÔ∏è How to See the Illusion</h2>
                <ol>
                    <li>Stare at the <strong>central cross</strong> without moving your eyes</li>
                    <li>After 5-10 seconds, a <span class="highlight-green">GREEN DOT</span> will appear</li>
                    <li>Keep staring ‚Äî the <span class="highlight-pink">PINK DOTS</span> will start to disappear!</li>
                    <li>Eventually you'll see only a green dot circling on a grey background</li>
                </ol>
            </div>

            <div class="canvas-container">
                <canvas id="canvas" width="600" height="600"></canvas>
            </div>

            <div class="stats-panel">
                <div class="stat">
                    <div class="stat-value" id="fixationTime">0s</div>
                    <div class="stat-label">Fixation Time</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="gapPosition">12 o'clock</div>
                    <div class="stat-label">Gap Position</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="effectPhase">Warming up...</div>
                    <div class="stat-label">Perceptual Phase</div>
                </div>
            </div>

            <div class="controls">
                <div class="control-group">
                    <label>‚è±Ô∏è Rotation Speed</label>
                    <input type="range" id="speedSlider" min="50" max="300" value="120">
                    <div class="control-value"><span id="speedValue">120</span>ms per step</div>
                </div>

                <div class="control-group">
                    <label>üîµ Number of Discs</label>
                    <input type="range" id="discsSlider" min="6" max="18" value="12">
                    <div class="control-value"><span id="discsValue">12</span> discs</div>
                </div>

                <div class="control-group">
                    <label>üí´ Blur Amount</label>
                    <input type="range" id="blurSlider" min="0" max="30" value="15">
                    <div class="control-value"><span id="blurValue">15</span>px</div>
                </div>

                <div class="control-group">
                    <label>üé® Disc Color</label>
                    <button class="toggle-btn active" id="colorToggle">Lilac/Magenta</button>
                </div>

                <div class="control-group">
                    <label>‚è∏Ô∏è Animation</label>
                    <button class="toggle-btn active" id="animToggle">Running</button>
                </div>

                <div class="control-group">
                    <label>üîç Show Fixation Cross</label>
                    <button class="toggle-btn active" id="crossToggle">Visible</button>
                </div>
            </div>
        </div>

        <div class="phenomena-grid">
            <div class="phenomenon-card phi">
                <h3>1. Phi Phenomenon</h3>
                <p>Nothing is actually moving! The discs appear and disappear in sequence, creating the <em>illusion of motion</em>. Your brain "fills in" the movement between discrete positions. This is the same principle behind movies and animations ‚Äî your visual system interpolates motion from static frames.</p>
            </div>

            <div class="phenomenon-card afterimage">
                <h3>2. Negative Afterimage</h3>
                <p>The <strong>green dot</strong> doesn't exist! When you stare at the pink/magenta discs, the cone cells in your retina that detect red become fatigued. When the disc disappears, those tired cells respond less, creating a "ghost" image in the <em>complementary color</em> ‚Äî green.</p>
            </div>

            <div class="phenomenon-card troxler">
                <h3>3. Troxler's Fading</h3>
                <p>Why do the pink dots disappear? When blurry stimuli are held in your peripheral vision while you fixate, your brain <em>ignores</em> them. This "neural adaptation" evolved to help you focus on what matters. After 30+ seconds, only the moving gap remains visible!</p>
            </div>
        </div>

        <div class="research-section">
            <h2>üìö The Science Behind the Magic</h2>

            <div class="quote-box">
                <p>"I stumbled across the configuration while devising stimuli for visual motion experiments. In one version, I mistakenly neglected to erase the preceding disc, creating the appearance of a moving gap. On noticing the moving green-disc afterimage, I adjusted colors and timing to optimize the effect."</p>
                <div class="attribution">‚Äî Jeremy Hinton, Creator (c. 2005)</div>
            </div>

            <div class="research-content">
                <div class="research-item">
                    <h3>üß† Opponent Process Theory</h3>
                    <p>Your visual system processes colors in three opponent channels: <strong>red vs. green</strong>, <strong>blue vs. yellow</strong>, and <strong>black vs. white</strong>. When the magenta/pink cone cells fatigue, the "green" side of the red-green channel temporarily dominates, producing a vivid green afterimage.</p>
                </div>

                <div class="research-item">
                    <h3>üëÅÔ∏è Retinal Ganglion Cells</h3>
                    <p>Research by Zaidi et al. (2012) localized the neural substrate for afterimages to the retinal ganglion cells ‚Äî the neurons that carry signals from your retina to your brain. The "ghost" green dot is created before the signal even reaches your visual cortex!</p>
                </div>

                <div class="research-item">
                    <h3>üî¨ Why Blur Matters</h3>
                    <p>Troxler's fading only works with <em>blurred</em> peripheral stimuli. Sharp edges trigger "edge detector" neurons that resist adaptation. That's why the effect uses soft, fuzzy discs ‚Äî they're invisible to your brain's edge-detection system.</p>
                    <ul>
                        <li>First described by Ignaz Troxler in 1804</li>
                        <li>Occurs because peripheral vision has fewer cone cells</li>
                        <li>Used in vision research to study neural adaptation</li>
                    </ul>
                </div>

                <div class="research-item">
                    <h3>üé¨ The Phi Phenomenon</h3>
                    <p>Discovered by Max Wertheimer in 1912, the phi phenomenon is "pure motion" perceived between discrete stimuli. It's distinct from beta movement (apparent object motion) and underpins all film, video, and animation. Your visual cortex assumes movement rather than teleportation.</p>
                </div>

                <div class="research-item">
                    <h3>üß™ Try These Variations</h3>
                    <p>Use the controls above to explore:</p>
                    <ul>
                        <li><strong>Remove blur</strong> ‚Äî sharp discs don't fade (Troxler blocked)</li>
                        <li><strong>Speed up</strong> ‚Äî afterimage weakens at high speeds</li>
                        <li><strong>More discs</strong> ‚Äî longer gap intervals, stronger afterimage</li>
                        <li><strong>Hide cross</strong> ‚Äî without fixation target, eyes wander and effect breaks</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <footer>
        The Lilac Chaser ‚Ä¢ Discovered by Jeremy Hinton (c. 2005) ‚Ä¢ Also known as the "Pac-Man Illusion"
    </footer>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');

        // State
        let numDiscs = 12;
        let gapIndex = 0;
        let rotationSpeed = 120;
        let blurAmount = 15;
        let isRunning = true;
        let showCross = true;
        let colorMode = 'lilac';
        let fixationStartTime = Date.now();
        let lastStepTime = Date.now();

        // Colors
        const colors = {
            lilac: 'rgb(218, 112, 214)',
            cyan: 'rgb(100, 200, 230)',
            yellow: 'rgb(255, 230, 100)'
        };

        const bgColor = '#808080'; // Neutral grey for optimal afterimage
        const centerX = canvas.width / 2;
        const centerY = canvas.height / 2;
        const radius = 200;
        const discRadius = 35;

        // Clock positions for display
        const clockPositions = [
            '12 o\'clock', '1 o\'clock', '2 o\'clock', '3 o\'clock',
            '4 o\'clock', '5 o\'clock', '6 o\'clock', '7 o\'clock',
            '8 o\'clock', '9 o\'clock', '10 o\'clock', '11 o\'clock'
        ];

        function getClockPosition(index, total) {
            // Map disc index to nearest clock position
            const fraction = index / total;
            const hourIndex = Math.round(fraction * 12) % 12;
            return clockPositions[hourIndex];
        }

        function drawDisc(x, y, isGap) {
            if (isGap) return;

            const color = colors[colorMode];
            const blur = blurAmount;

            ctx.save();

            // Create radial gradient for blur effect
            const gradient = ctx.createRadialGradient(x, y, 0, x, y, discRadius + blur);
            gradient.addColorStop(0, color);
            gradient.addColorStop(0.6, color);
            gradient.addColorStop(1, 'rgba(128, 128, 128, 0)');

            ctx.fillStyle = gradient;
            ctx.beginPath();
            ctx.arc(x, y, discRadius + blur, 0, Math.PI * 2);
            ctx.fill();

            ctx.restore();
        }

        function drawFixationCross() {
            if (!showCross) return;

            ctx.strokeStyle = '#000';
            ctx.lineWidth = 3;

            // Horizontal line
            ctx.beginPath();
            ctx.moveTo(centerX - 15, centerY);
            ctx.lineTo(centerX + 15, centerY);
            ctx.stroke();

            // Vertical line
            ctx.beginPath();
            ctx.moveTo(centerX, centerY - 15);
            ctx.lineTo(centerX, centerY + 15);
            ctx.stroke();
        }

        function draw() {
            // Clear with grey background
            ctx.fillStyle = bgColor;
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // Draw discs
            for (let i = 0; i < numDiscs; i++) {
                // Start from top (12 o'clock) and go clockwise
                const angle = (i / numDiscs) * Math.PI * 2 - Math.PI / 2;
                const x = centerX + Math.cos(angle) * radius;
                const y = centerY + Math.sin(angle) * radius;

                drawDisc(x, y, i === gapIndex);
            }

            // Draw fixation cross on top
            drawFixationCross();
        }

        function updateStats() {
            const elapsed = Math.floor((Date.now() - fixationStartTime) / 1000);
            document.getElementById('fixationTime').textContent = elapsed + 's';

            document.getElementById('gapPosition').textContent = getClockPosition(gapIndex, numDiscs);

            let phase = 'Warming up...';
            if (elapsed >= 30) {
                phase = '‚ú® Full Troxler!';
            } else if (elapsed >= 15) {
                phase = 'üëª Fading begins';
            } else if (elapsed >= 5) {
                phase = 'üíö Green visible';
            }
            document.getElementById('effectPhase').textContent = phase;
        }

        function step() {
            gapIndex = (gapIndex + 1) % numDiscs;
        }

        function animate() {
            const now = Date.now();

            if (isRunning && now - lastStepTime >= rotationSpeed) {
                step();
                lastStepTime = now;
            }

            draw();
            updateStats();
            requestAnimationFrame(animate);
        }

        // Control handlers
        document.getElementById('speedSlider').addEventListener('input', (e) => {
            rotationSpeed = parseInt(e.target.value);
            document.getElementById('speedValue').textContent = rotationSpeed;
        });

        document.getElementById('discsSlider').addEventListener('input', (e) => {
            numDiscs = parseInt(e.target.value);
            gapIndex = gapIndex % numDiscs;
            document.getElementById('discsValue').textContent = numDiscs;
        });

        document.getElementById('blurSlider').addEventListener('input', (e) => {
            blurAmount = parseInt(e.target.value);
            document.getElementById('blurValue').textContent = blurAmount;
        });

        document.getElementById('colorToggle').addEventListener('click', (e) => {
            const modes = ['lilac', 'cyan', 'yellow'];
            const names = ['Lilac/Magenta', 'Cyan/Blue', 'Yellow/Orange'];
            const currentIndex = modes.indexOf(colorMode);
            const nextIndex = (currentIndex + 1) % modes.length;
            colorMode = modes[nextIndex];
            e.target.textContent = names[nextIndex];
        });

        document.getElementById('animToggle').addEventListener('click', (e) => {
            isRunning = !isRunning;
            e.target.textContent = isRunning ? 'Running' : 'Paused';
            e.target.classList.toggle('active', isRunning);
        });

        document.getElementById('crossToggle').addEventListener('click', (e) => {
            showCross = !showCross;
            e.target.textContent = showCross ? 'Visible' : 'Hidden';
            e.target.classList.toggle('active', showCross);
        });

        // Reset fixation timer on mouse movement over canvas
        canvas.addEventListener('mousemove', () => {
            fixationStartTime = Date.now();
        });

        // Start animation
        animate();
    </script>
    <script src="../assets/js/enhance.js" defer></script>
</body>
</html>
