<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dragon Curve - The Paper Folding Fractal</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: linear-gradient(135deg, #1a0a0a 0%, #2d1f1f 100%);
            color: #e0e0e0;
            min-height: 100vh;
            padding: 20px;
        }
        .back-link {
            display: inline-flex;
            align-items: center;
            color: #ef4444;
            text-decoration: none;
            margin-bottom: 15px;
            font-size: 0.95em;
        }
        .back-link:hover {
            color: #f87171;
            text-decoration: underline;
        }
        h1 {
            font-size: 1.8em;
            margin-bottom: 5px;
            color: #fff;
            text-shadow: 0 0 30px rgba(239, 68, 68, 0.5);
        }
        .subtitle {
            color: #f87171;
            margin-bottom: 20px;
            font-size: 1.05em;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        .main-content {
            display: grid;
            grid-template-columns: 1fr 350px;
            gap: 20px;
        }
        .canvas-container {
            background: rgba(0,0,0,0.4);
            border-radius: 12px;
            padding: 15px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        canvas {
            border-radius: 8px;
            background: #0a0505;
        }
        .info-text {
            margin-top: 10px;
            font-size: 0.8em;
            color: #f87171;
        }
        .sidebar {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        .panel {
            background: rgba(255,255,255,0.05);
            border-radius: 12px;
            padding: 15px;
            border: 1px solid rgba(255,255,255,0.1);
        }
        .panel h3 {
            font-size: 0.9em;
            color: #ef4444;
            margin-bottom: 12px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .controls {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }
        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.85em;
            font-weight: 500;
            transition: all 0.2s;
        }
        .btn-primary {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            color: white;
        }
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(239, 68, 68, 0.4);
        }
        .btn-secondary {
            background: rgba(255,255,255,0.1);
            color: #e0e0e0;
            border: 1px solid rgba(255,255,255,0.2);
        }
        .btn-secondary:hover {
            background: rgba(255,255,255,0.2);
        }
        .param-group {
            margin-bottom: 15px;
        }
        .param-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
        }
        .param-name {
            color: #f87171;
            font-size: 0.85em;
        }
        .param-value {
            color: #fca5a5;
            font-family: 'Monaco', 'Consolas', monospace;
            font-size: 0.9em;
        }
        input[type="range"] {
            width: 100%;
            height: 6px;
            border-radius: 3px;
            background: rgba(255,255,255,0.1);
            -webkit-appearance: none;
        }
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: #ef4444;
            cursor: pointer;
        }
        .stat-row {
            display: flex;
            justify-content: space-between;
            padding: 6px 0;
            border-bottom: 1px solid rgba(255,255,255,0.05);
        }
        .stat-label {
            color: #f87171;
            font-size: 0.8em;
        }
        .stat-value {
            color: #fca5a5;
            font-family: 'Monaco', 'Consolas', monospace;
            font-size: 0.8em;
        }
        .lsystem-box {
            background: rgba(0,0,0,0.3);
            padding: 10px;
            border-radius: 6px;
            margin-top: 10px;
        }
        .lsystem-box code {
            font-family: 'Monaco', 'Consolas', monospace;
            color: #fca5a5;
            font-size: 0.8em;
            display: block;
            line-height: 1.6;
        }
        .fold-sequence {
            font-family: 'Monaco', 'Consolas', monospace;
            font-size: 0.75em;
            color: #f87171;
            word-break: break-all;
            max-height: 60px;
            overflow-y: auto;
            padding: 8px;
            background: rgba(0,0,0,0.3);
            border-radius: 4px;
            margin-top: 8px;
        }
        .exp-section {
            margin-top: 20px;
        }
        .exp-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 15px;
        }
        .exp-card {
            background: linear-gradient(135deg, rgba(239,68,68,0.1), rgba(220,38,38,0.05));
            border-radius: 10px;
            padding: 15px;
            border: 1px solid rgba(239,68,68,0.2);
        }
        .exp-card h4 {
            color: #ef4444;
            margin-bottom: 8px;
            font-size: 0.95em;
        }
        .exp-card p {
            font-size: 0.85em;
            line-height: 1.6;
            color: #f87171;
        }
        @media (max-width: 900px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <a href="index.html" class="back-link">← Back to Paradoxes</a>
        <h1>The Dragon Curve</h1>
        <p class="subtitle">A Fractal from Paper Folding That Fills the Plane</p>

        <div class="main-content">
            <div class="canvas-container">
                <canvas id="mainCanvas" width="650" height="600"></canvas>
                <p class="info-text">The dragon never crosses itself—every edge is unique!</p>
            </div>

            <div class="sidebar">
                <div class="panel">
                    <h3>Controls</h3>
                    <div class="controls">
                        <button class="btn btn-primary" id="animateBtn">Animate</button>
                        <button class="btn btn-secondary" id="resetBtn">Reset</button>
                    </div>
                </div>

                <div class="panel">
                    <h3>Iterations</h3>
                    <div class="param-group">
                        <div class="param-label">
                            <span class="param-name">Folds (n)</span>
                            <span class="param-value" id="iterValue">10</span>
                        </div>
                        <input type="range" id="iterSlider" min="1" max="18" value="10">
                    </div>
                    <div class="param-group">
                        <div class="param-label">
                            <span class="param-name">Rotation</span>
                            <span class="param-value" id="rotValue">0°</span>
                        </div>
                        <input type="range" id="rotSlider" min="0" max="360" value="0">
                    </div>
                </div>

                <div class="panel">
                    <h3>Statistics</h3>
                    <div class="stat-row">
                        <span class="stat-label">Segments</span>
                        <span id="segments" class="stat-value">1,024</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Right turns</span>
                        <span id="rightTurns" class="stat-value">-</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Left turns</span>
                        <span id="leftTurns" class="stat-value">-</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Fractal dimension</span>
                        <span class="stat-value">2.0 (space-filling!)</span>
                    </div>
                </div>

                <div class="panel">
                    <h3>Fold Sequence</h3>
                    <p style="font-size: 0.75em; color: #f87171;">R = Right turn, L = Left turn</p>
                    <div class="fold-sequence" id="foldSeq">R</div>
                </div>

                <div class="panel">
                    <h3>L-System Rules</h3>
                    <div class="lsystem-box">
                        <code>
                            Axiom: FX<br>
                            X → X+YF+<br>
                            Y → -FX-Y<br>
                            Angle: 90°
                        </code>
                    </div>
                </div>
            </div>
        </div>

        <div class="exp-section">
            <div class="exp-cards">
                <div class="exp-card">
                    <h4>John Heighway (1966)</h4>
                    <p>NASA physicist John Heighway discovered this curve by repeatedly folding a strip of paper in half, always in the same direction. Unfold it so each crease becomes a 90° angle—you get the dragon! Martin Gardner popularized it in his 1967 Scientific American column.</p>
                </div>
                <div class="exp-card">
                    <h4>The Jurassic Park Dragon</h4>
                    <p>Michael Crichton featured iterations of the dragon curve on chapter title pages in his novel "Jurassic Park" (1990). The curve symbolized the unpredictable chaos that emerges from simple rules—a perfect metaphor for the park's dinosaur disaster!</p>
                </div>
                <div class="exp-card">
                    <h4>Fractal Dimension = 2</h4>
                    <p>Unlike the Koch Snowflake (dim ≈ 1.26), the dragon curve has dimension EXACTLY 2. It's a space-filling curve! Four copies tile the plane perfectly. Yet it never crosses itself—the boundary has measure zero but the interior fills space.</p>
                </div>
                <div class="exp-card">
                    <h4>The Fold Sequence Pattern</h4>
                    <p>The turn sequence follows a beautiful recursive rule. Take previous sequence, add R, then append the previous sequence REVERSED with L/R swapped. Or: the nth bit tells you the nth turn! (A variant of the Gray code.)</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('mainCanvas');
        const ctx = canvas.getContext('2d');

        let iterations = 10;
        let rotation = 0;
        let animating = false;
        let animationIter = 0;

        // Generate dragon curve turn sequence
        // R = 1 (right), L = 0 (left)
        function generateTurns(n) {
            if (n === 0) return [];
            if (n === 1) return [1]; // R

            const prev = generateTurns(n - 1);
            const reversed = [...prev].reverse().map(t => 1 - t);
            return [...prev, 1, ...reversed];
        }

        // Draw the dragon curve
        function draw() {
            const w = canvas.width;
            const h = canvas.height;

            ctx.fillStyle = '#0a0505';
            ctx.fillRect(0, 0, w, h);

            const turns = generateTurns(iterations);
            const numSegments = turns.length + 1;

            // Calculate segment length to fit canvas
            // Approximate bounding box grows as 2^(n/2)
            const scale = Math.min(w, h) * 0.8 / Math.pow(2, iterations / 2);
            const segmentLength = Math.max(1, scale);

            // Start from center
            let x = w / 2;
            let y = h / 2;
            let angle = rotation * Math.PI / 180;

            // First pass: find bounds
            let points = [{ x, y }];
            let direction = angle;

            for (let i = 0; i < turns.length; i++) {
                x += Math.cos(direction) * segmentLength;
                y += Math.sin(direction) * segmentLength;
                points.push({ x, y });

                // Turn: R = +90°, L = -90°
                direction += turns[i] ? Math.PI / 2 : -Math.PI / 2;
            }
            // Final segment
            x += Math.cos(direction) * segmentLength;
            y += Math.sin(direction) * segmentLength;
            points.push({ x, y });

            // Center the curve
            let minX = Infinity, maxX = -Infinity, minY = Infinity, maxY = -Infinity;
            for (const p of points) {
                minX = Math.min(minX, p.x);
                maxX = Math.max(maxX, p.x);
                minY = Math.min(minY, p.y);
                maxY = Math.max(maxY, p.y);
            }

            const offsetX = (w - (maxX + minX)) / 2;
            const offsetY = (h - (maxY + minY)) / 2;

            // Draw
            ctx.lineWidth = Math.max(1, 3 - iterations * 0.15);
            ctx.lineCap = 'round';
            ctx.lineJoin = 'round';

            ctx.beginPath();
            ctx.moveTo(points[0].x + offsetX, points[0].y + offsetY);

            for (let i = 1; i < points.length; i++) {
                // Color gradient along curve
                const t = i / points.length;
                const hue = 0 + t * 60; // Red to orange
                ctx.strokeStyle = `hsl(${hue}, 80%, 55%)`;
                ctx.beginPath();
                ctx.moveTo(points[i - 1].x + offsetX, points[i - 1].y + offsetY);
                ctx.lineTo(points[i].x + offsetX, points[i].y + offsetY);
                ctx.stroke();
            }

            // Update stats
            const rightTurns = turns.filter(t => t === 1).length;
            const leftTurns = turns.filter(t => t === 0).length;

            document.getElementById('segments').textContent = numSegments.toLocaleString();
            document.getElementById('rightTurns').textContent = rightTurns.toLocaleString();
            document.getElementById('leftTurns').textContent = leftTurns.toLocaleString();
            document.getElementById('iterValue').textContent = iterations;
            document.getElementById('rotValue').textContent = rotation + '°';

            // Show fold sequence (abbreviated)
            const seq = turns.map(t => t ? 'R' : 'L').join('');
            const displaySeq = seq.length > 100 ? seq.substring(0, 100) + '...' : seq;
            document.getElementById('foldSeq').textContent = displaySeq || 'R';
        }

        function animate() {
            if (!animating) return;

            animationIter++;
            if (animationIter > 18) {
                animating = false;
                document.getElementById('animateBtn').textContent = 'Animate';
                return;
            }

            iterations = animationIter;
            document.getElementById('iterSlider').value = iterations;
            draw();

            setTimeout(() => requestAnimationFrame(animate), 500);
        }

        function reset() {
            animating = false;
            animationIter = 0;
            iterations = 1;
            document.getElementById('iterSlider').value = 1;
            document.getElementById('animateBtn').textContent = 'Animate';
            draw();
        }

        // Event handlers
        document.getElementById('iterSlider').addEventListener('input', (e) => {
            iterations = parseInt(e.target.value);
            draw();
        });

        document.getElementById('rotSlider').addEventListener('input', (e) => {
            rotation = parseInt(e.target.value);
            draw();
        });

        document.getElementById('animateBtn').addEventListener('click', () => {
            if (animating) {
                animating = false;
                document.getElementById('animateBtn').textContent = 'Animate';
            } else {
                animating = true;
                animationIter = 0;
                document.getElementById('animateBtn').textContent = 'Stop';
                animate();
            }
        });

        document.getElementById('resetBtn').addEventListener('click', reset);

        // Initial draw
        draw();
    </script>
</body>
</html>
