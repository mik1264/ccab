<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Moiré Patterns - Emergent Interference</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: linear-gradient(135deg, #1a1a1a 0%, #2a2a2a 50%, #1a1a2a 100%);
            color: #e0e0e0;
            min-height: 100vh;
            padding: 20px;
        }
        .back-link {
            display: inline-flex;
            align-items: center;
            color: #ec4899;
            text-decoration: none;
            margin-bottom: 15px;
            font-size: 0.95em;
        }
        .back-link:hover {
            color: #f472b6;
            text-decoration: underline;
        }
        h1 {
            font-size: 1.8em;
            margin-bottom: 5px;
            color: #fff;
            text-shadow: 0 0 30px rgba(236, 72, 153, 0.5);
        }
        .subtitle {
            color: #f472b6;
            margin-bottom: 20px;
            font-size: 1.05em;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        .main-content {
            display: grid;
            grid-template-columns: 1fr 320px;
            gap: 20px;
        }
        .canvas-container {
            background: rgba(0,0,0,0.4);
            border-radius: 12px;
            padding: 15px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        canvas {
            border-radius: 8px;
            background: #fff;
        }
        .info-text {
            margin-top: 10px;
            font-size: 0.8em;
            color: #ec4899;
        }
        .sidebar {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        .panel {
            background: rgba(255,255,255,0.05);
            border-radius: 12px;
            padding: 15px;
            border: 1px solid rgba(255,255,255,0.1);
        }
        .panel h3 {
            font-size: 0.9em;
            color: #ec4899;
            margin-bottom: 12px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .controls {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }
        .btn {
            padding: 8px 14px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.85em;
            font-weight: 500;
            transition: all 0.2s;
        }
        .btn-primary {
            background: linear-gradient(135deg, #ec4899, #db2777);
            color: white;
        }
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(236, 72, 153, 0.4);
        }
        .btn-secondary {
            background: rgba(255,255,255,0.1);
            color: #e0e0e0;
            border: 1px solid rgba(255,255,255,0.2);
        }
        .btn-secondary:hover {
            background: rgba(255,255,255,0.2);
        }
        .btn-secondary.active {
            background: rgba(236, 72, 153, 0.3);
            border-color: #ec4899;
        }
        .param-group {
            margin-bottom: 12px;
        }
        .param-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
        }
        .param-name {
            color: #f472b6;
            font-size: 0.85em;
        }
        .param-value {
            color: #f9a8d4;
            font-family: 'Monaco', 'Consolas', monospace;
            font-size: 0.9em;
        }
        input[type="range"] {
            width: 100%;
            height: 6px;
            border-radius: 3px;
            background: rgba(255,255,255,0.1);
            -webkit-appearance: none;
        }
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: #ec4899;
            cursor: pointer;
        }
        .pattern-buttons {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 6px;
        }
        .formula-box {
            background: rgba(0,0,0,0.3);
            padding: 12px;
            border-radius: 6px;
            font-family: 'Monaco', 'Consolas', monospace;
            font-size: 0.75em;
            line-height: 1.8;
            color: #f9a8d4;
            text-align: center;
        }
        .exp-section {
            margin-top: 20px;
        }
        .exp-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 15px;
        }
        .exp-card {
            background: linear-gradient(135deg, rgba(236,72,153,0.1), rgba(219,39,119,0.05));
            border-radius: 10px;
            padding: 15px;
            border: 1px solid rgba(236,72,153,0.2);
        }
        .exp-card h4 {
            color: #ec4899;
            margin-bottom: 8px;
            font-size: 0.95em;
        }
        .exp-card p {
            font-size: 0.85em;
            line-height: 1.6;
            color: #f472b6;
        }
        @media (max-width: 900px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <a href="index.html" class="back-link">← Back to Paradoxes</a>
        <h1>Moiré Patterns</h1>
        <p class="subtitle">Where Two Simple Patterns Create Unexpected Complexity</p>

        <div class="main-content">
            <div class="canvas-container">
                <canvas id="mainCanvas" width="650" height="600"></canvas>
                <p class="info-text">Two identical patterns, slightly rotated → emergent interference pattern</p>
            </div>

            <div class="sidebar">
                <div class="panel">
                    <h3>Controls</h3>
                    <div class="controls">
                        <button class="btn btn-primary" id="animateBtn">Animate</button>
                        <button class="btn btn-secondary" id="resetBtn">Reset</button>
                    </div>
                </div>

                <div class="panel">
                    <h3>Pattern Type</h3>
                    <div class="pattern-buttons">
                        <button class="btn btn-secondary active" data-pattern="lines">Lines</button>
                        <button class="btn btn-secondary" data-pattern="circles">Circles</button>
                        <button class="btn btn-secondary" data-pattern="dots">Dots</button>
                    </div>
                </div>

                <div class="panel">
                    <h3>Parameters</h3>
                    <div class="param-group">
                        <div class="param-label">
                            <span class="param-name">Rotation (degrees)</span>
                            <span class="param-value" id="rotationValue">5.0°</span>
                        </div>
                        <input type="range" id="rotationSlider" min="0" max="45" step="0.1" value="5">
                    </div>
                    <div class="param-group">
                        <div class="param-label">
                            <span class="param-name">Scale difference (%)</span>
                            <span class="param-value" id="scaleValue">0%</span>
                        </div>
                        <input type="range" id="scaleSlider" min="-10" max="10" step="0.1" value="0">
                    </div>
                    <div class="param-group">
                        <div class="param-label">
                            <span class="param-name">Line spacing (px)</span>
                            <span class="param-value" id="spacingValue">8</span>
                        </div>
                        <input type="range" id="spacingSlider" min="4" max="20" value="8">
                    </div>
                    <div class="param-group">
                        <div class="param-label">
                            <span class="param-name">Line width (px)</span>
                            <span class="param-value" id="widthValue">2</span>
                        </div>
                        <input type="range" id="widthSlider" min="1" max="6" value="2">
                    </div>
                </div>

                <div class="panel">
                    <h3>The Math</h3>
                    <div class="formula-box">
                        Moiré period = λ / (2 sin(θ/2))<br>
                        <span style="font-size: 0.9em;">As θ → 0, period → ∞</span>
                    </div>
                    <p style="font-size: 0.7em; color: #94a3b8; margin-top: 8px;">
                        Spatial frequencies interfere like waves.
                        The "beat frequency" creates the visible pattern.
                    </p>
                </div>

                <div class="panel">
                    <h3>Presets</h3>
                    <div class="controls">
                        <button class="btn btn-secondary preset-btn" data-rot="3" data-scale="0">Gentle</button>
                        <button class="btn btn-secondary preset-btn" data-rot="7" data-scale="0">Classic</button>
                        <button class="btn btn-secondary preset-btn" data-rot="15" data-scale="0">Strong</button>
                        <button class="btn btn-secondary preset-btn" data-rot="1" data-scale="5">Scale Only</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="exp-section">
            <div class="exp-cards">
                <div class="exp-card">
                    <h4>Wave Interference</h4>
                    <p>Moiré patterns are fundamentally a form of spatial interference—the same physics behind the double-slit experiment! When two periodic structures overlap, their spatial frequencies combine. Where they align: constructive interference (dark). Where they cancel: destructive (light).</p>
                </div>
                <div class="exp-card">
                    <h4>Emergent Complexity</h4>
                    <p>Neither layer contains the swirling pattern you see—it EMERGES from their interaction! This is a perfect visual metaphor for emergent phenomena in complex systems. Simple rules, layered together, create structures that aren't "in" any individual component.</p>
                </div>
                <div class="exp-card">
                    <h4>Magic Angle Graphene</h4>
                    <p>In 2018, physicists discovered that stacking two graphene sheets rotated by exactly 1.1° creates a moiré superlattice that becomes a SUPERCONDUCTOR! The "magic angle" creates electronic interference patterns that enable zero-resistance electricity flow.</p>
                </div>
                <div class="exp-card">
                    <h4>Art, Security & Problems</h4>
                    <p>Op artists like Bridget Riley deliberately create moiré for visual effects. Security holograms use moiré for anti-counterfeiting. But in printing and photography, moiré is a nuisance—causing unwanted patterns when scanning halftone images or photographing screens!</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('mainCanvas');
        const ctx = canvas.getContext('2d');

        // Parameters
        let patternType = 'lines';
        let rotation = 5;  // degrees
        let scaleDiff = 0;  // percentage
        let spacing = 8;
        let lineWidth = 2;
        let animating = false;
        let animationId = null;

        function drawPattern(offsetX, offsetY, rot, scale) {
            ctx.save();
            ctx.translate(canvas.width / 2 + offsetX, canvas.height / 2 + offsetY);
            ctx.rotate(rot * Math.PI / 180);
            ctx.scale(scale, scale);

            const size = Math.max(canvas.width, canvas.height) * 1.5;

            ctx.strokeStyle = 'black';
            ctx.fillStyle = 'black';
            ctx.lineWidth = lineWidth / scale;

            if (patternType === 'lines') {
                // Parallel lines
                for (let x = -size; x <= size; x += spacing) {
                    ctx.beginPath();
                    ctx.moveTo(x, -size);
                    ctx.lineTo(x, size);
                    ctx.stroke();
                }
            } else if (patternType === 'circles') {
                // Concentric circles
                for (let r = spacing; r <= size; r += spacing) {
                    ctx.beginPath();
                    ctx.arc(0, 0, r, 0, Math.PI * 2);
                    ctx.stroke();
                }
            } else if (patternType === 'dots') {
                // Dot grid
                const dotRadius = lineWidth;
                for (let x = -size; x <= size; x += spacing) {
                    for (let y = -size; y <= size; y += spacing) {
                        ctx.beginPath();
                        ctx.arc(x, y, dotRadius / scale, 0, Math.PI * 2);
                        ctx.fill();
                    }
                }
            }

            ctx.restore();
        }

        function draw() {
            // White background
            ctx.fillStyle = 'white';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // Use composite operations to create interference
            ctx.globalCompositeOperation = 'darken';

            // First pattern (base)
            drawPattern(0, 0, 0, 1);

            // Second pattern (rotated/scaled)
            const scale2 = 1 + scaleDiff / 100;
            drawPattern(0, 0, rotation, scale2);

            ctx.globalCompositeOperation = 'source-over';
        }

        function animate() {
            if (!animating) return;

            rotation += 0.1;
            if (rotation > 45) rotation = 0;

            document.getElementById('rotationSlider').value = rotation;
            document.getElementById('rotationValue').textContent = rotation.toFixed(1) + '°';
            draw();

            animationId = requestAnimationFrame(animate);
        }

        function reset() {
            rotation = 5;
            scaleDiff = 0;
            spacing = 8;
            lineWidth = 2;
            patternType = 'lines';

            document.getElementById('rotationSlider').value = rotation;
            document.getElementById('scaleSlider').value = scaleDiff;
            document.getElementById('spacingSlider').value = spacing;
            document.getElementById('widthSlider').value = lineWidth;

            document.getElementById('rotationValue').textContent = rotation.toFixed(1) + '°';
            document.getElementById('scaleValue').textContent = scaleDiff + '%';
            document.getElementById('spacingValue').textContent = spacing;
            document.getElementById('widthValue').textContent = lineWidth;

            // Update pattern buttons
            document.querySelectorAll('[data-pattern]').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.pattern === 'lines');
            });

            draw();
        }

        // Event handlers
        document.getElementById('rotationSlider').addEventListener('input', (e) => {
            rotation = parseFloat(e.target.value);
            document.getElementById('rotationValue').textContent = rotation.toFixed(1) + '°';
            draw();
        });

        document.getElementById('scaleSlider').addEventListener('input', (e) => {
            scaleDiff = parseFloat(e.target.value);
            document.getElementById('scaleValue').textContent = scaleDiff.toFixed(1) + '%';
            draw();
        });

        document.getElementById('spacingSlider').addEventListener('input', (e) => {
            spacing = parseInt(e.target.value);
            document.getElementById('spacingValue').textContent = spacing;
            draw();
        });

        document.getElementById('widthSlider').addEventListener('input', (e) => {
            lineWidth = parseInt(e.target.value);
            document.getElementById('widthValue').textContent = lineWidth;
            draw();
        });

        document.getElementById('animateBtn').addEventListener('click', () => {
            if (animating) {
                animating = false;
                cancelAnimationFrame(animationId);
                document.getElementById('animateBtn').textContent = 'Animate';
            } else {
                animating = true;
                document.getElementById('animateBtn').textContent = 'Stop';
                animate();
            }
        });

        document.getElementById('resetBtn').addEventListener('click', reset);

        document.querySelectorAll('[data-pattern]').forEach(btn => {
            btn.addEventListener('click', () => {
                patternType = btn.dataset.pattern;
                document.querySelectorAll('[data-pattern]').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                draw();
            });
        });

        document.querySelectorAll('.preset-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                rotation = parseFloat(btn.dataset.rot);
                scaleDiff = parseFloat(btn.dataset.scale);
                document.getElementById('rotationSlider').value = rotation;
                document.getElementById('scaleSlider').value = scaleDiff;
                document.getElementById('rotationValue').textContent = rotation.toFixed(1) + '°';
                document.getElementById('scaleValue').textContent = scaleDiff.toFixed(1) + '%';
                draw();
            });
        });

        // Initial draw
        draw();
    </script>
    <script src="../assets/js/enhance.js" defer></script>
</body>
</html>
