<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Unexpected Hanging Paradox - Surprising Paradoxes</title>
    <link href="https://fonts.googleapis.com/css2?family=Lora:wght@400;500;600;700&family=Nunito:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --sage: #8A9A5B;
            --moss: #606C38;
            --earth: #DDA15E;
            --cream: #FEFAE0;
            --terracotta: #BC6C25;
            --dark-moss: #3d4423;
            --prison: #44403c;
            --bars: #78716c;
            --judge: #7c3aed;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Nunito', sans-serif;
            background: linear-gradient(135deg, #FEFAE0 0%, #F4F1DE 50%, #EDE8D5 100%);
            min-height: 100vh;
            color: var(--dark-moss);
            line-height: 1.8;
        }
        .organic-shape {
            position: fixed;
            border-radius: 60% 40% 50% 50% / 50% 60% 40% 50%;
            opacity: 0.12;
            z-index: 0;
            animation: morph 30s ease-in-out infinite;
        }
        .shape-1 { width: 600px; height: 600px; background: var(--prison); top: -200px; right: -150px; }
        .shape-2 { width: 500px; height: 500px; background: var(--judge); bottom: -150px; left: -150px; animation-delay: -15s; }
        @keyframes morph {
            0%, 100% { border-radius: 60% 40% 50% 50% / 50% 60% 40% 50%; }
            25% { border-radius: 50% 60% 40% 50% / 40% 50% 60% 50%; }
            50% { border-radius: 40% 50% 60% 50% / 50% 40% 50% 60%; }
            75% { border-radius: 50% 40% 50% 60% / 60% 50% 40% 50%; }
        }
        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 40px 20px 80px;
            position: relative;
            z-index: 1;
        }
        .back-link {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            color: var(--moss);
            text-decoration: none;
            font-weight: 500;
            margin-bottom: 30px;
            padding: 10px 20px;
            background: rgba(255,255,255,0.6);
            backdrop-filter: blur(10px);
            border-radius: 30px;
            transition: all 0.3s ease;
        }
        .back-link:hover { background: rgba(255,255,255,0.9); transform: translateX(-5px); }
        h1 { font-family: 'Lora', serif; font-size: 2.8rem; color: var(--moss); margin-bottom: 20px; }
        .subtitle { font-size: 1.3rem; color: var(--terracotta); margin-bottom: 40px; font-weight: 500; }
        .section {
            background: rgba(255,255,255,0.6);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            border: 1px solid rgba(138,154,91,0.2);
        }
        h2 { font-family: 'Lora', serif; font-size: 1.6rem; color: var(--moss); margin-bottom: 20px; }
        h3 { font-family: 'Lora', serif; font-size: 1.3rem; color: var(--terracotta); margin: 25px 0 15px; }
        p { margin-bottom: 15px; color: #555; }
        .highlight {
            background: linear-gradient(135deg, rgba(124,58,237,0.1), rgba(68,64,60,0.1));
            border-left: 4px solid var(--judge);
            padding: 20px 25px;
            border-radius: 0 15px 15px 0;
            margin: 25px 0;
        }
        .highlight p { margin-bottom: 0; font-weight: 500; color: var(--dark-moss); }

        /* Simulation Container */
        .sim-container {
            background: linear-gradient(180deg, #e7e5e4 0%, #d6d3d1 100%);
            border-radius: 20px;
            padding: 40px 30px;
            margin: 25px 0;
            position: relative;
            overflow: hidden;
        }
        .sim-title {
            font-family: 'Lora', serif;
            font-size: 1.6rem;
            color: var(--prison);
            margin-bottom: 10px;
            text-align: center;
        }
        .sim-subtitle {
            color: #78716c;
            text-align: center;
            margin-bottom: 25px;
        }

        /* Calendar */
        .calendar-container {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }
        .calendar-header {
            text-align: center;
            font-weight: 700;
            color: var(--prison);
            margin-bottom: 20px;
            font-size: 1.2rem;
        }
        .days-row {
            display: flex;
            justify-content: center;
            gap: 10px;
            flex-wrap: wrap;
        }
        .day-card {
            width: 100px;
            padding: 15px 10px;
            border-radius: 12px;
            text-align: center;
            background: #f5f5f4;
            border: 3px solid transparent;
            transition: all 0.4s ease;
            position: relative;
        }
        .day-card.eliminated {
            background: #fee2e2;
            border-color: #fca5a5;
            opacity: 0.6;
        }
        .day-card.eliminated::after {
            content: '‚úó';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 3rem;
            color: #dc2626;
            opacity: 0.5;
        }
        .day-card.possible {
            background: #dcfce7;
            border-color: #86efac;
        }
        .day-card.current {
            background: #fef3c7;
            border-color: #fcd34d;
            animation: pulse 1s ease-in-out infinite;
        }
        .day-card.hanging {
            background: #7c3aed;
            border-color: #6d28d9;
        }
        .day-card.hanging .day-name,
        .day-card.hanging .day-status {
            color: white;
        }
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        .day-name {
            font-weight: 700;
            color: var(--prison);
            font-size: 0.9rem;
        }
        .day-status {
            font-size: 0.75rem;
            color: #78716c;
            margin-top: 5px;
        }

        /* Characters */
        .scene {
            display: flex;
            justify-content: center;
            align-items: flex-end;
            gap: 40px;
            margin: 25px 0;
            min-height: 150px;
        }
        .character {
            text-align: center;
            position: relative;
        }
        .avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            margin: 0 auto 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        .avatar.judge { background: linear-gradient(135deg, #c4b5fd, #a78bfa); }
        .avatar.prisoner { background: linear-gradient(135deg, #fed7aa, #fdba74); }
        .avatar.executioner { background: linear-gradient(135deg, #fecaca, #fca5a5); }
        .char-name {
            font-weight: 600;
            color: #78716c;
            font-size: 0.9rem;
        }
        .thought-bubble {
            position: absolute;
            top: -70px;
            left: 50%;
            transform: translateX(-50%);
            background: white;
            padding: 10px 15px;
            border-radius: 15px;
            font-size: 0.85rem;
            white-space: nowrap;
            box-shadow: 0 3px 10px rgba(0,0,0,0.15);
            opacity: 0;
            transition: all 0.4s ease;
            max-width: 180px;
            white-space: normal;
            text-align: center;
        }
        .thought-bubble::after {
            content: '';
            position: absolute;
            bottom: -8px;
            left: 50%;
            transform: translateX(-50%);
            border-left: 8px solid transparent;
            border-right: 8px solid transparent;
            border-top: 8px solid white;
        }
        .character.thinking .thought-bubble {
            opacity: 1;
        }

        /* Narrative */
        .narrative {
            background: rgba(255,255,255,0.9);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
            min-height: 80px;
        }
        .narrative-text {
            color: #78716c;
            font-size: 1.1rem;
            line-height: 1.6;
        }
        .narrative-text.dramatic {
            color: #7c3aed;
            font-weight: 600;
        }
        .narrative-text.surprise {
            color: #dc2626;
            font-weight: 700;
            font-size: 1.3rem;
        }

        /* Controls */
        .sim-controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 25px;
            flex-wrap: wrap;
        }
        .sim-btn {
            padding: 12px 25px;
            border: none;
            border-radius: 25px;
            font-family: 'Nunito', sans-serif;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .sim-btn.primary {
            background: linear-gradient(135deg, #7c3aed, #6d28d9);
            color: white;
        }
        .sim-btn.primary:hover { transform: scale(1.05); box-shadow: 0 5px 20px rgba(124,58,237,0.4); }
        .sim-btn.secondary {
            background: white;
            color: #78716c;
            border: 2px solid #d6d3d1;
        }
        .sim-btn.secondary:hover { background: #f5f5f4; }
        .sim-btn:disabled { opacity: 0.5; cursor: not-allowed; }

        /* Mode Toggle */
        .mode-toggle {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 20px;
        }
        .mode-btn {
            padding: 8px 20px;
            border: 2px solid #d6d3d1;
            border-radius: 20px;
            background: white;
            font-family: 'Nunito', sans-serif;
            font-weight: 600;
            color: #78716c;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .mode-btn.active {
            background: var(--judge);
            border-color: var(--judge);
            color: white;
        }

        /* Stage Indicator */
        .stage-indicator {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin-bottom: 20px;
        }
        .stage-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: #d6d3d1;
            transition: all 0.3s ease;
        }
        .stage-dot.active {
            background: var(--judge);
            transform: scale(1.3);
        }
        .stage-dot.complete {
            background: #16a34a;
        }

        /* Reasoning Steps */
        .reasoning-box {
            background: #fefce8;
            border: 2px solid #fef08a;
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
        }
        .reasoning-title {
            font-weight: 700;
            color: #ca8a04;
            margin-bottom: 10px;
        }
        .reasoning-step {
            display: flex;
            align-items: flex-start;
            gap: 10px;
            margin-bottom: 10px;
            opacity: 0.4;
            transition: opacity 0.4s ease;
        }
        .reasoning-step.active {
            opacity: 1;
        }
        .step-number {
            background: #ca8a04;
            color: white;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
            font-weight: 700;
            flex-shrink: 0;
        }
        .step-text {
            color: #713f12;
            font-size: 0.9rem;
        }

        /* Quote */
        .quote {
            background: linear-gradient(135deg, rgba(124,58,237,0.1), rgba(68,64,60,0.1));
            border-left: 4px solid var(--judge);
            padding: 20px 25px;
            margin: 25px 0;
            font-style: italic;
            border-radius: 0 15px 15px 0;
        }
        .quote-attribution {
            margin-top: 15px;
            font-style: normal;
            font-weight: 600;
            color: var(--judge);
        }

        /* Interpretation Cards */
        .interp-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }
        .interp-card {
            background: rgba(0,0,0,0.03);
            border-radius: 15px;
            padding: 20px;
        }
        .interp-icon {
            font-size: 2rem;
            margin-bottom: 10px;
        }
        .interp-title {
            font-weight: 600;
            color: var(--terracotta);
            margin-bottom: 8px;
        }
        .interp-desc {
            font-size: 0.9rem;
            color: #666;
        }

        /* Sources */
        .sources {
            background: rgba(255,255,255,0.4);
            border-radius: 15px;
            padding: 20px;
            margin-top: 30px;
        }
        .sources h3 { font-family: 'Lora', serif; color: var(--moss); margin-bottom: 10px; }
        .sources ul { list-style: none; }
        .sources li { margin-bottom: 8px; }
        .sources a { color: var(--terracotta); text-decoration: none; }
        .sources a:hover { text-decoration: underline; }

        @media (max-width: 768px) {
            h1 { font-size: 2rem; }
            .day-card { width: 60px; padding: 10px 5px; }
            .day-name { font-size: 0.7rem; }
            .scene { gap: 20px; }
            .avatar { width: 60px; height: 60px; font-size: 2rem; }
        }
    </style>
</head>
<body>
    <div class="organic-shape shape-1"></div>
    <div class="organic-shape shape-2"></div>

    <main class="container">
        <a href="index.html" class="back-link">‚Üê Back to Paradoxes</a>

        <h1>The Unexpected Hanging Paradox</h1>
        <p class="subtitle">A logical proof that something impossible will happen‚Äîand then it does</p>

        <div class="section">
            <h2>The Setup</h2>
            <p>A judge sentences a prisoner to be hanged at noon on one weekday of the following week‚ÄîMonday through Friday. But there's a twist:</p>

            <div class="highlight">
                <p>"The hanging will come as a complete surprise. You will not be able to deduce the day in advance."</p>
            </div>

            <p>The prisoner, being clever, returns to his cell and begins to reason. What follows is one of the most debated paradoxes in philosophy‚Äîone that has generated over 150 academic papers since the 1940s.</p>
        </div>

        <!-- Interactive Simulation -->
        <div class="sim-container">
            <h3 class="sim-title">‚öñÔ∏è The Prisoner's Reasoning ‚öñÔ∏è</h3>
            <p class="sim-subtitle">Watch backward induction unfold</p>

            <div class="mode-toggle">
                <button class="mode-btn active" id="modeReasoning" onclick="setMode('reasoning')">Prisoner's Logic</button>
                <button class="mode-btn" id="modeReality" onclick="setMode('reality')">What Actually Happens</button>
            </div>

            <div class="stage-indicator" id="stageIndicator"></div>

            <div class="calendar-container">
                <div class="calendar-header">Week of Possible Execution</div>
                <div class="days-row">
                    <div class="day-card possible" id="monday">
                        <div class="day-name">MON</div>
                        <div class="day-status" id="monStatus">Possible</div>
                    </div>
                    <div class="day-card possible" id="tuesday">
                        <div class="day-name">TUE</div>
                        <div class="day-status" id="tueStatus">Possible</div>
                    </div>
                    <div class="day-card possible" id="wednesday">
                        <div class="day-name">WED</div>
                        <div class="day-status" id="wedStatus">Possible</div>
                    </div>
                    <div class="day-card possible" id="thursday">
                        <div class="day-name">THU</div>
                        <div class="day-status" id="thuStatus">Possible</div>
                    </div>
                    <div class="day-card possible" id="friday">
                        <div class="day-name">FRI</div>
                        <div class="day-status" id="friStatus">Possible</div>
                    </div>
                </div>
            </div>

            <div class="scene">
                <div class="character" id="judge">
                    <div class="avatar judge">üë®‚Äç‚öñÔ∏è</div>
                    <div class="thought-bubble" id="judgeThought">The sentence is passed.</div>
                    <div class="char-name">Judge</div>
                </div>
                <div class="character" id="prisoner">
                    <div class="avatar prisoner">üßë</div>
                    <div class="thought-bubble" id="prisonerThought">Let me think about this...</div>
                    <div class="char-name">Prisoner</div>
                </div>
                <div class="character" id="executioner" style="display: none;">
                    <div class="avatar executioner">üíÄ</div>
                    <div class="thought-bubble" id="executionerThought">Knock knock...</div>
                    <div class="char-name">Executioner</div>
                </div>
            </div>

            <div class="reasoning-box" id="reasoningBox">
                <div class="reasoning-title">üß† Backward Induction</div>
                <div class="reasoning-step" id="step1">
                    <span class="step-number">1</span>
                    <span class="step-text">If I survive until Thursday evening, it <em>must</em> be Friday‚Äîso Friday can't be a surprise. ‚ùå Friday eliminated.</span>
                </div>
                <div class="reasoning-step" id="step2">
                    <span class="step-number">2</span>
                    <span class="step-text">With Friday gone, if I survive until Wednesday evening, it must be Thursday. ‚ùå Thursday eliminated.</span>
                </div>
                <div class="reasoning-step" id="step3">
                    <span class="step-number">3</span>
                    <span class="step-text">Same logic eliminates Wednesday... ‚ùå</span>
                </div>
                <div class="reasoning-step" id="step4">
                    <span class="step-number">4</span>
                    <span class="step-text">...and Tuesday... ‚ùå</span>
                </div>
                <div class="reasoning-step" id="step5">
                    <span class="step-number">5</span>
                    <span class="step-text">...and Monday! ‚ùå No day works!</span>
                </div>
                <div class="reasoning-step" id="step6">
                    <span class="step-number">6</span>
                    <span class="step-text"><strong>Conclusion:</strong> The hanging is logically impossible! üéâ</span>
                </div>
            </div>

            <div class="narrative">
                <div class="narrative-text" id="narrativeText">
                    The judge has pronounced the sentence. The prisoner begins his logical analysis...
                </div>
            </div>

            <div class="sim-controls">
                <button class="sim-btn primary" id="nextBtn" onclick="nextStep()">‚ñ∂Ô∏è Next</button>
                <button class="sim-btn secondary" onclick="resetSim()">üîÑ Restart</button>
            </div>
        </div>

        <div class="section">
            <h2>The Paradox</h2>
            <p>The prisoner's logic seems airtight. Using <strong>backward induction</strong>‚Äîreasoning from the end to the beginning‚Äîhe eliminates every possible day. He goes to sleep confident the hanging cannot occur.</p>

            <p>Then, on Wednesday at noon, the executioner knocks on his door.</p>

            <p><strong>And the prisoner is utterly surprised.</strong></p>

            <p>Everything the judge said came true: the hanging happened on a weekday, and it was indeed a complete surprise. The prisoner's "proof" that it couldn't happen... led to exactly the conditions that made it happen.</p>

            <div class="quote">
                "The very reasoning that convinced him no surprise was possible is precisely what made the surprise possible."
                <div class="quote-attribution">‚Äî The core insight of the paradox</div>
            </div>
        </div>

        <div class="section">
            <h2>Where Does the Logic Fail?</h2>
            <p>This paradox has puzzled philosophers, logicians, and mathematicians since the 1940s. Here are the main proposed resolutions:</p>

            <div class="interp-grid">
                <div class="interp-card">
                    <div class="interp-icon">üîÑ</div>
                    <div class="interp-title">Self-Refuting Reasoning</div>
                    <div class="interp-desc">The prisoner's conclusion ("no hanging") undermines the very assumptions needed to reach it. Once he "knows" there's no hanging, surprise becomes possible again.</div>
                </div>
                <div class="interp-card">
                    <div class="interp-icon">‚ùì</div>
                    <div class="interp-title">Ambiguous "Surprise"</div>
                    <div class="interp-desc">What does "surprise" mean? Unexpected given initial info? Or unexpected on the morning of? The paradox exploits this ambiguity.</div>
                </div>
                <div class="interp-card">
                    <div class="interp-icon">üìö</div>
                    <div class="interp-title">Knowledge vs. Truth</div>
                    <div class="interp-desc">The prisoner assumes he can "know" the judge's statement is true. But self-referential statements about knowledge are notoriously tricky.</div>
                </div>
                <div class="interp-card">
                    <div class="interp-icon">üéÆ</div>
                    <div class="interp-title">Game Theory View</div>
                    <div class="interp-desc">Similar to the "centipede game"‚Äîbackward induction in games with imperfect information can lead to paradoxical conclusions.</div>
                </div>
            </div>

            <h3>The Base Case Problem</h3>
            <p>The prisoner's reasoning starts with: "If I reach Thursday evening, Friday is the only option, so I can predict it." But this is only valid <em>if</em> the judge's statement remains true at that point. The prisoner is essentially assuming:</p>

            <ul style="margin-left: 25px; margin-bottom: 15px;">
                <li>The judge always tells the truth</li>
                <li>He will still "know" this on Thursday evening</li>
                <li>This knowledge is sufficient to make the prediction</li>
            </ul>

            <p>But knowledge about future events‚Äîespecially events that depend on whether you have that knowledge‚Äîcreates circular dependencies that logic alone cannot resolve.</p>
        </div>

        <div class="section">
            <h2>Historical Origins</h2>
            <p>The paradox emerged in the early 1940s, possibly inspired by a Swedish civil defense exercise in 1943-1944 that was announced as a "surprise" drill for the coming week.</p>

            <p>It first appeared in academic print in 1948 in the journal <em>Mind</em>, discussed by British philosopher D.J. O'Connor as "The Surprise Examination Paradox." Martin Gardner popularized it in his March 1963 <em>Scientific American</em> column, introducing the dramatic "hanging" framing.</p>

            <p>Since then, <strong>over 150 scholarly papers</strong> have been written on the paradox, connecting it to:</p>

            <ul style="margin-left: 25px;">
                <li>G√∂del's incompleteness theorems</li>
                <li>Moore's paradox ("It's raining but I don't believe it")</li>
                <li>The liar paradox and self-reference</li>
                <li>Game theory and backward induction</li>
                <li>The sorites (heap) paradox</li>
            </ul>
        </div>

        <div class="section">
            <h2>Variants & Applications</h2>

            <h3>üéì The Surprise Exam</h3>
            <p>A professor announces: "There will be a surprise quiz next week." Students use the same backward reasoning to "prove" no quiz can happen. Then Wednesday's quiz catches them completely off guard.</p>

            <h3>üî• The Fire Drill</h3>
            <p>Corporate version: "There will be an unannounced fire drill sometime this month." The same logical structure applies.</p>

            <h3>üçæ The Bottle Imp</h3>
            <p>A related paradox: A magic bottle must be resold for less money each time, but grants wishes. At $0.01, no one would buy it (can't resell). But by induction, no price works‚Äîyet people do buy it!</p>
        </div>

        <div class="section">
            <h2>The Deeper Lesson</h2>
            <p>The Unexpected Hanging Paradox reveals a fundamental tension between:</p>

            <ul style="margin-left: 25px; margin-bottom: 15px;">
                <li><strong>Static logic</strong>: Reasoning about fixed truths</li>
                <li><strong>Dynamic knowledge</strong>: How knowledge changes through time and affects outcomes</li>
            </ul>

            <p>Pure logic assumes statements have fixed truth values. But statements about "what will surprise you" are inherently self-referential‚Äîyour beliefs about them change their truth value.</p>

            <p>This is why no canonical resolution exists. The paradox sits at the intersection of logic, epistemology, time, and self-reference‚Äîeach offering different perspectives but none fully capturing the whole.</p>

            <div class="quote">
                "The harder the prisoner tries to predict the hanging, the more unpredictable it becomes."
            </div>
        </div>

        <div class="sources">
            <h3>Sources & Further Reading</h3>
            <ul>
                <li><a href="https://en.wikipedia.org/wiki/Unexpected_hanging_paradox" target="_blank">Wikipedia: Unexpected Hanging Paradox</a></li>
                <li><a href="https://www.britannica.com/topic/unexpected-hanging-paradox" target="_blank">Britannica: Unexpected Hanging Paradox</a></li>
                <li><a href="https://mathworld.wolfram.com/UnexpectedHangingParadox.html" target="_blank">Wolfram MathWorld: Unexpected Hanging Paradox</a></li>
                <li><a href="https://timothychow.net/unexpected.pdf" target="_blank">Timothy Chow: The Surprise Examination (PDF)</a></li>
                <li><a href="https://paulfranceschi.com/pages/surprise-exam/" target="_blank">Paul Franceschi: Dichotomic Analysis</a></li>
            </ul>
        </div>
    </main>

    <script>
        let currentMode = 'reasoning';
        let currentStep = 0;
        const days = ['monday', 'tuesday', 'wednesday', 'thursday', 'friday'];
        const statuses = ['monStatus', 'tueStatus', 'wedStatus', 'thuStatus', 'friStatus'];

        // Reasoning mode stages
        const reasoningStages = [
            {
                narrative: "The judge has pronounced the sentence. The prisoner begins his logical analysis...",
                actions: () => {
                    document.getElementById('prisoner').classList.add('thinking');
                    document.getElementById('judge').classList.add('thinking');
                    document.getElementById('prisonerThought').textContent = "Let me think about this...";
                    document.getElementById('judgeThought').textContent = "The sentence is passed.";
                }
            },
            {
                narrative: "\"If I survive until Thursday evening, Friday is the only option left‚Äîso I could predict it. That means Friday CAN'T be a surprise!\"",
                actions: () => {
                    document.getElementById('prisonerThought').textContent = "Friday is predictable!";
                    eliminateDay('friday', 'friStatus');
                    document.getElementById('step1').classList.add('active');
                }
            },
            {
                narrative: "\"With Friday eliminated, Thursday becomes the last possible day. If I survive Wednesday, I'd know it's Thursday. So Thursday is out too!\"",
                actions: () => {
                    document.getElementById('prisonerThought').textContent = "Thursday's out too!";
                    eliminateDay('thursday', 'thuStatus');
                    document.getElementById('step2').classList.add('active');
                }
            },
            {
                narrative: "\"Same logic... Wednesday can't work either. By Tuesday evening, I'd know!\"",
                actions: () => {
                    document.getElementById('prisonerThought').textContent = "Wednesday's gone!";
                    eliminateDay('wednesday', 'wedStatus');
                    document.getElementById('step3').classList.add('active');
                }
            },
            {
                narrative: "\"And Tuesday falls for the same reason... By Monday evening, I'd know!\"",
                actions: () => {
                    document.getElementById('prisonerThought').textContent = "Tuesday's eliminated!";
                    eliminateDay('tuesday', 'tueStatus');
                    document.getElementById('step4').classList.add('active');
                }
            },
            {
                narrative: "\"Finally, Monday is the only day left‚Äîwhich means I can predict it right now! Monday can't be a surprise either!\"",
                actions: () => {
                    document.getElementById('prisonerThought').textContent = "Even Monday fails!";
                    eliminateDay('monday', 'monStatus');
                    document.getElementById('step5').classList.add('active');
                }
            },
            {
                narrative: "\"I've proven the hanging is IMPOSSIBLE! The judge's statement is self-contradictory! I'm safe!\" The prisoner sleeps peacefully... üò¥",
                actions: () => {
                    document.getElementById('prisonerThought').textContent = "I'm safe! üéâ";
                    document.getElementById('narrativeText').classList.add('dramatic');
                    document.getElementById('step6').classList.add('active');
                    document.getElementById('judge').classList.remove('thinking');
                }
            }
        ];

        // Reality mode stages
        const realityStages = [
            {
                narrative: "The prisoner, confident in his proof, relaxes in his cell. Monday passes... nothing happens.",
                actions: () => {
                    document.getElementById('prisoner').classList.add('thinking');
                    document.getElementById('prisonerThought').textContent = "See? I was right!";
                    highlightDay('monday');
                }
            },
            {
                narrative: "Tuesday passes... still nothing. The prisoner grows more confident.",
                actions: () => {
                    document.getElementById('prisonerThought').textContent = "Still safe! üòä";
                    clearDay('monday');
                    highlightDay('tuesday');
                }
            },
            {
                narrative: "Wednesday morning. The prisoner is humming contentedly in his cell, convinced no hanging can occur...",
                actions: () => {
                    document.getElementById('prisonerThought').textContent = "‚ô™ What a lovely day ‚ô™";
                    clearDay('tuesday');
                    highlightDay('wednesday');
                }
            },
            {
                narrative: "KNOCK KNOCK. The executioner appears at the door.",
                actions: () => {
                    document.getElementById('executioner').style.display = 'block';
                    document.getElementById('executioner').classList.add('thinking');
                    document.getElementById('executionerThought').textContent = "Knock knock...";
                    document.getElementById('prisonerThought').textContent = "Wait, WHAT?!";
                    document.getElementById('narrativeText').classList.add('surprise');
                }
            },
            {
                narrative: "THE PRISONER IS COMPLETELY SURPRISED. Everything the judge said came true!",
                actions: () => {
                    setHangingDay('wednesday');
                    document.getElementById('prisonerThought').textContent = "But... but... my PROOF! üò±";
                    document.getElementById('executionerThought').textContent = "Surprised?";
                }
            },
            {
                narrative: "The very reasoning that made him believe no surprise was possible... is exactly what made the surprise possible.",
                actions: () => {
                    document.getElementById('prisonerThought').textContent = "I don't understand...";
                    document.getElementById('narrativeText').classList.remove('surprise');
                    document.getElementById('narrativeText').classList.add('dramatic');
                }
            }
        ];

        function eliminateDay(dayId, statusId) {
            const day = document.getElementById(dayId);
            day.classList.remove('possible', 'current');
            day.classList.add('eliminated');
            document.getElementById(statusId).textContent = 'Eliminated';
        }

        function highlightDay(dayId) {
            const day = document.getElementById(dayId);
            day.classList.remove('possible', 'eliminated');
            day.classList.add('current');
        }

        function clearDay(dayId) {
            const day = document.getElementById(dayId);
            day.classList.remove('current');
            day.classList.add('possible');
        }

        function setHangingDay(dayId) {
            const day = document.getElementById(dayId);
            day.classList.remove('current', 'possible');
            day.classList.add('hanging');
            const statusId = dayId.slice(0, 3) + 'Status';
            document.getElementById(statusId).textContent = '‚ò†Ô∏è HANGING';
        }

        function setMode(mode) {
            currentMode = mode;
            currentStep = 0;
            document.getElementById('modeReasoning').classList.toggle('active', mode === 'reasoning');
            document.getElementById('modeReality').classList.toggle('active', mode === 'reality');
            document.getElementById('reasoningBox').style.display = mode === 'reasoning' ? 'block' : 'none';
            resetSim();
        }

        function updateStageIndicators() {
            const stages = currentMode === 'reasoning' ? reasoningStages : realityStages;
            const container = document.getElementById('stageIndicator');
            container.innerHTML = '';
            for (let i = 0; i < stages.length; i++) {
                const dot = document.createElement('div');
                dot.className = 'stage-dot';
                if (i < currentStep) dot.classList.add('complete');
                else if (i === currentStep) dot.classList.add('active');
                container.appendChild(dot);
            }
        }

        function nextStep() {
            const stages = currentMode === 'reasoning' ? reasoningStages : realityStages;
            if (currentStep < stages.length) {
                const stage = stages[currentStep];
                document.getElementById('narrativeText').textContent = stage.narrative;
                document.getElementById('narrativeText').classList.remove('dramatic', 'surprise');
                stage.actions();
                currentStep++;
                updateStageIndicators();

                if (currentStep >= stages.length) {
                    document.getElementById('nextBtn').disabled = true;
                }
            }
        }

        function resetSim() {
            currentStep = 0;
            document.getElementById('nextBtn').disabled = false;

            // Reset days
            days.forEach((day, i) => {
                const el = document.getElementById(day);
                el.classList.remove('eliminated', 'current', 'hanging');
                el.classList.add('possible');
                document.getElementById(statuses[i]).textContent = 'Possible';
            });

            // Reset characters
            ['judge', 'prisoner', 'executioner'].forEach(id => {
                document.getElementById(id).classList.remove('thinking');
            });
            document.getElementById('executioner').style.display = 'none';

            // Reset thoughts
            document.getElementById('judgeThought').textContent = 'The sentence is passed.';
            document.getElementById('prisonerThought').textContent = 'Let me think about this...';
            document.getElementById('executionerThought').textContent = 'Knock knock...';

            // Reset reasoning steps
            for (let i = 1; i <= 6; i++) {
                document.getElementById('step' + i).classList.remove('active');
            }

            // Reset narrative
            document.getElementById('narrativeText').textContent = 'The judge has pronounced the sentence. The prisoner begins his logical analysis...';
            document.getElementById('narrativeText').classList.remove('dramatic', 'surprise');

            updateStageIndicators();
        }

        // Initialize
        updateStageIndicators();
    </script>
</body>
</html>
