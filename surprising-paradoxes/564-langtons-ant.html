<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Langton's Ant - Emergent Order from Chaos</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 50%, #1a1a1a 100%);
            min-height: 100vh;
            color: #e0e0e0;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            text-align: center;
            padding: 30px 0;
        }

        h1 {
            font-size: 2.5rem;
            background: linear-gradient(135deg, #ff6b6b, #feca57, #48dbfb);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
        }

        .subtitle {
            font-size: 1.2rem;
            color: #888;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 320px;
            gap: 20px;
            margin-top: 20px;
        }

        .canvas-container {
            background: rgba(0, 0, 0, 0.4);
            border-radius: 15px;
            padding: 20px;
            border: 1px solid rgba(255, 107, 107, 0.2);
        }

        canvas {
            display: block;
            width: 100%;
            background: #fff;
            border-radius: 10px;
        }

        .controls {
            background: rgba(0, 0, 0, 0.4);
            border-radius: 15px;
            padding: 20px;
            border: 1px solid rgba(255, 107, 107, 0.2);
        }

        .control-group {
            margin-bottom: 20px;
        }

        .control-group label {
            display: block;
            color: #ff6b6b;
            margin-bottom: 8px;
            font-weight: 500;
        }

        .slider-container {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        input[type="range"] {
            flex: 1;
            -webkit-appearance: none;
            height: 6px;
            background: linear-gradient(90deg, #ff6b6b, #feca57);
            border-radius: 3px;
            outline: none;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 18px;
            height: 18px;
            background: #ff6b6b;
            border-radius: 50%;
            cursor: pointer;
        }

        .value-display {
            min-width: 60px;
            text-align: right;
            color: #ff6b6b;
            font-family: monospace;
        }

        .button-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
        }

        button {
            padding: 12px 15px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .control-btn {
            background: linear-gradient(135deg, #ff6b6b, #ee5a5a);
            color: #fff;
            font-size: 1rem;
        }

        .control-btn:hover {
            background: linear-gradient(135deg, #ee5a5a, #dd4a4a);
            transform: scale(1.02);
        }

        .control-btn.pause {
            background: linear-gradient(135deg, #feca57, #f5ba46);
            color: #333;
        }

        .preset-btn {
            background: linear-gradient(135deg, #2a2a3a, #3a3a4a);
            color: #e0e0e0;
            border: 1px solid rgba(255, 107, 107, 0.3);
            padding: 10px;
        }

        .preset-btn:hover {
            background: linear-gradient(135deg, #3a3a4a, #4a4a5a);
            border-color: #ff6b6b;
        }

        .stats {
            background: rgba(255, 107, 107, 0.1);
            border-radius: 10px;
            padding: 15px;
            margin-top: 15px;
        }

        .stat-row {
            display: flex;
            justify-content: space-between;
            padding: 5px 0;
            border-bottom: 1px solid rgba(255, 107, 107, 0.1);
        }

        .stat-row:last-child {
            border-bottom: none;
        }

        .stat-label {
            color: #888;
        }

        .stat-value {
            color: #ff6b6b;
            font-family: monospace;
        }

        .phase-indicator {
            background: linear-gradient(135deg, rgba(255, 107, 107, 0.2), rgba(254, 202, 87, 0.2));
            border-radius: 10px;
            padding: 15px;
            margin-top: 15px;
            text-align: center;
        }

        .phase-name {
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .phase-simplicity { color: #48dbfb; }
        .phase-chaos { color: #ff6b6b; }
        .phase-highway { color: #1dd1a1; }

        .phase-desc {
            font-size: 0.9rem;
            color: #aaa;
        }

        .rules-box {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            padding: 15px;
            margin-top: 15px;
            border-left: 3px solid #feca57;
        }

        .rules-title {
            color: #feca57;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .rule {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 8px 0;
            font-size: 0.9rem;
        }

        .rule-square {
            width: 20px;
            height: 20px;
            border: 2px solid #666;
            border-radius: 3px;
        }

        .explanation {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .exp-card {
            background: rgba(0, 0, 0, 0.4);
            border-radius: 15px;
            padding: 20px;
            border: 1px solid rgba(255, 107, 107, 0.2);
        }

        .exp-card h3 {
            color: #ff6b6b;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .exp-card p {
            line-height: 1.7;
            color: #bbb;
        }

        .highlight {
            color: #ff6b6b;
            font-weight: 500;
        }

        .back-link {
            display: inline-block;
            color: #ff6b6b;
            text-decoration: none;
            margin-bottom: 20px;
            transition: transform 0.3s;
        }

        .back-link:hover {
            transform: translateX(-5px);
        }

        @media (max-width: 900px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <a href="index.html" class="back-link">‚Üê Back to Paradoxes</a>

        <header>
            <h1>Langton's Ant</h1>
            <p class="subtitle">Two simple rules, infinite complexity, and emergent highways</p>
        </header>

        <div class="main-content">
            <div class="canvas-container">
                <canvas id="antCanvas" width="800" height="700"></canvas>
            </div>

            <div class="controls">
                <div class="control-group">
                    <div class="button-row">
                        <button class="control-btn" id="playPauseBtn">‚ñ∂ Play</button>
                        <button class="control-btn" id="resetBtn">‚Ü∫ Reset</button>
                    </div>
                </div>

                <div class="control-group">
                    <label>Speed (steps/frame)</label>
                    <div class="slider-container">
                        <input type="range" id="speedSlider" min="1" max="100" value="10">
                        <span class="value-display" id="speedValue">10</span>
                    </div>
                </div>

                <div class="control-group">
                    <label>Zoom Level</label>
                    <div class="slider-container">
                        <input type="range" id="zoomSlider" min="1" max="10" value="3">
                        <span class="value-display" id="zoomValue">3</span>
                    </div>
                </div>

                <div class="control-group">
                    <label>Quick Jump</label>
                    <div class="button-row">
                        <button class="preset-btn" data-steps="1000">1K Steps</button>
                        <button class="preset-btn" data-steps="5000">5K Steps</button>
                        <button class="preset-btn" data-steps="10000">10K Steps</button>
                        <button class="preset-btn" data-steps="15000">15K Steps</button>
                    </div>
                </div>

                <div class="stats">
                    <div class="stat-row">
                        <span class="stat-label">Steps</span>
                        <span class="stat-value" id="stepCount">0</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Black Cells</span>
                        <span class="stat-value" id="blackCount">0</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Ant Position</span>
                        <span class="stat-value" id="antPos">(0, 0)</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Direction</span>
                        <span class="stat-value" id="antDir">‚Üë North</span>
                    </div>
                </div>

                <div class="phase-indicator">
                    <div class="phase-name" id="phaseName">Simplicity Phase</div>
                    <div class="phase-desc" id="phaseDesc">Creating symmetric patterns...</div>
                </div>

                <div class="rules-box">
                    <div class="rules-title">The Two Rules</div>
                    <div class="rule">
                        <div class="rule-square" style="background: #fff;"></div>
                        <span>‚Üí Turn RIGHT, flip to black, move forward</span>
                    </div>
                    <div class="rule">
                        <div class="rule-square" style="background: #000;"></div>
                        <span>‚Üí Turn LEFT, flip to white, move forward</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="explanation">
            <div class="exp-card">
                <h3>üêú The Surprise</h3>
                <p>
                    Just <span class="highlight">two rules</span>. At each step, the ant checks its
                    current cell and either turns left or right, flips the color, and moves forward.
                    That's it! Yet this simple system produces <span class="highlight">three distinct
                    phases</span>: initial symmetry, apparent chaos, and then‚Äîsuddenly, around step
                    10,000‚Äîa perfectly regular "highway" emerges and extends forever.
                </p>
            </div>

            <div class="exp-card">
                <h3>üõ§Ô∏è The Highway</h3>
                <p>
                    After wandering chaotically, the ant suddenly starts repeating a
                    <span class="highlight">104-step cycle</span> that moves it diagonally. This
                    "highway" pattern emerges from every tested starting configuration‚Äîbut
                    <span class="highlight">no one has proven</span> it always happens! It's one of
                    the simplest unsolved problems in mathematics.
                </p>
            </div>

            <div class="exp-card">
                <h3>üî¨ Turing Machine</h3>
                <p>
                    Langton's Ant is a <span class="highlight">universal Turing machine</span>‚Äîit
                    can compute anything! Chris Langton invented it in 1986 while studying
                    artificial life. Despite its simplicity, it demonstrates how complex behavior
                    can emerge from deterministic rules with no randomness whatsoever.
                </p>
            </div>

            <div class="exp-card">
                <h3>‚àû Chaos to Order</h3>
                <p>
                    The transition from chaos to highway mirrors <span class="highlight">phase
                    transitions</span> in physics‚Äîlike water suddenly freezing. But here,
                    it's pure mathematics: a deterministic system self-organizing into structure.
                    The ant creates its own "attractor basin" and falls into periodic motion.
                </p>
            </div>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('antCanvas');
        const ctx = canvas.getContext('2d');

        // High DPI support
        const dpr = window.devicePixelRatio || 1;
        const rect = canvas.getBoundingClientRect();
        canvas.width = rect.width * dpr;
        canvas.height = rect.height * dpr;
        ctx.scale(dpr, dpr);
        const W = rect.width;
        const H = rect.height;

        // Grid settings
        const GRID_SIZE = 500;
        const grid = new Map(); // Sparse grid: key = "x,y", value = true (black)

        // Ant state
        let antX = 0;
        let antY = 0;
        let antDir = 0; // 0=N, 1=E, 2=S, 3=W
        const DIRS = [
            { dx: 0, dy: -1, name: '‚Üë North' },
            { dx: 1, dy: 0, name: '‚Üí East' },
            { dx: 0, dy: 1, name: '‚Üì South' },
            { dx: -1, dy: 0, name: '‚Üê West' }
        ];

        let steps = 0;
        let blackCount = 0;
        let running = false;
        let speed = 10;
        let cellSize = 3;
        let animationId = null;

        // Get/set grid cell
        function getCell(x, y) {
            return grid.has(`${x},${y}`);
        }

        function setCell(x, y, black) {
            const key = `${x},${y}`;
            if (black) {
                if (!grid.has(key)) blackCount++;
                grid.set(key, true);
            } else {
                if (grid.has(key)) blackCount--;
                grid.delete(key);
            }
        }

        // Single step
        function step() {
            const isBlack = getCell(antX, antY);

            // Turn
            if (isBlack) {
                antDir = (antDir + 3) % 4; // Turn left (counter-clockwise)
            } else {
                antDir = (antDir + 1) % 4; // Turn right (clockwise)
            }

            // Flip color
            setCell(antX, antY, !isBlack);

            // Move forward
            antX += DIRS[antDir].dx;
            antY += DIRS[antDir].dy;

            steps++;
        }

        // Run multiple steps
        function runSteps(n) {
            for (let i = 0; i < n; i++) {
                step();
            }
        }

        // Get current phase
        function getPhase() {
            if (steps < 500) {
                return {
                    name: 'Simplicity Phase',
                    class: 'phase-simplicity',
                    desc: 'Creating symmetric patterns...'
                };
            } else if (steps < 10000) {
                return {
                    name: 'Chaos Phase',
                    class: 'phase-chaos',
                    desc: 'Pseudo-random wandering...'
                };
            } else {
                return {
                    name: 'Highway Phase!',
                    class: 'phase-highway',
                    desc: 'Order emerges! 104-step cycle begins.'
                };
            }
        }

        // Update stats display
        function updateStats() {
            document.getElementById('stepCount').textContent = steps.toLocaleString();
            document.getElementById('blackCount').textContent = blackCount.toLocaleString();
            document.getElementById('antPos').textContent = `(${antX}, ${antY})`;
            document.getElementById('antDir').textContent = DIRS[antDir].name;

            const phase = getPhase();
            const phaseNameEl = document.getElementById('phaseName');
            phaseNameEl.textContent = phase.name;
            phaseNameEl.className = 'phase-name ' + phase.class;
            document.getElementById('phaseDesc').textContent = phase.desc;
        }

        // Render
        function render() {
            // Clear
            ctx.fillStyle = '#fff';
            ctx.fillRect(0, 0, W, H);

            // Calculate view bounds centered on ant
            const viewCenterX = antX;
            const viewCenterY = antY;
            const halfWidth = Math.floor(W / cellSize / 2);
            const halfHeight = Math.floor(H / cellSize / 2);

            const minX = viewCenterX - halfWidth;
            const maxX = viewCenterX + halfWidth;
            const minY = viewCenterY - halfHeight;
            const maxY = viewCenterY + halfHeight;

            // Draw black cells
            ctx.fillStyle = '#000';
            for (const [key] of grid) {
                const [x, y] = key.split(',').map(Number);
                if (x >= minX && x <= maxX && y >= minY && y <= maxY) {
                    const screenX = (x - minX) * cellSize;
                    const screenY = (y - minY) * cellSize;
                    ctx.fillRect(screenX, screenY, cellSize, cellSize);
                }
            }

            // Draw ant
            const antScreenX = (antX - minX) * cellSize + cellSize / 2;
            const antScreenY = (antY - minY) * cellSize + cellSize / 2;

            ctx.fillStyle = '#ff6b6b';
            ctx.beginPath();
            ctx.arc(antScreenX, antScreenY, cellSize * 0.8, 0, Math.PI * 2);
            ctx.fill();

            // Draw direction indicator
            ctx.strokeStyle = '#fff';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(antScreenX, antScreenY);
            ctx.lineTo(
                antScreenX + DIRS[antDir].dx * cellSize * 1.5,
                antScreenY + DIRS[antDir].dy * cellSize * 1.5
            );
            ctx.stroke();

            updateStats();
        }

        // Animation loop
        function animate() {
            if (running) {
                runSteps(speed);
                render();
                animationId = requestAnimationFrame(animate);
            }
        }

        // Reset simulation
        function reset() {
            running = false;
            document.getElementById('playPauseBtn').textContent = '‚ñ∂ Play';
            if (animationId) cancelAnimationFrame(animationId);

            grid.clear();
            antX = 0;
            antY = 0;
            antDir = 0;
            steps = 0;
            blackCount = 0;

            render();
        }

        // Toggle play/pause
        function togglePlay() {
            running = !running;
            document.getElementById('playPauseBtn').textContent =
                running ? '‚è∏ Pause' : '‚ñ∂ Play';
            document.getElementById('playPauseBtn').classList.toggle('pause', running);

            if (running) {
                animate();
            }
        }

        // Jump to specific step count
        function jumpToStep(targetSteps) {
            running = false;
            document.getElementById('playPauseBtn').textContent = '‚ñ∂ Play';
            if (animationId) cancelAnimationFrame(animationId);

            // Reset and run to target
            grid.clear();
            antX = 0;
            antY = 0;
            antDir = 0;
            steps = 0;
            blackCount = 0;

            runSteps(targetSteps);
            render();
        }

        // Event listeners
        document.getElementById('playPauseBtn').addEventListener('click', togglePlay);
        document.getElementById('resetBtn').addEventListener('click', reset);

        document.getElementById('speedSlider').addEventListener('input', (e) => {
            speed = parseInt(e.target.value);
            document.getElementById('speedValue').textContent = speed;
        });

        document.getElementById('zoomSlider').addEventListener('input', (e) => {
            cellSize = parseInt(e.target.value);
            document.getElementById('zoomValue').textContent = cellSize;
            render();
        });

        document.querySelectorAll('.preset-btn[data-steps]').forEach(btn => {
            btn.addEventListener('click', () => {
                jumpToStep(parseInt(btn.dataset.steps));
            });
        });

        // Initial render
        render();
    </script>
    <script src="../assets/js/enhance.js" defer></script>
</body>
</html>
