<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>94. Stein's Paradox - Surprising Paradoxes</title>
    <link href="https://fonts.googleapis.com/css2?family=Lora:wght@400;500;600;700&family=Nunito:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --mle: #f44336;
            --stein: #4CAF50;
            --bg-dark: #1a1a2e;
            --card-bg: #16213e;
            --text: #e8e8e8;
            --accent: #ff9800;
            --highlight: #2196F3;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Nunito', sans-serif;
            background: linear-gradient(135deg, var(--bg-dark), #0f3460);
            color: var(--text);
            min-height: 100vh;
        }
        .container {
            max-width: 1100px;
            margin: 0 auto;
            padding: 30px 20px;
        }
        .back-link {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            color: var(--accent);
            text-decoration: none;
            font-weight: 500;
            margin-bottom: 20px;
            padding: 10px 20px;
            background: rgba(255,152,0,0.1);
            border-radius: 30px;
            transition: all 0.3s ease;
        }
        .back-link:hover {
            background: rgba(255,152,0,0.2);
        }
        h1 {
            font-family: 'Lora', serif;
            font-size: 2.5rem;
            color: var(--accent);
            margin-bottom: 10px;
            text-align: center;
        }
        .subtitle {
            text-align: center;
            color: #888;
            font-size: 1.2rem;
            margin-bottom: 30px;
        }
        .simulation-panel {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 25px;
            border: 1px solid rgba(255,152,0,0.3);
        }
        .panel-title {
            font-family: 'Lora', serif;
            color: var(--accent);
            text-align: center;
            margin-bottom: 20px;
        }
        .players-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 25px;
        }
        .player-card {
            background: rgba(0,0,0,0.3);
            border-radius: 12px;
            padding: 15px;
            text-align: center;
        }
        .player-name {
            font-weight: 700;
            margin-bottom: 8px;
            font-size: 0.9rem;
        }
        .player-early {
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--highlight);
        }
        .player-estimates {
            display: flex;
            justify-content: space-around;
            margin-top: 10px;
            font-size: 0.8rem;
        }
        .est-mle {
            color: var(--mle);
        }
        .est-stein {
            color: var(--stein);
        }
        .player-true {
            margin-top: 8px;
            font-size: 0.85rem;
            color: #888;
        }
        .results-comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 25px;
        }
        @media (max-width: 600px) {
            .results-comparison { grid-template-columns: 1fr; }
        }
        .result-box {
            background: rgba(0,0,0,0.3);
            border-radius: 15px;
            padding: 25px;
            text-align: center;
        }
        .result-box.mle {
            border-top: 4px solid var(--mle);
        }
        .result-box.stein {
            border-top: 4px solid var(--stein);
        }
        .result-label {
            font-size: 0.9rem;
            color: #888;
            margin-bottom: 8px;
        }
        .result-value {
            font-size: 2.5rem;
            font-weight: 700;
        }
        .result-box.mle .result-value { color: var(--mle); }
        .result-box.stein .result-value { color: var(--stein); }
        .result-desc {
            font-size: 0.85rem;
            color: #aaa;
            margin-top: 8px;
        }
        .winner-banner {
            background: linear-gradient(135deg, rgba(76,175,80,0.2), rgba(76,175,80,0.1));
            border: 2px solid var(--stein);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            margin-bottom: 20px;
        }
        .winner-banner h3 {
            color: var(--stein);
            font-size: 1.3rem;
        }
        .winner-banner p {
            color: #ccc;
            margin-top: 10px;
        }
        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
        }
        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 10px;
            font-family: inherit;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }
        .btn-primary {
            background: var(--accent);
            color: white;
        }
        .btn-secondary {
            background: rgba(255,255,255,0.1);
            color: white;
        }
        .btn:hover {
            transform: scale(1.05);
        }
        .shrinkage-visual {
            margin: 25px 0;
            padding: 20px;
            background: rgba(0,0,0,0.2);
            border-radius: 15px;
        }
        .shrink-title {
            text-align: center;
            color: var(--accent);
            margin-bottom: 15px;
        }
        .shrink-bar-container {
            position: relative;
            height: 60px;
            background: rgba(0,0,0,0.3);
            border-radius: 10px;
            margin-bottom: 10px;
        }
        .grand-mean-line {
            position: absolute;
            left: 50%;
            top: 0;
            bottom: 0;
            width: 3px;
            background: var(--accent);
            transform: translateX(-50%);
        }
        .grand-mean-label {
            position: absolute;
            top: -20px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.75rem;
            color: var(--accent);
        }
        .estimate-dot {
            position: absolute;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            transition: left 1s ease;
        }
        .estimate-dot.mle { background: var(--mle); top: 35%; }
        .estimate-dot.stein { background: var(--stein); top: 65%; }
        .legend {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-top: 15px;
        }
        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
        }
        .legend-dot {
            width: 14px;
            height: 14px;
            border-radius: 50%;
        }
        .content-section {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 25px;
        }
        .content-section h2 {
            font-family: 'Lora', serif;
            color: var(--accent);
            margin-bottom: 15px;
        }
        .content-section p {
            line-height: 1.8;
            color: #bbb;
            margin-bottom: 15px;
        }
        .quote-box {
            background: rgba(0,0,0,0.3);
            border-left: 4px solid var(--accent);
            padding: 20px;
            margin: 20px 0;
            font-style: italic;
        }
        .absurd-example {
            background: linear-gradient(135deg, rgba(33,150,243,0.1), rgba(33,150,243,0.05));
            border: 2px solid var(--highlight);
            border-radius: 15px;
            padding: 25px;
            margin: 25px 0;
        }
        .absurd-example h4 {
            color: var(--highlight);
            margin-bottom: 15px;
        }
        .absurd-items {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
        }
        @media (max-width: 600px) {
            .absurd-items { grid-template-columns: 1fr; }
        }
        .absurd-item {
            background: rgba(0,0,0,0.2);
            border-radius: 10px;
            padding: 15px;
            text-align: center;
        }
        .absurd-icon {
            font-size: 2rem;
            margin-bottom: 8px;
        }
        .formula-box {
            background: rgba(0,0,0,0.3);
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            font-family: 'Courier New', monospace;
            margin: 20px 0;
        }
        .improvement-stat {
            font-size: 3rem;
            font-weight: 700;
            color: var(--stein);
            text-align: center;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <a href="index.html" class="back-link">
            <span>‚Üê</span> Back to Paradoxes
        </a>

        <h1>94. Stein's Paradox</h1>
        <p class="subtitle">When knowing about candy bars helps predict wheat yields</p>

        <div class="simulation-panel">
            <h3 class="panel-title">‚öæ The Baseball Experiment (Efron & Morris, 1975)</h3>
            <p style="text-align: center; color: #aaa; margin-bottom: 20px;">
                Predicting end-of-season batting averages from early-season data (first 45 at-bats)
            </p>

            <div class="players-grid" id="playersGrid"></div>

            <div class="shrinkage-visual">
                <h4 class="shrink-title">Watch the Shrinkage</h4>
                <div class="shrink-bar-container" id="shrinkBar">
                    <div class="grand-mean-label">Grand Mean</div>
                    <div class="grand-mean-line"></div>
                </div>
                <div class="legend">
                    <div class="legend-item">
                        <div class="legend-dot" style="background: var(--mle);"></div>
                        <span>MLE (raw average)</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-dot" style="background: var(--stein);"></div>
                        <span>James-Stein (shrunk)</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-dot" style="background: var(--accent);"></div>
                        <span>Grand mean</span>
                    </div>
                </div>
            </div>

            <div class="results-comparison">
                <div class="result-box mle">
                    <div class="result-label">MLE Total Squared Error</div>
                    <div class="result-value" id="mleError">0.077</div>
                    <div class="result-desc">Sum of (prediction - actual)¬≤</div>
                </div>
                <div class="result-box stein">
                    <div class="result-label">James-Stein Total Squared Error</div>
                    <div class="result-value" id="steinError">0.022</div>
                    <div class="result-desc">Sum of (prediction - actual)¬≤</div>
                </div>
            </div>

            <div class="winner-banner">
                <h3>üèÜ James-Stein Wins by 3.5x!</h3>
                <p>Shrinking toward the grand mean reduces prediction error by a factor of 3.5</p>
            </div>

            <div class="controls">
                <button class="btn btn-primary" onclick="runSimulation()">New Simulation</button>
                <button class="btn btn-secondary" onclick="toggleShrinkage()">Animate Shrinkage</button>
            </div>
        </div>

        <div class="content-section">
            <h2>The Paradox</h2>
            <p>
                In 1955, Charles Stein proved something that seemed impossible: when estimating <strong>three or 
                more</strong> quantities simultaneously, you can do better on average by "shrinking" all estimates 
                toward their common mean‚Äîeven if the quantities are completely unrelated!
            </p>
            
            <div class="absurd-example">
                <h4>The Absurd Implication</h4>
                <p style="color: #ccc; margin-bottom: 15px;">
                    Stein's paradox says combining these unrelated estimates gives better predictions for ALL of them:
                </p>
                <div class="absurd-items">
                    <div class="absurd-item">
                        <div class="absurd-icon">üåæ</div>
                        <div>US Wheat Yield 1993</div>
                    </div>
                    <div class="absurd-item">
                        <div class="absurd-icon">üéæ</div>
                        <div>Wimbledon Spectators 2001</div>
                    </div>
                    <div class="absurd-item">
                        <div class="absurd-icon">üç´</div>
                        <div>Weight of a Random Candy Bar</div>
                    </div>
                </div>
                <p style="color: #ccc; margin-top: 15px; text-align: center;">
                    How can knowing about candy bars possibly help estimate wheat yields? ü§Ø
                </p>
            </div>
        </div>

        <div class="content-section">
            <h2>How It Works</h2>
            <p>
                The James-Stein estimator (1961) shrinks each individual estimate toward the grand mean:
            </p>
            <div class="formula-box">
                z = »≥ + c √ó (y - »≥)
                <br><br>
                <span style="font-size: 0.8rem; color: #888;">
                    y = raw estimate, »≥ = grand mean, c = shrinkage factor (0 to 1)
                </span>
            </div>
            <p>
                The shrinkage factor c is calculated from the data itself. When estimates are spread far from 
                the mean, c is close to 1 (little shrinkage). When they're clustered, c is small (more shrinkage).
            </p>
            <div class="quote-box">
                "The best guess about the future is usually obtained by computing the average of past events. 
                Stein's paradox defines circumstances in which there are estimators better than the arithmetic average."
                <div style="margin-top: 10px; color: var(--accent); font-style: normal;">‚Äî Efron & Morris (1977)</div>
            </div>
        </div>

        <div class="content-section">
            <h2>The Catch</h2>
            <p>
                There's an important subtlety: James-Stein doesn't make each <em>individual</em> estimate better. 
                It makes the <strong>vector of all estimates</strong> better on average. Sometimes shrinkage 
                hurts one estimate‚Äîbut the improvement elsewhere more than compensates.
            </p>
            <p>
                This is "borrowing strength": information from all estimates helps improve the overall prediction, 
                even when the quantities being estimated are unrelated.
            </p>
            <p>
                The phenomenon only works for <strong>3 or more dimensions</strong>. With just 1 or 2 estimates, 
                the raw sample mean cannot be beaten. This dimensional threshold adds to the paradox's mystery.
            </p>
        </div>

        <div class="content-section">
            <h2>Legacy</h2>
            <p>
                Stein's Paradox launched the field of <strong>shrinkage estimation</strong>, now fundamental to:
            </p>
            <ul style="margin-left: 25px; color: #bbb; line-height: 2;">
                <li><strong>Sports statistics:</strong> Predicting player performance</li>
                <li><strong>Medical trials:</strong> Estimating treatment effects across subgroups</li>
                <li><strong>Machine learning:</strong> Regularization techniques like Ridge regression</li>
                <li><strong>Bayesian statistics:</strong> Empirical Bayes methods</li>
            </ul>
            <p style="margin-top: 15px;">
                The paradox shows that the "obvious" estimator isn't always best‚Äîa profound lesson for statistics.
            </p>
        </div>
    </div>

    <script>
        // Simulated baseball data based on Efron-Morris 1975
        const players = [
            { name: 'Clemente', early: .400, true: .346 },
            { name: 'F.Robinson', early: .378, true: .298 },
            { name: 'F.Howard', early: .356, true: .276 },
            { name: 'Johnstone', early: .333, true: .222 },
            { name: 'Berry', early: .311, true: .273 },
            { name: 'Spencer', early: .311, true: .270 },
            { name: 'Kessinger', early: .289, true: .263 },
            { name: 'L.Alvarado', early: .267, true: .210 },
            { name: 'Santo', early: .244, true: .269 },
            { name: 'Swoboda', early: .222, true: .230 },
            { name: 'Petrocelli', early: .222, true: .264 },
            { name: 'E.Rodriguez', early: .222, true: .226 },
            { name: 'Campaneris', early: .200, true: .286 },
            { name: 'Munson', early: .178, true: .316 },
            { name: 'Alvis', early: .156, true: .200 }
        ];

        let currentPlayers = [...players];

        function calculateJamesStein(earlyAverages) {
            const n = earlyAverages.length;
            const grandMean = earlyAverages.reduce((a, b) => a + b, 0) / n;
            
            // Simplified shrinkage calculation
            const variance = earlyAverages.reduce((sum, x) => sum + Math.pow(x - grandMean, 2), 0) / n;
            const shrinkage = Math.max(0, 1 - (0.01 / variance));
            
            return earlyAverages.map(x => grandMean + shrinkage * (x - grandMean));
        }

        function runSimulation() {
            // Add some randomness
            currentPlayers = players.map(p => ({
                ...p,
                early: Math.max(0.100, Math.min(0.450, p.early + (Math.random() - 0.5) * 0.05)),
                true: Math.max(0.180, Math.min(0.380, p.true + (Math.random() - 0.5) * 0.03))
            }));

            renderPlayers();
            calculateErrors();
            renderShrinkage();
        }

        function renderPlayers() {
            const grid = document.getElementById('playersGrid');
            const earlyAverages = currentPlayers.map(p => p.early);
            const steinEstimates = calculateJamesStein(earlyAverages);

            grid.innerHTML = currentPlayers.slice(0, 12).map((p, i) => `
                <div class="player-card">
                    <div class="player-name">${p.name}</div>
                    <div class="player-early">.${Math.round(p.early * 1000)}</div>
                    <div class="player-estimates">
                        <span class="est-mle">MLE: .${Math.round(p.early * 1000)}</span>
                        <span class="est-stein">JS: .${Math.round(steinEstimates[i] * 1000)}</span>
                    </div>
                    <div class="player-true">Actual: .${Math.round(p.true * 1000)}</div>
                </div>
            `).join('');
        }

        function calculateErrors() {
            const earlyAverages = currentPlayers.map(p => p.early);
            const steinEstimates = calculateJamesStein(earlyAverages);
            const trueAverages = currentPlayers.map(p => p.true);

            const mleError = earlyAverages.reduce((sum, est, i) => 
                sum + Math.pow(est - trueAverages[i], 2), 0);
            const steinError = steinEstimates.reduce((sum, est, i) => 
                sum + Math.pow(est - trueAverages[i], 2), 0);

            document.getElementById('mleError').textContent = mleError.toFixed(3);
            document.getElementById('steinError').textContent = steinError.toFixed(3);
        }

        function renderShrinkage() {
            const bar = document.getElementById('shrinkBar');
            // Clear existing dots
            bar.querySelectorAll('.estimate-dot').forEach(d => d.remove());

            const earlyAverages = currentPlayers.map(p => p.early);
            const steinEstimates = calculateJamesStein(earlyAverages);
            const grandMean = earlyAverages.reduce((a, b) => a + b, 0) / earlyAverages.length;
            
            // Scale: 0.100 to 0.450
            const scale = (val) => ((val - 0.100) / 0.350) * 100;

            currentPlayers.slice(0, 8).forEach((p, i) => {
                const mleDot = document.createElement('div');
                mleDot.className = 'estimate-dot mle';
                mleDot.style.left = scale(p.early) + '%';
                bar.appendChild(mleDot);

                const steinDot = document.createElement('div');
                steinDot.className = 'estimate-dot stein';
                steinDot.style.left = scale(steinEstimates[i]) + '%';
                bar.appendChild(steinDot);
            });

            // Position grand mean line
            document.querySelector('.grand-mean-line').style.left = scale(grandMean) + '%';
        }

        let shrinkageAnimated = false;
        function toggleShrinkage() {
            const bar = document.getElementById('shrinkBar');
            const steinDots = bar.querySelectorAll('.estimate-dot.stein');
            const mleDots = bar.querySelectorAll('.estimate-dot.mle');
            
            if (!shrinkageAnimated) {
                // Move Stein dots to MLE positions
                steinDots.forEach((dot, i) => {
                    dot.style.left = mleDots[i].style.left;
                });
                setTimeout(() => {
                    renderShrinkage();
                }, 100);
            }
            shrinkageAnimated = !shrinkageAnimated;
        }

        // Initialize
        runSimulation();
    </script>
    <script src="../assets/js/enhance.js" defer></script>
</body>
</html>
