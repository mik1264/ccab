<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Crocodile Dilemma - Surprising Paradoxes - CCAB</title>
    <link href="https://fonts.googleapis.com/css2?family=Lora:wght@400;500;600;700&family=Nunito:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --nile-blue: #1a4d5c;
            --swamp-green: #2d5a3d;
            --papyrus: #f4e4bc;
            --croc-green: #4a6f4a;
            --egypt-gold: #c9a227;
            --danger-red: #8b0000;
            --text-dark: #2d2d2d;
            --water-deep: #0d3340;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Nunito', sans-serif;
            background: linear-gradient(180deg, #87ceeb 0%, #6ab7d4 20%, var(--nile-blue) 20%, #0d3340 100%);
            min-height: 100vh;
            color: var(--text-dark);
        }
        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 30px 20px;
        }
        .back-link {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            color: var(--papyrus);
            text-decoration: none;
            font-weight: 600;
            padding: 10px 20px;
            background: rgba(0,0,0,0.3);
            border-radius: 30px;
            transition: all 0.3s ease;
            margin-bottom: 30px;
        }
        .back-link:hover {
            background: rgba(0,0,0,0.5);
            transform: translateX(-5px);
        }
        h1 {
            font-family: 'Lora', serif;
            font-size: 2.8rem;
            font-weight: 600;
            color: var(--egypt-gold);
            margin-bottom: 15px;
            text-align: center;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }
        .subtitle {
            font-size: 1.2rem;
            color: var(--papyrus);
            text-align: center;
            margin-bottom: 30px;
            font-style: italic;
        }
        .intro-box {
            background: var(--papyrus);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 30px;
            border-left: 4px solid var(--egypt-gold);
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
        }
        .intro-box p {
            line-height: 1.8;
            color: #444;
            margin-bottom: 12px;
        }

        /* Tab Navigation */
        .tab-nav {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
            justify-content: center;
        }
        .tab-btn {
            padding: 12px 24px;
            background: rgba(0,0,0,0.3);
            border: 2px solid var(--egypt-gold);
            color: var(--papyrus);
            border-radius: 25px;
            font-family: 'Nunito', sans-serif;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .tab-btn:hover {
            background: rgba(201,162,39,0.3);
        }
        .tab-btn.active {
            background: var(--egypt-gold);
            color: var(--text-dark);
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Scene Container */
        .scene-container {
            background: linear-gradient(180deg, #1a4d5c 0%, #0d3340 100%);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            position: relative;
            overflow: hidden;
        }
        .water-surface {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 40%;
            background: linear-gradient(180deg, rgba(26,77,92,0.5), rgba(13,51,64,0.8));
            pointer-events: none;
        }
        .scene {
            position: relative;
            min-height: 200px;
            display: flex;
            justify-content: space-around;
            align-items: center;
            padding: 20px;
        }
        .character {
            text-align: center;
            z-index: 1;
        }
        .character-emoji {
            font-size: 4rem;
            filter: drop-shadow(2px 4px 6px rgba(0,0,0,0.4));
        }
        .character-label {
            background: var(--papyrus);
            padding: 6px 12px;
            border-radius: 15px;
            font-weight: 600;
            margin-top: 8px;
            display: inline-block;
            font-size: 0.85rem;
        }
        .crocodile {
            animation: float 3s ease-in-out infinite;
        }
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        .child-container {
            position: relative;
        }
        .child-emoji {
            font-size: 2.5rem;
            position: absolute;
            top: -50px;
            left: 50%;
            transform: translateX(-50%);
            filter: drop-shadow(2px 2px 4px rgba(0,0,0,0.3));
        }

        /* Dialogue System */
        .dialogue-container {
            background: var(--papyrus);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            min-height: 150px;
        }
        .dialogue-history {
            max-height: 300px;
            overflow-y: auto;
            margin-bottom: 15px;
        }
        .dialogue-line {
            display: flex;
            gap: 12px;
            margin-bottom: 15px;
            align-items: flex-start;
            animation: slideIn 0.3s ease;
        }
        @keyframes slideIn {
            from { opacity: 0; transform: translateX(-20px); }
            to { opacity: 1; transform: translateX(0); }
        }
        .dialogue-avatar {
            font-size: 2rem;
            flex-shrink: 0;
        }
        .dialogue-bubble {
            background: white;
            padding: 12px 16px;
            border-radius: 15px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            max-width: 80%;
            line-height: 1.6;
        }
        .dialogue-bubble.croc {
            background: #e8f5e9;
            border-left: 3px solid var(--croc-green);
        }
        .dialogue-bubble.parent {
            background: #fff3e0;
            border-left: 3px solid var(--egypt-gold);
        }
        .dialogue-bubble.narrator {
            background: #e3f2fd;
            border-left: 3px solid var(--nile-blue);
            font-style: italic;
        }
        .dialogue-choices {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        .dialogue-choice {
            padding: 12px 20px;
            background: white;
            border: 2px solid var(--egypt-gold);
            border-radius: 10px;
            text-align: left;
            cursor: pointer;
            font-family: 'Nunito', sans-serif;
            font-size: 1rem;
            transition: all 0.3s ease;
        }
        .dialogue-choice:hover {
            background: var(--egypt-gold);
            color: white;
            transform: translateX(5px);
        }
        .dialogue-choice:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        /* Logic Explorer */
        .logic-explorer {
            background: var(--papyrus);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 30px;
        }
        .logic-step {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 15px;
            border-left: 4px solid var(--nile-blue);
            display: none;
        }
        .logic-step.visible {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        .logic-step h4 {
            color: var(--nile-blue);
            margin-bottom: 10px;
            font-family: 'Lora', serif;
        }
        .logic-formula {
            background: #f5f5f5;
            padding: 15px;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            margin: 10px 0;
            overflow-x: auto;
        }
        .logic-nav {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 20px;
        }
        .logic-nav button {
            padding: 10px 25px;
            border: none;
            border-radius: 20px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .logic-nav .prev-btn {
            background: #ddd;
            color: #333;
        }
        .logic-nav .next-btn {
            background: var(--egypt-gold);
            color: white;
        }
        .logic-nav button:hover:not(:disabled) {
            transform: scale(1.05);
        }
        .logic-nav button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        .step-indicator {
            text-align: center;
            color: #666;
            margin-bottom: 15px;
        }

        /* Branching Narrative */
        .narrative-container {
            background: linear-gradient(180deg, #1a4d5c 0%, #0d3340 100%);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 30px;
        }
        .story-card {
            background: var(--papyrus);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
        }
        .story-text {
            font-size: 1.1rem;
            line-height: 1.8;
            color: #333;
            margin-bottom: 20px;
        }
        .story-choices {
            display: grid;
            gap: 15px;
        }
        .story-choice {
            padding: 20px;
            background: white;
            border: 2px solid var(--croc-green);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: left;
        }
        .story-choice:hover {
            background: var(--croc-green);
            color: white;
            transform: scale(1.02);
        }
        .story-choice h4 {
            margin-bottom: 8px;
            color: inherit;
        }
        .story-choice p {
            font-size: 0.9rem;
            opacity: 0.9;
        }
        .story-outcome {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
        }
        .outcome-paradox {
            border: 3px solid var(--danger-red);
            background: #ffe0e0;
        }
        .outcome-consistent {
            border: 3px solid var(--swamp-green);
            background: #e0ffe0;
        }
        .outcome-title {
            font-family: 'Lora', serif;
            font-size: 1.3rem;
            margin-bottom: 10px;
        }
        .outcome-paradox .outcome-title {
            color: var(--danger-red);
        }
        .outcome-consistent .outcome-title {
            color: var(--swamp-green);
        }
        .path-tracker {
            display: flex;
            gap: 8px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        .path-node {
            background: rgba(255,255,255,0.2);
            color: var(--papyrus);
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 0.85rem;
        }
        .path-node.current {
            background: var(--egypt-gold);
            color: var(--text-dark);
        }
        .restart-btn {
            display: block;
            margin: 20px auto 0;
            padding: 12px 30px;
            background: var(--egypt-gold);
            color: var(--text-dark);
            border: none;
            border-radius: 25px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .restart-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(201,162,39,0.4);
        }

        /* Content Sections */
        .content-section {
            background: var(--papyrus);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }
        .content-section h2 {
            font-family: 'Lora', serif;
            font-size: 1.6rem;
            color: var(--nile-blue);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .content-section p {
            line-height: 1.8;
            color: #444;
            margin-bottom: 15px;
        }
        .content-section ul {
            margin-left: 20px;
            margin-bottom: 15px;
        }
        .content-section li {
            line-height: 1.8;
            color: #444;
            margin-bottom: 8px;
        }

        /* Logic Table */
        .logic-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        .logic-table th, .logic-table td {
            padding: 12px;
            text-align: center;
            border: 2px solid var(--nile-blue);
        }
        .logic-table th {
            background: var(--nile-blue);
            color: white;
        }
        .logic-table td {
            background: white;
        }
        .logic-table .paradox-cell {
            background: #ffe0e0;
            color: var(--danger-red);
            font-weight: 600;
        }
        .logic-table .ok-cell {
            background: #e0ffe0;
            color: var(--swamp-green);
        }

        /* Quote Box */
        .quote-box {
            background: linear-gradient(135deg, rgba(201,162,39,0.1), rgba(26,77,92,0.1));
            border-radius: 15px;
            padding: 20px;
            margin: 15px 0;
            border-left: 4px solid var(--egypt-gold);
            font-style: italic;
        }
        .quote-attribution {
            text-align: right;
            font-weight: 600;
            color: var(--nile-blue);
            margin-top: 10px;
        }

        .source-link {
            color: var(--nile-blue);
            text-decoration: none;
        }
        .source-link:hover {
            text-decoration: underline;
        }

        /* Responsive */
        @media (max-width: 600px) {
            h1 { font-size: 2rem; }
            .tab-btn { padding: 10px 16px; font-size: 0.9rem; }
            .character-emoji { font-size: 3rem; }
            .dialogue-bubble { max-width: 90%; }
        }
    </style>
</head>
<body>
    <div class="container">
        <a href="index.html" class="back-link">‚Üê Back to Paradoxes</a>

        <h1>The Crocodile Dilemma</h1>
        <p class="subtitle">"An ancient Greek logic puzzle from the banks of the Nile"</p>

        <div class="intro-box">
            <p><strong>The Scenario:</strong> A crocodile steals a child from a parent. The crocodile, feeling philosophical, makes a promise:</p>
            <p style="font-style:italic; text-align:center; font-size:1.1rem; color:#333;">"I will return your child if and only if you correctly predict what I will do next."</p>
            <p>The parent must now predict: Will the crocodile return the child, or keep it?</p>
        </div>

        <!-- Tab Navigation -->
        <div class="tab-nav">
            <button class="tab-btn active" onclick="switchTab('dialogue')">Dialogue System</button>
            <button class="tab-btn" onclick="switchTab('logic')">Logic Explorer</button>
            <button class="tab-btn" onclick="switchTab('narrative')">Branching Narrative</button>
            <button class="tab-btn" onclick="switchTab('analysis')">Analysis</button>
        </div>

        <!-- Tab 1: Dialogue System -->
        <div id="tab-dialogue" class="tab-content active">
            <div class="scene-container">
                <div class="water-surface"></div>
                <div class="scene">
                    <div class="character parent">
                        <div class="character-emoji" id="parentEmoji">üò∞</div>
                        <div class="character-label">Parent</div>
                    </div>

                    <div class="character crocodile child-container">
                        <div class="child-emoji" id="childEmoji">üë∂</div>
                        <div class="character-emoji">üêä</div>
                        <div class="character-label">Crocodile</div>
                    </div>
                </div>

                <div class="dialogue-container">
                    <div class="dialogue-history" id="dialogueHistory"></div>
                    <div class="dialogue-choices" id="dialogueChoices"></div>
                </div>
            </div>
        </div>

        <!-- Tab 2: Logic Explorer -->
        <div id="tab-logic" class="tab-content">
            <div class="logic-explorer">
                <h2 style="font-family: 'Lora', serif; color: var(--nile-blue); margin-bottom: 20px; text-align: center;">
                    Step Through the Formal Logic
                </h2>
                <div class="step-indicator" id="stepIndicator">Step 1 of 8</div>

                <div class="logic-step visible" id="step1">
                    <h4>Step 1: Define the Variables</h4>
                    <p>Let's formalize the crocodile's promise using propositional logic:</p>
                    <div class="logic-formula">
                        P = "The parent's prediction is correct"<br>
                        R = "The crocodile returns the child"
                    </div>
                    <p>These two propositions will form the basis of our logical analysis.</p>
                </div>

                <div class="logic-step" id="step2">
                    <h4>Step 2: The Crocodile's Promise</h4>
                    <p>The crocodile says: "I will return your child if and only if you correctly predict what I will do."</p>
                    <div class="logic-formula">
                        Promise: P <=> R<br>
                        (The prediction is correct if and only if the child is returned)
                    </div>
                    <p>This biconditional creates a tight logical relationship between prediction and outcome.</p>
                </div>

                <div class="logic-step" id="step3">
                    <h4>Step 3: What Does "Correct Prediction" Mean?</h4>
                    <p>The prediction is correct when reality matches what was predicted:</p>
                    <div class="logic-formula">
                        If parent predicts "return": P <=> R<br>
                        If parent predicts "keep": P <=> ¬¨R
                    </div>
                    <p>The truth of P depends on what action the crocodile actually takes.</p>
                </div>

                <div class="logic-step" id="step4">
                    <h4>Step 4: Case 1 - Parent Predicts "Return"</h4>
                    <p>Suppose the parent says: "You will return my child."</p>
                    <div class="logic-formula">
                        Prediction correct means: P <=> R<br>
                        Promise says: P <=> R<br>
                        <br>
                        Both conditions are identical!
                    </div>
                    <p><strong>Result:</strong> The crocodile can choose either action consistently. No paradox here.</p>
                </div>

                <div class="logic-step" id="step5">
                    <h4>Step 5: Case 2 - Parent Predicts "Keep"</h4>
                    <p>Now suppose the parent says: "You will NOT return my child."</p>
                    <div class="logic-formula">
                        Prediction correct means: P <=> ¬¨R<br>
                        Promise says: P <=> R
                    </div>
                    <p>These two conditions <em>conflict</em>. Let's see what happens...</p>
                </div>

                <div class="logic-step" id="step6">
                    <h4>Step 6: Analyzing the Conflict</h4>
                    <p>From P <=> ¬¨R and P <=> R, we can derive:</p>
                    <div class="logic-formula">
                        P <=> ¬¨R (prediction is correct iff child kept)<br>
                        P <=> R  (promise: prediction correct iff child returned)<br>
                        <br>
                        Therefore: R <=> ¬¨R
                    </div>
                    <p>This is a <strong>contradiction</strong>! The child must be both returned AND kept.</p>
                </div>

                <div class="logic-step" id="step7">
                    <h4>Step 7: The Paradox Revealed</h4>
                    <p>The statement R <=> ¬¨R is logically impossible:</p>
                    <div class="logic-formula">
                        If R is true (return): ¬¨R must be true (keep) - CONTRADICTION<br>
                        If R is false (keep): ¬¨R is true, so R must be true - CONTRADICTION
                    </div>
                    <p>There is <strong>no truth assignment</strong> that satisfies both conditions simultaneously.</p>
                </div>

                <div class="logic-step" id="step8">
                    <h4>Step 8: Conclusion</h4>
                    <p>The Crocodile Dilemma demonstrates that <strong>self-referential promises can be impossible to fulfill</strong>.</p>
                    <div class="logic-formula">
                        The crocodile's promise is not merely difficult to keep‚Äî<br>
                        it is <em>logically impossible</em> to keep when the parent<br>
                        predicts "keep."
                    </div>
                    <p>This connects to deeper results in logic: Godel's incompleteness theorems, the halting problem, and the limits of formal systems.</p>
                </div>

                <div class="logic-nav">
                    <button class="prev-btn" id="prevBtn" onclick="prevStep()" disabled>‚Üê Previous</button>
                    <button class="next-btn" id="nextBtn" onclick="nextStep()">Next ‚Üí</button>
                </div>
            </div>
        </div>

        <!-- Tab 3: Branching Narrative -->
        <div id="tab-narrative" class="tab-content">
            <div class="narrative-container">
                <div class="path-tracker" id="pathTracker">
                    <span class="path-node current">Start</span>
                </div>
                <div class="story-card" id="storyCard">
                    <!-- Story content will be dynamically inserted -->
                </div>
            </div>
        </div>

        <!-- Tab 4: Analysis -->
        <div id="tab-analysis" class="tab-content">
            <!-- The Logic Table -->
            <div class="content-section">
                <h2>The Complete Logic</h2>
                <p>Let's analyze all possible combinations of prediction and action:</p>

                <table class="logic-table">
                    <tr>
                        <th>Parent Predicts</th>
                        <th>Crocodile Does</th>
                        <th>Prediction Correct?</th>
                        <th>Child Should Be...</th>
                        <th>Result</th>
                    </tr>
                    <tr>
                        <td>Return</td>
                        <td>Return</td>
                        <td>Yes</td>
                        <td>Returned</td>
                        <td class="ok-cell">Consistent</td>
                    </tr>
                    <tr>
                        <td>Return</td>
                        <td>Keep</td>
                        <td>No</td>
                        <td>Kept</td>
                        <td class="ok-cell">Consistent</td>
                    </tr>
                    <tr>
                        <td>Keep</td>
                        <td>Return</td>
                        <td>No</td>
                        <td>Kept</td>
                        <td class="paradox-cell">PARADOX</td>
                    </tr>
                    <tr>
                        <td>Keep</td>
                        <td>Keep</td>
                        <td>Yes</td>
                        <td>Returned</td>
                        <td class="paradox-cell">PARADOX</td>
                    </tr>
                </table>

                <p>When the parent predicts "keep," <strong>both outcomes violate the crocodile's terms</strong>‚Äîcreating an inescapable paradox!</p>
            </div>

            <!-- Why It's Unsolvable -->
            <div class="content-section">
                <h2>The Self-Referential Trap</h2>
                <p>The paradox arises because the prediction <em>refers to its own effect</em>:</p>
                <ul>
                    <li>The parent's prediction determines what "should" happen (via the crocodile's promise)</li>
                    <li>What "should" happen affects whether the prediction is true</li>
                    <li>Whether the prediction is true determines what "should" happen...</li>
                </ul>
                <p>This creates a <strong>circular dependency</strong> with no stable solution. It's the same logical structure as:</p>
                <div class="quote-box">
                    "This statement is false."
                    <div class="quote-attribution">‚Äî The Liar Paradox</div>
                </div>
                <p>If the Liar's statement is true, it's false. If it's false, it's true. Similarly, if the crocodile returns the child (when "keep" was predicted), it shouldn't have; if it keeps the child, it should have returned it.</p>
            </div>

            <!-- Historical Context -->
            <div class="content-section">
                <h2>Ancient Origins</h2>
                <p>The Crocodile Dilemma is one of the oldest recorded paradoxes in Western philosophy:</p>
                <ul>
                    <li><strong>Eubulides of Miletus</strong> (4th century BCE), the inventor of the Liar Paradox, is credited with this paradox as well</li>
                    <li>It appears in Greek discussions of <strong>sophism</strong>‚Äîtricky arguments that seem valid but lead to absurdity</li>
                    <li>Variants appear across cultures: <strong>Saint Jerome</strong> (Christian), <strong>Bhartrhari</strong> (Hindu), and <strong>Nasir al-Din al-Tusi</strong> (Islamic) all discussed similar dilemmas</li>
                </ul>
                <p>The Nile crocodile setting reflects Greece's fascination with Egypt‚Äîa land of ancient wisdom and dangerous wildlife.</p>
            </div>

            <!-- Philosophical Significance -->
            <div class="content-section">
                <h2>Why Philosophers Care</h2>
                <p>This seemingly silly riddle exposes deep problems:</p>
                <ul>
                    <li><strong>Metaknowledge:</strong> What happens when knowledge refers to itself? The parent needs to know what the crocodile will do, but the crocodile's action depends on what the parent knows.</li>
                    <li><strong>Promise-keeping:</strong> Can a promise ever be logically impossible to keep? The crocodile genuinely cannot fulfill its terms in the "keep" scenario.</li>
                    <li><strong>Game Theory:</strong> Rational actors making binding commitments can create situations where no rational action exists.</li>
                </ul>
                <p>The paradox helped motivate developments in formal logic, set theory (Russell's Paradox), and eventually Godel's incompleteness theorems.</p>
            </div>

            <!-- Sources -->
            <div class="content-section">
                <h2>Sources</h2>
                <p>
                    <a href="https://mathworld.wolfram.com/CrocodilesDilemma.html" class="source-link" target="_blank">Wolfram MathWorld: Crocodile's Dilemma</a> |
                    <a href="https://www.iflscience.com/what-logic-and-game-theory-says-about-the-crocodile-paradox-79005" class="source-link" target="_blank">IFLScience: The Crocodile Paradox</a> |
                    <a href="https://iep.utm.edu/par-log/" class="source-link" target="_blank">IEP: Logical Paradoxes</a>
                </p>
            </div>
        </div>
    </div>

    <script>
        // Tab switching
        function switchTab(tabId) {
            document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById('tab-' + tabId).classList.add('active');
            event.target.classList.add('active');

            if (tabId === 'dialogue') initDialogue();
            if (tabId === 'narrative') initNarrative();
        }

        // ========== DIALOGUE SYSTEM ==========
        const dialogueScript = [
            {
                speaker: 'narrator',
                text: 'The scene: The banks of the Nile, ancient Egypt. A cunning crocodile has snatched a child from the water\'s edge...',
                choices: null
            },
            {
                speaker: 'croc',
                text: 'Greetings, mortal! I have taken your precious child. But I am a sporting creature. I shall give you a chance.',
                choices: null
            },
            {
                speaker: 'parent',
                text: 'Please! I\'ll do anything! What must I do to save my child?',
                choices: null
            },
            {
                speaker: 'croc',
                text: 'Simply predict what I will do next. If you predict correctly, I shall return your child. If you predict wrongly... well, I grow hungry.',
                choices: null
            },
            {
                speaker: 'narrator',
                text: 'The parent pauses, mind racing. What should they predict?',
                choices: [
                    { text: '"You will RETURN my child to me."', value: 'return' },
                    { text: '"You will KEEP my child and not return them."', value: 'keep' }
                ]
            }
        ];

        const dialogueOutcomes = {
            return: [
                {
                    speaker: 'parent',
                    text: 'I predict... you will RETURN my child to me!',
                    choices: null
                },
                {
                    speaker: 'croc',
                    text: 'Interesting choice. You predict that I will return your child. Very well...',
                    choices: null
                },
                {
                    speaker: 'narrator',
                    text: 'The crocodile considers. In this case, it can choose either action without contradiction:',
                    choices: null
                },
                {
                    speaker: 'narrator',
                    text: 'If it RETURNS the child: Your prediction was correct, so it should return the child. Consistent! If it KEEPS the child: Your prediction was wrong, so it should keep the child. Also consistent!',
                    choices: null
                },
                {
                    speaker: 'croc',
                    text: 'You have predicted "return." I may do as I please‚Äîthere is no paradox here. Your fate rests solely on my whim!',
                    choices: [
                        { text: 'Wait, let me try the other prediction...', value: 'restart' }
                    ]
                }
            ],
            keep: [
                {
                    speaker: 'parent',
                    text: 'I predict... you will KEEP my child and NOT return them!',
                    choices: null
                },
                {
                    speaker: 'croc',
                    text: 'What?! You dare predict that I will keep your child?',
                    choices: null
                },
                {
                    speaker: 'narrator',
                    text: 'The crocodile\'s eyes narrow. It begins to reason through the implications...',
                    choices: null
                },
                {
                    speaker: 'croc',
                    text: 'Wait... if I KEEP your child, then your prediction was CORRECT. But my promise says correct predictions mean I must RETURN the child. Contradiction!',
                    choices: null
                },
                {
                    speaker: 'croc',
                    text: 'But if I RETURN your child, then your prediction was WRONG. And my promise says wrong predictions mean I should KEEP the child. Another contradiction!',
                    choices: null
                },
                {
                    speaker: 'narrator',
                    text: 'The crocodile thrashes in the water, caught in its own logical trap!',
                    choices: null
                },
                {
                    speaker: 'croc',
                    text: 'IMPOSSIBLE! There is no action I can take that honors my promise! You have trapped me in a PARADOX!',
                    choices: null
                },
                {
                    speaker: 'parent',
                    text: 'Then by the laws of logic itself, you cannot fulfill your promise. You must release my child, for any action you take violates your word!',
                    choices: null
                },
                {
                    speaker: 'narrator',
                    text: 'THE PARADOX IS REVEALED: The crocodile\'s self-referential promise becomes impossible to fulfill. This is the Crocodile Dilemma!',
                    choices: [
                        { text: 'Explore the other path', value: 'restart' }
                    ]
                }
            ]
        };

        let dialogueIndex = 0;
        let currentPath = 'main';

        function initDialogue() {
            dialogueIndex = 0;
            currentPath = 'main';
            document.getElementById('dialogueHistory').innerHTML = '';
            document.getElementById('parentEmoji').textContent = 'üò∞';
            advanceDialogue();
        }

        function advanceDialogue() {
            const history = document.getElementById('dialogueHistory');
            const choicesDiv = document.getElementById('dialogueChoices');

            let script = currentPath === 'main' ? dialogueScript : dialogueOutcomes[currentPath];

            if (dialogueIndex >= script.length) return;

            const line = script[dialogueIndex];

            // Add dialogue line
            const lineDiv = document.createElement('div');
            lineDiv.className = 'dialogue-line';

            let avatar = '';
            if (line.speaker === 'croc') avatar = 'üêä';
            else if (line.speaker === 'parent') avatar = 'üë©';
            else avatar = 'üìú';

            lineDiv.innerHTML = `
                <span class="dialogue-avatar">${avatar}</span>
                <div class="dialogue-bubble ${line.speaker}">${line.text}</div>
            `;
            history.appendChild(lineDiv);
            history.scrollTop = history.scrollHeight;

            dialogueIndex++;

            // Handle choices or auto-advance
            if (line.choices) {
                choicesDiv.innerHTML = '';
                line.choices.forEach(choice => {
                    const btn = document.createElement('button');
                    btn.className = 'dialogue-choice';
                    btn.textContent = choice.text;
                    btn.onclick = () => handleChoice(choice.value);
                    choicesDiv.appendChild(btn);
                });
            } else {
                choicesDiv.innerHTML = '';
                setTimeout(advanceDialogue, 1500);
            }
        }

        function handleChoice(value) {
            if (value === 'restart') {
                initDialogue();
                return;
            }

            currentPath = value;
            dialogueIndex = 0;

            if (value === 'keep') {
                document.getElementById('parentEmoji').textContent = 'üòè';
            }

            advanceDialogue();
        }

        // ========== LOGIC EXPLORER ==========
        let currentStep = 1;
        const totalSteps = 8;

        function updateLogicStep() {
            for (let i = 1; i <= totalSteps; i++) {
                const step = document.getElementById('step' + i);
                step.classList.toggle('visible', i === currentStep);
            }
            document.getElementById('stepIndicator').textContent = `Step ${currentStep} of ${totalSteps}`;
            document.getElementById('prevBtn').disabled = currentStep === 1;
            document.getElementById('nextBtn').disabled = currentStep === totalSteps;
            document.getElementById('nextBtn').textContent = currentStep === totalSteps ? 'Complete' : 'Next ‚Üí';
        }

        function nextStep() {
            if (currentStep < totalSteps) {
                currentStep++;
                updateLogicStep();
            }
        }

        function prevStep() {
            if (currentStep > 1) {
                currentStep--;
                updateLogicStep();
            }
        }

        // ========== BRANCHING NARRATIVE ==========
        const storyNodes = {
            start: {
                text: `<p>You are a humble fisher along the banks of the great Nile. The morning sun glints off the water as your young child plays near the reeds.</p>
                <p>Suddenly, a massive crocodile surges from the water and snatches your child! But instead of disappearing beneath the murky depths, it surfaces and speaks:</p>
                <p><em>"I am no ordinary crocodile. I am bound by ancient magic to honor my word. Predict correctly what I shall do, and I must return your child. Predict wrongly, and I shall keep them forever."</em></p>`,
                choices: [
                    { text: 'Plead emotionally', desc: 'Appeal to the crocodile\'s mercy', target: 'plead' },
                    { text: 'Think logically', desc: 'Consider the puzzle carefully', target: 'think' },
                    { text: 'Demand clarification', desc: 'Ask the crocodile to explain the rules', target: 'clarify' }
                ]
            },
            plead: {
                text: `<p>You fall to your knees, tears streaming down your face. "Please, great crocodile! My child is all I have. Show mercy!"</p>
                <p>The crocodile's ancient eyes regard you coldly. "Mercy is not part of our bargain. I am bound by magic older than the pyramids. You must make a prediction. There is no other way."</p>`,
                choices: [
                    { text: 'Think carefully now', desc: 'Accept the rules and consider options', target: 'think' },
                    { text: 'Predict "return" desperately', desc: 'Hope for the best', target: 'return_desperate' }
                ]
            },
            clarify: {
                text: `<p>"Wait," you say, steadying your voice. "Explain these rules precisely. What counts as a correct prediction?"</p>
                <p>The crocodile grins‚Äîif crocodiles can grin. "Simple. If you say I will return your child, and I do, your prediction is correct. If you say I will keep your child, and I do, your prediction is correct. The opposite makes you wrong."</p>
                <p>"And the magic?"</p>
                <p>"I MUST return your child if you predict correctly. I MUST keep your child if you predict wrongly. These are not choices‚Äîthey are compulsions."</p>`,
                choices: [
                    { text: 'Predict "You will return my child"', desc: 'The optimistic choice', target: 'predict_return' },
                    { text: 'Predict "You will NOT return my child"', desc: 'A strategic gambit', target: 'predict_keep' }
                ]
            },
            think: {
                text: `<p>You force yourself to think clearly. The crocodile said "if and only if"‚Äîthis is a logical biconditional. The magic compels specific outcomes based on prediction accuracy.</p>
                <p>You consider your options:</p>
                <ul>
                    <li><strong>Predict "return":</strong> If right, child returned. If wrong, child kept. Both outcomes are internally consistent.</li>
                    <li><strong>Predict "keep":</strong> If right (crocodile keeps), magic says return. If wrong (crocodile returns), magic says keep. Wait...</li>
                </ul>
                <p>Your eyes widen. You see it now.</p>`,
                choices: [
                    { text: 'Predict "You will return my child"', desc: 'Play it safe', target: 'predict_return' },
                    { text: 'Predict "You will NOT return my child"', desc: 'Spring the logical trap', target: 'predict_keep' }
                ]
            },
            return_desperate: {
                text: `<p>"You will return my child!" you cry out desperately.</p>
                <p>The crocodile tilts its massive head. "A simple prediction. How boring. Very well‚ÄîI am free to choose."</p>
                <p>The ancient creature seems to deliberate for a long moment. Then, with apparent whimsy, it releases your child, who swims safely to shore.</p>
                <p>"Today I am merciful. But know this‚Äîyou won by luck, not wit. The magic was satisfied either way."</p>`,
                outcome: {
                    type: 'consistent',
                    title: 'Outcome: Fortunate, but not clever',
                    text: 'Your child is safe, but only because the crocodile chose mercy. Had it wished, it could have kept your child and still honored its promise. You survived‚Äîbut you did not solve the paradox.'
                }
            },
            predict_return: {
                text: `<p>"I predict," you say slowly, "that you WILL return my child."</p>
                <p>The crocodile nods. "A straightforward prediction. If I return your child, you were right, and the magic compels me to return them anyway. If I keep your child, you were wrong, and the magic permits me to keep them."</p>
                <p>It pauses thoughtfully. "Both outcomes satisfy my promise. The choice is mine alone."</p>
                <p>After a tense moment, the crocodile releases your child. "Today, I choose to return. But remember‚Äîyou did not trap me. I honored my word by my own decision."</p>`,
                outcome: {
                    type: 'consistent',
                    title: 'Outcome: Consistent but uncertain',
                    text: 'Your prediction allowed the crocodile free choice. The magic was satisfied regardless of outcome. You were lucky, but you did not find the paradox.'
                }
            },
            predict_keep: {
                text: `<p>You take a deep breath. "I predict that you will NOT return my child. You will keep them."</p>
                <p>The crocodile freezes. Its eyes dart back and forth as ancient magic courses through its being.</p>
                <p>"Wait... If I keep your child, your prediction is correct. But correct predictions mean I must return them. So I should return..."</p>
                <p>"But if I return your child, your prediction is wrong! Wrong predictions mean I must keep them. So I should keep..."</p>
                <p>The great beast begins to thrash in the water, caught between two impossible imperatives.</p>`,
                choices: [
                    { text: 'Press the advantage', desc: 'Demand your child\'s release', target: 'press' },
                    { text: 'Watch in fascination', desc: 'See what the magic does', target: 'watch' }
                ]
            },
            press: {
                text: `<p>"You cannot fulfill your promise!" you declare. "The magic binds you to do what cannot be done. By the laws of logic itself, your bargain is void!"</p>
                <p>The crocodile roars in frustration, ancient scales rippling with conflicting magical forces. "IMPOSSIBLE! No mortal has ever‚Äî"</p>
                <p>With a sound like thunder, the binding magic shatters. Your child is thrown clear, landing safely on the shore as the crocodile sinks beneath the water, freed from its ancient curse‚Äîand its meal.</p>`,
                outcome: {
                    type: 'paradox',
                    title: 'THE PARADOX REVEALED',
                    text: 'You discovered the Crocodile Dilemma! By predicting "keep," you created a self-referential contradiction that no action could satisfy. The crocodile\'s "if and only if" promise became impossible to honor‚Äîa logical paradox that has puzzled philosophers for over 2,000 years.'
                }
            },
            watch: {
                text: `<p>You watch in awe as the crocodile struggles against its own magical bindings. The creature seems to flicker between two states‚Äîjaws opening to release your child, then snapping shut, then opening again.</p>
                <p>Finally, with an ear-splitting crack, the paradox resolves itself the only way it can: the magic breaks entirely. The crocodile is freed from its ancient compulsion, but so is your child, who materializes safely beside you.</p>
                <p>The crocodile, now just an ordinary beast, slips away into the Nile without a word.</p>`,
                outcome: {
                    type: 'paradox',
                    title: 'THE PARADOX REVEALED',
                    text: 'The Crocodile Dilemma demonstrates that self-referential promises can be logically impossible to fulfill. By predicting "keep," you created a situation where both possible actions (keep or return) would violate the crocodile\'s stated rules. This is the heart of the paradox!'
                }
            }
        };

        let currentStoryNode = 'start';
        let pathHistory = ['Start'];

        function initNarrative() {
            currentStoryNode = 'start';
            pathHistory = ['Start'];
            renderStoryNode();
        }

        function renderStoryNode() {
            const node = storyNodes[currentStoryNode];
            const storyCard = document.getElementById('storyCard');
            const pathTracker = document.getElementById('pathTracker');

            // Update path tracker
            pathTracker.innerHTML = pathHistory.map((p, i) =>
                `<span class="path-node ${i === pathHistory.length - 1 ? 'current' : ''}">${p}</span>`
            ).join('');

            let html = `<div class="story-text">${node.text}</div>`;

            if (node.outcome) {
                html += `
                    <div class="story-outcome ${node.outcome.type === 'paradox' ? 'outcome-paradox' : 'outcome-consistent'}">
                        <div class="outcome-title">${node.outcome.title}</div>
                        <p>${node.outcome.text}</p>
                    </div>
                    <button class="restart-btn" onclick="initNarrative()">Start Over</button>
                `;
            } else if (node.choices) {
                html += '<div class="story-choices">';
                node.choices.forEach(choice => {
                    html += `
                        <div class="story-choice" onclick="makeStoryChoice('${choice.target}', '${choice.text}')">
                            <h4>${choice.text}</h4>
                            <p>${choice.desc}</p>
                        </div>
                    `;
                });
                html += '</div>';
            }

            storyCard.innerHTML = html;
        }

        function makeStoryChoice(target, choiceText) {
            currentStoryNode = target;
            pathHistory.push(choiceText.substring(0, 20) + (choiceText.length > 20 ? '...' : ''));
            renderStoryNode();
        }

        // Initialize dialogue on page load
        document.addEventListener('DOMContentLoaded', initDialogue);
    </script>
    <script src="../assets/js/enhance.js" defer></script>
</body>
</html>
