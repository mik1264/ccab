<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Benford's Law - The Fraud Detector Hidden in Numbers</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Georgia', serif;
            background: linear-gradient(135deg, #0f0f23 0%, #1a1a3e 50%, #2d1b4e 100%);
            min-height: 100vh;
            color: #e8e8f8;
            line-height: 1.8;
        }

        .back-link {
            position: fixed;
            top: 20px;
            left: 20px;
            padding: 12px 24px;
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            color: #9d4edd;
            text-decoration: none;
            border-radius: 30px;
            font-size: 14px;
            z-index: 1000;
            transition: all 0.3s;
            border: 1px solid rgba(157,78,221,0.3);
        }

        .back-link:hover {
            background: rgba(157,78,221,0.2);
            transform: translateX(-5px);
        }

        .container {
            max-width: 1100px;
            margin: 0 auto;
            padding: 80px 30px 60px;
        }

        header {
            text-align: center;
            margin-bottom: 50px;
        }

        h1 {
            font-size: 2.8rem;
            font-weight: 400;
            color: #9d4edd;
            margin-bottom: 20px;
            letter-spacing: 2px;
        }

        .subtitle {
            font-size: 1.4rem;
            color: #a8b2d1;
            font-style: italic;
        }

        .paradox-statement {
            background: linear-gradient(135deg, rgba(157,78,221,0.15) 0%, rgba(255,215,0,0.1) 100%);
            border-left: 4px solid #9d4edd;
            padding: 30px 40px;
            margin: 40px 0;
            border-radius: 0 20px 20px 0;
            font-size: 1.25rem;
            text-align: center;
        }

        h2 {
            font-size: 1.8rem;
            color: #9d4edd;
            margin: 50px 0 25px;
            font-weight: 400;
        }

        p {
            margin-bottom: 20px;
            color: #c8d0e8;
        }

        .highlight {
            color: #ffd700;
            font-weight: 600;
        }

        .simulation-container {
            background: rgba(0,0,0,0.4);
            border-radius: 20px;
            padding: 30px;
            margin: 40px 0;
            border: 1px solid rgba(157,78,221,0.2);
        }

        .sim-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .sim-title {
            font-size: 1.4rem;
            color: #9d4edd;
        }

        .controls {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 600;
            transition: all 0.3s;
        }

        .btn-primary {
            background: linear-gradient(135deg, #9d4edd 0%, #7b2cbf 100%);
            color: white;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(157,78,221,0.3);
        }

        .dataset-selector {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
            margin-bottom: 25px;
        }

        .dataset-btn {
            padding: 10px 20px;
            border: 2px solid rgba(157,78,221,0.3);
            background: transparent;
            color: #a8b2d1;
            border-radius: 25px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s;
        }

        .dataset-btn.active {
            background: #9d4edd;
            border-color: #9d4edd;
            color: white;
        }

        .dataset-btn:hover:not(.active) {
            border-color: #9d4edd;
            color: #9d4edd;
        }

        #chart-container {
            position: relative;
            height: 350px;
            margin-bottom: 20px;
        }

        #canvas {
            width: 100%;
            height: 100%;
            background: #0a0a1a;
            border-radius: 15px;
        }

        .benford-table {
            display: grid;
            grid-template-columns: repeat(9, 1fr);
            gap: 10px;
            margin-top: 25px;
        }

        .digit-box {
            background: rgba(255,255,255,0.05);
            border-radius: 12px;
            padding: 15px 10px;
            text-align: center;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .digit-num {
            font-size: 2rem;
            font-weight: 700;
            color: #9d4edd;
        }

        .digit-expected {
            font-size: 0.85rem;
            color: #ffd700;
            margin-top: 5px;
        }

        .digit-actual {
            font-size: 0.85rem;
            color: #4ecdc4;
            margin-top: 3px;
        }

        .verdict-box {
            text-align: center;
            padding: 25px;
            border-radius: 15px;
            margin-top: 25px;
            font-size: 1.1rem;
        }

        .verdict-clean {
            background: rgba(78,205,196,0.2);
            border: 2px solid #4ecdc4;
            color: #4ecdc4;
        }

        .verdict-suspicious {
            background: rgba(233,69,96,0.2);
            border: 2px solid #e94560;
            color: #e94560;
        }

        .explanation-box {
            background: rgba(255,215,0,0.1);
            border: 1px solid rgba(255,215,0,0.3);
            border-radius: 15px;
            padding: 25px;
            margin: 30px 0;
        }

        .explanation-box h3 {
            color: #ffd700;
            margin-bottom: 15px;
            font-size: 1.2rem;
        }

        .math-box {
            background: rgba(0,0,0,0.4);
            border-radius: 12px;
            padding: 20px;
            font-family: 'Courier New', monospace;
            margin: 20px 0;
            text-align: center;
        }

        .math-formula {
            color: #9d4edd;
            font-size: 1.2rem;
        }

        .case-study {
            background: rgba(78,205,196,0.1);
            border: 1px solid rgba(78,205,196,0.3);
            border-radius: 15px;
            padding: 25px;
            margin: 30px 0;
        }

        .case-study h3 {
            color: #4ecdc4;
            margin-bottom: 15px;
        }

        .fraud-case {
            background: rgba(233,69,96,0.1);
            border: 1px solid rgba(233,69,96,0.3);
            border-radius: 15px;
            padding: 25px;
            margin: 30px 0;
        }

        .fraud-case h3 {
            color: #e94560;
            margin-bottom: 15px;
        }

        .interactive-input {
            background: rgba(0,0,0,0.3);
            border-radius: 15px;
            padding: 25px;
            margin: 30px 0;
        }

        .interactive-input h3 {
            color: #9d4edd;
            margin-bottom: 15px;
        }

        .number-input {
            width: 100%;
            padding: 15px;
            border: 2px solid rgba(157,78,221,0.3);
            border-radius: 10px;
            background: rgba(0,0,0,0.3);
            color: #fff;
            font-size: 1rem;
            font-family: 'Courier New', monospace;
            resize: vertical;
            min-height: 100px;
        }

        .number-input:focus {
            outline: none;
            border-color: #9d4edd;
        }

        .input-hint {
            font-size: 0.85rem;
            color: #8892b0;
            margin-top: 10px;
        }

        footer {
            text-align: center;
            margin-top: 60px;
            padding-top: 40px;
            border-top: 1px solid rgba(255,255,255,0.1);
            color: #5a6a8a;
        }

        footer a {
            color: #9d4edd;
            text-decoration: none;
        }

        @media (max-width: 768px) {
            h1 { font-size: 2rem; }
            .benford-table { grid-template-columns: repeat(3, 1fr); }
            .dataset-selector { flex-direction: column; align-items: center; }
        }
    </style>
</head>
<body>
    <a href="index.html" class="back-link">‚Üê Back to Gallery</a>

    <div class="container">
        <header>
            <h1>üî¢ Benford's Law</h1>
            <p class="subtitle">The mathematical fingerprint hidden in natural numbers</p>
        </header>

        <div class="paradox-statement">
            <strong>The Surprise:</strong> In naturally occurring datasets, the digit <span class="highlight">1</span>
            appears as the first digit <span class="highlight">30%</span> of the time‚Äînot 11% as you'd expect!
        </div>

        <h2>Nature's Hidden Pattern</h2>
        <p>
            Look at any collection of natural numbers‚Äîpopulations of cities, lengths of rivers, stock prices,
            your electricity bills. You'd expect each digit (1-9) to appear as the first digit equally often, right?
            About 11% each?
        </p>
        <p>
            <span class="highlight">Wrong.</span> In 1938, physicist Frank Benford noticed something extraordinary:
            the digit 1 appears first about 30% of the time, while 9 appears only 5% of the time.
            This pattern is so reliable that accountants use it to <em>detect fraud</em>.
        </p>

        <div class="simulation-container">
            <div class="sim-header">
                <div class="sim-title">üìä First Digit Distribution Analyzer</div>
                <div class="controls">
                    <button class="btn btn-primary" id="generate-btn">Generate New Data</button>
                </div>
            </div>

            <div class="dataset-selector">
                <button class="dataset-btn active" data-dataset="populations">üåç City Populations</button>
                <button class="dataset-btn" data-dataset="fibonacci">üî¢ Fibonacci Numbers</button>
                <button class="dataset-btn" data-dataset="powers">üìà Powers of 2</button>
                <button class="dataset-btn" data-dataset="random">üé≤ Random (Uniform)</button>
                <button class="dataset-btn" data-dataset="fraud">üö® Fraudulent Data</button>
            </div>

            <div id="chart-container">
                <canvas id="canvas"></canvas>
            </div>

            <div class="benford-table" id="digit-table"></div>

            <div class="verdict-box" id="verdict"></div>
        </div>

        <div class="interactive-input">
            <h3>üß™ Test Your Own Numbers</h3>
            <textarea class="number-input" id="custom-input" placeholder="Enter numbers separated by commas, spaces, or newlines...&#10;Example: 123, 456, 789, 1234, 5678"></textarea>
            <button class="btn btn-primary" id="analyze-btn" style="margin-top: 15px;">Analyze My Data</button>
            <p class="input-hint">Paste financial data, populations, or any natural dataset to see if it follows Benford's Law.</p>
        </div>

        <div class="explanation-box">
            <h3>üß† Why Does This Happen?</h3>
            <p>
                The key insight is that numbers in nature tend to grow <em>multiplicatively</em>, not additively.
                When something grows by a percentage (like populations, stock prices, or compound interest),
                it spends more "time" with lower first digits.
            </p>
            <p>
                Think of it this way: to go from 1,000 to 2,000 (first digit changes from 1 to 2), you need to
                double. But to go from 9,000 to 10,000 (first digit changes from 9 to 1), you only need to
                increase by 11%. Numbers "pass through" lower digits more slowly.
            </p>
            <div class="math-box">
                <div class="math-formula">
                    P(d) = log‚ÇÅ‚ÇÄ(1 + 1/d)
                </div>
                <p style="color: #8892b0; margin-top: 10px; font-size: 0.9rem;">
                    P(1) = 30.1%, P(2) = 17.6%, P(3) = 12.5%, ... P(9) = 4.6%
                </p>
            </div>
        </div>

        <div class="case-study">
            <h3>üîç Datasets That Follow Benford's Law</h3>
            <p>
                ‚Ä¢ <strong>Financial data:</strong> Stock prices, accounting ledgers, tax returns<br>
                ‚Ä¢ <strong>Geographic:</strong> City populations, river lengths, mountain heights<br>
                ‚Ä¢ <strong>Scientific:</strong> Physical constants, molecular weights, astronomical distances<br>
                ‚Ä¢ <strong>Mathematical:</strong> Fibonacci numbers, factorials, powers<br>
                ‚Ä¢ <strong>Social:</strong> Death rates, birth rates, election results
            </p>
        </div>

        <div class="fraud-case">
            <h3>üö® Famous Fraud Detections</h3>
            <p>
                <strong>Bernie Madoff's Ponzi Scheme:</strong> Investment returns showed suspicious deviation
                from Benford's Law‚Äîtoo many 1s and 2s, suggesting fabricated numbers.
            </p>
            <p>
                <strong>Greek Economic Data (2000s):</strong> Greece's EU application data showed anomalies
                that suggested manipulation of economic figures.
            </p>
            <p>
                <strong>Expense Report Fraud:</strong> An employee was caught replacing receipts starting with
                "1" with receipts starting with "7"‚Äîthe distribution revealed the deception.
            </p>
            <p>
                <strong>Election Fraud Detection:</strong> Researchers analyze vote counts to flag potential
                irregularities, though context is crucial for interpretation.
            </p>
        </div>

        <h2>Important Caveats</h2>
        <p>
            Not all data follows Benford's Law. It doesn't apply to:
        </p>
        <p>
            ‚Ä¢ <strong>Assigned numbers:</strong> Phone numbers, social security numbers, zip codes<br>
            ‚Ä¢ <strong>Constrained data:</strong> Human heights, IQ scores, prices ending in .99<br>
            ‚Ä¢ <strong>Small range data:</strong> Data that doesn't span multiple orders of magnitude
        </p>
        <p>
            A deviation from Benford's Law is a <span class="highlight">red flag, not proof</span> of fraud.
            It tells auditors where to look, but investigation is still required.
        </p>

        <footer>
            <p>
                Discovered by Simon Newcomb (1881), rediscovered by Frank Benford (1938) ¬∑
                <a href="https://en.wikipedia.org/wiki/Benford's_law" target="_blank">Learn more on Wikipedia</a>
            </p>
            <p style="margin-top: 15px; font-size: 0.9rem;">
                Sources:
                <a href="https://brilliant.org/wiki/benfords-law/" target="_blank">Brilliant.org</a> ¬∑
                <a href="https://statisticsbyjim.com/probability/benfords-law/" target="_blank">Statistics By Jim</a> ¬∑
                <a href="https://www.journalofaccountancy.com/issues/2017/apr/excel-and-benfords-law-to-detect-fraud/" target="_blank">Journal of Accountancy</a>
            </p>
        </footer>
    </div>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');

        // Benford's Law expected probabilities
        const benfordExpected = [
            30.1, 17.6, 12.5, 9.7, 7.9, 6.7, 5.8, 5.1, 4.6
        ];

        let currentDataset = 'populations';
        let actualDistribution = [];

        function resize() {
            const container = document.getElementById('chart-container');
            canvas.width = container.clientWidth;
            canvas.height = container.clientHeight;
        }
        resize();
        window.addEventListener('resize', () => { resize(); draw(); });

        // Generate different datasets
        function generateData(type) {
            let numbers = [];

            switch(type) {
                case 'populations':
                    // Simulate city populations (log-normal distribution)
                    for (let i = 0; i < 500; i++) {
                        const pop = Math.floor(Math.exp(Math.random() * 8 + 6));
                        numbers.push(pop);
                    }
                    break;

                case 'fibonacci':
                    let a = 1, b = 1;
                    for (let i = 0; i < 100; i++) {
                        numbers.push(a);
                        [a, b] = [b, a + b];
                    }
                    break;

                case 'powers':
                    for (let i = 1; i <= 100; i++) {
                        numbers.push(Math.pow(2, i));
                    }
                    break;

                case 'random':
                    // Uniform random - should NOT follow Benford
                    for (let i = 0; i < 500; i++) {
                        numbers.push(Math.floor(Math.random() * 9000) + 1000);
                    }
                    break;

                case 'fraud':
                    // Simulated fraudulent data - too uniform, favors 5-9
                    for (let i = 0; i < 500; i++) {
                        const firstDigit = Math.floor(Math.random() * 5) + 5; // 5-9 biased
                        const rest = Math.floor(Math.random() * 1000);
                        numbers.push(parseInt(firstDigit + '' + rest));
                    }
                    break;

                case 'custom':
                    const input = document.getElementById('custom-input').value;
                    const matches = input.match(/\d+/g);
                    if (matches) {
                        numbers = matches.map(n => parseInt(n)).filter(n => n > 0);
                    }
                    break;
            }

            return numbers;
        }

        function getFirstDigit(n) {
            const s = Math.abs(n).toString();
            return parseInt(s[0]);
        }

        function analyzeDistribution(numbers) {
            const counts = [0, 0, 0, 0, 0, 0, 0, 0, 0]; // digits 1-9

            numbers.forEach(n => {
                const d = getFirstDigit(n);
                if (d >= 1 && d <= 9) {
                    counts[d - 1]++;
                }
            });

            const total = counts.reduce((a, b) => a + b, 0);
            return counts.map(c => total > 0 ? (c / total * 100) : 0);
        }

        function calculateDeviation(actual) {
            let sumSquaredDiff = 0;
            for (let i = 0; i < 9; i++) {
                sumSquaredDiff += Math.pow(actual[i] - benfordExpected[i], 2);
            }
            return Math.sqrt(sumSquaredDiff / 9);
        }

        function draw() {
            ctx.fillStyle = '#0a0a1a';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            const margin = { top: 50, right: 30, bottom: 50, left: 50 };
            const chartWidth = canvas.width - margin.left - margin.right;
            const chartHeight = canvas.height - margin.top - margin.bottom;
            const barWidth = chartWidth / 9 * 0.8;
            const gap = chartWidth / 9 * 0.2;

            // Title
            ctx.fillStyle = '#9d4edd';
            ctx.font = 'bold 16px Georgia';
            ctx.textAlign = 'center';
            ctx.fillText('First Digit Distribution', canvas.width / 2, 25);

            // Y-axis
            ctx.strokeStyle = 'rgba(255,255,255,0.2)';
            ctx.lineWidth = 1;
            for (let i = 0; i <= 35; i += 5) {
                const y = margin.top + chartHeight - (i / 35) * chartHeight;
                ctx.beginPath();
                ctx.moveTo(margin.left, y);
                ctx.lineTo(canvas.width - margin.right, y);
                ctx.stroke();

                ctx.fillStyle = '#8892b0';
                ctx.font = '11px Georgia';
                ctx.textAlign = 'right';
                ctx.fillText(i + '%', margin.left - 8, y + 4);
            }

            // Draw bars
            for (let i = 0; i < 9; i++) {
                const x = margin.left + i * (chartWidth / 9) + gap / 2;

                // Expected (Benford) bar - outline
                const expectedHeight = (benfordExpected[i] / 35) * chartHeight;
                ctx.strokeStyle = '#ffd700';
                ctx.lineWidth = 2;
                ctx.setLineDash([5, 5]);
                ctx.strokeRect(x, margin.top + chartHeight - expectedHeight, barWidth, expectedHeight);
                ctx.setLineDash([]);

                // Actual bar
                if (actualDistribution.length > 0) {
                    const actualHeight = (actualDistribution[i] / 35) * chartHeight;
                    const deviation = Math.abs(actualDistribution[i] - benfordExpected[i]);

                    // Color based on deviation
                    if (deviation < 3) {
                        ctx.fillStyle = '#4ecdc4'; // Good match
                    } else if (deviation < 6) {
                        ctx.fillStyle = '#ffd700'; // Slight deviation
                    } else {
                        ctx.fillStyle = '#e94560'; // Significant deviation
                    }

                    ctx.fillRect(x + 3, margin.top + chartHeight - actualHeight, barWidth - 6, actualHeight);

                    // Actual value label
                    ctx.fillStyle = '#fff';
                    ctx.font = 'bold 12px Georgia';
                    ctx.textAlign = 'center';
                    if (actualHeight > 20) {
                        ctx.fillText(actualDistribution[i].toFixed(1) + '%', x + barWidth / 2, margin.top + chartHeight - actualHeight + 15);
                    }
                }

                // Digit label
                ctx.fillStyle = '#9d4edd';
                ctx.font = 'bold 16px Georgia';
                ctx.textAlign = 'center';
                ctx.fillText(i + 1, x + barWidth / 2, canvas.height - 20);
            }

            // Legend
            ctx.fillStyle = '#ffd700';
            ctx.fillRect(canvas.width - 180, 45, 15, 3);
            ctx.setLineDash([5, 5]);
            ctx.strokeStyle = '#ffd700';
            ctx.strokeRect(canvas.width - 180, 40, 15, 12);
            ctx.setLineDash([]);
            ctx.fillStyle = '#e0e0e0';
            ctx.font = '12px Georgia';
            ctx.textAlign = 'left';
            ctx.fillText("Benford's Law", canvas.width - 160, 52);

            ctx.fillStyle = '#4ecdc4';
            ctx.fillRect(canvas.width - 180, 65, 15, 12);
            ctx.fillStyle = '#e0e0e0';
            ctx.fillText('Actual Data', canvas.width - 160, 75);
        }

        function updateDigitTable() {
            let html = '';
            for (let i = 0; i < 9; i++) {
                const actual = actualDistribution[i] ? actualDistribution[i].toFixed(1) : '--';
                const deviation = actualDistribution[i] ? Math.abs(actualDistribution[i] - benfordExpected[i]) : 0;
                const color = deviation < 3 ? '#4ecdc4' : deviation < 6 ? '#ffd700' : '#e94560';

                html += `
                    <div class="digit-box">
                        <div class="digit-num">${i + 1}</div>
                        <div class="digit-expected">Expected: ${benfordExpected[i]}%</div>
                        <div class="digit-actual" style="color: ${color}">Actual: ${actual}%</div>
                    </div>
                `;
            }
            document.getElementById('digit-table').innerHTML = html;
        }

        function updateVerdict() {
            const deviation = calculateDeviation(actualDistribution);
            const verdict = document.getElementById('verdict');

            let datasetName = {
                'populations': 'City Populations',
                'fibonacci': 'Fibonacci Numbers',
                'powers': 'Powers of 2',
                'random': 'Uniform Random Numbers',
                'fraud': 'Fraudulent Data',
                'custom': 'Your Custom Data'
            }[currentDataset];

            if (deviation < 3) {
                verdict.className = 'verdict-box verdict-clean';
                verdict.innerHTML = `‚úÖ <strong>${datasetName}</strong> follows Benford's Law well!<br>
                    <span style="font-size: 0.9rem;">Mean deviation: ${deviation.toFixed(2)}% ‚Äî This data appears natural.</span>`;
            } else if (deviation < 6) {
                verdict.className = 'verdict-box verdict-clean';
                verdict.style.borderColor = '#ffd700';
                verdict.style.color = '#ffd700';
                verdict.innerHTML = `‚ö†Ô∏è <strong>${datasetName}</strong> shows some deviation from Benford's Law.<br>
                    <span style="font-size: 0.9rem;">Mean deviation: ${deviation.toFixed(2)}% ‚Äî May warrant closer examination.</span>`;
            } else {
                verdict.className = 'verdict-box verdict-suspicious';
                verdict.innerHTML = `üö® <strong>${datasetName}</strong> significantly deviates from Benford's Law!<br>
                    <span style="font-size: 0.9rem;">Mean deviation: ${deviation.toFixed(2)}% ‚Äî This data may be artificial or manipulated.</span>`;
            }
        }

        function loadDataset(type) {
            currentDataset = type;
            const numbers = generateData(type);
            actualDistribution = analyzeDistribution(numbers);
            draw();
            updateDigitTable();
            updateVerdict();
        }

        // Event listeners
        document.querySelectorAll('.dataset-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.dataset-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                loadDataset(this.dataset.dataset);
            });
        });

        document.getElementById('generate-btn').addEventListener('click', () => {
            loadDataset(currentDataset);
        });

        document.getElementById('analyze-btn').addEventListener('click', () => {
            document.querySelectorAll('.dataset-btn').forEach(b => b.classList.remove('active'));
            loadDataset('custom');
        });

        // Initial load
        loadDataset('populations');
    </script>
    <script src="../assets/js/enhance.js" defer></script>
</body>
</html>
