<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Penrose Tiling - Aperiodic Never-Repeating Patterns</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            color: #e0e0e0;
            min-height: 100vh;
            padding: 20px;
        }
        .back-link {
            display: inline-flex;
            align-items: center;
            color: #fbbf24;
            text-decoration: none;
            margin-bottom: 15px;
            font-size: 0.95em;
        }
        .back-link:hover {
            color: #fcd34d;
            text-decoration: underline;
        }
        h1 {
            font-size: 1.8em;
            margin-bottom: 5px;
            color: #fff;
            text-shadow: 0 0 30px rgba(251, 191, 36, 0.5);
        }
        .subtitle {
            color: #fcd34d;
            margin-bottom: 20px;
            font-size: 1.05em;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        .main-content {
            display: grid;
            grid-template-columns: 1fr 350px;
            gap: 20px;
        }
        .canvas-container {
            background: rgba(0,0,0,0.4);
            border-radius: 12px;
            padding: 15px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        canvas {
            border-radius: 8px;
            background: #0a0a14;
        }
        .info-text {
            margin-top: 10px;
            font-size: 0.8em;
            color: #fbbf24;
        }
        .sidebar {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        .panel {
            background: rgba(255,255,255,0.05);
            border-radius: 12px;
            padding: 15px;
            border: 1px solid rgba(255,255,255,0.1);
        }
        .panel h3 {
            font-size: 0.9em;
            color: #fbbf24;
            margin-bottom: 12px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .controls {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }
        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.85em;
            font-weight: 500;
            transition: all 0.2s;
        }
        .btn-primary {
            background: linear-gradient(135deg, #fbbf24, #d97706);
            color: #1a1a2e;
        }
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(251, 191, 36, 0.4);
        }
        .btn-secondary {
            background: rgba(255,255,255,0.1);
            color: #e0e0e0;
            border: 1px solid rgba(255,255,255,0.2);
        }
        .btn-secondary:hover {
            background: rgba(255,255,255,0.2);
        }
        .param-group {
            margin-bottom: 15px;
        }
        .param-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
        }
        .param-name {
            color: #fcd34d;
            font-size: 0.85em;
        }
        .param-value {
            color: #fde68a;
            font-family: 'Monaco', 'Consolas', monospace;
            font-size: 0.9em;
        }
        input[type="range"] {
            width: 100%;
            height: 6px;
            border-radius: 3px;
            background: rgba(255,255,255,0.1);
            -webkit-appearance: none;
        }
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: #fbbf24;
            cursor: pointer;
        }
        .stat-row {
            display: flex;
            justify-content: space-between;
            padding: 6px 0;
            border-bottom: 1px solid rgba(255,255,255,0.05);
        }
        .stat-label {
            color: #fcd34d;
            font-size: 0.8em;
        }
        .stat-value {
            color: #fde68a;
            font-family: 'Monaco', 'Consolas', monospace;
            font-size: 0.8em;
        }
        .golden-ratio {
            background: rgba(0,0,0,0.3);
            padding: 10px;
            border-radius: 6px;
            text-align: center;
            margin-top: 10px;
        }
        .golden-ratio .phi {
            font-size: 1.5em;
            color: #fbbf24;
            font-weight: bold;
        }
        .golden-ratio .label {
            font-size: 0.75em;
            color: #fcd34d;
        }
        .exp-section {
            margin-top: 20px;
        }
        .exp-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 15px;
        }
        .exp-card {
            background: linear-gradient(135deg, rgba(251,191,36,0.1), rgba(217,119,6,0.05));
            border-radius: 10px;
            padding: 15px;
            border: 1px solid rgba(251,191,36,0.2);
        }
        .exp-card h4 {
            color: #fbbf24;
            margin-bottom: 8px;
            font-size: 0.95em;
        }
        .exp-card p {
            font-size: 0.85em;
            line-height: 1.6;
            color: #fcd34d;
        }
        @media (max-width: 900px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <a href="index.html" class="back-link">← Back to Paradoxes</a>
        <h1>Penrose Tiling</h1>
        <p class="subtitle">Aperiodic Patterns That NEVER Repeat</p>

        <div class="main-content">
            <div class="canvas-container">
                <canvas id="mainCanvas" width="650" height="600"></canvas>
                <p class="info-text">Five-fold symmetry with only two tile shapes!</p>
            </div>

            <div class="sidebar">
                <div class="panel">
                    <h3>Controls</h3>
                    <div class="controls">
                        <button class="btn btn-primary" id="generateBtn">Regenerate</button>
                        <button class="btn btn-secondary" id="animateBtn">Animate</button>
                    </div>
                </div>

                <div class="panel">
                    <h3>Subdivision Level</h3>
                    <div class="param-group">
                        <div class="param-label">
                            <span class="param-name">Iterations</span>
                            <span class="param-value" id="iterValue">5</span>
                        </div>
                        <input type="range" id="iterSlider" min="1" max="8" value="5">
                    </div>
                </div>

                <div class="panel">
                    <h3>Statistics</h3>
                    <div class="stat-row">
                        <span class="stat-label">Thin rhombi (36°)</span>
                        <span id="thinCount" class="stat-value">-</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Thick rhombi (72°)</span>
                        <span id="thickCount" class="stat-value">-</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Ratio (thick/thin)</span>
                        <span id="ratio" class="stat-value">-</span>
                    </div>
                    <div class="golden-ratio">
                        <div class="phi">φ ≈ 1.618</div>
                        <div class="label">Ratio approaches Golden Ratio!</div>
                    </div>
                </div>

                <div class="panel">
                    <h3>The Two Rhombi</h3>
                    <canvas id="tileCanvas" width="300" height="100"></canvas>
                    <p style="font-size: 0.75em; color: #94a3b8; margin-top: 8px;">
                        Thin (36°, 144°) and Thick (72°, 108°). Edge lengths are in golden ratio!
                    </p>
                </div>

                <div class="panel">
                    <h3>Why Aperiodic?</h3>
                    <p style="font-size: 0.8em; color: #fcd34d; line-height: 1.6;">
                        Matching rules on the edges force non-periodic arrangement. No matter how far you extend the tiling, it will NEVER repeat translationally. Yet it has perfect local five-fold symmetry!
                    </p>
                </div>
            </div>
        </div>

        <div class="exp-section">
            <div class="exp-cards">
                <div class="exp-card">
                    <h4>Roger Penrose (1974)</h4>
                    <p>British mathematician and physicist Roger Penrose discovered these tilings while trying to pack regular pentagons. His original set had 6 shapes; he reduced it to just 2 (kites & darts, then rhombi). Martin Gardner popularized them in Scientific American 1977.</p>
                </div>
                <div class="exp-card">
                    <h4>Quasicrystals!</h4>
                    <p>In 1984, Dan Shechtman found real materials with five-fold symmetry—supposedly impossible! Penrose tilings explained them. Quasicrystals have ordered but non-periodic atomic arrangements. Shechtman won the 2011 Nobel Prize in Chemistry!</p>
                </div>
                <div class="exp-card">
                    <h4>The Golden Ratio Connection</h4>
                    <p>The ratio of thick to thin rhombi approaches φ = (1+√5)/2 ≈ 1.618. Edge lengths are also in golden ratio. Even the angles (36°, 72°) divide 360° into golden proportions. φ appears EVERYWHERE in Penrose tilings!</p>
                </div>
                <div class="exp-card">
                    <h4>Infinite, Never Repeating</h4>
                    <p>Unlike square or hexagonal tilings, Penrose tilings have NO translational period. Shift the pattern any distance—it won't match! Yet any finite patch appears infinitely often. Local patterns repeat; global patterns never do!</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('mainCanvas');
        const ctx = canvas.getContext('2d');
        const tileCanvas = document.getElementById('tileCanvas');
        const tileCtx = tileCanvas.getContext('2d');

        // Golden ratio
        const phi = (1 + Math.sqrt(5)) / 2;

        // Angles in radians
        const deg36 = Math.PI / 5;
        const deg72 = 2 * Math.PI / 5;

        let iterations = 5;
        let triangles = [];
        let animating = false;
        let animLevel = 0;

        // Triangle types: 0 = thin half, 1 = thick half
        // Each triangle stored as {type, A, B, C} where A is the apex

        function subdivide(triangles) {
            const result = [];

            for (const tri of triangles) {
                const { type, A, B, C } = tri;

                if (type === 0) {
                    // Thin half-rhombus: split into one thin and one thick
                    const P = {
                        x: A.x + (B.x - A.x) / phi,
                        y: A.y + (B.y - A.y) / phi
                    };
                    result.push({ type: 0, A: C, B: P, C: B });
                    result.push({ type: 1, A: P, B: C, C: A });
                } else {
                    // Thick half-rhombus: split into two thick and one thin
                    const Q = {
                        x: B.x + (A.x - B.x) / phi,
                        y: B.y + (A.y - B.y) / phi
                    };
                    const R = {
                        x: B.x + (C.x - B.x) / phi,
                        y: B.y + (C.y - B.y) / phi
                    };
                    result.push({ type: 1, A: Q, B: R, C: B });
                    result.push({ type: 1, A: R, B: Q, C: A });
                    result.push({ type: 0, A: R, B: C, C: A });
                }
            }

            return result;
        }

        function initializeWheel() {
            // Start with a "sun" configuration - 10 triangles around center
            const centerX = canvas.width / 2;
            const centerY = canvas.height / 2;
            const radius = Math.min(canvas.width, canvas.height) * 0.45;

            triangles = [];

            for (let i = 0; i < 10; i++) {
                const angle1 = (2 * i - 1) * deg36;
                const angle2 = (2 * i + 1) * deg36;

                const B = {
                    x: centerX + radius * Math.cos(angle1),
                    y: centerY + radius * Math.sin(angle1)
                };
                const C = {
                    x: centerX + radius * Math.cos(angle2),
                    y: centerY + radius * Math.sin(angle2)
                };

                // Alternate between pointing in and out
                if (i % 2 === 0) {
                    triangles.push({ type: 0, A: { x: centerX, y: centerY }, B, C });
                } else {
                    triangles.push({ type: 0, A: { x: centerX, y: centerY }, B: C, C: B });
                }
            }
        }

        function generate() {
            initializeWheel();

            for (let i = 0; i < iterations; i++) {
                triangles = subdivide(triangles);
            }
        }

        function draw() {
            const w = canvas.width;
            const h = canvas.height;

            ctx.fillStyle = '#0a0a14';
            ctx.fillRect(0, 0, w, h);

            // Count tile types
            let thinCount = 0;
            let thickCount = 0;

            // Group triangles into rhombi by drawing pairs
            ctx.lineWidth = 0.5;

            for (let i = 0; i < triangles.length; i++) {
                const tri = triangles[i];
                const { type, A, B, C } = tri;

                // Color based on type
                if (type === 0) {
                    ctx.fillStyle = 'rgba(251, 191, 36, 0.6)'; // Yellow - thin
                    thinCount++;
                } else {
                    ctx.fillStyle = 'rgba(59, 130, 246, 0.6)'; // Blue - thick
                    thickCount++;
                }

                ctx.strokeStyle = 'rgba(255, 255, 255, 0.3)';

                ctx.beginPath();
                ctx.moveTo(A.x, A.y);
                ctx.lineTo(B.x, B.y);
                ctx.lineTo(C.x, C.y);
                ctx.closePath();
                ctx.fill();
                ctx.stroke();
            }

            // Each rhombus is made of 2 half-triangles
            const thinRhombi = Math.floor(thinCount / 2);
            const thickRhombi = Math.floor(thickCount / 2);
            const ratio = thickRhombi / (thinRhombi || 1);

            document.getElementById('thinCount').textContent = thinRhombi.toLocaleString();
            document.getElementById('thickCount').textContent = thickRhombi.toLocaleString();
            document.getElementById('ratio').textContent = ratio.toFixed(4);
            document.getElementById('iterValue').textContent = iterations;
        }

        function drawTileShapes() {
            const w = tileCanvas.width;
            const h = tileCanvas.height;

            tileCtx.fillStyle = 'rgba(0,0,0,0.3)';
            tileCtx.fillRect(0, 0, w, h);

            const size = 35;

            // Thin rhombus (36°, 144°)
            const thin36 = Math.PI / 5;
            tileCtx.fillStyle = 'rgba(251, 191, 36, 0.7)';
            tileCtx.strokeStyle = 'rgba(255,255,255,0.5)';
            tileCtx.lineWidth = 1;
            tileCtx.beginPath();
            tileCtx.moveTo(60, 50);
            tileCtx.lineTo(60 + size * Math.cos(-thin36/2), 50 + size * Math.sin(-thin36/2));
            tileCtx.lineTo(60 + size * 2 * Math.cos(0), 50);
            tileCtx.lineTo(60 + size * Math.cos(thin36/2), 50 + size * Math.sin(thin36/2));
            tileCtx.closePath();
            tileCtx.fill();
            tileCtx.stroke();

            tileCtx.fillStyle = '#fcd34d';
            tileCtx.font = '10px sans-serif';
            tileCtx.textAlign = 'center';
            tileCtx.fillText('Thin (36°)', 75, 90);

            // Thick rhombus (72°, 108°)
            const thick72 = 2 * Math.PI / 5;
            tileCtx.fillStyle = 'rgba(59, 130, 246, 0.7)';
            tileCtx.beginPath();
            tileCtx.moveTo(200, 50);
            tileCtx.lineTo(200 + size * Math.cos(-thick72/2), 50 + size * Math.sin(-thick72/2));
            tileCtx.lineTo(200 + size * 1.3 * Math.cos(0), 50);
            tileCtx.lineTo(200 + size * Math.cos(thick72/2), 50 + size * Math.sin(thick72/2));
            tileCtx.closePath();
            tileCtx.fill();
            tileCtx.stroke();

            tileCtx.fillStyle = '#93c5fd';
            tileCtx.fillText('Thick (72°)', 210, 90);
        }

        function animate() {
            if (!animating) return;

            animLevel++;
            if (animLevel > 8) {
                animating = false;
                document.getElementById('animateBtn').textContent = 'Animate';
                return;
            }

            iterations = animLevel;
            document.getElementById('iterSlider').value = iterations;
            generate();
            draw();

            setTimeout(() => requestAnimationFrame(animate), 600);
        }

        // Event handlers
        document.getElementById('iterSlider').addEventListener('input', (e) => {
            iterations = parseInt(e.target.value);
            generate();
            draw();
        });

        document.getElementById('generateBtn').addEventListener('click', () => {
            generate();
            draw();
        });

        document.getElementById('animateBtn').addEventListener('click', () => {
            if (animating) {
                animating = false;
                document.getElementById('animateBtn').textContent = 'Animate';
            } else {
                animating = true;
                animLevel = 0;
                document.getElementById('animateBtn').textContent = 'Stop';
                animate();
            }
        });

        // Initialize
        generate();
        draw();
        drawTileShapes();
    </script>
    <script src="../assets/js/enhance.js" defer></script>
</body>
</html>
