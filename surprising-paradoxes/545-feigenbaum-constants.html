<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Feigenbaum Constants - Surprising Paradoxes</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: linear-gradient(135deg, #0a192f 0%, #112240 50%, #0a192f 100%);
            color: #e6f1ff;
            min-height: 100vh;
            overflow-x: hidden;
        }

        .back-link {
            position: fixed;
            top: 20px;
            left: 20px;
            color: #64ffda;
            text-decoration: none;
            font-size: 14px;
            z-index: 100;
            padding: 8px 16px;
            background: rgba(100, 255, 218, 0.1);
            border-radius: 20px;
            backdrop-filter: blur(10px);
            transition: all 0.3s;
        }

        .back-link:hover {
            background: rgba(100, 255, 218, 0.2);
        }

        header {
            text-align: center;
            padding: 60px 20px 20px;
        }

        h1 {
            font-size: clamp(1.8rem, 5vw, 2.8rem);
            background: linear-gradient(135deg, #64ffda, #63b3ed, #f687b3);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 15px;
        }

        .constant-display {
            font-size: 2.5rem;
            font-family: 'Courier New', monospace;
            color: #64ffda;
            margin: 15px 0;
            text-shadow: 0 0 30px rgba(100, 255, 218, 0.5);
        }

        .subtitle {
            font-size: 1.1rem;
            color: #8892b0;
            max-width: 800px;
            margin: 0 auto;
            line-height: 1.6;
        }

        .main-container {
            display: grid;
            grid-template-columns: 1fr 350px;
            gap: 20px;
            max-width: 1400px;
            margin: 20px auto;
            padding: 0 20px;
        }

        @media (max-width: 1000px) {
            .main-container {
                grid-template-columns: 1fr;
            }
        }

        .viz-panel {
            background: rgba(255,255,255,0.02);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 20px;
            padding: 20px;
        }

        #bifurcationCanvas {
            width: 100%;
            height: 450px;
            background: #0a0f1a;
            border-radius: 12px;
            cursor: crosshair;
        }

        .controls-panel {
            background: rgba(255,255,255,0.02);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 20px;
            padding: 25px;
        }

        .control-section {
            margin-bottom: 25px;
        }

        .control-section h3 {
            color: #64ffda;
            font-size: 0.95rem;
            margin-bottom: 15px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .map-selector {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 15px;
        }

        .map-btn {
            padding: 8px 15px;
            background: rgba(100, 255, 218, 0.1);
            border: 1px solid rgba(100, 255, 218, 0.3);
            border-radius: 20px;
            color: #64ffda;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.85rem;
        }

        .map-btn:hover, .map-btn.active {
            background: rgba(100, 255, 218, 0.3);
            border-color: #64ffda;
        }

        .bifurcation-points {
            background: rgba(0,0,0,0.3);
            border-radius: 12px;
            padding: 15px;
            max-height: 200px;
            overflow-y: auto;
        }

        .bifurcation-row {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            font-family: monospace;
            font-size: 0.85rem;
        }

        .bifurcation-row:last-child {
            border-bottom: none;
        }

        .period-label {
            color: #63b3ed;
        }

        .r-value {
            color: #f687b3;
        }

        .ratio-value {
            color: #64ffda;
            font-weight: bold;
        }

        .constant-box {
            background: linear-gradient(135deg, rgba(100, 255, 218, 0.1), rgba(99, 179, 237, 0.1));
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            margin: 15px 0;
            border: 1px solid rgba(100, 255, 218, 0.3);
        }

        .constant-box h4 {
            color: #64ffda;
            margin-bottom: 10px;
        }

        .delta-value {
            font-size: 2rem;
            font-family: 'Courier New', monospace;
            color: #f687b3;
            text-shadow: 0 0 20px rgba(246, 135, 179, 0.5);
        }

        .convergence {
            font-size: 0.85rem;
            color: #8892b0;
            margin-top: 10px;
        }

        button {
            width: 100%;
            padding: 14px;
            font-size: 1rem;
            background: linear-gradient(135deg, #64ffda, #63b3ed);
            border: none;
            border-radius: 12px;
            color: #0a192f;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            margin: 5px 0;
        }

        button:hover {
            transform: scale(1.02);
            box-shadow: 0 5px 25px rgba(100, 255, 218, 0.3);
        }

        button.secondary {
            background: linear-gradient(135deg, #f687b3, #fc8181);
        }

        .zoom-info {
            font-size: 0.8rem;
            color: #8892b0;
            text-align: center;
            margin-top: 10px;
        }

        .explanation {
            background: linear-gradient(135deg, rgba(100, 255, 218, 0.05), rgba(99, 179, 237, 0.05));
            border-radius: 20px;
            padding: 30px;
            margin: 30px auto;
            max-width: 1360px;
        }

        .explanation h2 {
            color: #64ffda;
            margin-bottom: 20px;
        }

        .exp-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
        }

        .exp-card {
            background: rgba(0,0,0,0.2);
            padding: 20px;
            border-radius: 12px;
            border-left: 4px solid #63b3ed;
        }

        .exp-card h3 {
            color: #63b3ed;
            margin-bottom: 10px;
            font-size: 1rem;
        }

        .exp-card p {
            color: #a8b2d1;
            font-size: 0.9rem;
            line-height: 1.6;
        }

        .math-box {
            background: rgba(246, 135, 179, 0.1);
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            margin: 20px 0;
            font-family: 'Times New Roman', serif;
            font-size: 1.2rem;
            border: 1px solid rgba(246, 135, 179, 0.3);
        }

        .universality-demo {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .map-result {
            background: rgba(0,0,0,0.3);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }

        .map-result h5 {
            color: #63b3ed;
            font-size: 0.85rem;
            margin-bottom: 8px;
        }

        .map-result .delta {
            font-family: monospace;
            color: #64ffda;
            font-size: 1.1rem;
        }

        footer {
            text-align: center;
            padding: 40px 20px;
            color: #495670;
            font-size: 0.85rem;
        }

        footer a {
            color: #64ffda;
            text-decoration: none;
        }
    </style>
</head>
<body>
    <a href="index.html" class="back-link">← Back to Paradoxes</a>

    <header>
        <h1>The Feigenbaum Constants</h1>
        <div class="constant-display">δ ≈ 4.669201609...</div>
        <p class="subtitle">
            This number appears in <em>every</em> chaotic system—logistic maps, fluid turbulence,
            electrical circuits, even dripping faucets. Discovered by Mitchell Feigenbaum in 1975
            using only a pocket calculator. Why is this universal? Nobody fully knows.
        </p>
    </header>

    <div class="main-container">
        <div class="viz-panel">
            <canvas id="bifurcationCanvas"></canvas>
            <div class="zoom-info">Click and drag to zoom • Double-click to reset</div>
        </div>

        <div class="controls-panel">
            <div class="control-section">
                <h3>Choose Map Function</h3>
                <div class="map-selector">
                    <button class="map-btn active" onclick="setMap('logistic')">Logistic</button>
                    <button class="map-btn" onclick="setMap('sine')">Sine</button>
                    <button class="map-btn" onclick="setMap('tent')">Tent</button>
                    <button class="map-btn" onclick="setMap('cubic')">Cubic</button>
                </div>
            </div>

            <div class="control-section">
                <h3>Period-Doubling Points</h3>
                <div class="bifurcation-points" id="bifurcationPoints">
                    <div class="bifurcation-row">
                        <span class="period-label">Loading...</span>
                    </div>
                </div>
            </div>

            <div class="constant-box">
                <h4>Computed δ (Feigenbaum)</h4>
                <div class="delta-value" id="deltaValue">--</div>
                <div class="convergence" id="convergence">
                    Approaches 4.669201609...
                </div>
            </div>

            <button onclick="animatePeriodDoubling()">
                ▶ Animate Period Doubling
            </button>
            <button onclick="resetZoom()" class="secondary">
                ↺ Reset View
            </button>
        </div>
    </div>

    <div class="explanation">
        <h2>Why Is This Universal?</h2>
        <div class="exp-grid">
            <div class="exp-card">
                <h3>Period Doubling Cascade</h3>
                <p>As a parameter increases, stable fixed points become unstable.
                   The system "doubles" its period: 1→2→4→8→16→... until chaos.
                   The bifurcation points r₁, r₂, r₃... converge geometrically.</p>
            </div>
            <div class="exp-card">
                <h3>The Feigenbaum Ratio</h3>
                <p>The ratio (rₙ - rₙ₋₁)/(rₙ₊₁ - rₙ) approaches δ ≈ 4.669 as n→∞.
                   This means each period-doubling interval is ~4.67× smaller than the last.
                   At r∞ ≈ 3.5699..., chaos begins.</p>
            </div>
            <div class="exp-card">
                <h3>Universality Class</h3>
                <p>ANY smooth function with a single quadratic maximum shows the same δ!
                   Logistic, sine, Gaussian, polynomial—they all give 4.669...
                   This is like π appearing in every circle, regardless of size.</p>
            </div>
            <div class="exp-card">
                <h3>Real-World Observations</h3>
                <p>Feigenbaum's constant has been measured in:
                   fluid convection, laser systems, chemical reactions,
                   heart rhythms, population dynamics, and electronic oscillators.
                   Nature knows this number!</p>
            </div>
        </div>

        <div class="math-box">
            <strong>Logistic Map:</strong> xₙ₊₁ = r·xₙ(1 - xₙ)
            <br><small style="color: #8892b0;">Period doubles at r₁≈3.0, r₂≈3.449, r₃≈3.545, r₄≈3.564...</small>
        </div>

        <h3 style="color: #64ffda; margin: 20px 0;">Universality Across Different Maps</h3>
        <div class="universality-demo">
            <div class="map-result">
                <h5>Logistic Map</h5>
                <div class="delta">δ = 4.6692...</div>
            </div>
            <div class="map-result">
                <h5>Sine Map</h5>
                <div class="delta">δ = 4.6692...</div>
            </div>
            <div class="map-result">
                <h5>Gaussian Map</h5>
                <div class="delta">δ = 4.6692...</div>
            </div>
            <div class="map-result">
                <h5>Cubic Map</h5>
                <div class="delta">δ = 4.6692...</div>
            </div>
        </div>
    </div>

    <footer>
        <p>Part of <a href="index.html">Surprising Paradoxes</a> |
           Discovered by Mitchell Feigenbaum (1975) • First proven by Oscar Lanford (1982)</p>
    </footer>

    <script>
        const canvas = document.getElementById('bifurcationCanvas');
        const ctx = canvas.getContext('2d');

        let currentMap = 'logistic';
        let viewMin = 2.5, viewMax = 4.0;
        let yMin = 0, yMax = 1;
        let isZooming = false;
        let zoomStart = { x: 0, y: 0 };

        // Known bifurcation points for logistic map
        const logisticBifurcations = [
            { period: 2, r: 3.0 },
            { period: 4, r: 3.4494897 },
            { period: 8, r: 3.5450903 },
            { period: 16, r: 3.5644073 },
            { period: 32, r: 3.5687594 },
            { period: 64, r: 3.5696916 },
            { period: 128, r: 3.5698913 },
            { period: 'chaos', r: 3.5699456 }
        ];

        function resizeCanvas() {
            const rect = canvas.getBoundingClientRect();
            canvas.width = rect.width * 2;
            canvas.height = rect.height * 2;
            ctx.scale(2, 2);
        }

        function mapFunction(x, r, type) {
            switch(type) {
                case 'logistic':
                    return r * x * (1 - x);
                case 'sine':
                    return r * Math.sin(Math.PI * x) / Math.PI;
                case 'tent':
                    return x < 0.5 ? r * x : r * (1 - x);
                case 'cubic':
                    return r * x * (1 - x * x);
                default:
                    return r * x * (1 - x);
            }
        }

        function drawBifurcationDiagram() {
            resizeCanvas();
            const width = canvas.width / 2;
            const height = canvas.height / 2;

            ctx.fillStyle = '#0a0f1a';
            ctx.fillRect(0, 0, width, height);

            const iterations = 300;
            const display = 100;

            // Draw bifurcation points
            for (let px = 0; px < width; px++) {
                const r = viewMin + (px / width) * (viewMax - viewMin);

                let x = 0.5;

                // Iterate to reach attractor
                for (let i = 0; i < iterations; i++) {
                    x = mapFunction(x, r, currentMap);
                }

                // Plot attractor points
                for (let i = 0; i < display; i++) {
                    x = mapFunction(x, r, currentMap);

                    if (x >= yMin && x <= yMax && !isNaN(x) && isFinite(x)) {
                        const py = height - ((x - yMin) / (yMax - yMin)) * height;

                        // Color based on r value
                        const hue = 180 + ((r - viewMin) / (viewMax - viewMin)) * 60;
                        ctx.fillStyle = `hsla(${hue}, 80%, 60%, 0.3)`;
                        ctx.fillRect(px, py, 1, 1);
                    }
                }
            }

            // Draw axes labels
            ctx.fillStyle = '#8892b0';
            ctx.font = '12px sans-serif';
            ctx.fillText(`r = ${viewMin.toFixed(3)}`, 10, height - 10);
            ctx.fillText(`r = ${viewMax.toFixed(3)}`, width - 70, height - 10);
            ctx.fillText('x', 10, 20);

            // Mark bifurcation points if visible
            if (currentMap === 'logistic') {
                ctx.strokeStyle = 'rgba(246, 135, 179, 0.5)';
                ctx.setLineDash([5, 5]);
                logisticBifurcations.forEach(bp => {
                    if (bp.r >= viewMin && bp.r <= viewMax) {
                        const px = ((bp.r - viewMin) / (viewMax - viewMin)) * width;
                        ctx.beginPath();
                        ctx.moveTo(px, 0);
                        ctx.lineTo(px, height);
                        ctx.stroke();
                    }
                });
                ctx.setLineDash([]);
            }
        }

        function updateBifurcationPoints() {
            const container = document.getElementById('bifurcationPoints');
            let html = '';

            if (currentMap === 'logistic') {
                logisticBifurcations.forEach((bp, i) => {
                    let ratio = '--';
                    if (i >= 2 && i < logisticBifurcations.length - 1) {
                        const prev = logisticBifurcations[i-1].r - logisticBifurcations[i-2].r;
                        const curr = bp.r - logisticBifurcations[i-1].r;
                        ratio = (prev / curr).toFixed(4);
                    }

                    html += `
                        <div class="bifurcation-row">
                            <span class="period-label">Period ${bp.period}</span>
                            <span class="r-value">r = ${bp.r.toFixed(6)}</span>
                            <span class="ratio-value">${ratio}</span>
                        </div>
                    `;
                });

                // Compute delta from last ratios
                const n = logisticBifurcations.length - 2;
                if (n >= 2) {
                    const prev = logisticBifurcations[n-1].r - logisticBifurcations[n-2].r;
                    const curr = logisticBifurcations[n].r - logisticBifurcations[n-1].r;
                    const delta = prev / curr;
                    document.getElementById('deltaValue').textContent = delta.toFixed(6);
                }
            } else {
                html = '<div class="bifurcation-row"><span>Switch to Logistic map to see exact values</span></div>';
                document.getElementById('deltaValue').textContent = '≈ 4.6692';
            }

            container.innerHTML = html;
        }

        function setMap(type) {
            currentMap = type;
            document.querySelectorAll('.map-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');

            // Adjust view for different maps
            if (type === 'sine') {
                viewMin = 0;
                viewMax = 1;
            } else if (type === 'tent') {
                viewMin = 0;
                viewMax = 2;
            } else if (type === 'cubic') {
                viewMin = 0;
                viewMax = 3;
            } else {
                viewMin = 2.5;
                viewMax = 4.0;
            }
            yMin = 0;
            yMax = 1;

            drawBifurcationDiagram();
            updateBifurcationPoints();
        }

        function resetZoom() {
            if (currentMap === 'logistic') {
                viewMin = 2.5;
                viewMax = 4.0;
            }
            yMin = 0;
            yMax = 1;
            drawBifurcationDiagram();
        }

        function animatePeriodDoubling() {
            let targetR = viewMin;
            const endR = Math.min(viewMax, 3.6);

            function animate() {
                if (targetR < endR) {
                    viewMin = Math.max(2.5, targetR - 0.3);
                    viewMax = targetR + 0.3;
                    drawBifurcationDiagram();
                    targetR += 0.01;
                    setTimeout(animate, 50);
                } else {
                    resetZoom();
                }
            }
            animate();
        }

        // Zoom handling
        canvas.addEventListener('mousedown', (e) => {
            isZooming = true;
            const rect = canvas.getBoundingClientRect();
            zoomStart = {
                x: e.clientX - rect.left,
                y: e.clientY - rect.top
            };
        });

        canvas.addEventListener('mouseup', (e) => {
            if (!isZooming) return;
            isZooming = false;

            const rect = canvas.getBoundingClientRect();
            const zoomEnd = {
                x: e.clientX - rect.left,
                y: e.clientY - rect.top
            };

            if (Math.abs(zoomEnd.x - zoomStart.x) > 10) {
                const width = rect.width;
                const height = rect.height;

                const newRMin = viewMin + (Math.min(zoomStart.x, zoomEnd.x) / width) * (viewMax - viewMin);
                const newRMax = viewMin + (Math.max(zoomStart.x, zoomEnd.x) / width) * (viewMax - viewMin);

                const newYMax = yMax - (Math.min(zoomStart.y, zoomEnd.y) / height) * (yMax - yMin);
                const newYMin = yMax - (Math.max(zoomStart.y, zoomEnd.y) / height) * (yMax - yMin);

                viewMin = newRMin;
                viewMax = newRMax;
                yMin = newYMin;
                yMax = newYMax;

                drawBifurcationDiagram();
            }
        });

        canvas.addEventListener('dblclick', resetZoom);

        // Initial draw
        drawBifurcationDiagram();
        updateBifurcationPoints();
    </script>
    <script src="../assets/js/enhance.js" defer></script>
</body>
</html>
