<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Burning Ship Fractal - Surprising Paradoxes</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: linear-gradient(135deg, #0a0a0f 0%, #1a1a2e 100%);
            color: #e0e0e0;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
        }

        h1 {
            font-size: 2.5em;
            background: linear-gradient(135deg, #ff6b35 0%, #f7931e 50%, #ffcc00 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
        }

        .subtitle {
            font-size: 1.2em;
            color: #888;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 350px;
            gap: 20px;
        }

        @media (max-width: 1000px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }

        .canvas-container {
            background: #000;
            border-radius: 12px;
            overflow: hidden;
            position: relative;
        }

        #fractalCanvas {
            display: block;
            width: 100%;
            cursor: crosshair;
        }

        .info-overlay {
            position: absolute;
            top: 10px;
            left: 10px;
            background: rgba(0,0,0,0.7);
            padding: 10px 15px;
            border-radius: 8px;
            font-size: 0.85em;
            font-family: monospace;
        }

        .info-overlay span {
            color: #ffcc00;
        }

        .controls {
            background: rgba(255,255,255,0.05);
            border-radius: 12px;
            padding: 20px;
        }

        .control-section {
            margin-bottom: 25px;
        }

        .control-section h3 {
            color: #ff6b35;
            margin-bottom: 15px;
            font-size: 1.1em;
            border-bottom: 1px solid rgba(255,107,53,0.3);
            padding-bottom: 8px;
        }

        .control-row {
            margin-bottom: 15px;
        }

        .control-row label {
            display: block;
            margin-bottom: 5px;
            color: #aaa;
            font-size: 0.9em;
        }

        .control-row input[type="range"] {
            width: 100%;
            margin-bottom: 5px;
        }

        .control-row .value {
            text-align: right;
            font-family: monospace;
            color: #ffcc00;
            font-size: 0.9em;
        }

        .btn-group {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        button {
            padding: 10px 16px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9em;
            transition: all 0.2s;
        }

        .btn-primary {
            background: linear-gradient(135deg, #ff6b35, #f7931e);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(255,107,53,0.4);
        }

        .btn-secondary {
            background: rgba(255,255,255,0.1);
            color: #e0e0e0;
        }

        .btn-secondary:hover {
            background: rgba(255,255,255,0.2);
        }

        .preset-btn {
            flex: 1;
            min-width: 80px;
            font-size: 0.8em;
            padding: 8px 12px;
        }

        .color-schemes {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 8px;
        }

        .explanation {
            margin-top: 30px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
        }

        .exp-card {
            background: rgba(255,255,255,0.05);
            border-radius: 12px;
            padding: 20px;
            border-left: 4px solid #ff6b35;
        }

        .exp-card h3 {
            color: #ff6b35;
            margin-bottom: 10px;
        }

        .exp-card p {
            color: #bbb;
            line-height: 1.6;
        }

        .formula {
            background: rgba(0,0,0,0.3);
            padding: 15px;
            border-radius: 8px;
            font-family: 'Times New Roman', serif;
            font-size: 1.2em;
            text-align: center;
            margin: 15px 0;
            color: #ffcc00;
        }

        .back-link {
            display: inline-block;
            color: #ff6b35;
            text-decoration: none;
            margin-bottom: 20px;
            transition: transform 0.2s;
        }

        .back-link:hover {
            transform: translateX(-5px);
        }

        .loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #ff6b35;
            font-size: 1.2em;
        }

        .instructions {
            font-size: 0.85em;
            color: #888;
            margin-top: 10px;
            padding: 10px;
            background: rgba(0,0,0,0.2);
            border-radius: 8px;
        }
    </style>
</head>
<body>
    <div class="container">
        <a href="index.html" class="back-link">← Back to Paradoxes</a>

        <header>
            <h1>The Burning Ship Fractal</h1>
            <p class="subtitle">Where absolute values create mathematical flames</p>
        </header>

        <div class="main-content">
            <div class="canvas-container">
                <canvas id="fractalCanvas" width="900" height="700"></canvas>
                <div class="info-overlay">
                    <div>Center: (<span id="centerX">-0.4</span>, <span id="centerY">-0.5</span>)</div>
                    <div>Zoom: <span id="zoomLevel">1.0</span>x</div>
                    <div>Iterations: <span id="iterCount">256</span></div>
                </div>
                <div class="loading" id="loading" style="display: none;">Rendering...</div>
            </div>

            <div class="controls">
                <div class="control-section">
                    <h3>Navigation</h3>
                    <div class="btn-group">
                        <button class="btn-primary" id="resetBtn">Reset View</button>
                        <button class="btn-secondary" id="zoomOutBtn">Zoom Out</button>
                    </div>
                    <div class="instructions">
                        Click to zoom in. Drag to pan. Scroll to zoom.
                    </div>
                </div>

                <div class="control-section">
                    <h3>Presets</h3>
                    <div class="btn-group">
                        <button class="btn-secondary preset-btn" data-preset="full">Full Ship</button>
                        <button class="btn-secondary preset-btn" data-preset="ship">Ship Hull</button>
                        <button class="btn-secondary preset-btn" data-preset="mast">Mast Detail</button>
                        <button class="btn-secondary preset-btn" data-preset="flame">Flame Tip</button>
                        <button class="btn-secondary preset-btn" data-preset="miniship">Mini-Ship</button>
                        <button class="btn-secondary preset-btn" data-preset="spiral">Spiral</button>
                    </div>
                </div>

                <div class="control-section">
                    <h3>Iterations</h3>
                    <div class="control-row">
                        <label>Max Iterations</label>
                        <input type="range" id="iterSlider" min="50" max="1000" value="256">
                        <div class="value" id="iterValue">256</div>
                    </div>
                </div>

                <div class="control-section">
                    <h3>Color Scheme</h3>
                    <div class="color-schemes">
                        <button class="btn-secondary" data-scheme="fire">Fire</button>
                        <button class="btn-secondary" data-scheme="ocean">Ocean</button>
                        <button class="btn-secondary" data-scheme="midnight">Midnight</button>
                        <button class="btn-secondary" data-scheme="rainbow">Rainbow</button>
                    </div>
                </div>

                <div class="control-section">
                    <h3>Compare</h3>
                    <div class="btn-group">
                        <button class="btn-secondary" id="toggleMandel">Show Mandelbrot</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="explanation">
            <div class="exp-card">
                <h3>The Iteration Formula</h3>
                <div class="formula">z<sub>n+1</sub> = (|Re(z<sub>n</sub>)| + i|Im(z<sub>n</sub>)|)² + c</div>
                <p>Unlike the Mandelbrot set which uses z² + c directly, the Burning Ship takes the absolute value of the real and imaginary parts before squaring. This seemingly small change transforms the smooth Mandelbrot into a fractal resembling a ship engulfed in flames.</p>
            </div>

            <div class="exp-card">
                <h3>The Paradox of Asymmetry</h3>
                <p>The Mandelbrot set is symmetric about the real axis because complex conjugation preserves the iteration. But the absolute value operation breaks this symmetry in a surprising way—the Burning Ship is asymmetric, yet still infinitely detailed and self-similar at every scale.</p>
            </div>

            <div class="exp-card">
                <h3>Discovery & History</h3>
                <p>The Burning Ship was discovered by Michael Michelitsch and Otto Rössler in 1992. Unlike the Mandelbrot set (discovered 1978), it received less attention despite its striking appearance. It belongs to a family of "non-analytic" fractals created by using absolute values.</p>
            </div>

            <div class="exp-card">
                <h3>Mini-Ships Within</h3>
                <p>Just as the Mandelbrot set contains infinite copies of itself (mini-Mandelbrots), the Burning Ship contains mini-ships at various scales. Zoom into the boundary regions to discover these embedded copies, each slightly distorted but maintaining the characteristic ship shape.</p>
            </div>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('fractalCanvas');
        const ctx = canvas.getContext('2d');
        const loading = document.getElementById('loading');

        // View parameters
        let centerX = -0.4;
        let centerY = -0.5;
        let zoom = 1.0;
        let maxIter = 256;
        let showMandelbrot = false;
        let colorScheme = 'fire';

        // Drag state
        let isDragging = false;
        let dragStartX, dragStartY;
        let dragStartCenterX, dragStartCenterY;

        // Color palettes
        const colorSchemes = {
            fire: (t) => {
                const r = Math.min(255, t * 3 * 255);
                const g = Math.min(255, Math.max(0, (t - 0.33) * 3 * 255));
                const b = Math.min(255, Math.max(0, (t - 0.66) * 3 * 255));
                return [r, g, b];
            },
            ocean: (t) => {
                const r = Math.min(255, t * 128);
                const g = Math.min(255, t * 200 + 55);
                const b = Math.min(255, 100 + t * 155);
                return [r, g, b];
            },
            midnight: (t) => {
                const r = Math.min(255, t * 100 + 20);
                const g = Math.min(255, t * 50);
                const b = Math.min(255, 80 + t * 175);
                return [r, g, b];
            },
            rainbow: (t) => {
                const h = t * 360;
                const s = 1;
                const l = 0.5;
                const c = (1 - Math.abs(2 * l - 1)) * s;
                const x = c * (1 - Math.abs((h / 60) % 2 - 1));
                const m = l - c / 2;
                let r, g, b;
                if (h < 60) { r = c; g = x; b = 0; }
                else if (h < 120) { r = x; g = c; b = 0; }
                else if (h < 180) { r = 0; g = c; b = x; }
                else if (h < 240) { r = 0; g = x; b = c; }
                else if (h < 300) { r = x; g = 0; b = c; }
                else { r = c; g = 0; b = x; }
                return [(r + m) * 255, (g + m) * 255, (b + m) * 255];
            }
        };

        // Presets
        const presets = {
            full: { x: -0.4, y: -0.5, z: 1.0, iter: 256 },
            ship: { x: -1.76, y: -0.028, z: 25, iter: 400 },
            mast: { x: -1.762, y: -0.028, z: 200, iter: 500 },
            flame: { x: -1.755, y: -0.035, z: 80, iter: 400 },
            miniship: { x: -1.941, y: -0.0055, z: 500, iter: 600 },
            spiral: { x: -1.8605, y: -0.0002, z: 1000, iter: 700 }
        };

        function updateInfo() {
            document.getElementById('centerX').textContent = centerX.toFixed(6);
            document.getElementById('centerY').textContent = centerY.toFixed(6);
            document.getElementById('zoomLevel').textContent = zoom.toFixed(1);
            document.getElementById('iterCount').textContent = maxIter;
            document.getElementById('iterValue').textContent = maxIter;
        }

        function burningShipIteration(cx, cy, maxIter) {
            let x = 0, y = 0;
            let iteration = 0;

            while (x*x + y*y <= 4 && iteration < maxIter) {
                const xTemp = x*x - y*y + cx;
                y = Math.abs(2*x*y) + cy;
                x = Math.abs(xTemp);
                iteration++;
            }

            if (iteration === maxIter) return -1;

            // Smooth coloring
            const logZn = Math.log(x*x + y*y) / 2;
            const nu = Math.log(logZn / Math.log(2)) / Math.log(2);
            return iteration + 1 - nu;
        }

        function mandelbrotIteration(cx, cy, maxIter) {
            let x = 0, y = 0;
            let iteration = 0;

            while (x*x + y*y <= 4 && iteration < maxIter) {
                const xTemp = x*x - y*y + cx;
                y = 2*x*y + cy;
                x = xTemp;
                iteration++;
            }

            if (iteration === maxIter) return -1;

            const logZn = Math.log(x*x + y*y) / 2;
            const nu = Math.log(logZn / Math.log(2)) / Math.log(2);
            return iteration + 1 - nu;
        }

        function render() {
            loading.style.display = 'block';

            requestAnimationFrame(() => {
                const width = canvas.width;
                const height = canvas.height;
                const imageData = ctx.createImageData(width, height);
                const data = imageData.data;

                const scale = 3 / zoom;
                const aspectRatio = width / height;

                const iterFunc = showMandelbrot ? mandelbrotIteration : burningShipIteration;
                const getColor = colorSchemes[colorScheme];

                for (let py = 0; py < height; py++) {
                    for (let px = 0; px < width; px++) {
                        // Map pixel to complex plane (flip y for burning ship orientation)
                        const cx = centerX + (px / width - 0.5) * scale * aspectRatio;
                        const cy = centerY - (py / height - 0.5) * scale;

                        const result = iterFunc(cx, cy, maxIter);

                        const idx = (py * width + px) * 4;

                        if (result < 0) {
                            // Inside the set
                            data[idx] = 0;
                            data[idx + 1] = 0;
                            data[idx + 2] = 0;
                        } else {
                            // Outside - color based on escape time
                            const t = (result % 50) / 50;
                            const [r, g, b] = getColor(t);
                            data[idx] = r;
                            data[idx + 1] = g;
                            data[idx + 2] = b;
                        }
                        data[idx + 3] = 255;
                    }
                }

                ctx.putImageData(imageData, 0, 0);
                loading.style.display = 'none';
            });
        }

        // Event handlers
        canvas.addEventListener('click', (e) => {
            if (isDragging) return;

            const rect = canvas.getBoundingClientRect();
            const px = (e.clientX - rect.left) * (canvas.width / rect.width);
            const py = (e.clientY - rect.top) * (canvas.height / rect.height);

            const scale = 3 / zoom;
            const aspectRatio = canvas.width / canvas.height;

            centerX += (px / canvas.width - 0.5) * scale * aspectRatio;
            centerY -= (py / canvas.height - 0.5) * scale;
            zoom *= 2;

            updateInfo();
            render();
        });

        canvas.addEventListener('mousedown', (e) => {
            isDragging = true;
            dragStartX = e.clientX;
            dragStartY = e.clientY;
            dragStartCenterX = centerX;
            dragStartCenterY = centerY;
            canvas.style.cursor = 'grabbing';
        });

        canvas.addEventListener('mousemove', (e) => {
            if (!isDragging) return;

            const rect = canvas.getBoundingClientRect();
            const dx = (e.clientX - dragStartX) / rect.width;
            const dy = (e.clientY - dragStartY) / rect.height;

            const scale = 3 / zoom;
            const aspectRatio = canvas.width / canvas.height;

            centerX = dragStartCenterX - dx * scale * aspectRatio;
            centerY = dragStartCenterY + dy * scale;

            updateInfo();
            render();
        });

        canvas.addEventListener('mouseup', () => {
            isDragging = false;
            canvas.style.cursor = 'crosshair';
        });

        canvas.addEventListener('mouseleave', () => {
            isDragging = false;
            canvas.style.cursor = 'crosshair';
        });

        canvas.addEventListener('wheel', (e) => {
            e.preventDefault();
            const factor = e.deltaY > 0 ? 0.8 : 1.25;
            zoom *= factor;
            updateInfo();
            render();
        });

        // Controls
        document.getElementById('resetBtn').addEventListener('click', () => {
            centerX = -0.4;
            centerY = -0.5;
            zoom = 1.0;
            showMandelbrot = false;
            document.getElementById('toggleMandel').textContent = 'Show Mandelbrot';
            updateInfo();
            render();
        });

        document.getElementById('zoomOutBtn').addEventListener('click', () => {
            zoom *= 0.5;
            updateInfo();
            render();
        });

        document.getElementById('iterSlider').addEventListener('input', (e) => {
            maxIter = parseInt(e.target.value);
            updateInfo();
            render();
        });

        document.getElementById('toggleMandel').addEventListener('click', (e) => {
            showMandelbrot = !showMandelbrot;
            e.target.textContent = showMandelbrot ? 'Show Burning Ship' : 'Show Mandelbrot';
            render();
        });

        // Preset buttons
        document.querySelectorAll('.preset-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                const preset = presets[btn.dataset.preset];
                centerX = preset.x;
                centerY = preset.y;
                zoom = preset.z;
                maxIter = preset.iter;
                document.getElementById('iterSlider').value = maxIter;
                showMandelbrot = false;
                document.getElementById('toggleMandel').textContent = 'Show Mandelbrot';
                updateInfo();
                render();
            });
        });

        // Color scheme buttons
        document.querySelectorAll('[data-scheme]').forEach(btn => {
            btn.addEventListener('click', () => {
                colorScheme = btn.dataset.scheme;
                render();
            });
        });

        // Initial render
        updateInfo();
        render();
    </script>
    <script src="../assets/js/enhance.js" defer></script>
</body>
</html>
