<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Wine-Water Paradox - A Spoonful of Surprise</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Georgia', serif;
            background: linear-gradient(135deg, #1a0a1a 0%, #2a1a2a 50%, #1a1a2a 100%);
            color: #e0e0e0;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
        }

        h1 {
            font-size: 2.4em;
            background: linear-gradient(135deg, #cc3366, #9933cc, #3366cc);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
        }

        .subtitle {
            font-size: 1.3em;
            color: #aaa;
            font-style: italic;
        }

        .back-link {
            position: fixed;
            top: 20px;
            left: 20px;
            color: #cc6699;
            text-decoration: none;
            font-size: 1.1em;
            z-index: 100;
            transition: color 0.3s;
        }

        .back-link:hover {
            color: #ff99cc;
        }

        .main-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
            margin-bottom: 25px;
        }

        @media (max-width: 900px) {
            .main-grid {
                grid-template-columns: 1fr;
            }
        }

        .panel {
            background: rgba(30, 20, 40, 0.9);
            border-radius: 15px;
            padding: 25px;
            border: 1px solid rgba(200, 100, 150, 0.2);
        }

        .panel h2 {
            color: #cc6699;
            margin-bottom: 15px;
            font-size: 1.4em;
        }

        .panel h3 {
            color: #9966cc;
            margin: 15px 0 10px 0;
            font-size: 1.1em;
        }

        .simulation-area {
            display: flex;
            justify-content: center;
            align-items: flex-end;
            gap: 80px;
            padding: 30px;
            background: linear-gradient(180deg, #0a0510 0%, #151020 100%);
            border-radius: 15px;
            min-height: 350px;
            position: relative;
        }

        .glass {
            position: relative;
            width: 120px;
            height: 200px;
            border: 3px solid rgba(255,255,255,0.3);
            border-top: none;
            border-radius: 0 0 20px 20px;
            background: rgba(255,255,255,0.05);
            overflow: hidden;
        }

        .glass-label {
            position: absolute;
            bottom: -30px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 1.1em;
            color: #aaa;
            white-space: nowrap;
        }

        .liquid {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 80%;
            transition: background 0.5s;
        }

        #wineGlass .liquid {
            background: linear-gradient(180deg, rgba(180, 40, 60, 0.9), rgba(120, 20, 40, 0.95));
        }

        #waterGlass .liquid {
            background: linear-gradient(180deg, rgba(40, 100, 180, 0.9), rgba(20, 60, 120, 0.95));
        }

        .particle-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }

        .spoon {
            position: absolute;
            width: 40px;
            height: 60px;
            opacity: 0;
            transition: all 0.5s ease-in-out;
            pointer-events: none;
        }

        .spoon-bowl {
            width: 35px;
            height: 25px;
            background: linear-gradient(135deg, #c0c0c0, #808080);
            border-radius: 50%;
            position: absolute;
            bottom: 0;
        }

        .spoon-handle {
            width: 8px;
            height: 40px;
            background: linear-gradient(90deg, #a0a0a0, #c0c0c0, #a0a0a0);
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            border-radius: 4px;
        }

        .controls {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
            margin: 20px 0;
        }

        button {
            padding: 12px 25px;
            font-size: 1em;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
        }

        .btn-wine {
            background: linear-gradient(135deg, #cc3366, #993366);
            color: white;
        }

        .btn-water {
            background: linear-gradient(135deg, #3366cc, #336699);
            color: white;
        }

        .btn-secondary {
            background: linear-gradient(135deg, #555, #333);
            color: #fff;
        }

        button:hover {
            transform: scale(1.05);
        }

        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .stats-container {
            display: flex;
            justify-content: space-around;
            margin-top: 20px;
        }

        .stat-group {
            text-align: center;
            padding: 15px;
            border-radius: 10px;
            min-width: 120px;
        }

        .stat-group.wine {
            background: rgba(180, 40, 60, 0.2);
            border: 1px solid rgba(180, 40, 60, 0.4);
        }

        .stat-group.water {
            background: rgba(40, 100, 180, 0.2);
            border: 1px solid rgba(40, 100, 180, 0.4);
        }

        .stat-group h4 {
            font-size: 0.9em;
            margin-bottom: 10px;
        }

        .stat-group.wine h4 { color: #ff6688; }
        .stat-group.water h4 { color: #6688ff; }

        .stat-row {
            display: flex;
            justify-content: space-between;
            margin: 5px 0;
            font-size: 0.9em;
        }

        .stat-row .label { color: #888; }
        .stat-row .value { font-weight: bold; }
        .stat-row .value.wine-val { color: #ff6688; }
        .stat-row .value.water-val { color: #6688ff; }

        .paradox-box {
            background: linear-gradient(135deg, rgba(200, 100, 150, 0.1), rgba(100, 100, 200, 0.1));
            border: 1px solid rgba(200, 100, 150, 0.3);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }

        .paradox-box h3 {
            color: #cc6699;
            margin-bottom: 10px;
        }

        .reveal-box {
            background: linear-gradient(135deg, rgba(100, 255, 150, 0.1), rgba(50, 200, 100, 0.1));
            border: 1px solid rgba(100, 255, 150, 0.3);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            display: none;
        }

        .reveal-box.visible {
            display: block;
        }

        .reveal-box h3 {
            color: #66ff99;
            margin-bottom: 10px;
        }

        .explanation {
            line-height: 1.8;
            color: #ccc;
        }

        .explanation p {
            margin-bottom: 15px;
        }

        .highlight {
            background: rgba(200, 100, 150, 0.2);
            padding: 2px 6px;
            border-radius: 4px;
            color: #ff99cc;
        }

        .full-width {
            grid-column: 1 / -1;
        }

        .step-indicator {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 15px 0;
        }

        .step {
            padding: 8px 15px;
            border-radius: 20px;
            background: rgba(0,0,0,0.3);
            color: #666;
            font-size: 0.9em;
        }

        .step.active {
            background: rgba(200, 100, 150, 0.3);
            color: #cc6699;
            border: 1px solid rgba(200, 100, 150, 0.5);
        }

        .step.done {
            background: rgba(100, 200, 100, 0.2);
            color: #66cc66;
        }

        .arrow {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 2em;
            color: #666;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .arrow.visible {
            opacity: 1;
        }

        .source-link {
            color: #cc6699;
            text-decoration: none;
        }

        .source-link:hover {
            text-decoration: underline;
        }

        .marble-legend {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin: 15px 0;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .legend-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }

        .legend-dot.wine { background: #cc3366; }
        .legend-dot.water { background: #3366cc; }
    </style>
</head>
<body>
    <a href="index.html" class="back-link">← Back to Paradoxes</a>

    <div class="container">
        <header>
            <h1>The Wine-Water Paradox</h1>
            <p class="subtitle">A spoonful of wine, a spoonful back... who has more of whom?</p>
        </header>

        <div class="main-grid">
            <!-- Simulation -->
            <div class="panel full-width">
                <h2>The Experiment</h2>

                <div class="step-indicator">
                    <div class="step active" id="step1">1. Start</div>
                    <div class="step" id="step2">2. Wine → Water</div>
                    <div class="step" id="step3">3. Stir</div>
                    <div class="step" id="step4">4. Mix → Wine</div>
                    <div class="step" id="step5">5. Compare!</div>
                </div>

                <div class="simulation-area">
                    <div class="glass" id="wineGlass">
                        <div class="liquid"></div>
                        <canvas class="particle-canvas" id="wineCanvas"></canvas>
                        <div class="glass-label">Wine Glass</div>
                    </div>

                    <div class="arrow" id="arrow">→</div>

                    <div class="glass" id="waterGlass">
                        <div class="liquid"></div>
                        <canvas class="particle-canvas" id="waterCanvas"></canvas>
                        <div class="glass-label">Water Glass</div>
                    </div>

                    <div class="spoon" id="spoon">
                        <div class="spoon-handle"></div>
                        <div class="spoon-bowl"></div>
                    </div>
                </div>

                <div class="marble-legend">
                    <div class="legend-item">
                        <div class="legend-dot wine"></div>
                        <span>Wine particle</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-dot water"></div>
                        <span>Water particle</span>
                    </div>
                </div>

                <div class="controls">
                    <button class="btn-wine" id="transferToWater">Spoon Wine → Water</button>
                    <button class="btn-secondary" id="stir" disabled>Stir Water Glass</button>
                    <button class="btn-water" id="transferToWine" disabled>Spoon Mix → Wine</button>
                    <button class="btn-secondary" id="reset">Reset</button>
                </div>

                <div class="stats-container">
                    <div class="stat-group wine">
                        <h4>Wine Glass</h4>
                        <div class="stat-row">
                            <span class="label">Wine:</span>
                            <span class="value wine-val" id="wineInWine">50</span>
                        </div>
                        <div class="stat-row">
                            <span class="label">Water:</span>
                            <span class="value water-val" id="waterInWine">0</span>
                        </div>
                    </div>
                    <div class="stat-group water">
                        <h4>Water Glass</h4>
                        <div class="stat-row">
                            <span class="label">Wine:</span>
                            <span class="value wine-val" id="wineInWater">0</span>
                        </div>
                        <div class="stat-row">
                            <span class="label">Water:</span>
                            <span class="value water-val" id="waterInWater">50</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- The Puzzle -->
            <div class="panel">
                <h2>The Puzzle</h2>

                <div class="paradox-box">
                    <h3>The Question</h3>
                    <p>You have a glass of wine and a glass of water, filled equally.</p>
                    <ol style="margin-left: 20px; margin-top: 10px; color: #aaa;">
                        <li>Take a spoonful of wine and add it to the water</li>
                        <li>Stir the water glass thoroughly</li>
                        <li>Take a spoonful of the mixture and add it back to the wine</li>
                    </ol>
                    <p style="margin-top: 15px; color: #ffcc66; font-weight: bold;">
                        Is there more wine in the water glass, or more water in the wine glass?
                    </p>
                </div>

                <div class="explanation">
                    <h3>What Most People Think</h3>
                    <p>The first spoonful is <em>pure wine</em>. The second spoonful is <em>diluted</em>. So surely there's more wine in the water than water in the wine?</p>
                    <p style="color: #ff6666;">This intuition is <strong>wrong!</strong></p>
                </div>

                <div class="reveal-box" id="revealBox">
                    <h3>The Answer: Exactly Equal!</h3>
                    <p>No matter how much you transfer or how well you stir, the amount of wine in the water glass <strong>always equals</strong> the amount of water in the wine glass!</p>
                </div>
            </div>

            <!-- The Proof -->
            <div class="panel">
                <h2>Why It Works</h2>

                <div class="explanation">
                    <h3>The Conservation Argument</h3>
                    <p>At the end, both glasses have the <span class="highlight">same total volume</span> as they started with.</p>
                    <p>If some wine is "missing" from the wine glass, it <em>must</em> be in the water glass.</p>
                    <p>But the water glass is back to its original volume. So whatever wine is there has <em>displaced an equal volume of water</em>.</p>
                    <p>That displaced water? It's now in the wine glass!</p>

                    <h3>The Marble Proof</h3>
                    <p>Imagine 50 red marbles (wine) and 50 blue marbles (water).</p>
                    <ol style="margin-left: 20px; color: #aaa;">
                        <li>Move 10 red marbles to the blue pile (now 40 red, 60 mixed)</li>
                        <li>Move 10 marbles back (some red, some blue)</li>
                        <li>Each pile has 50 marbles again</li>
                    </ol>
                    <p style="margin-top: 10px;">If x blue marbles are now in the red pile, then x red marbles must be in the blue pile. <span class="highlight">It's just conservation!</span></p>
                </div>
            </div>

            <!-- Deeper Insight -->
            <div class="panel full-width">
                <h2>The Deep Insight</h2>

                <div class="explanation">
                    <h3>It's Even More General</h3>
                    <p>This result holds <strong>no matter what</strong>:</p>
                    <ul style="margin-left: 20px; color: #aaa;">
                        <li>The size of the spoon (as long as it's the same both times)</li>
                        <li>How well you stir (or don't stir at all!)</li>
                        <li>How many transfers you make (as long as glasses end at original levels)</li>
                        <li>The shapes of the glasses</li>
                    </ul>

                    <h3>The Key Constraint</h3>
                    <p>The only requirement is that <span class="highlight">both glasses end up at their original volumes</span>. This conservation constraint forces the "contaminations" to be equal.</p>

                    <h3>Historical Notes</h3>
                    <p>This puzzle appears in Martin Gardner's "Hexaflexagons and Other Mathematical Diversions" (1959) and was also discussed by George Gamow and Marvin Stern in "Puzzle Math" (1958). It's been stumping people for decades!</p>
                </div>
            </div>
        </div>

        <p style="text-align: center; color: #666; margin-top: 30px; font-size: 0.9em;">
            From <a href="https://en.wikipedia.org/wiki/Wine/water_mixing_problem" class="source-link" target="_blank">Martin Gardner</a> and
            <a href="https://mindyourdecisions.com/blog/2016/11/27/can-you-solve-the-diluted-wine-puzzle-famous-16th-century-math-problem/" class="source-link" target="_blank">historical sources</a>.
        </p>
    </div>

    <script>
        // Particle system
        const PARTICLE_COUNT = 50;
        const SPOON_SIZE = 10;

        let wineGlassParticles = [];
        let waterGlassParticles = [];
        let step = 1;
        let animating = false;

        const wineCanvas = document.getElementById('wineCanvas');
        const waterCanvas = document.getElementById('waterCanvas');
        const wineCtx = wineCanvas.getContext('2d');
        const waterCtx = waterCanvas.getContext('2d');

        function setupCanvases() {
            const dpr = window.devicePixelRatio || 1;

            [wineCanvas, waterCanvas].forEach(canvas => {
                const rect = canvas.parentElement.querySelector('.liquid').getBoundingClientRect();
                canvas.width = 114 * dpr;
                canvas.height = 160 * dpr;
                canvas.style.width = '114px';
                canvas.style.height = '160px';
                canvas.getContext('2d').scale(dpr, dpr);
            });
        }

        function initParticles() {
            wineGlassParticles = [];
            waterGlassParticles = [];

            // Wine particles (red)
            for (let i = 0; i < PARTICLE_COUNT; i++) {
                wineGlassParticles.push({
                    x: Math.random() * 100 + 7,
                    y: Math.random() * 140 + 10,
                    vx: (Math.random() - 0.5) * 0.5,
                    vy: (Math.random() - 0.5) * 0.5,
                    type: 'wine'
                });
            }

            // Water particles (blue)
            for (let i = 0; i < PARTICLE_COUNT; i++) {
                waterGlassParticles.push({
                    x: Math.random() * 100 + 7,
                    y: Math.random() * 140 + 10,
                    vx: (Math.random() - 0.5) * 0.5,
                    vy: (Math.random() - 0.5) * 0.5,
                    type: 'water'
                });
            }

            updateStats();
        }

        function drawParticles() {
            // Clear canvases
            wineCtx.clearRect(0, 0, 114, 160);
            waterCtx.clearRect(0, 0, 114, 160);

            // Draw wine glass particles
            wineGlassParticles.forEach(p => {
                wineCtx.beginPath();
                wineCtx.arc(p.x, p.y, 5, 0, Math.PI * 2);
                wineCtx.fillStyle = p.type === 'wine' ? '#cc3366' : '#3366cc';
                wineCtx.fill();
            });

            // Draw water glass particles
            waterGlassParticles.forEach(p => {
                waterCtx.beginPath();
                waterCtx.arc(p.x, p.y, 5, 0, Math.PI * 2);
                waterCtx.fillStyle = p.type === 'wine' ? '#cc3366' : '#3366cc';
                waterCtx.fill();
            });
        }

        function updateParticles() {
            const updateSet = (particles) => {
                particles.forEach(p => {
                    p.x += p.vx;
                    p.y += p.vy;

                    // Bounce off walls
                    if (p.x < 10 || p.x > 104) p.vx *= -1;
                    if (p.y < 10 || p.y > 150) p.vy *= -1;

                    // Keep in bounds
                    p.x = Math.max(10, Math.min(104, p.x));
                    p.y = Math.max(10, Math.min(150, p.y));

                    // Random motion
                    p.vx += (Math.random() - 0.5) * 0.1;
                    p.vy += (Math.random() - 0.5) * 0.1;

                    // Damping
                    p.vx *= 0.99;
                    p.vy *= 0.99;
                });
            };

            updateSet(wineGlassParticles);
            updateSet(waterGlassParticles);
        }

        function updateStats() {
            const wineInWine = wineGlassParticles.filter(p => p.type === 'wine').length;
            const waterInWine = wineGlassParticles.filter(p => p.type === 'water').length;
            const wineInWater = waterGlassParticles.filter(p => p.type === 'wine').length;
            const waterInWater = waterGlassParticles.filter(p => p.type === 'water').length;

            document.getElementById('wineInWine').textContent = wineInWine;
            document.getElementById('waterInWine').textContent = waterInWine;
            document.getElementById('wineInWater').textContent = wineInWater;
            document.getElementById('waterInWater').textContent = waterInWater;
        }

        function setStep(n) {
            step = n;
            for (let i = 1; i <= 5; i++) {
                const el = document.getElementById('step' + i);
                el.classList.remove('active', 'done');
                if (i < n) el.classList.add('done');
                if (i === n) el.classList.add('active');
            }

            document.getElementById('transferToWater').disabled = n !== 1;
            document.getElementById('stir').disabled = n !== 2;
            document.getElementById('transferToWine').disabled = n !== 3;
        }

        function transferWineToWater() {
            if (animating) return;
            animating = true;

            // Take SPOON_SIZE random wine particles
            const toTransfer = [];
            for (let i = 0; i < SPOON_SIZE && wineGlassParticles.length > 0; i++) {
                const idx = Math.floor(Math.random() * wineGlassParticles.length);
                toTransfer.push(wineGlassParticles.splice(idx, 1)[0]);
            }

            // Add to water glass
            toTransfer.forEach(p => {
                p.x = Math.random() * 100 + 7;
                p.y = Math.random() * 140 + 10;
                waterGlassParticles.push(p);
            });

            updateStats();
            setStep(2);

            setTimeout(() => {
                animating = false;
            }, 500);
        }

        function stirWater() {
            if (animating) return;
            animating = true;

            // Add chaotic motion
            waterGlassParticles.forEach(p => {
                p.vx = (Math.random() - 0.5) * 3;
                p.vy = (Math.random() - 0.5) * 3;
            });

            setTimeout(() => {
                setStep(3);
                animating = false;
            }, 1000);
        }

        function transferMixToWine() {
            if (animating) return;
            animating = true;

            // Take SPOON_SIZE random particles from water glass (mixed!)
            const toTransfer = [];
            for (let i = 0; i < SPOON_SIZE && waterGlassParticles.length > 0; i++) {
                const idx = Math.floor(Math.random() * waterGlassParticles.length);
                toTransfer.push(waterGlassParticles.splice(idx, 1)[0]);
            }

            // Add to wine glass
            toTransfer.forEach(p => {
                p.x = Math.random() * 100 + 7;
                p.y = Math.random() * 140 + 10;
                wineGlassParticles.push(p);
            });

            updateStats();
            setStep(5);

            // Reveal the answer
            document.getElementById('revealBox').classList.add('visible');

            setTimeout(() => {
                animating = false;
            }, 500);
        }

        function reset() {
            initParticles();
            setStep(1);
            document.getElementById('revealBox').classList.remove('visible');
        }

        // Event listeners
        document.getElementById('transferToWater').addEventListener('click', transferWineToWater);
        document.getElementById('stir').addEventListener('click', stirWater);
        document.getElementById('transferToWine').addEventListener('click', transferMixToWine);
        document.getElementById('reset').addEventListener('click', reset);

        // Animation loop
        function animate() {
            updateParticles();
            drawParticles();
            requestAnimationFrame(animate);
        }

        // Initialize
        window.addEventListener('load', () => {
            setupCanvases();
            initParticles();
            animate();
        });

        window.addEventListener('resize', () => {
            setupCanvases();
        });
    </script>
    <script src="../assets/js/enhance.js" defer></script>
</body>
</html>
