<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Supernova Light Curves - Type Ia vs Core Collapse - CCAB</title>
    <meta name="description" content="Compare light curves of different supernova types. Watch how Type Ia, II-P, and II-L supernovae evolve over time.">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            background: linear-gradient(135deg, #0a0814 0%, #1a1025 100%);
            min-height: 100vh;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            color: #e8e6e1;
            overflow-x: hidden;
        }
        .back-link {
            position: fixed;
            top: 15px; left: 15px;
            padding: 10px 18px;
            background: rgba(0, 0, 0, 0.6);
            color: #fbbf24;
            text-decoration: none;
            border-radius: 8px;
            font-size: 14px;
            z-index: 1000;
            border: 1px solid rgba(251, 191, 36, 0.3);
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 60px 20px 20px;
        }
        h1 {
            font-size: 2rem;
            margin-bottom: 10px;
            color: #fbbf24;
            text-align: center;
        }
        .subtitle {
            text-align: center;
            color: #888;
            margin-bottom: 30px;
        }
        .chart-container {
            background: rgba(0,0,0,0.3);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
        }
        #chart {
            width: 100%;
            height: 400px;
        }
        .controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }
        .btn {
            padding: 12px 24px;
            background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
            border: none;
            color: black;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.95rem;
            font-weight: 600;
        }
        .btn:hover { transform: scale(1.02); }
        .btn.secondary {
            background: rgba(251, 191, 36, 0.2);
            border: 1px solid rgba(251, 191, 36, 0.5);
            color: white;
        }
        .type-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }
        .type-btn {
            padding: 10px 20px;
            border: 2px solid;
            background: transparent;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s;
        }
        .type-btn.type-ia { border-color: #ef4444; color: #ef4444; }
        .type-btn.type-iip { border-color: #3b82f6; color: #3b82f6; }
        .type-btn.type-iil { border-color: #22c55e; color: #22c55e; }
        .type-btn.type-ibc { border-color: #a855f7; color: #a855f7; }
        .type-btn.active { color: black !important; }
        .type-btn.type-ia.active { background: #ef4444; }
        .type-btn.type-iip.active { background: #3b82f6; }
        .type-btn.type-iil.active { background: #22c55e; }
        .type-btn.type-ibc.active { background: #a855f7; }
        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
        }
        .info-panel {
            background: rgba(0,0,0,0.3);
            border-radius: 12px;
            padding: 20px;
        }
        .info-panel h2 {
            font-size: 1.1rem;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .info-panel h2 .dot {
            width: 12px; height: 12px;
            border-radius: 50%;
        }
        .info-panel.type-ia h2 { color: #ef4444; }
        .info-panel.type-ia h2 .dot { background: #ef4444; }
        .info-panel.type-iip h2 { color: #3b82f6; }
        .info-panel.type-iip h2 .dot { background: #3b82f6; }
        .info-panel.type-iil h2 { color: #22c55e; }
        .info-panel.type-iil h2 .dot { background: #22c55e; }
        .info-panel.type-ibc h2 { color: #a855f7; }
        .info-panel.type-ibc h2 .dot { background: #a855f7; }
        .info-panel p { font-size: 0.85rem; color: #aaa; line-height: 1.6; }
        .stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 15px;
        }
        .stat { text-align: center; padding: 10px; background: rgba(0,0,0,0.3); border-radius: 8px; }
        .stat-value { font-size: 1.2rem; font-weight: 600; }
        .stat-label { font-size: 0.7rem; color: #888; }
        .time-display {
            text-align: center;
            font-size: 1.5rem;
            color: #fbbf24;
            margin-bottom: 10px;
        }
        .legend {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
            font-size: 0.85rem;
        }
        .legend-item { display: flex; align-items: center; gap: 8px; }
        .legend-color { width: 30px; height: 3px; border-radius: 2px; }
    </style>
</head>
<body>
    <a href="index.html" class="back-link">← Back to Gallery</a>

    <div class="container">
        <h1>Supernova Light Curves</h1>
        <p class="subtitle">Compare the brightness evolution of different supernova types over time</p>

        <div class="time-display">Day: <span id="currentDay">0</span></div>

        <div class="type-buttons">
            <button class="type-btn type-ia active" data-type="ia">Type Ia</button>
            <button class="type-btn type-iip active" data-type="iip">Type II-P</button>
            <button class="type-btn type-iil active" data-type="iil">Type II-L</button>
            <button class="type-btn type-ibc active" data-type="ibc">Type Ib/c</button>
        </div>

        <div class="chart-container">
            <canvas id="chart"></canvas>
        </div>

        <div class="controls">
            <button class="btn" id="playBtn">▶ Play Animation</button>
            <button class="btn secondary" id="resetBtn">↺ Reset</button>
            <select id="speedSelect" style="padding: 12px; border-radius: 8px; background: rgba(251,191,36,0.2); color: white; border: 1px solid rgba(251,191,36,0.5);">
                <option value="1">1 day/sec</option>
                <option value="5" selected>5 days/sec</option>
                <option value="10">10 days/sec</option>
                <option value="20">20 days/sec</option>
            </select>
        </div>

        <div class="legend">
            <div class="legend-item"><div class="legend-color" style="background: #ef4444;"></div>Type Ia (Thermonuclear)</div>
            <div class="legend-item"><div class="legend-color" style="background: #3b82f6;"></div>Type II-P (Plateau)</div>
            <div class="legend-item"><div class="legend-color" style="background: #22c55e;"></div>Type II-L (Linear)</div>
            <div class="legend-item"><div class="legend-color" style="background: #a855f7;"></div>Type Ib/c (Stripped)</div>
        </div>

        <div class="info-grid" style="margin-top: 20px;">
            <div class="info-panel type-ia">
                <h2><span class="dot"></span>Type Ia Supernova</h2>
                <p>
                    Thermonuclear explosion of a white dwarf that accretes mass from a companion.
                    Peak luminosity is remarkably consistent (~10⁹ L☉), making them excellent
                    "standard candles" for measuring cosmic distances.
                </p>
                <div class="stats">
                    <div class="stat">
                        <div class="stat-value" style="color: #ef4444;">-19.3</div>
                        <div class="stat-label">Peak Mag</div>
                    </div>
                    <div class="stat">
                        <div class="stat-value" style="color: #ef4444;">~20</div>
                        <div class="stat-label">Days to Peak</div>
                    </div>
                </div>
            </div>

            <div class="info-panel type-iip">
                <h2><span class="dot"></span>Type II-P Supernova</h2>
                <p>
                    Core collapse of a red supergiant with intact hydrogen envelope.
                    Shows a distinctive "plateau" phase lasting ~100 days as the
                    photosphere recedes through the hydrogen layer.
                </p>
                <div class="stats">
                    <div class="stat">
                        <div class="stat-value" style="color: #3b82f6;">-17.0</div>
                        <div class="stat-label">Peak Mag</div>
                    </div>
                    <div class="stat">
                        <div class="stat-value" style="color: #3b82f6;">~100</div>
                        <div class="stat-label">Plateau Days</div>
                    </div>
                </div>
            </div>

            <div class="info-panel type-iil">
                <h2><span class="dot"></span>Type II-L Supernova</h2>
                <p>
                    Core collapse with partially stripped hydrogen envelope.
                    Shows linear decline after peak without plateau phase.
                    Less hydrogen than II-P but more than Ib/c types.
                </p>
                <div class="stats">
                    <div class="stat">
                        <div class="stat-value" style="color: #22c55e;">-17.5</div>
                        <div class="stat-label">Peak Mag</div>
                    </div>
                    <div class="stat">
                        <div class="stat-value" style="color: #22c55e;">~15</div>
                        <div class="stat-label">Days to Peak</div>
                    </div>
                </div>
            </div>

            <div class="info-panel type-ibc">
                <h2><span class="dot"></span>Type Ib/c Supernova</h2>
                <p>
                    Core collapse of massive stars that lost their outer layers.
                    No hydrogen lines (Ib has helium, Ic lacks both).
                    Associated with long gamma-ray bursts in some cases.
                </p>
                <div class="stats">
                    <div class="stat">
                        <div class="stat-value" style="color: #a855f7;">-17.5</div>
                        <div class="stat-label">Peak Mag</div>
                    </div>
                    <div class="stat">
                        <div class="stat-value" style="color: #a855f7;">~15</div>
                        <div class="stat-label">Days to Peak</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('chart');
        const ctx = canvas.getContext('2d');

        function resize() {
            const rect = canvas.parentElement.getBoundingClientRect();
            canvas.width = rect.width - 40;
            canvas.height = 400;
        }
        resize();
        window.addEventListener('resize', resize);

        // Light curve models (simplified)
        const lightCurves = {
            ia: {
                color: '#ef4444',
                name: 'Type Ia',
                visible: true,
                // Arnett model approximation
                generate: (days) => {
                    const tPeak = 20;
                    const tau1 = 15; // rise
                    const tau2 = 35; // decline
                    const peakMag = -19.3;

                    if (days < tPeak) {
                        return peakMag + 2.5 * Math.log10(1 - Math.exp(-days / tau1));
                    } else {
                        const t = days - tPeak;
                        // Cobalt-56 decay dominates
                        return peakMag + 0.026 * t + 0.5 * Math.sin(t * 0.02); // ~0.98 mag/100 days
                    }
                }
            },
            iip: {
                color: '#3b82f6',
                name: 'Type II-P',
                visible: true,
                generate: (days) => {
                    const peakMag = -17.0;
                    const plateauEnd = 100;

                    if (days < 10) {
                        // Rise to plateau
                        return peakMag + 1 - days * 0.1;
                    } else if (days < plateauEnd) {
                        // Plateau phase
                        return peakMag + (days - 10) * 0.005;
                    } else {
                        // Drop off plateau, then radioactive tail
                        const t = days - plateauEnd;
                        if (t < 20) {
                            return peakMag + 0.45 + t * 0.1; // steep drop
                        }
                        return peakMag + 2.45 + (t - 20) * 0.0098; // Co-56 decay
                    }
                }
            },
            iil: {
                color: '#22c55e',
                name: 'Type II-L',
                visible: true,
                generate: (days) => {
                    const peakMag = -17.5;
                    const tPeak = 15;

                    if (days < tPeak) {
                        return peakMag + 1.5 * (1 - days / tPeak);
                    } else {
                        // Linear decline
                        const t = days - tPeak;
                        return peakMag + t * 0.02;
                    }
                }
            },
            ibc: {
                color: '#a855f7',
                name: 'Type Ib/c',
                visible: true,
                generate: (days) => {
                    const peakMag = -17.5;
                    const tPeak = 15;
                    const tau = 12;

                    if (days < tPeak) {
                        return peakMag + 2 * Math.exp(-days / 5);
                    } else {
                        const t = days - tPeak;
                        // Faster initial decline, then radioactive tail
                        if (t < 30) {
                            return peakMag + t * 0.05;
                        }
                        return peakMag + 1.5 + (t - 30) * 0.015;
                    }
                }
            }
        };

        // State
        let currentDay = 0;
        let maxDay = 200;
        let playing = false;
        let speed = 5;
        let lastTime = 0;

        function drawChart() {
            ctx.fillStyle = '#0a0814';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            const padding = { left: 60, right: 20, top: 30, bottom: 50 };
            const chartWidth = canvas.width - padding.left - padding.right;
            const chartHeight = canvas.height - padding.top - padding.bottom;

            // Magnitude range (note: inverted - lower is brighter)
            const minMag = -20;
            const maxMag = -12;

            // Grid
            ctx.strokeStyle = 'rgba(255,255,255,0.1)';
            ctx.lineWidth = 1;

            // Horizontal grid lines (magnitude)
            for (let mag = minMag; mag <= maxMag; mag += 1) {
                const y = padding.top + ((mag - minMag) / (maxMag - minMag)) * chartHeight;
                ctx.beginPath();
                ctx.moveTo(padding.left, y);
                ctx.lineTo(canvas.width - padding.right, y);
                ctx.stroke();

                // Labels
                ctx.fillStyle = '#888';
                ctx.font = '12px Arial';
                ctx.textAlign = 'right';
                ctx.fillText(mag.toString(), padding.left - 10, y + 4);
            }

            // Vertical grid lines (days)
            for (let day = 0; day <= maxDay; day += 25) {
                const x = padding.left + (day / maxDay) * chartWidth;
                ctx.beginPath();
                ctx.moveTo(x, padding.top);
                ctx.lineTo(x, canvas.height - padding.bottom);
                ctx.stroke();

                // Labels
                ctx.fillStyle = '#888';
                ctx.font = '12px Arial';
                ctx.textAlign = 'center';
                ctx.fillText(day.toString(), x, canvas.height - padding.bottom + 20);
            }

            // Axis labels
            ctx.fillStyle = '#aaa';
            ctx.font = '14px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('Days Since Explosion', canvas.width / 2, canvas.height - 10);

            ctx.save();
            ctx.translate(15, canvas.height / 2);
            ctx.rotate(-Math.PI / 2);
            ctx.fillText('Absolute Magnitude', 0, 0);
            ctx.restore();

            // Draw light curves
            Object.entries(lightCurves).forEach(([key, curve]) => {
                if (!curve.visible) return;

                ctx.beginPath();
                ctx.strokeStyle = curve.color;
                ctx.lineWidth = 3;

                let started = false;
                for (let day = 0; day <= Math.min(currentDay, maxDay); day += 0.5) {
                    const mag = curve.generate(day);
                    if (mag < minMag || mag > maxMag) continue;

                    const x = padding.left + (day / maxDay) * chartWidth;
                    const y = padding.top + ((mag - minMag) / (maxMag - minMag)) * chartHeight;

                    if (!started) {
                        ctx.moveTo(x, y);
                        started = true;
                    } else {
                        ctx.lineTo(x, y);
                    }
                }
                ctx.stroke();

                // Draw current point
                if (currentDay > 0) {
                    const mag = curve.generate(currentDay);
                    if (mag >= minMag && mag <= maxMag) {
                        const x = padding.left + (currentDay / maxDay) * chartWidth;
                        const y = padding.top + ((mag - minMag) / (maxMag - minMag)) * chartHeight;

                        ctx.beginPath();
                        ctx.arc(x, y, 6, 0, Math.PI * 2);
                        ctx.fillStyle = curve.color;
                        ctx.fill();

                        // Glow
                        const gradient = ctx.createRadialGradient(x, y, 0, x, y, 20);
                        gradient.addColorStop(0, curve.color + '80');
                        gradient.addColorStop(1, 'transparent');
                        ctx.beginPath();
                        ctx.arc(x, y, 20, 0, Math.PI * 2);
                        ctx.fillStyle = gradient;
                        ctx.fill();
                    }
                }
            });

            // Current time indicator
            if (currentDay > 0 && currentDay <= maxDay) {
                const x = padding.left + (currentDay / maxDay) * chartWidth;
                ctx.beginPath();
                ctx.moveTo(x, padding.top);
                ctx.lineTo(x, canvas.height - padding.bottom);
                ctx.strokeStyle = 'rgba(251, 191, 36, 0.5)';
                ctx.lineWidth = 2;
                ctx.setLineDash([5, 5]);
                ctx.stroke();
                ctx.setLineDash([]);
            }
        }

        function animate(time) {
            if (playing) {
                const dt = (time - lastTime) / 1000;
                currentDay += dt * speed;

                if (currentDay > maxDay) {
                    currentDay = maxDay;
                    playing = false;
                    document.getElementById('playBtn').textContent = '▶ Play Animation';
                }

                document.getElementById('currentDay').textContent = Math.floor(currentDay);
            }
            lastTime = time;

            drawChart();
            requestAnimationFrame(animate);
        }

        // Event listeners
        document.querySelectorAll('.type-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                btn.classList.toggle('active');
                const type = btn.dataset.type;
                lightCurves[type].visible = btn.classList.contains('active');
            });
        });

        document.getElementById('playBtn').addEventListener('click', () => {
            playing = !playing;
            document.getElementById('playBtn').textContent = playing ? '⏸ Pause' : '▶ Play Animation';
        });

        document.getElementById('resetBtn').addEventListener('click', () => {
            currentDay = 0;
            playing = false;
            document.getElementById('playBtn').textContent = '▶ Play Animation';
            document.getElementById('currentDay').textContent = '0';
        });

        document.getElementById('speedSelect').addEventListener('change', (e) => {
            speed = parseInt(e.target.value);
        });

        requestAnimationFrame(animate);
    </script>
</body>
</html>
