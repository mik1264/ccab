<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pulsar Lighthouse Model - Rotating Magnetic Field - CCAB</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { background: #050510; min-height: 100vh; font-family: system-ui, sans-serif; color: #e8e8f8; overflow: hidden; display: flex; }
        .back-link { position: fixed; top: 15px; left: 15px; padding: 10px 18px; background: rgba(0,0,0,0.6); color: #818cf8; text-decoration: none; border-radius: 8px; font-size: 14px; z-index: 1000; }
        #canvas { flex: 1; }
        #panel { width: 340px; background: rgba(5,5,16,0.95); padding: 70px 20px 20px; border-left: 1px solid rgba(129,140,248,0.2); overflow-y: auto; }
        h1 { font-size: 1.3rem; margin-bottom: 10px; color: #818cf8; }
        h2 { font-size: 0.95rem; margin: 15px 0 10px; color: #818cf8; }
        .desc { font-size: 0.82rem; line-height: 1.6; color: #aaa; margin-bottom: 15px; }
        .stats-box { background: rgba(129,140,248,0.1); border: 1px solid rgba(129,140,248,0.2); border-radius: 8px; padding: 12px; margin: 15px 0; }
        .stat { display: flex; justify-content: space-between; font-size: 0.82rem; margin: 4px 0; }
        .stat-label { color: #888; }
        .stat-value { color: #818cf8; font-weight: bold; }
        .pulse-indicator { text-align: center; padding: 20px; background: rgba(0,0,0,0.3); border-radius: 8px; margin: 15px 0; }
        .pulse-dot { width: 30px; height: 30px; border-radius: 50%; background: #818cf8; margin: 0 auto; transition: all 0.1s; }
        .pulse-dot.active { background: #fff; box-shadow: 0 0 20px #818cf8, 0 0 40px #818cf8; }
        .controls { margin-top: 15px; }
        .control-group { margin-bottom: 12px; }
        .control-group label { display: flex; justify-content: space-between; font-size: 0.82rem; margin-bottom: 5px; color: #aaa; }
        input[type="range"] { width: 100%; accent-color: #818cf8; }
        .buttons { display: flex; gap: 10px; }
        button { flex: 1; background: rgba(129,140,248,0.2); border: 1px solid rgba(129,140,248,0.4); color: #818cf8; padding: 10px; border-radius: 8px; cursor: pointer; }
        button:hover { background: rgba(129,140,248,0.3); }
    </style>
</head>
<body>
    <a href="index.html" class="back-link">‚Üê Back to Gallery</a>
    <canvas id="canvas"></canvas>
    <div id="panel">
        <h1>Pulsar Lighthouse Model</h1>
        <p class="desc">Pulsars are rapidly rotating neutron stars with intense magnetic fields. Radio beams from the magnetic poles sweep across space like lighthouse beams.</p>
        <h2>Pulse Detection</h2>
        <div class="pulse-indicator">
            <div class="pulse-dot" id="pulse-dot"></div>
        </div>
        <div class="stats-box">
            <div class="stat"><span class="stat-label">Period:</span><span class="stat-value" id="period">1.0 s</span></div>
            <div class="stat"><span class="stat-label">Rotation Rate:</span><span class="stat-value" id="rate">1.0 Hz</span></div>
            <div class="stat"><span class="stat-label">Magnetic Field:</span><span class="stat-value" id="field">10¬π¬≤ G</span></div>
            <div class="stat"><span class="stat-label">Beam Angle:</span><span class="stat-value" id="angle">30¬∞</span></div>
            <div class="stat"><span class="stat-label">Obliquity:</span><span class="stat-value" id="obliquity">45¬∞</span></div>
        </div>
        <div class="controls">
            <div class="control-group">
                <label><span>Rotation Period (s)</span><span id="period-val">1.0</span></label>
                <input type="range" id="period-slider" min="0.033" max="3" value="1" step="0.001">
            </div>
            <div class="control-group">
                <label><span>Obliquity Angle</span><span id="obliquity-val">45¬∞</span></label>
                <input type="range" id="obliquity-slider" min="0" max="90" value="45" step="1">
            </div>
            <div class="control-group">
                <label><span>Beam Width</span><span id="beam-val">30¬∞</span></label>
                <input type="range" id="beam-slider" min="5" max="60" value="30" step="1">
            </div>
        </div>
        <div class="buttons">
            <button id="play">‚è∏ Pause</button>
            <button id="view">üîÑ Toggle View</button>
        </div>
    </div>
    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        let time = 0, playing = true, period = 1, obliquity = 45, beamWidth = 30;
        let view3D = true;
        function resize() {
            canvas.width = (window.innerWidth - 340) * devicePixelRatio;
            canvas.height = window.innerHeight * devicePixelRatio;
            ctx.scale(devicePixelRatio, devicePixelRatio);
        }
        function updateUI() {
            const phase = (time / period) % 1;
            const beamAngle = phase * Math.PI * 2;
            const beamVisible = Math.abs(Math.sin(beamAngle) * Math.sin(obliquity * Math.PI / 180)) < Math.sin(beamWidth * Math.PI / 360);
            document.getElementById('period').textContent = period.toFixed(3) + ' s';
            document.getElementById('rate').textContent = (1 / period).toFixed(1) + ' Hz';
            document.getElementById('field').textContent = '10¬π¬≤ G';
            document.getElementById('angle').textContent = beamWidth + '¬∞';
            document.getElementById('obliquity').textContent = obliquity + '¬∞';
            const pulseDot = document.getElementById('pulse-dot');
            if (beamVisible) {
                pulseDot.classList.add('active');
            } else {
                pulseDot.classList.remove('active');
            }
        }
        function render(timestamp) {
            const dt = 1 / 60;
            if (playing) time += dt;
            const w = canvas.width / devicePixelRatio;
            const h = canvas.height;
            const cx = w / 2, cy = h / 2;
            ctx.fillStyle = '#050510';
            ctx.fillRect(0, 0, w, h);
            for (let i = 0; i < 200; i++) {
                const x = (Math.sin(i * 1234) * 0.5 + 0.5) * w;
                const y = (Math.cos(i * 5678) * 0.5 + 0.5) * h;
                ctx.fillStyle = `rgba(255,255,255,${0.2 + Math.random() * 0.2})`;
                ctx.beginPath();
                ctx.arc(x, y, Math.random() + 0.5, 0, Math.PI * 2);
                ctx.fill();
            }
            const phase = (time / period) % 1;
            const rotAngle = phase * Math.PI * 2;
            const oblRad = obliquity * Math.PI / 180;
            const beamRad = beamWidth * Math.PI / 180;
            const nsRadius = 30;
            if (view3D) {
                // 3D view
                ctx.save();
                ctx.translate(cx, cy);
                // Rotation axis
                ctx.strokeStyle = 'rgba(129, 140, 248, 0.3)';
                ctx.setLineDash([5, 5]);
                ctx.beginPath();
                ctx.moveTo(0, -150);
                ctx.lineTo(0, 150);
                ctx.stroke();
                ctx.setLineDash([]);
                // Neutron star
                const nsGlow = ctx.createRadialGradient(0, 0, 0, 0, 0, nsRadius * 2);
                nsGlow.addColorStop(0, '#aabbff');
                nsGlow.addColorStop(0.5, '#6677ff44');
                nsGlow.addColorStop(1, 'transparent');
                ctx.fillStyle = nsGlow;
                ctx.beginPath();
                ctx.arc(0, 0, nsRadius * 2, 0, Math.PI * 2);
                ctx.fill();
                ctx.fillStyle = '#aabbff';
                ctx.beginPath();
                ctx.arc(0, 0, nsRadius, 0, Math.PI * 2);
                ctx.fill();
                // Magnetic axis (tilted)
                const magX = Math.sin(rotAngle) * Math.sin(oblRad);
                const magY = Math.cos(oblRad);
                const magZ = Math.cos(rotAngle) * Math.sin(oblRad);
                ctx.strokeStyle = '#ff6b6b';
                ctx.lineWidth = 2;
                ctx.beginPath();
                ctx.moveTo(-magX * 100, magY * 100);
                ctx.lineTo(magX * 100, -magY * 100);
                ctx.stroke();
                // Magnetic poles
                ctx.fillStyle = '#ff6b6b';
                ctx.beginPath();
                ctx.arc(magX * 40, -magY * 40, 5, 0, Math.PI * 2);
                ctx.fill();
                ctx.beginPath();
                ctx.arc(-magX * 40, magY * 40, 5, 0, Math.PI * 2);
                ctx.fill();
                // Radio beams
                const beamLength = 200;
                ctx.save();
                const gradient1 = ctx.createLinearGradient(magX * 40, -magY * 40, magX * beamLength, -magY * beamLength);
                gradient1.addColorStop(0, 'rgba(129, 140, 248, 0.8)');
                gradient1.addColorStop(1, 'transparent');
                ctx.fillStyle = gradient1;
                ctx.beginPath();
                ctx.moveTo(magX * 40, -magY * 40);
                const beamSpread = beamRad;
                ctx.lineTo(magX * beamLength + Math.cos(rotAngle + beamSpread) * 50, -magY * beamLength - 50);
                ctx.lineTo(magX * beamLength + Math.cos(rotAngle - beamSpread) * 50, -magY * beamLength + 50);
                ctx.closePath();
                ctx.fill();
                const gradient2 = ctx.createLinearGradient(-magX * 40, magY * 40, -magX * beamLength, magY * beamLength);
                gradient2.addColorStop(0, 'rgba(129, 140, 248, 0.8)');
                gradient2.addColorStop(1, 'transparent');
                ctx.fillStyle = gradient2;
                ctx.beginPath();
                ctx.moveTo(-magX * 40, magY * 40);
                ctx.lineTo(-magX * beamLength - Math.cos(rotAngle + beamSpread) * 50, magY * beamLength - 50);
                ctx.lineTo(-magX * beamLength - Math.cos(rotAngle - beamSpread) * 50, magY * beamLength + 50);
                ctx.closePath();
                ctx.fill();
                ctx.restore();
                // Observer line of sight indicator
                ctx.fillStyle = '#4ade80';
                ctx.font = '12px sans-serif';
                ctx.textAlign = 'left';
                ctx.fillText('‚Üê To Observer', 180, 0);
                ctx.restore();
            } else {
                // Side view with pulse signal
                ctx.save();
                ctx.translate(cx - 100, cy);
                // Neutron star
                ctx.fillStyle = '#aabbff';
                ctx.beginPath();
                ctx.arc(0, 0, nsRadius, 0, Math.PI * 2);
                ctx.fill();
                // Sweeping beam
                const beamAngle = rotAngle - Math.PI / 2;
                ctx.save();
                ctx.rotate(beamAngle);
                const beamGrad = ctx.createLinearGradient(0, 0, 150, 0);
                beamGrad.addColorStop(0, 'rgba(129, 140, 248, 0.8)');
                beamGrad.addColorStop(1, 'transparent');
                ctx.fillStyle = beamGrad;
                ctx.beginPath();
                ctx.moveTo(nsRadius, 0);
                ctx.lineTo(200, -20);
                ctx.lineTo(200, 20);
                ctx.closePath();
                ctx.fill();
                ctx.restore();
                ctx.restore();
                // Pulse signal graph
                const graphX = cx + 50;
                const graphY = cy;
                const graphW = 200;
                const graphH = 100;
                ctx.strokeStyle = '#333';
                ctx.beginPath();
                ctx.moveTo(graphX, graphY - graphH / 2);
                ctx.lineTo(graphX, graphY + graphH / 2);
                ctx.lineTo(graphX + graphW, graphY + graphH / 2);
                ctx.stroke();
                ctx.strokeStyle = '#818cf8';
                ctx.lineWidth = 2;
                ctx.beginPath();
                for (let i = 0; i < graphW; i++) {
                    const t = i / graphW * 3;
                    const pulsePhase = (t + time / period) % 1;
                    const pulseIntensity = Math.exp(-Math.pow((pulsePhase - 0.5) * 10, 2));
                    const y = graphY + graphH / 2 - pulseIntensity * graphH;
                    if (i === 0) ctx.moveTo(graphX + i, y);
                    else ctx.lineTo(graphX + i, y);
                }
                ctx.stroke();
                ctx.fillStyle = '#888';
                ctx.font = '11px sans-serif';
                ctx.textAlign = 'center';
                ctx.fillText('Detected Pulse Signal', graphX + graphW / 2, graphY + graphH / 2 + 20);
            }
            // Labels
            ctx.fillStyle = '#818cf8';
            ctx.font = '14px sans-serif';
            ctx.textAlign = 'center';
            ctx.fillText('Pulsar Lighthouse Model', cx, 40);
            ctx.fillStyle = '#888';
            ctx.font = '12px sans-serif';
            ctx.fillText(`Period: ${period.toFixed(3)}s | Rotation: ${(1/period).toFixed(1)} Hz`, cx, 60);
            updateUI();
            requestAnimationFrame(render);
        }
        document.getElementById('period-slider').addEventListener('input', (e) => {
            period = parseFloat(e.target.value);
            document.getElementById('period-val').textContent = period.toFixed(3);
        });
        document.getElementById('obliquity-slider').addEventListener('input', (e) => {
            obliquity = parseFloat(e.target.value);
            document.getElementById('obliquity-val').textContent = obliquity + '¬∞';
        });
        document.getElementById('beam-slider').addEventListener('input', (e) => {
            beamWidth = parseFloat(e.target.value);
            document.getElementById('beam-val').textContent = beamWidth + '¬∞';
        });
        document.getElementById('play').addEventListener('click', () => {
            playing = !playing;
            document.getElementById('play').textContent = playing ? '‚è∏ Pause' : '‚ñ∂ Play';
        });
        document.getElementById('view').addEventListener('click', () => {
            view3D = !view3D;
        });
        window.addEventListener('resize', resize);
        resize();
        requestAnimationFrame(render);
    </script>
    <script src="../assets/js/enhance.js" defer></script>
</body>
</html>
