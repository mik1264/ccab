<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Proton-Proton Chain - Solar Energy Production</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: linear-gradient(135deg, #0a0a1a 0%, #1a1a0a 50%, #0a1a1a 100%);
            min-height: 100vh;
            color: #e8e8f8;
        }
        .back-link {
            position: fixed;
            top: 20px; left: 20px;
            color: #ffcc44;
            text-decoration: none;
            font-size: 14px;
            z-index: 1000;
            padding: 8px 16px;
            background: rgba(0,0,0,0.5);
            border-radius: 20px;
        }
        .container { max-width: 1400px; margin: 0 auto; padding: 20px; }
        header { text-align: center; padding: 60px 20px 20px; }
        h1 {
            font-size: 2.2rem;
            margin-bottom: 10px;
            background: linear-gradient(90deg, #ffcc00, #ffff66, #ffffff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .subtitle { font-size: 1rem; opacity: 0.8; max-width: 700px; margin: 0 auto; }
        .main-grid { display: grid; grid-template-columns: 1fr 360px; gap: 20px; margin-top: 20px; }
        .visualization { background: rgba(0,0,0,0.4); border-radius: 16px; padding: 20px; }
        #canvas { width: 100%; border-radius: 12px; background: #050508; }
        .controls { background: rgba(0,0,0,0.4); border-radius: 16px; padding: 20px; }
        .panel { margin-bottom: 20px; padding-bottom: 20px; border-bottom: 1px solid rgba(255,255,255,0.1); }
        .panel:last-child { border-bottom: none; }
        .panel h3 { font-size: 0.9rem; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 12px; color: #ffcc44; }
        .step-indicator { padding: 15px; border-radius: 10px; background: rgba(255,200,100,0.2); margin-bottom: 15px; text-align: center; }
        .step-name { font-size: 1.1rem; font-weight: 600; color: #ffcc44; }
        .step-reaction { font-size: 1rem; margin-top: 8px; font-family: monospace; }
        .branches { display: grid; gap: 10px; }
        .branch-item {
            padding: 12px;
            border-radius: 8px;
            background: rgba(255,255,255,0.03);
            cursor: pointer;
            border: 2px solid transparent;
        }
        .branch-item:hover { background: rgba(255,255,255,0.08); }
        .branch-item.active { border-color: #ffcc44; background: rgba(255,200,100,0.15); }
        .branch-name { font-weight: 600; color: #ffcc44; }
        .branch-pct { font-size: 0.8rem; opacity: 0.7; }
        .btn-row { display: flex; gap: 10px; margin-top: 15px; }
        .btn { flex: 1; padding: 12px; border: none; border-radius: 8px; font-size: 0.9rem; font-weight: 600; cursor: pointer; }
        .btn-primary { background: #ffaa00; color: #000; }
        .btn-secondary { background: rgba(255,255,255,0.1); color: #e8e8f8; }
        .energy-box { background: rgba(255,200,0,0.15); border-radius: 8px; padding: 15px; text-align: center; margin-top: 15px; }
        .energy-value { font-size: 1.8rem; font-weight: 700; color: #ffcc00; }
        .info-box { background: rgba(255,200,100,0.1); border: 1px solid rgba(255,200,100,0.3); border-radius: 8px; padding: 12px; font-size: 0.82rem; line-height: 1.6; margin-top: 15px; }
        #info { position: fixed; bottom: 20px; left: 20px; background: rgba(0,0,0,0.7); padding: 12px 20px; border-radius: 8px; font-size: 0.85rem; }
        @media (max-width: 900px) { .main-grid { grid-template-columns: 1fr; } }
    </style>
</head>
<body>
    <a href="index.html" class="back-link">← Back to Gallery</a>
    <div class="container">
        <header>
            <h1>☀️ Proton-Proton Chain</h1>
            <p class="subtitle">
                The pp-chain powers 99% of the Sun's energy. Four protons fuse to form helium-4,
                releasing 26.7 MeV of energy through three possible branches.
            </p>
        </header>
        <div class="main-grid">
            <div class="visualization">
                <canvas id="canvas"></canvas>
            </div>
            <div class="controls">
                <div class="panel">
                    <div class="step-indicator">
                        <div class="step-name" id="step-name">Step 1: Proton Fusion</div>
                        <div class="step-reaction" id="step-reaction">p + p → d + e⁺ + νₑ</div>
                    </div>
                </div>
                <div class="panel">
                    <h3>PP Chain Branches</h3>
                    <div class="branches">
                        <div class="branch-item active" data-branch="1">
                            <div class="branch-name">PP-I Chain</div>
                            <div class="branch-pct">~83% in Sun • 26.2 MeV</div>
                        </div>
                        <div class="branch-item" data-branch="2">
                            <div class="branch-name">PP-II Chain</div>
                            <div class="branch-pct">~17% in Sun • via ⁷Be</div>
                        </div>
                        <div class="branch-item" data-branch="3">
                            <div class="branch-name">PP-III Chain</div>
                            <div class="branch-pct">~0.02% in Sun • via ⁸B</div>
                        </div>
                    </div>
                </div>
                <div class="btn-row">
                    <button class="btn btn-primary" id="play-btn">▶ Animate</button>
                    <button class="btn btn-secondary" id="reset-btn">↻ Reset</button>
                </div>
                <div class="energy-box">
                    <div>Energy per cycle:</div>
                    <div class="energy-value" id="energy">26.7 MeV</div>
                    <div style="font-size: 0.8rem; opacity: 0.7;">4p → ⁴He + 2e⁺ + 2νₑ</div>
                </div>
                <div class="info-box">
                    <strong>Solar Core:</strong> T ≈ 15 million K<br>
                    <strong>Rate:</strong> ~3.6×10³⁸ reactions/sec<br>
                    <strong>Power:</strong> 3.8×10²⁶ W (99% from pp-chain)<br><br>
                    The first step (p+p → d) is rate-limiting, taking ~10⁹ years on average!
                </div>
            </div>
        </div>
    </div>
    <div id="info">
        <span>Branch: <strong id="current-branch">PP-I</strong></span> |
        <span>Step: <strong id="current-step">1</strong></span> |
        <span><strong id="fps">0</strong> FPS</span>
    </div>
    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        function resize() {
            const container = canvas.parentElement;
            canvas.width = Math.min(container.clientWidth - 40, 800);
            canvas.height = canvas.width * 0.75;
        }
        resize();
        window.addEventListener('resize', resize);
        const branches = {
            1: [
                { name: 'Proton Fusion', reaction: 'p + p → d + e⁺ + νₑ', desc: 'Two protons fuse to deuterium' },
                { name: 'Deuterium Fusion', reaction: 'd + p → ³He + γ', desc: 'Deuterium captures a proton' },
                { name: 'Helium-3 Fusion', reaction: '³He + ³He → ⁴He + 2p', desc: 'Two He-3 form He-4 + 2 protons' }
            ],
            2: [
                { name: 'Proton Fusion', reaction: 'p + p → d + e⁺ + νₑ', desc: 'Two protons fuse to deuterium' },
                { name: 'Deuterium Fusion', reaction: 'd + p → ³He + γ', desc: 'Deuterium captures a proton' },
                { name: 'He-3 + He-4', reaction: '³He + ⁴He → ⁷Be + γ', desc: 'Forms Beryllium-7' },
                { name: 'Electron Capture', reaction: '⁷Be + e⁻ → ⁷Li + νₑ', desc: 'Beryllium captures electron' },
                { name: 'Lithium Burning', reaction: '⁷Li + p → 2⁴He', desc: 'Lithium burns to 2 Helium-4' }
            ],
            3: [
                { name: 'Proton Fusion', reaction: 'p + p → d + e⁺ + νₑ', desc: 'Two protons fuse to deuterium' },
                { name: 'Deuterium Fusion', reaction: 'd + p → ³He + γ', desc: 'Deuterium captures a proton' },
                { name: 'He-3 + He-4', reaction: '³He + ⁴He → ⁷Be + γ', desc: 'Forms Beryllium-7' },
                { name: 'Proton Capture', reaction: '⁷Be + p → ⁸B + γ', desc: 'Forms unstable Boron-8' },
                { name: 'Beta Decay', reaction: '⁸B → ⁸Be + e⁺ + νₑ', desc: 'B-8 decays to Be-8' },
                { name: 'Fission', reaction: '⁸Be → 2⁴He', desc: 'Be-8 splits to 2 Helium-4' }
            ]
        };
        let currentBranch = 1, currentStep = 0, animProgress = 0, playing = false;
        let lastTime = 0, frameCount = 0, fps = 0;
        const particles = { proton: '#ff4444', deuterium: '#ff8844', he3: '#44ff88', he4: '#ffff44', be7: '#aa88ff', li7: '#88aaff', b8: '#ff88aa', be8: '#cc88ff', electron: '#4488ff', positron: '#ffffff', neutrino: '#88ffff', gamma: '#ffff00' };
        function drawParticle(x, y, r, type, label) {
            const color = particles[type] || '#888';
            const grad = ctx.createRadialGradient(x - r * 0.3, y - r * 0.3, 0, x, y, r);
            grad.addColorStop(0, '#fff');
            grad.addColorStop(0.4, color);
            grad.addColorStop(1, color.replace(/[0-9a-f]{2}$/i, '88'));
            ctx.fillStyle = grad;
            ctx.beginPath();
            ctx.arc(x, y, r, 0, Math.PI * 2);
            ctx.fill();
            if (label) {
                ctx.fillStyle = '#fff';
                ctx.font = Math.max(10, r * 0.7) + 'px sans-serif';
                ctx.textAlign = 'center';
                ctx.fillText(label, x, y + r + 14);
            }
        }
        function draw() {
            ctx.fillStyle = '#050508';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            const cx = canvas.width / 2, cy = canvas.height / 2;
            const step = branches[currentBranch][currentStep];
            ctx.fillStyle = '#ffcc44';
            ctx.font = 'bold 16px sans-serif';
            ctx.textAlign = 'center';
            ctx.fillText('PP-' + ['I', 'II', 'III'][currentBranch - 1] + ' Chain', cx, 30);
            ctx.font = '13px sans-serif';
            ctx.fillStyle = '#888';
            ctx.fillText('Step ' + (currentStep + 1) + '/' + branches[currentBranch].length + ': ' + step.reaction, cx, 55);
            // Draw based on step
            const t = animProgress;
            if (currentStep === 0) { // p + p -> d
                const x1 = cx - 100 + t * 50, x2 = cx + 100 - t * 50;
                drawParticle(x1, cy, 25, 'proton', 'p');
                drawParticle(x2, cy, 25, 'proton', 'p');
                if (t > 0.6) {
                    const dt = (t - 0.6) / 0.4;
                    drawParticle(cx, cy, 30, 'deuterium', 'd');
                    drawParticle(cx + dt * 80, cy - dt * 60, 10, 'positron', 'e⁺');
                    drawParticle(cx + dt * 60, cy + dt * 70, 8, 'neutrino', 'νₑ');
                }
            } else if (currentStep === 1) { // d + p -> He3
                const x1 = cx - 80 + t * 40, x2 = cx + 80 - t * 40;
                drawParticle(x1, cy, 30, 'deuterium', 'd');
                drawParticle(x2, cy, 22, 'proton', 'p');
                if (t > 0.6) {
                    const dt = (t - 0.6) / 0.4;
                    drawParticle(cx, cy, 35, 'he3', '³He');
                    ctx.strokeStyle = '#ffff00';
                    ctx.lineWidth = 2;
                    for (let i = 0; i < 6; i++) {
                        const a = (i / 6) * Math.PI * 2;
                        const gx = cx + dt * 70, gy = cy - dt * 50;
                        ctx.beginPath();
                        ctx.moveTo(gx + Math.cos(a) * 5, gy + Math.sin(a) * 5);
                        ctx.lineTo(gx + Math.cos(a) * 12, gy + Math.sin(a) * 12);
                        ctx.stroke();
                    }
                }
            } else if (currentStep === 2 && currentBranch === 1) { // He3 + He3 -> He4 + 2p
                const x1 = cx - 100 + t * 50, x2 = cx + 100 - t * 50;
                drawParticle(x1, cy, 35, 'he3', '³He');
                drawParticle(x2, cy, 35, 'he3', '³He');
                if (t > 0.6) {
                    const dt = (t - 0.6) / 0.4;
                    drawParticle(cx, cy, 40, 'he4', '⁴He');
                    drawParticle(cx - 60 - dt * 40, cy - dt * 50, 20, 'proton', 'p');
                    drawParticle(cx + 60 + dt * 40, cy - dt * 50, 20, 'proton', 'p');
                }
            } else if (currentStep === 2) { // He3 + He4 -> Be7
                const x1 = cx - 80 + t * 40, x2 = cx + 80 - t * 40;
                drawParticle(x1, cy, 35, 'he3', '³He');
                drawParticle(x2, cy, 38, 'he4', '⁴He');
                if (t > 0.6) {
                    const dt = (t - 0.6) / 0.4;
                    drawParticle(cx, cy, 42, 'be7', '⁷Be');
                }
            } else if (currentStep === 3 && currentBranch === 2) { // Be7 + e -> Li7
                drawParticle(cx - 50 + t * 25, cy, 42, 'be7', '⁷Be');
                drawParticle(cx + 80 - t * 40, cy, 12, 'electron', 'e⁻');
                if (t > 0.6) {
                    const dt = (t - 0.6) / 0.4;
                    drawParticle(cx, cy, 40, 'li7', '⁷Li');
                    drawParticle(cx + dt * 70, cy - dt * 50, 8, 'neutrino', 'νₑ');
                }
            } else if (currentStep === 4 && currentBranch === 2) { // Li7 + p -> 2 He4
                drawParticle(cx - 60 + t * 30, cy, 40, 'li7', '⁷Li');
                drawParticle(cx + 80 - t * 40, cy, 22, 'proton', 'p');
                if (t > 0.6) {
                    const dt = (t - 0.6) / 0.4;
                    drawParticle(cx - 50 - dt * 30, cy, 35, 'he4', '⁴He');
                    drawParticle(cx + 50 + dt * 30, cy, 35, 'he4', '⁴He');
                }
            } else if (currentStep === 3 && currentBranch === 3) { // Be7 + p -> B8
                drawParticle(cx - 60 + t * 30, cy, 42, 'be7', '⁷Be');
                drawParticle(cx + 80 - t * 40, cy, 22, 'proton', 'p');
                if (t > 0.6) {
                    const dt = (t - 0.6) / 0.4;
                    drawParticle(cx, cy, 44, 'b8', '⁸B');
                }
            } else if (currentStep === 4 && currentBranch === 3) { // B8 -> Be8 + e+ + nu
                drawParticle(cx, cy, 44, 'b8', '⁸B');
                if (t > 0.4) {
                    const dt = (t - 0.4) / 0.6;
                    drawParticle(cx, cy, 42, 'be8', '⁸Be');
                    drawParticle(cx + dt * 80, cy - dt * 50, 10, 'positron', 'e⁺');
                    drawParticle(cx + dt * 60, cy + dt * 60, 8, 'neutrino', 'νₑ');
                }
            } else if (currentStep === 5 && currentBranch === 3) { // Be8 -> 2 He4
                drawParticle(cx, cy, 42, 'be8', '⁸Be');
                if (t > 0.4) {
                    const dt = (t - 0.4) / 0.6;
                    drawParticle(cx - 50 - dt * 40, cy, 35, 'he4', '⁴He');
                    drawParticle(cx + 50 + dt * 40, cy, 35, 'he4', '⁴He');
                }
            }
            // Arrow
            ctx.fillStyle = '#555';
            ctx.font = '24px sans-serif';
            ctx.fillText('→', cx, cy + 80);
        }
        function updateUI() {
            const step = branches[currentBranch][currentStep];
            document.getElementById('step-name').textContent = 'Step ' + (currentStep + 1) + ': ' + step.name;
            document.getElementById('step-reaction').textContent = step.reaction;
            document.getElementById('current-branch').textContent = 'PP-' + ['I', 'II', 'III'][currentBranch - 1];
            document.getElementById('current-step').textContent = (currentStep + 1) + '/' + branches[currentBranch].length;
            document.querySelectorAll('.branch-item').forEach((el, i) => {
                el.classList.toggle('active', i + 1 === currentBranch);
            });
        }
        function animate(t) {
            if (playing) {
                animProgress += 0.01;
                if (animProgress >= 1) {
                    animProgress = 0;
                    currentStep = (currentStep + 1) % branches[currentBranch].length;
                    updateUI();
                }
            }
            draw();
            frameCount++;
            if (t - lastTime >= 1000) {
                fps = frameCount;
                frameCount = 0;
                lastTime = t;
                document.getElementById('fps').textContent = fps;
            }
            requestAnimationFrame(animate);
        }
        document.querySelectorAll('.branch-item').forEach(el => {
            el.addEventListener('click', () => {
                currentBranch = parseInt(el.dataset.branch);
                currentStep = 0;
                animProgress = 0;
                updateUI();
            });
        });
        document.getElementById('play-btn').addEventListener('click', function() {
            playing = !playing;
            this.textContent = playing ? '⏸ Pause' : '▶ Animate';
        });
        document.getElementById('reset-btn').addEventListener('click', function() {
            currentStep = 0;
            animProgress = 0;
            playing = false;
            document.getElementById('play-btn').textContent = '▶ Animate';
            updateUI();
        });
        updateUI();
        requestAnimationFrame(animate);
    </script>
</body>
</html>
