<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tree Varieties - Autumn Leaf Visualizations</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            background: linear-gradient(180deg, #87CEEB 0%, #DEB887 100%);
            font-family: 'Arial', sans-serif;
        }
        canvas {
            display: block;
        }
        .info-panel {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.95);
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            max-width: 250px;
        }
        h3 {
            margin-top: 0;
            color: #2a5298;
        }
        .tree-type {
            margin: 15px 0;
            padding: 10px;
            border-radius: 5px;
            background: #f0f0f0;
        }
        .tree-type h4 {
            margin: 0 0 8px 0;
            color: #333;
        }
        .tree-type p {
            margin: 5px 0;
            font-size: 13px;
            color: #666;
        }
        .color-sample {
            display: inline-block;
            width: 20px;
            height: 20px;
            border-radius: 3px;
            margin: 0 3px;
            border: 1px solid #333;
        }
    </style>
</head>
<body>
<!--
# Goal
Show different tree species side by side, each with characteristic autumn colors:
Maple (bright reds), Oak (browns/oranges), Birch (yellows), Ash (purples).

# Approach
- Display 4 different trees representing different species
- Each species has unique: sugar levels, pigment ratios, temperature sensitivity
- Maple: high sugar ‚Üí vibrant reds (anthocyanin-heavy)
- Oak: moderate pigments ‚Üí browns and oranges
- Birch: high carotene ‚Üí bright yellows and golds
- Ash: unique chemistry ‚Üí purples and burgundy
- Side-by-side comparison under same environmental conditions

# Technical Implementation
- Canvas 2D with multiple tree instances
- Tree class with species-specific chemistry parameters
- Shared environmental conditions
- Species-specific color calculation algorithms
- Educational labels for each species
-->

<canvas id="canvas"></canvas>
<div class="info-panel">
    <h3>Tree Species Comparison</h3>

    <div class="tree-type" style="background: #ffebee;">
        <h4>üçÅ Maple</h4>
        <p>High sugar content</p>
        <p>Colors:
            <span class="color-sample" style="background: #DC143C;"></span>
            <span class="color-sample" style="background: #8B0000;"></span>
            Brilliant reds
        </p>
    </div>

    <div class="tree-type" style="background: #fff3e0;">
        <h4>üå≥ Oak</h4>
        <p>Moderate pigments</p>
        <p>Colors:
            <span class="color-sample" style="background: #D2691E;"></span>
            <span class="color-sample" style="background: #8B4513;"></span>
            Browns & oranges
        </p>
    </div>

    <div class="tree-type" style="background: #fffde7;">
        <h4>üå≤ Birch</h4>
        <p>High carotene</p>
        <p>Colors:
            <span class="color-sample" style="background: #FFD700;"></span>
            <span class="color-sample" style="background: #DAA520;"></span>
            Bright yellows
        </p>
    </div>

    <div class="tree-type" style="background: #f3e5f5;">
        <h4>üçÉ Ash</h4>
        <p>Unique chemistry</p>
        <p>Colors:
            <span class="color-sample" style="background: #9370DB;"></span>
            <span class="color-sample" style="background: #800020;"></span>
            Purples
        </p>
    </div>
</div>

<script>
const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d');

canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

// Environmental conditions (shared by all trees)
const environment = {
    temperature: 8,
    sunIntensity: 50,
    dayOfAutumn: 0
};

class SpeciesLeaf {
    constructor(x, y, species) {
        this.x = x;
        this.y = y;
        this.size = 5 + Math.random() * 3;
        this.species = species;

        // Species-specific initial chemistry
        switch (species) {
            case 'maple':
                this.sugar = 70 + Math.random() * 30; // Very high
                this.chlorophyll = 40 + Math.random() * 30;
                this.carotene = 40 + Math.random() * 20;
                this.anthocyanin = 0;
                this.tempSensitivity = 1.5; // Very sensitive to cold
                break;

            case 'oak':
                this.sugar = 30 + Math.random() * 20;
                this.chlorophyll = 50 + Math.random() * 30;
                this.carotene = 50 + Math.random() * 30;
                this.anthocyanin = 0;
                this.tempSensitivity = 0.8;
                this.tannins = 50; // Browns
                break;

            case 'birch':
                this.sugar = 20 + Math.random() * 15;
                this.chlorophyll = 60 + Math.random() * 20;
                this.carotene = 80 + Math.random() * 20; // Very high
                this.anthocyanin = 0;
                this.tempSensitivity = 1.0;
                break;

            case 'ash':
                this.sugar = 40 + Math.random() * 25;
                this.chlorophyll = 45 + Math.random() * 25;
                this.carotene = 30 + Math.random() * 20;
                this.anthocyanin = 0;
                this.tempSensitivity = 1.2;
                this.purpleCompound = 40; // Unique to ash
                break;
        }

        this.water = 70 + Math.random() * 20;
    }

    update(temp, sunIntensity, days) {
        // Chlorophyll degradation (species-specific sensitivity)
        if (temp < 15) {
            this.chlorophyll -= (15 - temp) * 0.1 * this.tempSensitivity;
        }

        // Anthocyanin production (cold + sugar)
        if (temp < 12 && this.sugar > 10 && this.water > 10) {
            const production = this.sugar * 0.03 * this.tempSensitivity;
            this.anthocyanin += production;
            this.sugar -= production * 0.5;
        }

        // Progressive change over days
        this.chlorophyll -= days * 0.02;

        // Clamp
        this.chlorophyll = Math.max(0, Math.min(100, this.chlorophyll));
        this.anthocyanin = Math.max(0, Math.min(100, this.anthocyanin));
    }

    getColor() {
        const chloroRatio = this.chlorophyll / 100;
        const caroteRatio = this.carotene / 100;
        const anthocRatio = this.anthocyanin / 100;

        if (chloroRatio > 0.5) {
            // Still green
            const intensity = 50 + chloroRatio * 150;
            return `rgb(${intensity * 0.3}, ${intensity}, ${intensity * 0.3})`;
        }

        let r, g, b;

        switch (this.species) {
            case 'maple':
                // Maple: brilliant reds from high anthocyanin
                if (anthocRatio > 0.3) {
                    r = 180 + anthocRatio * 75;
                    g = 20 + (1 - anthocRatio) * 80;
                    b = 20 + (1 - anthocRatio) * 40;
                } else {
                    // Yellow-orange transition
                    r = 200 + caroteRatio * 55;
                    g = 140 + caroteRatio * 100;
                    b = 20;
                }
                break;

            case 'oak':
                // Oak: browns and russets (tannins)
                const tanninRatio = this.tannins / 100;
                r = 139 + caroteRatio * 80;
                g = 69 + caroteRatio * 100 + tanninRatio * 50;
                b = 19 + tanninRatio * 40;
                break;

            case 'birch':
                // Birch: bright yellows and golds
                r = 200 + caroteRatio * 55;
                g = 180 + caroteRatio * 75;
                b = 20 + caroteRatio * 20;
                break;

            case 'ash':
                // Ash: purples and burgundy
                const purpleRatio = this.purpleCompound / 100;
                if (anthocRatio > 0.2 || purpleRatio > 0.4) {
                    r = 128 + anthocRatio * 80;
                    g = 40 + (1 - purpleRatio) * 80;
                    b = 128 + purpleRatio * 75;
                } else {
                    r = 200 + caroteRatio * 40;
                    g = 150 + caroteRatio * 60;
                    b = 80 + purpleRatio * 100;
                }
                break;
        }

        return `rgb(${Math.floor(r)}, ${Math.floor(g)}, ${Math.floor(b)})`;
    }

    draw() {
        ctx.fillStyle = this.getColor();
        ctx.beginPath();
        ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
        ctx.fill();

        ctx.strokeStyle = 'rgba(0, 0, 0, 0.2)';
        ctx.lineWidth = 1;
        ctx.stroke();
    }
}

// Create four trees
const trees = [];
const species = ['maple', 'oak', 'birch', 'ash'];
const treePositions = [
    canvas.width * 0.2,
    canvas.width * 0.4,
    canvas.width * 0.6,
    canvas.width * 0.8
];

species.forEach((spec, index) => {
    const tree = {
        species: spec,
        x: treePositions[index],
        y: canvas.height - 80,
        leaves: [],
        branches: []
    };

    // Simple branching structure
    function createBranches(x, y, angle, length, depth) {
        if (depth > 6) return;

        const endX = x + Math.cos(angle) * length;
        const endY = y + Math.sin(angle) * length;

        tree.branches.push({ x1: x, y1: y, x2: endX, y2: endY, depth });

        // Add leaves
        if (depth > 3) {
            for (let i = 0; i < 2; i++) {
                tree.leaves.push(new SpeciesLeaf(
                    endX + (Math.random() - 0.5) * 10,
                    endY + (Math.random() - 0.5) * 10,
                    spec
                ));
            }
        }

        // Branch
        if (depth < 6) {
            const newLength = length * (0.65 + Math.random() * 0.1);
            createBranches(endX, endY, angle - Math.PI / 6, newLength, depth + 1);
            createBranches(endX, endY, angle + Math.PI / 6, newLength, depth + 1);
        }
    }

    createBranches(tree.x, tree.y, -Math.PI / 2, 80, 0);
    trees.push(tree);
});

// Animation
function animate() {
    // Background
    const gradient = ctx.createLinearGradient(0, 0, 0, canvas.height);
    gradient.addColorStop(0, '#87CEEB');
    gradient.addColorStop(1, '#DEB887');
    ctx.fillStyle = gradient;
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    // Ground
    ctx.fillStyle = '#8B7355';
    ctx.fillRect(0, canvas.height - 80, canvas.width, 80);

    // Slowly progress autumn
    environment.dayOfAutumn += 0.01;

    // Draw trees
    trees.forEach((tree, index) => {
        // Branches
        ctx.strokeStyle = '#3e2723';
        ctx.lineCap = 'round';
        tree.branches.forEach(branch => {
            ctx.lineWidth = Math.max(1, 8 - branch.depth);
            ctx.beginPath();
            ctx.moveTo(branch.x1, branch.y1);
            ctx.lineTo(branch.x2, branch.y2);
            ctx.stroke();
        });

        // Leaves
        tree.leaves.forEach(leaf => {
            leaf.update(environment.temperature, environment.sunIntensity, environment.dayOfAutumn);
            leaf.draw();
        });

        // Labels
        ctx.fillStyle = 'rgba(0, 0, 0, 0.8)';
        ctx.font = 'bold 18px Arial';
        ctx.textAlign = 'center';
        const labels = ['Maple', 'Oak', 'Birch', 'Ash'];
        ctx.fillText(labels[index], tree.x, canvas.height - 50);
    });

    // Environmental info
    ctx.fillStyle = 'rgba(0, 0, 0, 0.7)';
    ctx.font = '16px Arial';
    ctx.textAlign = 'left';
    ctx.fillText(`Temperature: ${environment.temperature}¬∞C`, 20, canvas.height - 30);
    ctx.fillText(`Day ${Math.floor(environment.dayOfAutumn)} of Autumn`, 20, canvas.height - 10);

    requestAnimationFrame(animate);
}

animate();

window.addEventListener('resize', () => {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
});
</script>
    <script src="../assets/js/enhance.js" defer></script>
</body>
</html>
