<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lucky Numbers vs Primes - Ulam Spiral</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { background: #0a0a0f; overflow: hidden; font-family: system-ui; }
        canvas { display: block; }
        .back-link {
            position: fixed; top: 20px; left: 20px; z-index: 100;
            color: #8A9A5B; text-decoration: none;
            background: rgba(0,0,0,0.7); padding: 10px 20px; border-radius: 25px;
            font-size: 14px; transition: all 0.3s;
        }
        .back-link:hover { background: rgba(138,154,91,0.3); }
        .legend {
            position: fixed; bottom: 20px; right: 20px; z-index: 100;
            background: rgba(0,0,0,0.85); padding: 20px; border-radius: 15px;
            color: white; font-size: 14px;
        }
        .legend h3 { color: #DDA15E; margin-bottom: 12px; }
        .legend-item { display: flex; align-items: center; margin: 8px 0; }
        .legend-color { width: 20px; height: 20px; border-radius: 50%; margin-right: 10px; }
        .info {
            position: fixed; bottom: 20px; left: 20px; z-index: 100;
            background: rgba(0,0,0,0.85); padding: 20px; border-radius: 15px;
            color: white; font-size: 13px; max-width: 350px;
        }
        .info h3 { color: #DDA15E; margin-bottom: 10px; }
        .stats {
            position: fixed; top: 20px; right: 20px; z-index: 100;
            background: rgba(0,0,0,0.8); padding: 15px 20px; border-radius: 10px;
            color: white; font-size: 14px;
        }
        .stats div { margin: 5px 0; }
    </style>
</head>
<body>
    <a href="index.html" class="back-link">‚Üê Back to Gallery</a>
    <div class="stats">
        <div>Primes: <span style="color:#FFD764" id="primeCount">0</span></div>
        <div>Lucky: <span style="color:#00ffaa" id="luckyCount">0</span></div>
        <div>Both: <span style="color:#ff6bff" id="bothCount">0</span></div>
    </div>
    <div class="info">
        <h3>Lucky Numbers</h3>
        <p>Lucky numbers are generated by a sieve similar to Eratosthenes: start with odds, remove every 3rd, then every 7th of what remains, etc. Surprisingly, they share many properties with primes!</p>
    </div>
    <div class="legend">
        <h3>Number Types</h3>
        <div class="legend-item">
            <div class="legend-color" style="background: linear-gradient(45deg, #FFD764, #ff6bff);"></div>
            <span>Both Prime & Lucky</span>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: #FFD764;"></div>
            <span>Prime Only</span>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: #00ffaa;"></div>
            <span>Lucky Only</span>
        </div>
    </div>
    <canvas id="canvas"></canvas>
    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');

        const gridSize = 151;
        const maxN = gridSize * gridSize;
        let cellSize;

        // Generate primes
        const isPrimeArr = new Array(maxN + 1).fill(true);
        isPrimeArr[0] = isPrimeArr[1] = false;
        for (let i = 2; i * i <= maxN; i++) {
            if (isPrimeArr[i]) {
                for (let j = i * i; j <= maxN; j += i) {
                    isPrimeArr[j] = false;
                }
            }
        }

        // Generate lucky numbers using sieve
        function generateLuckyNumbers(max) {
            // Start with odd numbers
            let sequence = [];
            for (let i = 1; i <= max; i += 2) {
                sequence.push(i);
            }

            let sieveIndex = 1; // Start with second element (3)

            while (sieveIndex < sequence.length) {
                const step = sequence[sieveIndex];
                if (step > sequence.length) break;

                // Remove every step-th element
                const newSequence = [];
                for (let i = 0; i < sequence.length; i++) {
                    if ((i + 1) % step !== 0) {
                        newSequence.push(sequence[i]);
                    }
                }
                sequence = newSequence;
                sieveIndex++;
            }

            return new Set(sequence);
        }

        const luckyNumbers = generateLuckyNumbers(maxN);

        function getSpiralCoord(n) {
            if (n === 1) return { x: 0, y: 0 };
            let layer = Math.ceil((Math.sqrt(n) - 1) / 2);
            let leg = Math.floor((n - (2 * layer - 1) ** 2) / (2 * layer));
            let element = (n - (2 * layer - 1) ** 2) % (2 * layer);
            let x, y;
            switch (leg) {
                case 0: x = layer; y = -layer + 1 + element; break;
                case 1: x = layer - 1 - element; y = layer; break;
                case 2: x = -layer; y = layer - 1 - element; break;
                case 3: x = -layer + 1 + element; y = -layer; break;
            }
            return { x, y };
        }

        function resize() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            cellSize = Math.min(canvas.width, canvas.height) / gridSize;
            draw();
        }

        function draw() {
            const offsetX = canvas.width / 2;
            const offsetY = canvas.height / 2;

            ctx.fillStyle = '#0a0a0f';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            let primeCount = 0;
            let luckyCount = 0;
            let bothCount = 0;

            for (let n = 1; n <= maxN; n++) {
                const { x, y } = getSpiralCoord(n);
                const px = offsetX + x * cellSize;
                const py = offsetY + y * cellSize;

                if (px < -cellSize * 2 || px > canvas.width + cellSize * 2 ||
                    py < -cellSize * 2 || py > canvas.height + cellSize * 2) continue;

                const isPrime = isPrimeArr[n];
                const isLucky = luckyNumbers.has(n);

                if (isPrime) primeCount++;
                if (isLucky) luckyCount++;

                if (isPrime && isLucky) {
                    bothCount++;
                    // Both - special gradient
                    const gradient = ctx.createRadialGradient(px, py, 0, px, py, cellSize * 0.8);
                    gradient.addColorStop(0, '#ff6bff');
                    gradient.addColorStop(0.5, 'rgba(255, 107, 255, 0.4)');
                    gradient.addColorStop(1, 'transparent');
                    ctx.fillStyle = gradient;
                    ctx.beginPath();
                    ctx.arc(px, py, cellSize * 0.8, 0, Math.PI * 2);
                    ctx.fill();

                    ctx.fillStyle = '#ff6bff';
                    ctx.beginPath();
                    ctx.arc(px, py, cellSize * 0.4, 0, Math.PI * 2);
                    ctx.fill();
                } else if (isPrime) {
                    // Prime only - gold
                    ctx.fillStyle = '#FFD764';
                    ctx.beginPath();
                    ctx.arc(px, py, cellSize * 0.35, 0, Math.PI * 2);
                    ctx.fill();
                } else if (isLucky) {
                    // Lucky only - teal
                    ctx.fillStyle = '#00ffaa';
                    ctx.beginPath();
                    ctx.arc(px, py, cellSize * 0.35, 0, Math.PI * 2);
                    ctx.fill();
                } else if (cellSize > 2) {
                    ctx.fillStyle = 'rgba(50, 50, 60, 0.25)';
                    ctx.beginPath();
                    ctx.arc(px, py, cellSize * 0.1, 0, Math.PI * 2);
                    ctx.fill();
                }
            }

            // Center
            ctx.fillStyle = '#BC6C25';
            ctx.beginPath();
            ctx.arc(offsetX, offsetY, cellSize * 0.5, 0, Math.PI * 2);
            ctx.fill();

            document.getElementById('primeCount').textContent = primeCount;
            document.getElementById('luckyCount').textContent = luckyCount;
            document.getElementById('bothCount').textContent = bothCount;
        }

        window.addEventListener('resize', resize);
        resize();
    </script>
</body>
</html>
