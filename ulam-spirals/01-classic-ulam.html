<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Classic Ulam Spiral - Prime Number Visualization</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { background: #0a0a0f; overflow: hidden; font-family: system-ui; }
        canvas { display: block; }
        .back-link {
            position: fixed; top: 20px; left: 20px; z-index: 100;
            color: #8A9A5B; text-decoration: none;
            background: rgba(0,0,0,0.7); padding: 10px 20px; border-radius: 25px;
            font-size: 14px; transition: all 0.3s;
        }
        .back-link:hover { background: rgba(138,154,91,0.3); }
        .info {
            position: fixed; bottom: 20px; left: 20px; z-index: 100;
            color: rgba(255,255,255,0.7); font-size: 14px;
            background: rgba(0,0,0,0.7); padding: 15px 20px; border-radius: 10px;
            max-width: 300px;
        }
        .info h3 { color: #DDA15E; margin-bottom: 8px; }
        .controls {
            position: fixed; top: 20px; right: 20px; z-index: 100;
            background: rgba(0,0,0,0.7); padding: 15px; border-radius: 10px;
        }
        .controls label { color: white; display: block; margin-bottom: 10px; font-size: 14px; }
        .controls input[type="range"] { width: 150px; }
    </style>
</head>
<body>
    <a href="index.html" class="back-link">‚Üê Back to Gallery</a>
    <div class="controls">
        <label>Grid Size: <span id="sizeVal">201</span>
            <input type="range" id="gridSize" min="51" max="401" step="50" value="201">
        </label>
    </div>
    <div class="info">
        <h3>Ulam Spiral</h3>
        <p>Discovered by Stanislaw Ulam in 1963. Numbers spiral outward from center; primes (yellow) form mysterious diagonal patterns.</p>
    </div>
    <canvas id="canvas"></canvas>
    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');

        let gridSize = 201;
        let cellSize;

        function resize() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            cellSize = Math.min(canvas.width, canvas.height) / gridSize;
            draw();
        }

        function isPrime(n) {
            if (n < 2) return false;
            if (n === 2) return true;
            if (n % 2 === 0) return false;
            for (let i = 3; i * i <= n; i += 2) {
                if (n % i === 0) return false;
            }
            return true;
        }

        function getSpiralCoord(n) {
            if (n === 1) return { x: 0, y: 0 };

            let layer = Math.ceil((Math.sqrt(n) - 1) / 2);
            let leg = Math.floor((n - (2 * layer - 1) ** 2) / (2 * layer));
            let element = (n - (2 * layer - 1) ** 2) % (2 * layer);

            let x, y;
            switch (leg) {
                case 0: x = layer; y = -layer + 1 + element; break;
                case 1: x = layer - 1 - element; y = layer; break;
                case 2: x = -layer; y = layer - 1 - element; break;
                case 3: x = -layer + 1 + element; y = -layer; break;
            }
            return { x, y };
        }

        function draw() {
            const offsetX = canvas.width / 2;
            const offsetY = canvas.height / 2;

            ctx.fillStyle = '#0a0a0f';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            const maxN = gridSize * gridSize;

            for (let n = 1; n <= maxN; n++) {
                const { x, y } = getSpiralCoord(n);
                const px = offsetX + x * cellSize;
                const py = offsetY + y * cellSize;

                if (px < -cellSize || px > canvas.width + cellSize ||
                    py < -cellSize || py > canvas.height + cellSize) continue;

                if (isPrime(n)) {
                    const brightness = 0.5 + 0.5 * (1 - n / maxN);
                    ctx.fillStyle = `rgba(255, 215, 100, ${brightness})`;
                    ctx.beginPath();
                    ctx.arc(px, py, cellSize * 0.4, 0, Math.PI * 2);
                    ctx.fill();
                } else if (cellSize > 3) {
                    ctx.fillStyle = 'rgba(50, 50, 60, 0.5)';
                    ctx.fillRect(px - cellSize * 0.3, py - cellSize * 0.3, cellSize * 0.6, cellSize * 0.6);
                }
            }

            // Draw center marker
            ctx.fillStyle = '#BC6C25';
            ctx.beginPath();
            ctx.arc(offsetX, offsetY, cellSize * 0.6, 0, Math.PI * 2);
            ctx.fill();
        }

        document.getElementById('gridSize').addEventListener('input', (e) => {
            gridSize = parseInt(e.target.value);
            document.getElementById('sizeVal').textContent = gridSize;
            cellSize = Math.min(canvas.width, canvas.height) / gridSize;
            draw();
        });

        window.addEventListener('resize', resize);
        resize();
    </script>
</body>
</html>
