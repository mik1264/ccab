<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Parameter Playground</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            background: #000;
            font-family: monospace;
        }
        canvas {
            display: block;
        }
        #controls {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(0,0,0,0.9);
            padding: 20px;
            border-radius: 10px;
            color: white;
            width: 280px;
            max-height: 90vh;
            overflow-y: auto;
        }
        h3 {
            margin: 0 0 15px 0;
            color: #667eea;
            border-bottom: 2px solid #667eea;
            padding-bottom: 8px;
        }
        .control-group {
            margin-bottom: 20px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-size: 12px;
            color: #aaa;
        }
        input[type="range"] {
            width: 100%;
            margin-bottom: 5px;
        }
        .value {
            color: #667eea;
            font-weight: bold;
        }
        button {
            width: 100%;
            padding: 10px;
            margin: 5px 0;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-family: monospace;
        }
        button:hover {
            background: #764ba2;
        }
        .preset-btn {
            background: #444;
            padding: 8px;
            margin: 3px 0;
        }
        .preset-btn:hover {
            background: #666;
        }
        .stats {
            background: rgba(102, 126, 234, 0.2);
            padding: 10px;
            border-radius: 5px;
            margin-top: 15px;
            font-size: 11px;
        }
    </style>
</head>
<body>
    <canvas id="canvas"></canvas>
    <div id="controls">
        <h3>‚öôÔ∏è Parameter Playground</h3>

        <div class="control-group">
            <label>Population: <span class="value" id="popValue">100</span></label>
            <input type="range" id="population" min="20" max="300" value="100">
        </div>

        <div class="control-group">
            <label>Speed: <span class="value" id="speedValue">1.5</span></label>
            <input type="range" id="speed" min="0.5" max="5" step="0.1" value="1.5">
        </div>

        <div class="control-group">
            <label>Near Radius: <span class="value" id="nearValue">30</span></label>
            <input type="range" id="nearRadius" min="10" max="80" value="30">
        </div>

        <div class="control-group">
            <label>Far Radius: <span class="value" id="farValue">60</span></label>
            <input type="range" id="farRadius" min="20" max="150" value="60">
        </div>

        <div class="control-group">
            <label>Waver: <span class="value" id="waverValue">15</span></label>
            <input type="range" id="waver" min="0" max="45" value="15">
        </div>

        <div class="control-group">
            <label>Trail Fade: <span class="value" id="fadeValue">0.1</span></label>
            <input type="range" id="fade" min="0.01" max="0.5" step="0.01" value="0.1">
        </div>

        <div class="control-group">
            <label>Glow Intensity: <span class="value" id="glowValue">15</span></label>
            <input type="range" id="glow" min="0" max="40" value="15">
        </div>

        <h3>üìã Presets</h3>
        <button class="preset-btn" onclick="loadPreset('chaotic')">Chaotic Swarm</button>
        <button class="preset-btn" onclick="loadPreset('flowing')">Flowing Streams</button>
        <button class="preset-btn" onclick="loadPreset('tight')">Tight Chains</button>
        <button class="preset-btn" onclick="loadPreset('slow')">Slow Dance</button>
        <button class="preset-btn" onclick="loadPreset('explosive')">Explosive</button>

        <button onclick="reset()">üîÑ Reset</button>
        <button onclick="breakAll()">üí• Break All Chains</button>

        <div class="stats">
            <div>Chains: <span class="value" id="chainCount">0</span></div>
            <div>Longest: <span class="value" id="longest">0</span></div>
            <div>Attached: <span class="value" id="attached">0</span></div>
        </div>
    </div>

    <script>
        /*
# Goal
Create ultimate interactive parameter exploration tool allowing real-time manipulation
of all follower system variables with preset configurations for different behaviors.

# Approach
- Comprehensive parameter controls for all aspects
- Real-time updates without restart
- Preset configurations for interesting behaviors
- Dynamic population adjustment
- Visual parameter feedback

# Key Features
- 7 controllable parameters
- 5 behavior presets
- Real-time statistics
- Dynamic agent creation/destruction
- Chain breaking functionality

# Innovation
- Enables user discovery of emergent behaviors
- Educational tool for understanding parameter effects
- Performance-optimized for parameter changes
        */

        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        let params = {
            population: 100,
            speed: 1.5,
            nearRadius: 30,
            farRadius: 60,
            waver: 15,
            fade: 0.1,
            glow: 15
        };

        class Turtle {
            constructor(x, y) {
                this.x = x || Math.random() * canvas.width;
                this.y = y || Math.random() * canvas.height;
                this.heading = Math.random() * Math.PI * 2;
                this.leader = null;
                this.follower = null;
                this.chainHue = Math.random() * 360;
                this.size = 5;
            }

            attachTurtle(turtles) {
                if (this.leader !== null) return;

                const distance = params.nearRadius + Math.random() * (params.farRadius - params.nearRadius);
                const angle = Math.random() * Math.PI * 2;

                const targetX = this.x + Math.cos(angle) * distance;
                const targetY = this.y + Math.sin(angle) * distance;

                let candidate = null;
                let minDist = 20;

                for (let turtle of turtles) {
                    if (turtle === this || turtle.follower !== null) continue;

                    const dx = turtle.x - targetX;
                    const dy = turtle.y - targetY;
                    const dist = Math.sqrt(dx * dx + dy * dy);

                    if (dist < minDist) {
                        candidate = turtle;
                        minDist = dist;
                    }
                }

                if (candidate) {
                    candidate.follower = this;
                    this.leader = candidate;
                    this.chainHue = candidate.chainHue;
                }
            }

            breakChain() {
                if (this.leader) {
                    this.leader.follower = null;
                    this.leader = null;
                }
                if (this.follower) {
                    this.follower.leader = null;
                    this.follower = null;
                }
            }

            getColor() {
                if (this.leader === null && this.follower === null) {
                    return `hsl(0, 0%, 50%)`;
                } else {
                    return `hsl(${this.chainHue}, 100%, 55%)`;
                }
            }

            turn() {
                if (this.leader === null) {
                    const change = (Math.random() - 0.5) * (params.waver * Math.PI / 180);
                    this.heading += change;
                } else {
                    const dx = this.leader.x - this.x;
                    const dy = this.leader.y - this.y;
                    this.heading = Math.atan2(dy, dx);
                }
            }

            move() {
                this.x += Math.cos(this.heading) * params.speed;
                this.y += Math.sin(this.heading) * params.speed;

                if (this.x < 0) this.x = canvas.width;
                if (this.x > canvas.width) this.x = 0;
                if (this.y < 0) this.y = canvas.height;
                if (this.y > canvas.height) this.y = 0;
            }

            draw() {
                const color = this.getColor();

                if (this.leader) {
                    ctx.strokeStyle = color;
                    ctx.lineWidth = 2.5;
                    ctx.shadowBlur = params.glow;
                    ctx.shadowColor = color;
                    ctx.beginPath();
                    ctx.moveTo(this.x, this.y);
                    ctx.lineTo(this.leader.x, this.leader.y);
                    ctx.stroke();
                    ctx.shadowBlur = 0;
                }

                ctx.fillStyle = color;
                ctx.shadowBlur = params.glow * 1.2;
                ctx.shadowColor = color;
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.fill();
                ctx.shadowBlur = 0;
            }
        }

        let turtles = [];

        function initTurtles() {
            turtles = [];
            for (let i = 0; i < params.population; i++) {
                turtles.push(new Turtle());
            }
        }

        initTurtles();

        // Parameter controls
        document.getElementById('population').addEventListener('input', (e) => {
            const newPop = parseInt(e.target.value);
            document.getElementById('popValue').textContent = newPop;

            if (newPop > turtles.length) {
                for (let i = turtles.length; i < newPop; i++) {
                    turtles.push(new Turtle());
                }
            } else {
                turtles.length = newPop;
            }
            params.population = newPop;
        });

        document.getElementById('speed').addEventListener('input', (e) => {
            params.speed = parseFloat(e.target.value);
            document.getElementById('speedValue').textContent = params.speed.toFixed(1);
        });

        document.getElementById('nearRadius').addEventListener('input', (e) => {
            params.nearRadius = parseInt(e.target.value);
            document.getElementById('nearValue').textContent = params.nearRadius;
        });

        document.getElementById('farRadius').addEventListener('input', (e) => {
            params.farRadius = parseInt(e.target.value);
            document.getElementById('farValue').textContent = params.farRadius;
        });

        document.getElementById('waver').addEventListener('input', (e) => {
            params.waver = parseInt(e.target.value);
            document.getElementById('waverValue').textContent = params.waver;
        });

        document.getElementById('fade').addEventListener('input', (e) => {
            params.fade = parseFloat(e.target.value);
            document.getElementById('fadeValue').textContent = params.fade.toFixed(2);
        });

        document.getElementById('glow').addEventListener('input', (e) => {
            params.glow = parseInt(e.target.value);
            document.getElementById('glowValue').textContent = params.glow;
        });

        function loadPreset(name) {
            const presets = {
                chaotic: { speed: 3, waver: 35, nearRadius: 25, farRadius: 100, glow: 20, fade: 0.15 },
                flowing: { speed: 1.2, waver: 5, nearRadius: 35, farRadius: 60, glow: 15, fade: 0.05 },
                tight: { speed: 1.5, waver: 10, nearRadius: 20, farRadius: 35, glow: 25, fade: 0.12 },
                slow: { speed: 0.8, waver: 20, nearRadius: 40, farRadius: 80, glow: 30, fade: 0.03 },
                explosive: { speed: 4.5, waver: 40, nearRadius: 15, farRadius: 120, glow: 35, fade: 0.2 }
            };

            const preset = presets[name];
            Object.assign(params, preset);

            document.getElementById('speed').value = preset.speed;
            document.getElementById('speedValue').textContent = preset.speed.toFixed(1);
            document.getElementById('waver').value = preset.waver;
            document.getElementById('waverValue').textContent = preset.waver;
            document.getElementById('nearRadius').value = preset.nearRadius;
            document.getElementById('nearValue').textContent = preset.nearRadius;
            document.getElementById('farRadius').value = preset.farRadius;
            document.getElementById('farValue').textContent = preset.farRadius;
            document.getElementById('glow').value = preset.glow;
            document.getElementById('glowValue').textContent = preset.glow;
            document.getElementById('fade').value = preset.fade;
            document.getElementById('fadeValue').textContent = preset.fade.toFixed(2);
        }

        function reset() {
            initTurtles();
        }

        function breakAll() {
            for (let turtle of turtles) {
                turtle.breakChain();
            }
        }

        function updateStats() {
            const chains = new Set();
            let longest = 0;
            let attached = 0;

            for (let turtle of turtles) {
                if (turtle.leader !== null || turtle.follower !== null) {
                    attached++;

                    let head = turtle;
                    while (head.leader !== null) {
                        head = head.leader;
                    }
                    chains.add(head);

                    let length = 0;
                    let current = head;
                    while (current !== null) {
                        length++;
                        current = current.follower;
                    }
                    longest = Math.max(longest, length);
                }
            }

            document.getElementById('chainCount').textContent = chains.size;
            document.getElementById('longest').textContent = longest;
            document.getElementById('attached').textContent = attached;
        }

        let frameCount = 0;

        function animate() {
            ctx.fillStyle = `rgba(0, 0, 0, ${params.fade})`;
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            for (let turtle of turtles) {
                if (turtle.leader === null) {
                    turtle.attachTurtle(turtles);
                }
            }

            for (let turtle of turtles) {
                turtle.turn();
            }

            for (let turtle of turtles) {
                turtle.move();
            }

            for (let turtle of turtles) {
                turtle.draw();
            }

            frameCount++;
            if (frameCount % 30 === 0) {
                updateStats();
            }

            requestAnimationFrame(animate);
        }

        animate();
    </script>
</body>
</html>
