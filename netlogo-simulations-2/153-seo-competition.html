<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SEO Competition - CCAB</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, sans-serif; background: #1a1a2e; color: #e8e6e1; overflow: hidden; }
        #container { display: flex; height: 100vh; }
        #canvas-container { flex: 1; position: relative; }
        canvas { display: block; width: 100%; height: 100%; }
        #controls { width: 300px; background: rgba(0,0,0,0.8); padding: 20px; overflow-y: auto; }
        h1 { font-size: 1.2rem; margin-bottom: 15px; color: #4ade80; }
        .control-group { margin-bottom: 15px; }
        label { display: block; font-size: 0.8rem; margin-bottom: 5px; color: #aaa; }
        input[type="range"] { width: 100%; }
        button { width: 100%; padding: 10px; margin-bottom: 10px; background: #4ade80; color: #1a1a2e; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; }
        .stats { background: rgba(255,255,255,0.1); padding: 10px; border-radius: 5px; font-size: 0.8rem; }
        .back-link { position: fixed; top: 10px; left: 10px; padding: 8px 16px; background: rgba(0,0,0,0.7); color: #4ade80; text-decoration: none; border-radius: 6px; font-size: 14px; z-index: 999; }
        .explain-btn { background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%); margin-top: 10px; }
        .modal-overlay { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.8); z-index: 1000; }
        .modal-overlay.active { display: flex; align-items: center; justify-content: center; }
        .modal { background: linear-gradient(135deg, #1e1e2e 0%, #2d2d44 100%); border-radius: 16px; padding: 30px; max-width: 600px; max-height: 80vh; overflow-y: auto; border: 1px solid rgba(255,255,255,0.1); position: relative; }
        .modal-close { position: absolute; top: 15px; right: 20px; background: none; border: none; color: #888; font-size: 28px; cursor: pointer; width: auto; }
        .modal h2 { color: #4ade80; margin-bottom: 20px; }
        .modal-body { color: #ccc; line-height: 1.8; }
    </style>
</head>
<body>
    <a href="index.html" class="back-link">‚Üê Back to Gallery</a>
    <div id="container">
        <div id="canvas-container"><canvas id="canvas"></canvas></div>
        <div id="controls">
            <h1>SEO Competition</h1>
            <div class="control-group">
                <label>Algorithm Volatility: <span id="volatilityValue">0.2</span></label>
                <input type="range" id="volatility" min="0" max="0.5" step="0.05" value="0.2">
            </div>
            <div class="control-group">
                <label>Competition: <span id="competitionValue">10</span> sites</label>
                <input type="range" id="competition" min="5" max="20" step="1" value="10">
            </div>
            <button id="reset">Reset</button>
            <button id="update">Algorithm Update</button>
            <button id="explainBtn" class="explain-btn">üìö Explain</button>
            <div class="stats">
                <div>Top Rank: <span id="topRank">-</span></div>
                <div>Avg Position: <span id="avgPos">0</span></div>
                <div>Volatility: <span id="volScore">0</span></div>
            </div>
        </div>
    </div>
    <div id="explainModal" class="modal-overlay">
        <div class="modal">
            <button class="modal-close">&times;</button>
            <h2>SEO Competition</h2>
            <div class="modal-body">
                <p><strong>SEO (Search Engine Optimization)</strong> is a competitive game where websites vie for ranking positions.</p>
                <p>Key dynamics:</p>
                <ul>
                    <li><strong>Ranking factors:</strong> Content quality, backlinks, authority</li>
                    <li><strong>Algorithm updates:</strong> Search engines change ranking criteria</li>
                    <li><strong>Competition:</strong> Others optimizing affects your position</li>
                    <li><strong>Red Queen effect:</strong> Must keep improving to maintain rank</li>
                </ul>
                <p>Each bar represents a website's ranking score over time.</p>
            </div>
        </div>
    </div>
    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        let params = { volatility: 0.2, competition: 10 };
        let sites = [], history = [], time = 0;
        
        function resize() { canvas.width = document.getElementById('canvas-container').clientWidth; canvas.height = document.getElementById('canvas-container').clientHeight; }
        
        function init() {
            resize(); time = 0; history = [];
            sites = [];
            const colors = ['#4ade80', '#f472b6', '#22d3ee', '#f59e0b', '#a855f7', '#ef4444', '#14b8a6', '#eab308', '#6366f1', '#ec4899',
                           '#10b981', '#8b5cf6', '#f97316', '#06b6d4', '#84cc16', '#d946ef', '#0ea5e9', '#f43f5e', '#22c55e', '#a3e635'];
            for (let i = 0; i < params.competition; i++) {
                sites.push({
                    name: `Site ${i + 1}`,
                    score: 50 + Math.random() * 50,
                    quality: 0.3 + Math.random() * 0.7,
                    investment: 0.1 + Math.random() * 0.2,
                    color: colors[i % colors.length],
                    history: []
                });
            }
        }
        
        function algorithmUpdate() {
            for (let site of sites) {
                const change = (Math.random() - 0.5) * 30 * params.volatility;
                site.score = Math.max(0, Math.min(100, site.score + change));
            }
        }
        
        function update() {
            time++;
            for (let site of sites) {
                // Natural optimization efforts
                const effort = site.investment * site.quality * (Math.random() * 2);
                // Competition effect
                const avgScore = sites.reduce((s, st) => s + st.score, 0) / sites.length;
                const competitive = (avgScore - site.score) * 0.02;
                // Random noise
                const noise = (Math.random() - 0.5) * 5 * params.volatility;
                
                site.score = Math.max(0, Math.min(100, site.score + effort + competitive + noise));
                site.history.push(site.score);
                if (site.history.length > 200) site.history.shift();
            }
        }
        
        function draw() {
            ctx.fillStyle = '#1a1a2e';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            const chartWidth = canvas.width - 380;
            const chartHeight = canvas.height - 100;
            const chartX = 50;
            const chartY = 50;
            
            // Draw chart background
            ctx.fillStyle = 'rgba(255,255,255,0.05)';
            ctx.fillRect(chartX, chartY, chartWidth, chartHeight);
            
            // Draw grid
            ctx.strokeStyle = 'rgba(255,255,255,0.1)';
            ctx.lineWidth = 1;
            for (let i = 0; i <= 10; i++) {
                const y = chartY + (i / 10) * chartHeight;
                ctx.beginPath();
                ctx.moveTo(chartX, y);
                ctx.lineTo(chartX + chartWidth, y);
                ctx.stroke();
            }
            
            // Draw lines
            for (let site of sites) {
                if (site.history.length < 2) continue;
                ctx.strokeStyle = site.color;
                ctx.lineWidth = 2;
                ctx.beginPath();
                for (let i = 0; i < site.history.length; i++) {
                    const x = chartX + (i / 200) * chartWidth;
                    const y = chartY + chartHeight - (site.history[i] / 100) * chartHeight;
                    if (i === 0) ctx.moveTo(x, y);
                    else ctx.lineTo(x, y);
                }
                ctx.stroke();
            }
            
            // Draw legend
            const sorted = [...sites].sort((a, b) => b.score - a.score);
            for (let i = 0; i < sorted.length; i++) {
                ctx.fillStyle = sorted[i].color;
                ctx.fillRect(chartX + chartWidth + 20, chartY + i * 20, 15, 15);
                ctx.fillStyle = '#ccc';
                ctx.font = '12px sans-serif';
                ctx.fillText(`${i + 1}. ${sorted[i].name}`, chartX + chartWidth + 40, chartY + i * 20 + 12);
            }
            
            document.getElementById('topRank').textContent = sorted[0].name;
            document.getElementById('avgPos').textContent = (sites.reduce((s, st) => s + st.score, 0) / sites.length).toFixed(1);
            const volatilityScore = sites.reduce((s, st) => {
                if (st.history.length < 2) return s;
                const last = st.history[st.history.length - 1];
                const prev = st.history[st.history.length - 2];
                return s + Math.abs(last - prev);
            }, 0) / sites.length;
            document.getElementById('volScore').textContent = volatilityScore.toFixed(2);
        }
        
        function animate() { update(); draw(); requestAnimationFrame(animate); }
        
        document.getElementById('volatility').addEventListener('input', e => { params.volatility = parseFloat(e.target.value); document.getElementById('volatilityValue').textContent = params.volatility.toFixed(2); });
        document.getElementById('competition').addEventListener('input', e => { params.competition = parseInt(e.target.value); document.getElementById('competitionValue').textContent = params.competition; });
        document.getElementById('reset').addEventListener('click', init);
        document.getElementById('update').addEventListener('click', algorithmUpdate);
        window.addEventListener('resize', resize);
        const modal = document.getElementById('explainModal');
        document.getElementById('explainBtn').addEventListener('click', () => modal.classList.add('active'));
        modal.querySelector('.modal-close').addEventListener('click', () => modal.classList.remove('active'));
        modal.addEventListener('click', e => { if (e.target === modal) modal.classList.remove('active'); });
        init(); animate();
    </script>
    <script src="../assets/js/enhance.js" defer></script>
</body>
</html>
