<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gene Interaction Network</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: Arial, sans-serif;
            background: #0a0e27;
            overflow: hidden;
        }
        h1 {
            color: #00d4ff;
            text-align: center;
            margin-bottom: 10px;
        }
        .info {
            color: #7fb3d5;
            text-align: center;
            margin-bottom: 20px;
        }
        svg {
            display: block;
            margin: 0 auto;
        }
        .chord {
            fill-opacity: 0.6;
        }
        .chord:hover {
            fill-opacity: 0.95;
        }
        text {
            font-family: 'Courier New', monospace;
        }
    </style>
</head>
<body>
    <h1>Gene Interaction Network</h1>
    <p class="info">Protein-protein interaction strengths</p>
    <svg id="chord"></svg>

    <script>
        const width = window.innerWidth - 40;
        const height = window.innerHeight - 140;
        const outerRadius = Math.min(width, height) * 0.4;
        const innerRadius = outerRadius - 30;

        const svg = d3.select("#chord")
            .attr("width", width)
            .attr("height", height)
            .append("g")
            .attr("transform", `translate(${width / 2},${height / 2})`);

        const genes = ["BRCA1", "TP53", "EGFR", "KRAS", "PTEN", "MYC", "AKT1", "PIK3CA"];

        const matrix = [
            [0, 85, 20, 15, 30, 25, 40, 35],
            [85, 0, 45, 40, 55, 60, 50, 30],
            [20, 45, 0, 70, 25, 15, 35, 65],
            [15, 40, 70, 0, 20, 30, 25, 55],
            [30, 55, 25, 20, 0, 35, 75, 40],
            [25, 60, 15, 30, 35, 0, 45, 20],
            [40, 50, 35, 25, 75, 45, 0, 60],
            [35, 30, 65, 55, 40, 20, 60, 0]
        ];

        const chord = d3.chord()
            .padAngle(0.03)
            .sortSubgroups(d3.descending);

        const arc = d3.arc()
            .innerRadius(innerRadius)
            .outerRadius(outerRadius);

        const ribbon = d3.ribbon()
            .radius(innerRadius);

        const color = d3.scaleSequential(d3.interpolatePlasma)
            .domain([0, genes.length - 1]);

        const chords = chord(matrix);

        // Add glow effect
        const defs = svg.append("defs");
        const filter = defs.append("filter")
            .attr("id", "glow");
        filter.append("feGaussianBlur")
            .attr("stdDeviation", "3")
            .attr("result", "coloredBlur");
        const feMerge = filter.append("feMerge");
        feMerge.append("feMergeNode").attr("in", "coloredBlur");
        feMerge.append("feMergeNode").attr("in", "SourceGraphic");

        svg.append("g")
            .selectAll("path")
            .data(chords)
            .join("path")
            .attr("class", "chord")
            .attr("d", ribbon)
            .attr("fill", d => color(d.target.index))
            .attr("stroke", d => d3.rgb(color(d.target.index)).darker())
            .attr("filter", "url(#glow)")
            .append("title")
            .text(d => `${genes[d.source.index]} â†” ${genes[d.target.index]}\nInteraction Strength: ${d.source.value}`);

        const group = svg.append("g")
            .selectAll("g")
            .data(chords.groups)
            .join("g");

        group.append("path")
            .attr("fill", d => color(d.index))
            .attr("stroke", "#00d4ff")
            .attr("stroke-width", 2)
            .attr("d", arc)
            .attr("filter", "url(#glow)");

        group.append("title")
            .text(d => `${genes[d.index]}\nTotal Interactions: ${d.value}`);

        group.append("text")
            .each(d => { d.angle = (d.startAngle + d.endAngle) / 2; })
            .attr("dy", ".35em")
            .attr("transform", d => `
                rotate(${d.angle * 180 / Math.PI - 90})
                translate(${outerRadius + 15})
                ${d.angle > Math.PI ? "rotate(180)" : ""}
            `)
            .attr("text-anchor", d => d.angle > Math.PI ? "end" : "start")
            .attr("fill", "#00d4ff")
            .attr("font-weight", "bold")
            .attr("font-size", "12px")
            .text(d => genes[d.index]);
    </script>
</body>
</html>
