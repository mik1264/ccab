<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Streaming Particle Data</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: Arial, sans-serif;
            background: #000;
            overflow: hidden;
        }
        h1 {
            color: #00d4ff;
            text-align: center;
            margin-bottom: 10px;
        }
        .info {
            color: #7fb3d5;
            text-align: center;
            margin-bottom: 20px;
        }
        svg {
            display: block;
            margin: 0 auto;
            background: #0a0a1a;
            border-radius: 10px;
        }
        .particle {
            fill: #00d4ff;
            opacity: 0.8;
        }
        .stats {
            fill: #00d4ff;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <h1>Live Event Stream</h1>
    <p class="info">Real-time event data visualization</p>
    <svg id="chart"></svg>

    <script>
        const width = window.innerWidth - 40;
        const height = window.innerHeight - 140;

        const svg = d3.select("#chart")
            .attr("width", width)
            .attr("height", height);

        const particles = [];
        let eventCount = 0;

        const colorScale = d3.scaleOrdinal(d3.schemeCategory10);

        function addParticle() {
            const type = Math.floor(Math.random() * 5);
            particles.push({
                id: Date.now() + Math.random(),
                x: Math.random() * width,
                y: -10,
                vy: 1 + Math.random() * 2,
                type: type,
                radius: 3 + Math.random() * 5
            });
            eventCount++;
        }

        function update() {
            // Update particle positions
            particles.forEach(p => {
                p.y += p.vy;
                p.vy += 0.05; // Gravity
            });

            // Remove particles that are off screen
            const onScreen = particles.filter(p => p.y < height + 20);
            particles.length = 0;
            particles.push(...onScreen);

            // Render particles
            const circles = svg.selectAll("circle.particle")
                .data(particles, d => d.id);

            circles.exit().remove();

            circles.enter()
                .append("circle")
                .attr("class", "particle")
                .attr("r", d => d.radius)
                .attr("fill", d => colorScale(d.type))
                .merge(circles)
                .attr("cx", d => d.x)
                .attr("cy", d => d.y);

            // Update stats
            svg.selectAll(".stats").remove();
            svg.append("text")
                .attr("class", "stats")
                .attr("x", 20)
                .attr("y", 30)
                .text(`Active Events: ${particles.length}`);

            svg.append("text")
                .attr("class", "stats")
                .attr("x", 20)
                .attr("y", 50)
                .text(`Total Events: ${eventCount}`);
        }

        // Add particles at random intervals
        setInterval(() => {
            const numParticles = Math.floor(Math.random() * 3) + 1;
            for (let i = 0; i < numParticles; i++) {
                addParticle();
            }
        }, 200);

        // Animation loop
        setInterval(update, 30);
    </script>
</body>
</html>
