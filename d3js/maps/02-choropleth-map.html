<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>USA Choropleth Map</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: Arial, sans-serif;
            background: #f5f5f5;
            overflow: hidden;
        }
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 10px;
        }
        .info {
            color: #666;
            text-align: center;
            margin-bottom: 20px;
        }
        svg {
            display: block;
            margin: 0 auto;
            background: white;
            border-radius: 10px;
        }
        .state {
            stroke: #fff;
            stroke-width: 1px;
            cursor: pointer;
        }
        .state:hover {
            stroke: #333;
            stroke-width: 2px;
        }
        .legend {
            font-size: 12px;
        }
    </style>
</head>
<body>
    <h1>USA GDP by State (Choropleth)</h1>
    <p class="info">Color intensity represents GDP per capita</p>
    <svg id="map"></svg>

    <script>
        const width = window.innerWidth - 40;
        const height = window.innerHeight - 140;

        const svg = d3.select("#map")
            .attr("width", width)
            .attr("height", height);

        // Simplified US states representation as rectangles in a grid
        const states = [
            { name: "California", x: 50, y: 200, value: 85 },
            { name: "Texas", x: 300, y: 300, value: 70 },
            { name: "New York", x: 700, y: 150, value: 95 },
            { name: "Florida", x: 650, y: 350, value: 65 },
            { name: "Illinois", x: 500, y: 150, value: 75 },
            { name: "Pennsylvania", x: 650, y: 170, value: 72 },
            { name: "Ohio", x: 600, y: 180, value: 68 },
            { name: "Georgia", x: 650, y: 280, value: 70 },
            { name: "North Carolina", x: 700, y: 250, value: 68 },
            { name: "Michigan", x: 550, y: 120, value: 67 },
            { name: "New Jersey", x: 720, y: 170, value: 88 },
            { name: "Virginia", x: 700, y: 220, value: 75 },
            { name: "Washington", x: 80, y: 80, value: 82 },
            { name: "Arizona", x: 180, y: 280, value: 63 },
            { name: "Massachusetts", x: 750, y: 130, value: 92 },
            { name: "Tennessee", x: 600, y: 260, value: 65 },
            { name: "Indiana", x: 550, y: 180, value: 66 },
            { name: "Missouri", x: 480, y: 220, value: 64 },
            { name: "Maryland", x: 710, y: 200, value: 80 },
            { name: "Wisconsin", x: 500, y: 110, value: 68 },
            { name: "Colorado", x: 250, y: 200, value: 78 },
            { name: "Minnesota", x: 450, y: 90, value: 76 },
            { name: "South Carolina", x: 680, y: 290, value: 62 },
            { name: "Alabama", x: 600, y: 300, value: 60 },
            { name: "Louisiana", x: 480, y: 330, value: 64 },
            { name: "Kentucky", x: 600, y: 230, value: 63 },
            { name: "Oregon", x: 70, y: 120, value: 72 },
            { name: "Oklahoma", x: 380, y: 280, value: 63 },
            { name: "Connecticut", x: 760, y: 150, value: 90 },
            { name: "Utah", x: 200, y: 200, value: 70 }
        ];

        const colorScale = d3.scaleSequential(d3.interpolateBlues)
            .domain([55, 100]);

        svg.append("g")
            .selectAll("rect")
            .data(states)
            .join("rect")
            .attr("class", "state")
            .attr("x", d => d.x)
            .attr("y", d => d.y)
            .attr("width", 60)
            .attr("height", 40)
            .attr("fill", d => colorScale(d.value))
            .append("title")
            .text(d => `${d.name}\nGDP per capita: $${d.value}K`);

        svg.append("g")
            .selectAll("text")
            .data(states)
            .join("text")
            .attr("x", d => d.x + 30)
            .attr("y", d => d.y + 25)
            .attr("text-anchor", "middle")
            .attr("fill", d => d.value > 75 ? "white" : "#333")
            .attr("font-size", "9px")
            .attr("font-weight", "bold")
            .attr("pointer-events", "none")
            .text(d => d.name.substring(0, 3).toUpperCase());

        // Legend
        const legend = svg.append("g")
            .attr("class", "legend")
            .attr("transform", `translate(50, ${height - 80})`);

        const legendScale = d3.scaleLinear()
            .domain([55, 100])
            .range([0, 200]);

        const legendAxis = d3.axisBottom(legendScale)
            .ticks(5)
            .tickFormat(d => `$${d}K`);

        const defs = svg.append("defs");
        const gradient = defs.append("linearGradient")
            .attr("id", "legend-gradient");

        gradient.selectAll("stop")
            .data(d3.range(0, 1.1, 0.1))
            .join("stop")
            .attr("offset", d => `${d * 100}%`)
            .attr("stop-color", d => colorScale(55 + d * 45));

        legend.append("rect")
            .attr("width", 200)
            .attr("height", 20)
            .style("fill", "url(#legend-gradient)");

        legend.append("g")
            .attr("transform", "translate(0, 20)")
            .call(legendAxis);
    </script>
</body>
</html>
