<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>World Population Bubble Map</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://d3js.org/d3-geo.v3.min.js"></script>
    <script src="https://d3js.org/topojson.v3.min.js"></script>
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: Arial, sans-serif;
            background: #1a1a2e;
            overflow: hidden;
        }
        h1 {
            color: #eee;
            text-align: center;
            margin-bottom: 10px;
        }
        .info {
            color: #aaa;
            text-align: center;
            margin-bottom: 20px;
        }
        svg {
            display: block;
            margin: 0 auto;
            background: #16213e;
            border-radius: 10px;
        }
        .country {
            fill: #2d4a5a;
            stroke: #4a6fa5;
            stroke-width: 0.5px;
        }
        .country:hover {
            fill: #3a5a6a;
        }
        .bubble {
            fill: rgba(255, 100, 100, 0.6);
            stroke: #ff6b6b;
            stroke-width: 1px;
        }
        .bubble:hover {
            fill: rgba(255, 100, 100, 0.9);
        }
    </style>
</head>
<body>
    <h1>World Major Cities Population</h1>
    <p class="info">Bubble size represents population</p>
    <svg id="map"></svg>

    <script>
        const width = window.innerWidth - 40;
        const height = window.innerHeight - 140;

        const svg = d3.select("#map")
            .attr("width", width)
            .attr("height", height);

        const projection = d3.geoMercator()
            .scale(150)
            .translate([width / 2, height / 1.5]);

        const path = d3.geoPath().projection(projection);

        // Simplified world data (just drawing some basic land masses as rectangles)
        const landData = [
            {type: "Feature", geometry: {type: "Polygon", coordinates: [[
                [-180, -60], [180, -60], [180, 75], [-180, 75], [-180, -60]
            ]]}}
        ];

        svg.append("g")
            .selectAll("path")
            .data(landData)
            .join("path")
            .attr("class", "country")
            .attr("d", path);

        const cities = [
            { name: "Tokyo", coords: [139.6917, 35.6895], population: 37.4 },
            { name: "Delhi", coords: [77.1025, 28.7041], population: 28.5 },
            { name: "Shanghai", coords: [121.4737, 31.2304], population: 25.6 },
            { name: "SÃ£o Paulo", coords: [-46.6333, -23.5505], population: 21.7 },
            { name: "Mexico City", coords: [-99.1332, 19.4326], population: 21.6 },
            { name: "Cairo", coords: [31.2357, 30.0444], population: 20.1 },
            { name: "Mumbai", coords: [72.8777, 19.0760], population: 20.0 },
            { name: "Beijing", coords: [116.4074, 39.9042], population: 19.6 },
            { name: "Dhaka", coords: [90.4125, 23.8103], population: 19.6 },
            { name: "Osaka", coords: [135.5022, 34.6937], population: 19.3 },
            { name: "New York", coords: [-74.0060, 40.7128], population: 18.8 },
            { name: "Karachi", coords: [67.0011, 24.8607], population: 15.4 },
            { name: "Buenos Aires", coords: [-58.3816, -34.6037], population: 15.0 },
            { name: "Istanbul", coords: [28.9784, 41.0082], population: 14.8 },
            { name: "Lagos", coords: [3.3792, 6.5244], population: 14.3 },
            { name: "Paris", coords: [2.3522, 48.8566], population: 10.9 },
            { name: "London", coords: [-0.1276, 51.5074], population: 9.0 },
            { name: "Los Angeles", coords: [-118.2437, 34.0522], population: 12.4 },
            { name: "Moscow", coords: [37.6173, 55.7558], population: 12.4 },
            { name: "Sydney", coords: [151.2093, -33.8688], population: 5.3 }
        ];

        const radiusScale = d3.scaleSqrt()
            .domain([0, d3.max(cities, d => d.population)])
            .range([0, 30]);

        const bubbles = svg.append("g")
            .selectAll("circle")
            .data(cities)
            .join("circle")
            .attr("class", "bubble")
            .attr("cx", d => projection(d.coords)[0])
            .attr("cy", d => projection(d.coords)[1])
            .attr("r", d => radiusScale(d.population))
            .append("title")
            .text(d => `${d.name}\nPopulation: ${d.population}M`);

        svg.append("g")
            .selectAll("text")
            .data(cities.filter(d => d.population > 15))
            .join("text")
            .attr("x", d => projection(d.coords)[0])
            .attr("y", d => projection(d.coords)[1] - radiusScale(d.population) - 5)
            .attr("text-anchor", "middle")
            .attr("fill", "#eee")
            .attr("font-size", "10px")
            .text(d => d.name);
    </script>
</body>
</html>
