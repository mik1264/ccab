<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cartogram - Distorted by Population</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            overflow: hidden;
        }
        h1 {
            color: white;
            text-align: center;
            margin-bottom: 10px;
        }
        .info {
            color: rgba(255,255,255,0.9);
            text-align: center;
            margin-bottom: 20px;
        }
        svg {
            display: block;
            margin: 0 auto;
            background: rgba(255,255,255,0.95);
            border-radius: 10px;
        }
        .region {
            stroke: white;
            stroke-width: 2px;
        }
        .region:hover {
            opacity: 0.8;
        }
        text {
            pointer-events: none;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <h1>Population Cartogram</h1>
    <p class="info">Region size distorted by population (not geographic area)</p>
    <svg id="map"></svg>

    <script>
        const width = window.innerWidth - 40;
        const height = window.innerHeight - 140;

        const svg = d3.select("#map")
            .attr("width", width)
            .attr("height", height);

        // Regions with population data
        const regions = [
            { name: "Asia", population: 4700, color: "#e74c3c" },
            { name: "Africa", population: 1400, color: "#f39c12" },
            { name: "Europe", population: 750, color: "#3498db" },
            { name: "N. America", population: 580, color: "#2ecc71" },
            { name: "S. America", population: 430, color: "#9b59b6" },
            { name: "Oceania", population: 45, color: "#1abc9c" }
        ];

        const totalPop = d3.sum(regions, d => d.population);
        const areaScale = d3.scaleSqrt()
            .domain([0, totalPop])
            .range([0, width * height * 0.8]);

        // Calculate sizes
        regions.forEach(d => {
            d.area = areaScale(d.population);
            d.size = Math.sqrt(d.area);
        });

        // Simple treemap-like layout
        const pack = d3.pack()
            .size([width - 40, height - 40])
            .padding(5);

        const root = d3.hierarchy({ children: regions })
            .sum(d => d.population);

        pack(root);

        const nodes = svg.append("g")
            .attr("transform", "translate(20,20)")
            .selectAll("g")
            .data(root.leaves())
            .join("g")
            .attr("transform", d => `translate(${d.x},${d.y})`);

        nodes.append("circle")
            .attr("class", "region")
            .attr("r", d => d.r)
            .attr("fill", d => d.data.color)
            .append("title")
            .text(d => `${d.data.name}\nPopulation: ${d.data.population}M`);

        nodes.append("text")
            .attr("text-anchor", "middle")
            .attr("dy", "-0.5em")
            .attr("fill", "white")
            .attr("font-size", d => Math.min(d.r / 3, 18) + "px")
            .text(d => d.data.name);

        nodes.append("text")
            .attr("text-anchor", "middle")
            .attr("dy", "1em")
            .attr("fill", "white")
            .attr("font-size", d => Math.min(d.r / 4, 14) + "px")
            .text(d => `${d.data.population}M`);

        // Add summary
        svg.append("text")
            .attr("x", width / 2)
            .attr("y", height - 10)
            .attr("text-anchor", "middle")
            .attr("fill", "white")
            .attr("font-size", "14px")
            .text(`World Population: ${totalPop}M`);
    </script>
</body>
</html>
