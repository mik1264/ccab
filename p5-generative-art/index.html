<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>P5.js Generative Art - 40 Visualizations</title>
    <link rel="stylesheet" href="../assets/css/navigation.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.7.0/p5.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
        }

        h1 {
            text-align: center;
            color: white;
            margin-bottom: 10px;
            font-size: 3rem;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .subtitle {
            text-align: center;
            color: rgba(255, 255, 255, 0.9);
            margin-bottom: 30px;
            font-size: 1.2rem;
        }

        .category {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .category h2 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 2rem;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }

        .sketch-card {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 10px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .sketch-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
        }

        .sketch-card h3 {
            font-size: 1.1rem;
            margin-bottom: 8px;
            color: #333;
            text-align: center;
        }

        .sketch-container {
            width: 100%;
            height: 300px;
            border-radius: 5px;
            overflow: hidden;
        }

        .stats {
            text-align: center;
            color: white;
            margin-top: 30px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
        }

        .stats h3 {
            font-size: 2rem;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <!-- Navigation Header -->
    <nav class="ccab-nav">
        <div class="nav-container">
            <a href="../index.html" class="nav-home">
                <span class="nav-logo">CCAB</span>
                <span class="nav-tagline">Creative Code & Algorithmic Beauty</span>
            </a>
            <div class="nav-breadcrumb"></div>
            <div class="nav-actions">
                <button class="nav-search" aria-label="Search">üîç</button>
                <button class="nav-menu" aria-label="Menu">‚ò∞</button>
            </div>
        </div>
    </nav>


    <div class="container">
        <a href="../index.html" class="gallery-back">‚Üê Back to Main Gallery</a>
        <h1>P5.js Generative Art Gallery</h1>
        <p class="subtitle">40 Creative Coding Visualizations: Perlin Noise Landscapes, Recursive Patterns & Generative Art Systems</p>

        <!-- Perlin Noise Landscapes -->
        <div class="category">
            <h2>Perlin Noise Landscapes (10 Visualizations)</h2>
            <div class="grid">
                <div class="sketch-card">
                    <h3>1. Classic Terrain</h3>
                    <div class="sketch-container" id="sketch1"></div>
                </div>
                <div class="sketch-card">
                    <h3>2. Flowing Mountains</h3>
                    <div class="sketch-container" id="sketch2"></div>
                </div>
                <div class="sketch-card">
                    <h3>3. Ocean Waves</h3>
                    <div class="sketch-container" id="sketch3"></div>
                </div>
                <div class="sketch-card">
                    <h3>4. Cloud Formation</h3>
                    <div class="sketch-container" id="sketch4"></div>
                </div>
                <div class="sketch-card">
                    <h3>5. Topographic Map</h3>
                    <div class="sketch-container" id="sketch5"></div>
                </div>
                <div class="sketch-card">
                    <h3>6. Particle Flow Field</h3>
                    <div class="sketch-container" id="sketch6"></div>
                </div>
                <div class="sketch-card">
                    <h3>7. Noise Waves</h3>
                    <div class="sketch-container" id="sketch7"></div>
                </div>
                <div class="sketch-card">
                    <h3>8. 3D Terrain</h3>
                    <div class="sketch-container" id="sketch8"></div>
                </div>
                <div class="sketch-card">
                    <h3>9. Marble Texture</h3>
                    <div class="sketch-container" id="sketch9"></div>
                </div>
                <div class="sketch-card">
                    <h3>10. Aurora Borealis</h3>
                    <div class="sketch-container" id="sketch10"></div>
                </div>
            </div>
        </div>

        <!-- Recursive Patterns -->
        <div class="category">
            <h2>Recursive Patterns (10 Visualizations)</h2>
            <div class="grid">
                <div class="sketch-card">
                    <h3>11. Fractal Tree</h3>
                    <div class="sketch-container" id="sketch11"></div>
                </div>
                <div class="sketch-card">
                    <h3>12. Sierpinski Triangle</h3>
                    <div class="sketch-container" id="sketch12"></div>
                </div>
                <div class="sketch-card">
                    <h3>13. Koch Snowflake</h3>
                    <div class="sketch-container" id="sketch13"></div>
                </div>
                <div class="sketch-card">
                    <h3>14. Dragon Curve</h3>
                    <div class="sketch-container" id="sketch14"></div>
                </div>
                <div class="sketch-card">
                    <h3>15. Barnsley Fern</h3>
                    <div class="sketch-container" id="sketch15"></div>
                </div>
                <div class="sketch-card">
                    <h3>16. Pythagoras Tree</h3>
                    <div class="sketch-container" id="sketch16"></div>
                </div>
                <div class="sketch-card">
                    <h3>17. Spiral Recursion</h3>
                    <div class="sketch-container" id="sketch17"></div>
                </div>
                <div class="sketch-card">
                    <h3>18. Circle Packing</h3>
                    <div class="sketch-container" id="sketch18"></div>
                </div>
                <div class="sketch-card">
                    <h3>19. Branching Vines</h3>
                    <div class="sketch-container" id="sketch19"></div>
                </div>
                <div class="sketch-card">
                    <h3>20. Mandelbrot Set</h3>
                    <div class="sketch-container" id="sketch20"></div>
                </div>
            </div>
        </div>

        <!-- Creative Coding & Generative Art Systems -->
        <div class="category">
            <h2>Creative Coding & Generative Art Systems (20 Visualizations)</h2>
            <div class="grid">
                <div class="sketch-card">
                    <h3>21. Particle System</h3>
                    <div class="sketch-container" id="sketch21"></div>
                </div>
                <div class="sketch-card">
                    <h3>22. Flocking Behavior</h3>
                    <div class="sketch-container" id="sketch22"></div>
                </div>
                <div class="sketch-card">
                    <h3>23. Reaction Diffusion</h3>
                    <div class="sketch-container" id="sketch23"></div>
                </div>
                <div class="sketch-card">
                    <h3>24. Attraction Points</h3>
                    <div class="sketch-container" id="sketch24"></div>
                </div>
                <div class="sketch-card">
                    <h3>25. Cellular Automata</h3>
                    <div class="sketch-container" id="sketch25"></div>
                </div>
                <div class="sketch-card">
                    <h3>26. Fourier Transform</h3>
                    <div class="sketch-container" id="sketch26"></div>
                </div>
                <div class="sketch-card">
                    <h3>27. Voronoi Diagram</h3>
                    <div class="sketch-container" id="sketch27"></div>
                </div>
                <div class="sketch-card">
                    <h3>28. Chaotic Pendulum</h3>
                    <div class="sketch-container" id="sketch28"></div>
                </div>
                <div class="sketch-card">
                    <h3>29. Lissajous Curves</h3>
                    <div class="sketch-container" id="sketch29"></div>
                </div>
                <div class="sketch-card">
                    <h3>30. Strange Attractor</h3>
                    <div class="sketch-container" id="sketch30"></div>
                </div>
                <div class="sketch-card">
                    <h3>31. Phyllotaxis Spiral</h3>
                    <div class="sketch-container" id="sketch31"></div>
                </div>
                <div class="sketch-card">
                    <h3>32. Metaballs</h3>
                    <div class="sketch-container" id="sketch32"></div>
                </div>
                <div class="sketch-card">
                    <h3>33. Morphing Shapes</h3>
                    <div class="sketch-container" id="sketch33"></div>
                </div>
                <div class="sketch-card">
                    <h3>34. Plasma Effect</h3>
                    <div class="sketch-container" id="sketch34"></div>
                </div>
                <div class="sketch-card">
                    <h3>35. Kaleidoscope</h3>
                    <div class="sketch-container" id="sketch35"></div>
                </div>
                <div class="sketch-card">
                    <h3>36. Differential Growth</h3>
                    <div class="sketch-container" id="sketch36"></div>
                </div>
                <div class="sketch-card">
                    <h3>37. Spiral Galaxy</h3>
                    <div class="sketch-container" id="sketch37"></div>
                </div>
                <div class="sketch-card">
                    <h3>38. Chromatic Waves</h3>
                    <div class="sketch-container" id="sketch38"></div>
                </div>
                <div class="sketch-card">
                    <h3>39. Magnetic Field</h3>
                    <div class="sketch-container" id="sketch39"></div>
                </div>
                <div class="sketch-card">
                    <h3>40. Generative Typography</h3>
                    <div class="sketch-container" id="sketch40"></div>
                </div>
            </div>
        </div>

        <div class="stats">
            <h3>40 P5.js Generative Art Visualizations</h3>
            <p>Featuring Perlin Noise Landscapes, Recursive Patterns, and Creative Coding Systems</p>
        </div>
    </div>

    <script>
        // Sketch 1: Classic Terrain
        new p5(function(p) {
            let yoff = 0;
            p.setup = function() {
                p.createCanvas(280, 300).parent('sketch1');
            };
            p.draw = function() {
                p.background(135, 206, 235);
                p.fill(34, 139, 34);
                p.noStroke();
                p.beginShape();
                p.vertex(0, p.height);
                let xoff = 0;
                for (let x = 0; x <= p.width; x += 5) {
                    let y = p.map(p.noise(xoff, yoff), 0, 1, p.height * 0.3, p.height * 0.8);
                    p.vertex(x, y);
                    xoff += 0.1;
                }
                p.vertex(p.width, p.height);
                p.endShape(p.CLOSE);
                yoff += 0.01;
            };
        });

        // Sketch 2: Flowing Mountains
        new p5(function(p) {
            let yoff = 0;
            p.setup = function() {
                p.createCanvas(280, 300).parent('sketch2');
            };
            p.draw = function() {
                p.background(255, 200, 150);
                for (let layer = 0; layer < 5; layer++) {
                    p.fill(50 + layer * 40, 100 + layer * 30, 200 - layer * 20, 150);
                    p.noStroke();
                    p.beginShape();
                    p.vertex(0, p.height);
                    let xoff = 0;
                    for (let x = 0; x <= p.width; x += 10) {
                        let y = p.map(p.noise(xoff, yoff + layer), 0, 1,
                            p.height * 0.3 + layer * 30, p.height * 0.7 + layer * 30);
                        p.vertex(x, y);
                        xoff += 0.05;
                    }
                    p.vertex(p.width, p.height);
                    p.endShape(p.CLOSE);
                }
                yoff += 0.005;
            };
        });

        // Sketch 3: Ocean Waves
        new p5(function(p) {
            let yoff = 0;
            p.setup = function() {
                p.createCanvas(280, 300).parent('sketch3');
            };
            p.draw = function() {
                p.background(10, 50, 100);
                for (let y = p.height * 0.3; y < p.height; y += 15) {
                    p.stroke(30, 144, 255, 100);
                    p.strokeWeight(2);
                    p.noFill();
                    p.beginShape();
                    let xoff = yoff;
                    for (let x = 0; x <= p.width; x += 5) {
                        let wave = p.sin(xoff) * 10;
                        p.vertex(x, y + wave);
                        xoff += 0.1;
                    }
                    p.endShape();
                }
                yoff += 0.05;
            };
        });

        // Sketch 4: Cloud Formation
        new p5(function(p) {
            let xoff = 0;
            p.setup = function() {
                p.createCanvas(280, 300).parent('sketch4');
            };
            p.draw = function() {
                p.background(135, 206, 250);
                p.loadPixels();
                let yoff = 0;
                for (let y = 0; y < p.height; y++) {
                    let xoff = 0;
                    for (let x = 0; x < p.width; x++) {
                        let bright = p.noise(xoff, yoff) * 255;
                        let index = (x + y * p.width) * 4;
                        if (bright > 180) {
                            p.pixels[index] = 255;
                            p.pixels[index + 1] = 255;
                            p.pixels[index + 2] = 255;
                            p.pixels[index + 3] = bright;
                        }
                        xoff += 0.02;
                    }
                    yoff += 0.02;
                }
                p.updatePixels();
                p.noLoop();
            };
        });

        // Sketch 5: Topographic Map
        new p5(function(p) {
            p.setup = function() {
                p.createCanvas(280, 300).parent('sketch5');
                p.background(240, 230, 200);
                p.noFill();
                for (let i = 0; i < 20; i++) {
                    let threshold = i * 0.05;
                    p.stroke(100, 80, 60, 150);
                    p.strokeWeight(1);
                    p.beginShape();
                    for (let x = 0; x < p.width; x += 2) {
                        for (let y = 0; y < p.height; y += 2) {
                            let n = p.noise(x * 0.01, y * 0.01);
                            if (p.abs(n - threshold) < 0.02) {
                                p.vertex(x, y);
                            }
                        }
                    }
                    p.endShape();
                }
            };
        });

        // Sketch 6: Particle Flow Field
        new p5(function(p) {
            let particles = [];
            let flowField;
            p.setup = function() {
                p.createCanvas(280, 300).parent('sketch6');
                for (let i = 0; i < 500; i++) {
                    particles.push(new FlowParticle(p));
                }
            };
            p.draw = function() {
                p.background(0, 10);
                for (let particle of particles) {
                    particle.follow(p.frameCount);
                    particle.update();
                    particle.edges();
                    particle.show();
                }
            };

            class FlowParticle {
                constructor(p) {
                    this.p = p;
                    this.pos = p.createVector(p.random(p.width), p.random(p.height));
                    this.vel = p.createVector(0, 0);
                    this.acc = p.createVector(0, 0);
                    this.maxSpeed = 2;
                }
                follow(time) {
                    let angle = this.p.noise(this.pos.x * 0.01, this.pos.y * 0.01, time * 0.01) * this.p.TWO_PI * 2;
                    let force = this.p.constructor.Vector.fromAngle(angle);
                    force.setMag(0.1);
                    this.acc.add(force);
                }
                update() {
                    this.vel.add(this.acc);
                    this.vel.limit(this.maxSpeed);
                    this.pos.add(this.vel);
                    this.acc.mult(0);
                }
                edges() {
                    if (this.pos.x > this.p.width) this.pos.x = 0;
                    if (this.pos.x < 0) this.pos.x = this.p.width;
                    if (this.pos.y > this.p.height) this.pos.y = 0;
                    if (this.pos.y < 0) this.pos.y = this.p.height;
                }
                show() {
                    this.p.strokeWeight(1);
                    this.p.stroke(this.p.map(this.pos.x, 0, this.p.width, 100, 255),
                                   this.p.map(this.pos.y, 0, this.p.height, 100, 255), 200, 200);
                    this.p.point(this.pos.x, this.pos.y);
                }
            }
        });

        // Sketch 7: Noise Waves
        new p5(function(p) {
            let yoff = 0;
            p.setup = function() {
                p.createCanvas(280, 300).parent('sketch7');
            };
            p.draw = function() {
                p.background(20);
                p.noFill();
                for (let wave = 0; wave < 10; wave++) {
                    p.stroke(p.map(wave, 0, 10, 100, 255), 150, 255);
                    p.strokeWeight(2);
                    p.beginShape();
                    let xoff = yoff;
                    for (let x = 0; x <= p.width; x += 5) {
                        let y = p.map(p.noise(xoff + wave, yoff), 0, 1,
                            wave * 25, wave * 25 + 50);
                        p.vertex(x, y);
                        xoff += 0.1;
                    }
                    p.endShape();
                }
                yoff += 0.01;
            };
        });

        // Sketch 8: 3D Terrain
        new p5(function(p) {
            let terrain = [];
            let w = 20;
            let h = 20;
            let flying = 0;
            p.setup = function() {
                p.createCanvas(280, 300, p.WEBGL).parent('sketch8');
                for (let i = 0; i < w; i++) {
                    terrain[i] = [];
                }
            };
            p.draw = function() {
                flying -= 0.05;
                let yoff = flying;
                for (let y = 0; y < h; y++) {
                    let xoff = 0;
                    for (let x = 0; x < w; x++) {
                        terrain[x][y] = p.map(p.noise(xoff, yoff), 0, 1, -50, 50);
                        xoff += 0.2;
                    }
                    yoff += 0.2;
                }

                p.background(0);
                p.rotateX(p.PI / 3);
                p.translate(-p.width / 2, -p.height / 2);

                for (let y = 0; y < h - 1; y++) {
                    p.beginShape(p.TRIANGLE_STRIP);
                    for (let x = 0; x < w; x++) {
                        let currentHeight = terrain[x][y];
                        let nextHeight = terrain[x][y + 1];
                        p.fill(p.map(currentHeight, -50, 50, 50, 200), 100, 150);
                        p.vertex(x * 15, y * 15, currentHeight);
                        p.fill(p.map(nextHeight, -50, 50, 50, 200), 100, 150);
                        p.vertex(x * 15, (y + 1) * 15, nextHeight);
                    }
                    p.endShape();
                }
            };
        });

        // Sketch 9: Marble Texture
        new p5(function(p) {
            p.setup = function() {
                p.createCanvas(280, 300).parent('sketch9');
                p.pixelDensity(1);
                p.loadPixels();
                for (let x = 0; x < p.width; x++) {
                    for (let y = 0; y < p.height; y++) {
                        let n = p.noise(x * 0.01, y * 0.01);
                        let marble = p.sin(x * 0.05 + n * 10) * 127 + 128;
                        let index = (x + y * p.width) * 4;
                        p.pixels[index] = marble;
                        p.pixels[index + 1] = marble * 0.9;
                        p.pixels[index + 2] = marble * 0.8;
                        p.pixels[index + 3] = 255;
                    }
                }
                p.updatePixels();
            };
        });

        // Sketch 10: Aurora Borealis
        new p5(function(p) {
            let yoff = 0;
            p.setup = function() {
                p.createCanvas(280, 300).parent('sketch10');
                p.background(10, 10, 50);
            };
            p.draw = function() {
                p.background(10, 10, 50, 25);
                for (let i = 0; i < 5; i++) {
                    p.noFill();
                    p.stroke(100 + i * 30, 255, 150, 100);
                    p.strokeWeight(3);
                    p.beginShape();
                    let xoff = yoff + i;
                    for (let x = 0; x <= p.width; x += 5) {
                        let y = p.map(p.noise(xoff, yoff), 0, 1,
                            p.height * 0.2 + i * 20, p.height * 0.5 + i * 20);
                        p.curveVertex(x, y);
                        xoff += 0.05;
                    }
                    p.endShape();
                }
                yoff += 0.01;
            };
        });

        // Sketch 11: Fractal Tree
        new p5(function(p) {
            let angle = 0;
            p.setup = function() {
                p.createCanvas(280, 300).parent('sketch11');
            };
            p.draw = function() {
                p.background(230, 240, 255);
                p.translate(p.width / 2, p.height);
                angle = p.map(p.sin(p.frameCount * 0.02), -1, 1, p.PI / 6, p.PI / 3);
                branch(80);
            };
            function branch(len) {
                p.strokeWeight(p.map(len, 10, 80, 1, 8));
                p.stroke(100, 70, 50);
                p.line(0, 0, 0, -len);
                p.translate(0, -len);

                if (len > 10) {
                    p.push();
                    p.rotate(angle);
                    branch(len * 0.67);
                    p.pop();

                    p.push();
                    p.rotate(-angle);
                    branch(len * 0.67);
                    p.pop();
                }
            }
        });

        // Sketch 12: Sierpinski Triangle
        new p5(function(p) {
            p.setup = function() {
                p.createCanvas(280, 300).parent('sketch12');
                p.background(255);
                drawSierpinski(p.width / 2, 20, p.width - 40, 6);
            };
            function drawSierpinski(x, y, size, depth) {
                if (depth === 0) {
                    p.noStroke();
                    p.fill(100, 150, 255, 200);
                    p.triangle(x, y, x - size / 2, y + size * 0.866, x + size / 2, y + size * 0.866);
                } else {
                    let newSize = size / 2;
                    drawSierpinski(x, y, newSize, depth - 1);
                    drawSierpinski(x - newSize / 2, y + newSize * 0.866, newSize, depth - 1);
                    drawSierpinski(x + newSize / 2, y + newSize * 0.866, newSize, depth - 1);
                }
            }
        });

        // Sketch 13: Koch Snowflake
        new p5(function(p) {
            let angle = 0;
            p.setup = function() {
                p.createCanvas(280, 300).parent('sketch13');
            };
            p.draw = function() {
                p.background(240, 248, 255);
                p.translate(p.width / 2, p.height / 2);
                p.rotate(angle);
                drawKoch(0, -80, 4);
                angle += 0.01;
            };
            function drawKoch(x, y, depth) {
                let size = 120;
                let h = size * p.sqrt(3) / 2;

                p.stroke(50, 100, 200);
                p.strokeWeight(2);
                p.noFill();
                p.beginShape();
                koch(x - size / 2, y + h / 3, x + size / 2, y + h / 3, depth);
                koch(x + size / 2, y + h / 3, x, y - 2 * h / 3, depth);
                koch(x, y - 2 * h / 3, x - size / 2, y + h / 3, depth);
                p.endShape();
            }
            function koch(x1, y1, x2, y2, depth) {
                if (depth === 0) {
                    p.vertex(x1, y1);
                } else {
                    let dx = x2 - x1;
                    let dy = y2 - y1;
                    let x3 = x1 + dx / 3;
                    let y3 = y1 + dy / 3;
                    let x4 = x1 + dx / 2 - dy * p.sqrt(3) / 6;
                    let y4 = y1 + dy / 2 + dx * p.sqrt(3) / 6;
                    let x5 = x1 + 2 * dx / 3;
                    let y5 = y1 + 2 * dy / 3;

                    koch(x1, y1, x3, y3, depth - 1);
                    koch(x3, y3, x4, y4, depth - 1);
                    koch(x4, y4, x5, y5, depth - 1);
                    koch(x5, y5, x2, y2, depth - 1);
                }
            }
        });

        // Sketch 14: Dragon Curve
        new p5(function(p) {
            let sequence = "FX";
            let angle = p.PI / 2;
            let len = 3;
            p.setup = function() {
                p.createCanvas(280, 300).parent('sketch14');
                p.background(20);
                for (let i = 0; i < 12; i++) {
                    sequence = generate(sequence);
                }
                p.translate(p.width * 0.3, p.height * 0.5);
                turtle(sequence);
            };
            function generate(seq) {
                let next = "";
                for (let char of seq) {
                    if (char === 'X') next += "X+YF+";
                    else if (char === 'Y') next += "-FX-Y";
                    else next += char;
                }
                return next;
            }
            function turtle(seq) {
                p.stroke(255, 100, 150);
                p.strokeWeight(1);
                for (let char of seq) {
                    if (char === 'F') {
                        p.line(0, 0, len, 0);
                        p.translate(len, 0);
                    } else if (char === '+') {
                        p.rotate(angle);
                    } else if (char === '-') {
                        p.rotate(-angle);
                    }
                }
            }
        });

        // Sketch 15: Barnsley Fern
        new p5(function(p) {
            let x = 0, y = 0;
            p.setup = function() {
                p.createCanvas(280, 300).parent('sketch15');
                p.background(20, 40, 20);
            };
            p.draw = function() {
                for (let i = 0; i < 100; i++) {
                    let nextX, nextY;
                    let r = p.random(100);

                    if (r < 1) {
                        nextX = 0;
                        nextY = 0.16 * y;
                    } else if (r < 86) {
                        nextX = 0.85 * x + 0.04 * y;
                        nextY = -0.04 * x + 0.85 * y + 1.6;
                    } else if (r < 93) {
                        nextX = 0.2 * x - 0.26 * y;
                        nextY = 0.23 * x + 0.22 * y + 1.6;
                    } else {
                        nextX = -0.15 * x + 0.28 * y;
                        nextY = 0.26 * x + 0.24 * y + 0.44;
                    }

                    let px = p.map(nextX, -2.5, 2.5, 0, p.width);
                    let py = p.map(nextY, 0, 10, p.height, 0);

                    p.stroke(100, 255, 100, 100);
                    p.strokeWeight(1);
                    p.point(px, py);

                    x = nextX;
                    y = nextY;
                }
            };
        });

        // Sketch 16: Pythagoras Tree
        new p5(function(p) {
            let angle = 0;
            p.setup = function() {
                p.createCanvas(280, 300).parent('sketch16');
            };
            p.draw = function() {
                p.background(250, 245, 230);
                p.translate(p.width / 2, p.height);
                angle = p.map(p.sin(p.frameCount * 0.02), -1, 1, p.PI / 6, p.PI / 3);
                drawPythagorasTree(0, 0, 60, p.PI / 2, 8);
            };
            function drawPythagorasTree(x, y, size, rotation, depth) {
                if (depth === 0) return;

                p.push();
                p.translate(x, y);
                p.rotate(rotation);

                p.fill(100, 200 - depth * 15, 100, 200);
                p.stroke(50, 100, 50);
                p.strokeWeight(1);
                p.rect(0, 0, size, -size);

                let newSize = size * 0.7;
                drawPythagorasTree(0, -size, newSize, angle, depth - 1);
                drawPythagorasTree(size, -size, newSize, -angle, depth - 1);

                p.pop();
            }
        });

        // Sketch 17: Spiral Recursion
        new p5(function(p) {
            let hue = 0;
            p.setup = function() {
                p.createCanvas(280, 300).parent('sketch17');
                p.colorMode(p.HSB);
            };
            p.draw = function() {
                p.background(0);
                p.translate(p.width / 2, p.height / 2);
                drawSpiral(0, 0, 100, hue);
                hue = (hue + 1) % 360;
            };
            function drawSpiral(x, y, size, h) {
                if (size < 2) return;

                p.stroke(h % 360, 80, 100);
                p.strokeWeight(2);
                p.noFill();
                p.circle(x, y, size);

                let newSize = size * 0.7;
                let angle = p.frameCount * 0.05;
                let newX = x + p.cos(angle) * size * 0.3;
                let newY = y + p.sin(angle) * size * 0.3;

                drawSpiral(newX, newY, newSize, h + 10);
            }
        });

        // Sketch 18: Circle Packing
        new p5(function(p) {
            let circles = [];
            p.setup = function() {
                p.createCanvas(280, 300).parent('sketch18');
            };
            p.draw = function() {
                p.background(20);

                let newCircle = {
                    x: p.random(p.width),
                    y: p.random(p.height),
                    r: 2
                };

                let valid = true;
                for (let c of circles) {
                    let d = p.dist(newCircle.x, newCircle.y, c.x, c.y);
                    if (d < newCircle.r + c.r) {
                        valid = false;
                        break;
                    }
                }

                if (valid) {
                    circles.push(newCircle);
                }

                for (let c of circles) {
                    let growing = true;
                    for (let other of circles) {
                        if (c !== other) {
                            let d = p.dist(c.x, c.y, other.x, other.y);
                            if (d < c.r + other.r + 2) {
                                growing = false;
                                break;
                            }
                        }
                    }

                    if (growing && c.r < p.width / 4) {
                        if (c.x - c.r > 0 && c.x + c.r < p.width &&
                            c.y - c.r > 0 && c.y + c.r < p.height) {
                            c.r += 0.5;
                        }
                    }

                    p.stroke(p.map(c.r, 0, 50, 100, 255), 150, 255);
                    p.strokeWeight(2);
                    p.noFill();
                    p.circle(c.x, c.y, c.r * 2);
                }

                if (circles.length > 200) {
                    circles = [];
                }
            };
        });

        // Sketch 19: Branching Vines
        new p5(function(p) {
            p.setup = function() {
                p.createCanvas(280, 300).parent('sketch19');
                p.background(250, 248, 240);
                p.translate(p.width / 2, p.height);
                drawVine(0, 0, -p.PI / 2, 80, 6);
            };
            function drawVine(x, y, angle, length, depth) {
                if (depth === 0) return;

                let endX = x + p.cos(angle) * length;
                let endY = y + p.sin(angle) * length;

                p.strokeWeight(depth);
                p.stroke(80, 150, 80, 200);
                p.line(x, y, endX, endY);

                // Draw leaf
                if (p.random(1) > 0.5) {
                    p.fill(100, 200, 100, 150);
                    p.noStroke();
                    p.ellipse(endX, endY, 10, 20);
                }

                let branches = p.floor(p.random(2, 4));
                for (let i = 0; i < branches; i++) {
                    let newAngle = angle + p.random(-p.PI / 3, p.PI / 3);
                    drawVine(endX, endY, newAngle, length * p.random(0.5, 0.8), depth - 1);
                }
            }
        });

        // Sketch 20: Mandelbrot Set
        new p5(function(p) {
            p.setup = function() {
                p.createCanvas(280, 300).parent('sketch20');
                p.pixelDensity(1);
                p.loadPixels();

                for (let x = 0; x < p.width; x++) {
                    for (let y = 0; y < p.height; y++) {
                        let a = p.map(x, 0, p.width, -2.5, 1);
                        let b = p.map(y, 0, p.height, -1, 1);

                        let ca = a;
                        let cb = b;

                        let n = 0;
                        let maxIterations = 100;

                        while (n < maxIterations) {
                            let aa = a * a - b * b;
                            let bb = 2 * a * b;

                            a = aa + ca;
                            b = bb + cb;

                            if (a * a + b * b > 16) {
                                break;
                            }
                            n++;
                        }

                        let bright = p.map(n, 0, maxIterations, 0, 255);
                        let index = (x + y * p.width) * 4;

                        if (n === maxIterations) {
                            p.pixels[index] = 0;
                            p.pixels[index + 1] = 0;
                            p.pixels[index + 2] = 0;
                        } else {
                            p.pixels[index] = bright;
                            p.pixels[index + 1] = bright * 0.5;
                            p.pixels[index + 2] = 255 - bright;
                        }
                        p.pixels[index + 3] = 255;
                    }
                }
                p.updatePixels();
            };
        });

        // Sketch 21: Particle System
        new p5(function(p) {
            let particles = [];
            p.setup = function() {
                p.createCanvas(280, 300).parent('sketch21');
            };
            p.draw = function() {
                p.background(0, 20);

                if (p.frameCount % 3 === 0) {
                    particles.push(new Particle21(p, p.width / 2, p.height));
                }

                for (let i = particles.length - 1; i >= 0; i--) {
                    particles[i].update();
                    particles[i].show();
                    if (particles[i].finished()) {
                        particles.splice(i, 1);
                    }
                }
            };

            class Particle21 {
                constructor(p, x, y) {
                    this.p = p;
                    this.pos = p.createVector(x, y);
                    this.vel = p5.Vector.random2D();
                    this.vel.mult(p.random(2, 5));
                    this.acc = p.createVector(0, -0.1);
                    this.lifespan = 255;
                    this.hue = p.random(360);
                }
                update() {
                    this.vel.add(this.acc);
                    this.pos.add(this.vel);
                    this.lifespan -= 5;
                }
                show() {
                    this.p.colorMode(this.p.HSB);
                    this.p.noStroke();
                    this.p.fill(this.hue, 255, 255, this.lifespan);
                    this.p.circle(this.pos.x, this.pos.y, 8);
                    this.p.colorMode(this.p.RGB);
                }
                finished() {
                    return this.lifespan < 0;
                }
            }
        });

        // Sketch 22: Flocking Behavior
        new p5(function(p) {
            let flock = [];
            p.setup = function() {
                p.createCanvas(280, 300).parent('sketch22');
                for (let i = 0; i < 50; i++) {
                    flock.push(new Boid(p));
                }
            };
            p.draw = function() {
                p.background(240, 248, 255);
                for (let boid of flock) {
                    boid.flock(flock);
                    boid.update();
                    boid.show();
                }
            };

            class Boid {
                constructor(p) {
                    this.p = p;
                    this.pos = p.createVector(p.random(p.width), p.random(p.height));
                    this.vel = p5.Vector.random2D();
                    this.vel.setMag(p.random(2, 4));
                    this.acc = p.createVector();
                    this.maxForce = 0.2;
                    this.maxSpeed = 4;
                }
                flock(boids) {
                    let alignment = this.align(boids);
                    let cohesion = this.cohesion(boids);
                    let separation = this.separation(boids);

                    this.acc.add(alignment);
                    this.acc.add(cohesion);
                    this.acc.add(separation);
                }
                align(boids) {
                    let perceptionRadius = 50;
                    let steering = this.p.createVector();
                    let total = 0;
                    for (let other of boids) {
                        let d = this.p.dist(this.pos.x, this.pos.y, other.pos.x, other.pos.y);
                        if (other !== this && d < perceptionRadius) {
                            steering.add(other.vel);
                            total++;
                        }
                    }
                    if (total > 0) {
                        steering.div(total);
                        steering.setMag(this.maxSpeed);
                        steering.sub(this.vel);
                        steering.limit(this.maxForce);
                    }
                    return steering;
                }
                cohesion(boids) {
                    let perceptionRadius = 50;
                    let steering = this.p.createVector();
                    let total = 0;
                    for (let other of boids) {
                        let d = this.p.dist(this.pos.x, this.pos.y, other.pos.x, other.pos.y);
                        if (other !== this && d < perceptionRadius) {
                            steering.add(other.pos);
                            total++;
                        }
                    }
                    if (total > 0) {
                        steering.div(total);
                        steering.sub(this.pos);
                        steering.setMag(this.maxSpeed);
                        steering.sub(this.vel);
                        steering.limit(this.maxForce);
                    }
                    return steering;
                }
                separation(boids) {
                    let perceptionRadius = 25;
                    let steering = this.p.createVector();
                    let total = 0;
                    for (let other of boids) {
                        let d = this.p.dist(this.pos.x, this.pos.y, other.pos.x, other.pos.y);
                        if (other !== this && d < perceptionRadius) {
                            let diff = p5.Vector.sub(this.pos, other.pos);
                            diff.div(d * d);
                            steering.add(diff);
                            total++;
                        }
                    }
                    if (total > 0) {
                        steering.div(total);
                        steering.setMag(this.maxSpeed);
                        steering.sub(this.vel);
                        steering.limit(this.maxForce);
                    }
                    return steering;
                }
                update() {
                    this.pos.add(this.vel);
                    this.vel.add(this.acc);
                    this.vel.limit(this.maxSpeed);
                    this.acc.mult(0);

                    if (this.pos.x > this.p.width) this.pos.x = 0;
                    if (this.pos.x < 0) this.pos.x = this.p.width;
                    if (this.pos.y > this.p.height) this.pos.y = 0;
                    if (this.pos.y < 0) this.pos.y = this.p.height;
                }
                show() {
                    this.p.strokeWeight(6);
                    this.p.stroke(100, 150, 255);
                    this.p.point(this.pos.x, this.pos.y);
                }
            }
        });

        // Sketch 23: Reaction Diffusion
        new p5(function(p) {
            let grid;
            let next;
            let dA = 1.0;
            let dB = 0.5;
            let feed = 0.055;
            let k = 0.062;

            p.setup = function() {
                p.createCanvas(280, 300).parent('sketch23');
                p.pixelDensity(1);
                grid = [];
                next = [];
                for (let x = 0; x < p.width; x++) {
                    grid[x] = [];
                    next[x] = [];
                    for (let y = 0; y < p.height; y++) {
                        grid[x][y] = {a: 1, b: 0};
                        next[x][y] = {a: 1, b: 0};
                    }
                }

                // Seed center
                for (let i = 120; i < 160; i++) {
                    for (let j = 130; j < 170; j++) {
                        if (i < p.width && j < p.height) {
                            grid[i][j].b = 1;
                        }
                    }
                }
            };

            p.draw = function() {
                for (let x = 1; x < p.width - 1; x++) {
                    for (let y = 1; y < p.height - 1; y++) {
                        let a = grid[x][y].a;
                        let b = grid[x][y].b;

                        next[x][y].a = a +
                            (dA * laplaceA(x, y)) -
                            (a * b * b) +
                            (feed * (1 - a));
                        next[x][y].b = b +
                            (dB * laplaceB(x, y)) +
                            (a * b * b) -
                            ((k + feed) * b);

                        next[x][y].a = p.constrain(next[x][y].a, 0, 1);
                        next[x][y].b = p.constrain(next[x][y].b, 0, 1);
                    }
                }

                p.loadPixels();
                for (let x = 0; x < p.width; x++) {
                    for (let y = 0; y < p.height; y++) {
                        let pix = (x + y * p.width) * 4;
                        let a = next[x][y].a;
                        let b = next[x][y].b;
                        let c = p.floor((a - b) * 255);
                        c = p.constrain(c, 0, 255);
                        p.pixels[pix + 0] = c;
                        p.pixels[pix + 1] = c;
                        p.pixels[pix + 2] = c;
                        p.pixels[pix + 3] = 255;
                    }
                }
                p.updatePixels();

                let temp = grid;
                grid = next;
                next = temp;
            };

            function laplaceA(x, y) {
                let sum = 0;
                sum += grid[x][y].a * -1;
                sum += grid[x-1][y].a * 0.2;
                sum += grid[x+1][y].a * 0.2;
                sum += grid[x][y-1].a * 0.2;
                sum += grid[x][y+1].a * 0.2;
                sum += grid[x-1][y-1].a * 0.05;
                sum += grid[x+1][y-1].a * 0.05;
                sum += grid[x-1][y+1].a * 0.05;
                sum += grid[x+1][y+1].a * 0.05;
                return sum;
            }

            function laplaceB(x, y) {
                let sum = 0;
                sum += grid[x][y].b * -1;
                sum += grid[x-1][y].b * 0.2;
                sum += grid[x+1][y].b * 0.2;
                sum += grid[x][y-1].b * 0.2;
                sum += grid[x][y+1].b * 0.2;
                sum += grid[x-1][y-1].b * 0.05;
                sum += grid[x+1][y-1].b * 0.05;
                sum += grid[x-1][y+1].b * 0.05;
                sum += grid[x+1][y+1].b * 0.05;
                return sum;
            }
        });

        // Sketch 24: Attraction Points
        new p5(function(p) {
            let movers = [];
            let attractor;

            p.setup = function() {
                p.createCanvas(280, 300).parent('sketch24');
                attractor = p.createVector(p.width / 2, p.height / 2);
                for (let i = 0; i < 30; i++) {
                    movers.push(new Mover24(p));
                }
            };

            p.draw = function() {
                p.background(20);

                attractor.x = p.width / 2 + p.sin(p.frameCount * 0.02) * 80;
                attractor.y = p.height / 2 + p.cos(p.frameCount * 0.03) * 80;

                p.fill(255, 100, 100);
                p.noStroke();
                p.circle(attractor.x, attractor.y, 20);

                for (let mover of movers) {
                    let force = p5.Vector.sub(attractor, mover.pos);
                    force.setMag(0.5);
                    mover.applyForce(force);
                    mover.update();
                    mover.show();
                }
            };

            class Mover24 {
                constructor(p) {
                    this.p = p;
                    this.pos = p.createVector(p.random(p.width), p.random(p.height));
                    this.vel = p.createVector(0, 0);
                    this.acc = p.createVector(0, 0);
                }
                applyForce(force) {
                    this.acc.add(force);
                }
                update() {
                    this.vel.add(this.acc);
                    this.vel.limit(5);
                    this.pos.add(this.vel);
                    this.acc.mult(0);

                    if (this.pos.x > this.p.width) this.pos.x = 0;
                    if (this.pos.x < 0) this.pos.x = this.p.width;
                    if (this.pos.y > this.p.height) this.pos.y = 0;
                    if (this.pos.y < 0) this.pos.y = this.p.height;
                }
                show() {
                    this.p.fill(100, 150, 255);
                    this.p.noStroke();
                    this.p.circle(this.pos.x, this.pos.y, 8);
                }
            }
        });

        // Sketch 25: Cellular Automata
        new p5(function(p) {
            let cells;
            let w = 5;
            let cols, rows;
            let ruleset = [0, 1, 0, 1, 1, 0, 1, 0];
            let generation = 0;

            p.setup = function() {
                p.createCanvas(280, 300).parent('sketch25');
                cols = p.floor(p.width / w);
                rows = p.floor(p.height / w);
                cells = Array(cols).fill(0);
                cells[p.floor(cols / 2)] = 1;
                p.background(255);
            };

            p.draw = function() {
                for (let i = 0; i < cols; i++) {
                    if (cells[i] === 1) {
                        p.fill(0);
                    } else {
                        p.fill(255);
                    }
                    p.noStroke();
                    p.square(i * w, generation * w, w);
                }

                let nextCells = Array(cols).fill(0);
                for (let i = 1; i < cols - 1; i++) {
                    let left = cells[i - 1];
                    let me = cells[i];
                    let right = cells[i + 1];
                    nextCells[i] = rules(left, me, right);
                }

                cells = nextCells;
                generation++;

                if (generation > rows) {
                    p.noLoop();
                }
            };

            function rules(a, b, c) {
                let s = "" + a + b + c;
                let index = parseInt(s, 2);
                return ruleset[index];
            }
        });

        // Sketch 26: Fourier Transform (Drawing)
        new p5(function(p) {
            let time = 0;
            let wave = [];
            let path = [];

            p.setup = function() {
                p.createCanvas(280, 300).parent('sketch26');
            };

            p.draw = function() {
                p.background(0);
                p.translate(p.width / 2, p.height / 2);

                let x = 0;
                let y = 0;

                for (let i = 0; i < 5; i++) {
                    let prevx = x;
                    let prevy = y;

                    let n = i * 2 + 1;
                    let radius = 50 * (4 / (n * p.PI));
                    x += radius * p.cos(n * time);
                    y += radius * p.sin(n * time);

                    p.stroke(255, 100);
                    p.noFill();
                    p.circle(prevx, prevy, radius * 2);

                    p.stroke(255);
                    p.line(prevx, prevy, x, y);
                }

                wave.unshift(y);

                p.translate(120, 0);
                p.line(0, y, 10, wave[0]);

                p.beginShape();
                p.noFill();
                p.stroke(255);
                for (let i = 0; i < wave.length; i++) {
                    p.vertex(i, wave[i]);
                }
                p.endShape();

                time += 0.05;

                if (wave.length > 150) {
                    wave.pop();
                }
            };
        });

        // Sketch 27: Voronoi Diagram
        new p5(function(p) {
            let points = [];

            p.setup = function() {
                p.createCanvas(280, 300).parent('sketch27');
                for (let i = 0; i < 20; i++) {
                    points.push({
                        x: p.random(p.width),
                        y: p.random(p.height),
                        vx: p.random(-1, 1),
                        vy: p.random(-1, 1),
                        color: p.color(p.random(255), p.random(255), p.random(255))
                    });
                }
            };

            p.draw = function() {
                p.loadPixels();
                for (let x = 0; x < p.width; x++) {
                    for (let y = 0; y < p.height; y++) {
                        let minDist = Infinity;
                        let closestPoint;

                        for (let point of points) {
                            let d = p.dist(x, y, point.x, point.y);
                            if (d < minDist) {
                                minDist = d;
                                closestPoint = point;
                            }
                        }

                        let index = (x + y * p.width) * 4;
                        p.pixels[index] = p.red(closestPoint.color);
                        p.pixels[index + 1] = p.green(closestPoint.color);
                        p.pixels[index + 2] = p.blue(closestPoint.color);
                        p.pixels[index + 3] = 255;
                    }
                }
                p.updatePixels();

                for (let point of points) {
                    point.x += point.vx;
                    point.y += point.vy;

                    if (point.x < 0 || point.x > p.width) point.vx *= -1;
                    if (point.y < 0 || point.y > p.height) point.vy *= -1;

                    p.fill(0);
                    p.noStroke();
                    p.circle(point.x, point.y, 5);
                }
            };
        });

        // Sketch 28: Chaotic Pendulum
        new p5(function(p) {
            let r1 = 100;
            let r2 = 100;
            let m1 = 20;
            let m2 = 20;
            let a1 = p.PI / 2;
            let a2 = p.PI / 2;
            let a1_v = 0;
            let a2_v = 0;
            let g = 1;
            let trail = [];

            p.setup = function() {
                p.createCanvas(280, 300).parent('sketch28');
            };

            p.draw = function() {
                p.background(255, 10);
                p.translate(p.width / 2, 50);

                let num1 = -g * (2 * m1 + m2) * p.sin(a1);
                let num2 = -m2 * g * p.sin(a1 - 2 * a2);
                let num3 = -2 * p.sin(a1 - a2) * m2;
                let num4 = a2_v * a2_v * r2 + a1_v * a1_v * r1 * p.cos(a1 - a2);
                let den = r1 * (2 * m1 + m2 - m2 * p.cos(2 * a1 - 2 * a2));
                let a1_a = (num1 + num2 + num3 * num4) / den;

                num1 = 2 * p.sin(a1 - a2);
                num2 = a1_v * a1_v * r1 * (m1 + m2);
                num3 = g * (m1 + m2) * p.cos(a1);
                num4 = a2_v * a2_v * r2 * m2 * p.cos(a1 - a2);
                den = r2 * (2 * m1 + m2 - m2 * p.cos(2 * a1 - 2 * a2));
                let a2_a = (num1 * (num2 + num3 + num4)) / den;

                let x1 = r1 * p.sin(a1);
                let y1 = r1 * p.cos(a1);
                let x2 = x1 + r2 * p.sin(a2);
                let y2 = y1 + r2 * p.cos(a2);

                p.stroke(0);
                p.strokeWeight(2);
                p.line(0, 0, x1, y1);
                p.line(x1, y1, x2, y2);

                p.fill(100);
                p.circle(x1, y1, m1);
                p.fill(200, 50, 50);
                p.circle(x2, y2, m2);

                a1_v += a1_a;
                a2_v += a2_a;
                a1 += a1_v;
                a2 += a2_v;

                a1_v *= 0.99;
                a2_v *= 0.99;

                trail.push({x: x2, y: y2});
                if (trail.length > 100) {
                    trail.shift();
                }

                p.stroke(255, 0, 0, 100);
                p.strokeWeight(1);
                p.noFill();
                p.beginShape();
                for (let pt of trail) {
                    p.vertex(pt.x, pt.y);
                }
                p.endShape();
            };
        });

        // Sketch 29: Lissajous Curves
        new p5(function(p) {
            let angle = 0;
            let trail = [];

            p.setup = function() {
                p.createCanvas(280, 300).parent('sketch29');
            };

            p.draw = function() {
                p.background(0, 10);
                p.translate(p.width / 2, p.height / 2);

                let a = 3;
                let b = 2;
                let x = p.sin(a * angle) * 100;
                let y = p.sin(b * angle) * 100;

                trail.push({x, y});
                if (trail.length > 200) {
                    trail.shift();
                }

                p.stroke(100, 200, 255);
                p.strokeWeight(2);
                p.noFill();
                p.beginShape();
                for (let pt of trail) {
                    p.vertex(pt.x, pt.y);
                }
                p.endShape();

                p.fill(255);
                p.noStroke();
                p.circle(x, y, 8);

                angle += 0.02;
            };
        });

        // Sketch 30: Strange Attractor (Lorenz)
        new p5(function(p) {
            let x = 0.01;
            let y = 0;
            let z = 0;
            let a = 10;
            let b = 28;
            let c = 8.0 / 3.0;
            let points = [];

            p.setup = function() {
                p.createCanvas(280, 300, p.WEBGL).parent('sketch30');
                p.colorMode(p.HSB);
            };

            p.draw = function() {
                p.background(0);

                let dt = 0.01;
                let dx = (a * (y - x)) * dt;
                let dy = (x * (b - z) - y) * dt;
                let dz = (x * y - c * z) * dt;

                x += dx;
                y += dy;
                z += dz;

                points.push({x, y, z});
                if (points.length > 500) {
                    points.shift();
                }

                p.rotateY(p.frameCount * 0.003);
                p.scale(3);

                p.noFill();
                p.beginShape();
                for (let i = 0; i < points.length; i++) {
                    let pt = points[i];
                    p.stroke(i % 360, 255, 255);
                    p.vertex(pt.x, pt.y, pt.z);
                }
                p.endShape();
            };
        });

        // Sketch 31: Phyllotaxis Spiral
        new p5(function(p) {
            let n = 0;
            let c = 4;

            p.setup = function() {
                p.createCanvas(280, 300).parent('sketch31');
                p.colorMode(p.HSB);
                p.background(0);
            };

            p.draw = function() {
                let a = n * 137.5;
                let r = c * p.sqrt(n);

                let x = r * p.cos(a) + p.width / 2;
                let y = r * p.sin(a) + p.height / 2;

                p.fill(n % 256, 255, 255);
                p.noStroke();
                p.circle(x, y, 4);

                n++;

                if (r > p.width / 2) {
                    p.background(0);
                    n = 0;
                }
            };
        });

        // Sketch 32: Metaballs
        new p5(function(p) {
            let blobs = [];

            p.setup = function() {
                p.createCanvas(280, 300).parent('sketch32');
                for (let i = 0; i < 5; i++) {
                    blobs.push({
                        x: p.random(p.width),
                        y: p.random(p.height),
                        r: p.random(30, 60),
                        vx: p.random(-1, 1),
                        vy: p.random(-1, 1)
                    });
                }
            };

            p.draw = function() {
                p.loadPixels();
                for (let x = 0; x < p.width; x++) {
                    for (let y = 0; y < p.height; y++) {
                        let sum = 0;
                        for (let blob of blobs) {
                            let d = p.dist(x, y, blob.x, blob.y);
                            sum += (blob.r * blob.r) / (d * d);
                        }

                        let index = (x + y * p.width) * 4;
                        if (sum > 1) {
                            p.pixels[index] = 100;
                            p.pixels[index + 1] = 200;
                            p.pixels[index + 2] = 255;
                        } else {
                            p.pixels[index] = 20;
                            p.pixels[index + 1] = 20;
                            p.pixels[index + 2] = 40;
                        }
                        p.pixels[index + 3] = 255;
                    }
                }
                p.updatePixels();

                for (let blob of blobs) {
                    blob.x += blob.vx;
                    blob.y += blob.vy;

                    if (blob.x < 0 || blob.x > p.width) blob.vx *= -1;
                    if (blob.y < 0 || blob.y > p.height) blob.vy *= -1;
                }
            };
        });

        // Sketch 33: Morphing Shapes
        new p5(function(p) {
            let angle = 0;

            p.setup = function() {
                p.createCanvas(280, 300).parent('sketch33');
            };

            p.draw = function() {
                p.background(240);
                p.translate(p.width / 2, p.height / 2);

                p.fill(100, 150, 255, 150);
                p.noStroke();

                p.beginShape();
                for (let a = 0; a < p.TWO_PI; a += 0.1) {
                    let xoff = p.map(p.cos(a + angle), -1, 1, 0, 1);
                    let yoff = p.map(p.sin(a + angle), -1, 1, 0, 1);
                    let r = p.map(p.noise(xoff, yoff, angle), 0, 1, 50, 150);
                    let x = r * p.cos(a);
                    let y = r * p.sin(a);
                    p.vertex(x, y);
                }
                p.endShape(p.CLOSE);

                angle += 0.01;
            };
        });

        // Sketch 34: Plasma Effect
        new p5(function(p) {
            let time = 0;

            p.setup = function() {
                p.createCanvas(280, 300).parent('sketch34');
                p.colorMode(p.HSB);
            };

            p.draw = function() {
                p.loadPixels();
                for (let x = 0; x < p.width; x++) {
                    for (let y = 0; y < p.height; y++) {
                        let value = p.sin(x * 0.05 + time) +
                                   p.sin(y * 0.05 + time) +
                                   p.sin((x + y) * 0.05 + time) +
                                   p.sin(p.sqrt(x * x + y * y) * 0.05 + time);

                        let hue = p.map(value, -4, 4, 0, 360);
                        let index = (x + y * p.width) * 4;

                        let c = p.color(hue, 255, 255);
                        p.pixels[index] = p.red(c);
                        p.pixels[index + 1] = p.green(c);
                        p.pixels[index + 2] = p.blue(c);
                        p.pixels[index + 3] = 255;
                    }
                }
                p.updatePixels();
                time += 0.05;
            };
        });

        // Sketch 35: Kaleidoscope
        new p5(function(p) {
            let symmetry = 8;
            let angle = 360 / symmetry;

            p.setup = function() {
                p.createCanvas(280, 300).parent('sketch35');
                p.angleMode(p.DEGREES);
                p.background(0);
            };

            p.draw = function() {
                p.translate(p.width / 2, p.height / 2);

                if (p.frameCount % 2 === 0) {
                    let mx = p.mouseX - p.width / 2;
                    let my = p.mouseY - p.height / 2;
                    let pmx = p.pmouseX - p.width / 2;
                    let pmy = p.pmouseY - p.height / 2;

                    if (p.dist(pmx, pmy, mx, my) > 0) {
                        for (let i = 0; i < symmetry; i++) {
                            p.rotate(angle);
                            p.stroke(p.random(255), p.random(255), p.random(255));
                            p.strokeWeight(2);
                            p.line(pmx, pmy, mx, my);
                            p.push();
                            p.scale(1, -1);
                            p.line(pmx, pmy, mx, my);
                            p.pop();
                        }
                    }
                } else {
                    // Auto-generate pattern
                    let r = p.random(50, 100);
                    let ang = p.frameCount * 5;
                    let x = r * p.cos(ang);
                    let y = r * p.sin(ang);
                    let px = r * p.cos(ang - 5);
                    let py = r * p.sin(ang - 5);

                    for (let i = 0; i < symmetry; i++) {
                        p.rotate(angle);
                        p.stroke(p.frameCount % 255, 200, 255, 100);
                        p.strokeWeight(1);
                        p.line(px, py, x, y);
                        p.push();
                        p.scale(1, -1);
                        p.line(px, py, x, y);
                        p.pop();
                    }
                }
            };
        });

        // Sketch 36: Differential Growth
        new p5(function(p) {
            let nodes = [];
            let maxNodes = 300;

            p.setup = function() {
                p.createCanvas(280, 300).parent('sketch36');
                let radius = 50;
                let numNodes = 20;
                for (let i = 0; i < numNodes; i++) {
                    let angle = p.map(i, 0, numNodes, 0, p.TWO_PI);
                    let x = p.width / 2 + radius * p.cos(angle);
                    let y = p.height / 2 + radius * p.sin(angle);
                    nodes.push(new Node36(p, x, y));
                }
            };

            p.draw = function() {
                p.background(250);

                for (let node of nodes) {
                    node.attract(nodes);
                    node.repel(nodes);
                    node.update();
                }

                if (nodes.length < maxNodes && p.frameCount % 3 === 0) {
                    let maxDist = 0;
                    let splitIndex = 0;

                    for (let i = 0; i < nodes.length; i++) {
                        let next = (i + 1) % nodes.length;
                        let d = p.dist(nodes[i].x, nodes[i].y, nodes[next].x, nodes[next].y);
                        if (d > maxDist) {
                            maxDist = d;
                            splitIndex = i;
                        }
                    }

                    if (maxDist > 10) {
                        let next = (splitIndex + 1) % nodes.length;
                        let newX = (nodes[splitIndex].x + nodes[next].x) / 2;
                        let newY = (nodes[splitIndex].y + nodes[next].y) / 2;
                        nodes.splice(next, 0, new Node36(p, newX, newY));
                    }
                }

                p.stroke(100, 150, 255);
                p.strokeWeight(2);
                p.noFill();
                p.beginShape();
                for (let node of nodes) {
                    p.vertex(node.x, node.y);
                }
                p.endShape(p.CLOSE);
            };

            class Node36 {
                constructor(p, x, y) {
                    this.p = p;
                    this.x = x;
                    this.y = y;
                    this.vx = 0;
                    this.vy = 0;
                }
                attract(nodes) {
                    let index = nodes.indexOf(this);
                    let prev = nodes[(index - 1 + nodes.length) % nodes.length];
                    let next = nodes[(index + 1) % nodes.length];

                    this.vx += (prev.x - this.x) * 0.01;
                    this.vy += (prev.y - this.y) * 0.01;
                    this.vx += (next.x - this.x) * 0.01;
                    this.vy += (next.y - this.y) * 0.01;
                }
                repel(nodes) {
                    for (let other of nodes) {
                        if (other === this) continue;
                        let d = this.p.dist(this.x, this.y, other.x, other.y);
                        if (d < 20 && d > 0) {
                            let force = (20 - d) / 20;
                            this.vx += (this.x - other.x) / d * force * 0.5;
                            this.vy += (this.y - other.y) / d * force * 0.5;
                        }
                    }
                }
                update() {
                    this.x += this.vx;
                    this.y += this.vy;
                    this.vx *= 0.9;
                    this.vy *= 0.9;
                }
            }
        });

        // Sketch 37: Spiral Galaxy
        new p5(function(p) {
            let stars = [];

            p.setup = function() {
                p.createCanvas(280, 300).parent('sketch37');
                p.colorMode(p.HSB);
                for (let i = 0; i < 1000; i++) {
                    stars.push(new Star37(p));
                }
            };

            p.draw = function() {
                p.background(0, 20);
                p.translate(p.width / 2, p.height / 2);

                for (let star of stars) {
                    star.update();
                    star.show();
                }
            };

            class Star37 {
                constructor(p) {
                    this.p = p;
                    this.angle = p.random(p.TWO_PI);
                    this.radius = p.random(10, 120);
                    this.speed = p.map(this.radius, 10, 120, 0.02, 0.001);
                    this.hue = p.map(this.radius, 10, 120, 180, 300);
                }
                update() {
                    this.angle += this.speed;
                }
                show() {
                    let spiralFactor = this.angle * 0.5;
                    let x = (this.radius + spiralFactor) * this.p.cos(this.angle);
                    let y = (this.radius + spiralFactor) * this.p.sin(this.angle);

                    this.p.stroke(this.hue, 255, 255);
                    this.p.strokeWeight(2);
                    this.p.point(x, y);
                }
            }
        });

        // Sketch 38: Chromatic Waves
        new p5(function(p) {
            let yoff = 0;

            p.setup = function() {
                p.createCanvas(280, 300).parent('sketch38');
                p.colorMode(p.HSB);
            };

            p.draw = function() {
                p.background(0);

                for (let y = 0; y < p.height; y += 5) {
                    let xoff = 0;
                    p.noFill();
                    p.beginShape();
                    for (let x = 0; x <= p.width; x += 5) {
                        let wave = p.noise(xoff, yoff) * 50;
                        let hue = p.map(y, 0, p.height, 0, 360);
                        p.stroke(hue, 255, 255);
                        p.strokeWeight(2);
                        p.vertex(x, y + wave);
                        xoff += 0.1;
                    }
                    p.endShape();
                    yoff += 0.01;
                }
            };
        });

        // Sketch 39: Magnetic Field
        new p5(function(p) {
            let particles = [];

            p.setup = function() {
                p.createCanvas(280, 300).parent('sketch39');
                for (let i = 0; i < 200; i++) {
                    particles.push(new MagParticle(p));
                }
            };

            p.draw = function() {
                p.background(0, 10);

                let m1 = {x: p.width * 0.3, y: p.height / 2};
                let m2 = {x: p.width * 0.7, y: p.height / 2};

                p.fill(255, 0, 0);
                p.noStroke();
                p.circle(m1.x, m1.y, 20);
                p.fill(0, 0, 255);
                p.circle(m2.x, m2.y, 20);

                for (let particle of particles) {
                    particle.applyField(m1, m2);
                    particle.update();
                    particle.show();
                }
            };

            class MagParticle {
                constructor(p) {
                    this.p = p;
                    this.pos = p.createVector(p.random(p.width), p.random(p.height));
                    this.vel = p.createVector(0, 0);
                }
                applyField(m1, m2) {
                    let f1 = this.p.createVector(m1.x - this.pos.x, m1.y - this.pos.y);
                    let d1 = f1.mag();
                    f1.normalize().mult(50 / (d1 * d1));

                    let f2 = this.p.createVector(m2.x - this.pos.x, m2.y - this.pos.y);
                    let d2 = f2.mag();
                    f2.normalize().mult(-50 / (d2 * d2));

                    this.vel.add(f1);
                    this.vel.add(f2);
                }
                update() {
                    this.pos.add(this.vel);
                    this.vel.mult(0.95);

                    if (this.pos.x < 0 || this.pos.x > this.p.width ||
                        this.pos.y < 0 || this.pos.y > this.p.height) {
                        this.pos.set(this.p.random(this.p.width), this.p.random(this.p.height));
                        this.vel.set(0, 0);
                    }
                }
                show() {
                    this.p.stroke(100, 200, 255, 200);
                    this.p.strokeWeight(2);
                    this.p.point(this.pos.x, this.pos.y);
                }
            }
        });

        // Sketch 40: Generative Typography
        new p5(function(p) {
            let particles = [];
            let font;
            let points;

            p.setup = function() {
                p.createCanvas(280, 300).parent('sketch40');

                // Create text points
                points = [];
                let txt = "P5";
                p.textSize(120);
                p.textAlign(p.CENTER, p.CENTER);

                // Manually create points for text outline
                let spacing = 3;
                for (let x = 0; x < p.width; x += spacing) {
                    for (let y = 0; y < p.height; y += spacing) {
                        // Sample the text
                        if (x > p.width * 0.2 && x < p.width * 0.8 &&
                            y > p.height * 0.25 && y < p.height * 0.75) {
                            if (p.random(1) < 0.3) {
                                points.push(p.createVector(x, y));
                            }
                        }
                    }
                }

                for (let i = 0; i < 300; i++) {
                    particles.push(new TypeParticle(p, points));
                }
            };

            p.draw = function() {
                p.background(20);

                for (let particle of particles) {
                    particle.behaviors();
                    particle.update();
                    particle.show();
                }

                // Draw actual text
                p.fill(255, 20);
                p.noStroke();
                p.textSize(120);
                p.textAlign(p.CENTER, p.CENTER);
                p.text("P5", p.width / 2, p.height / 2);
            };

            class TypeParticle {
                constructor(p, points) {
                    this.p = p;
                    this.pos = p.createVector(p.random(p.width), p.random(p.height));
                    this.target = p.random(points);
                    this.vel = p.createVector();
                    this.acc = p.createVector();
                    this.maxSpeed = 4;
                }
                behaviors() {
                    let arrive = this.arrive(this.target);
                    this.acc.add(arrive);
                }
                arrive(target) {
                    let desired = p5.Vector.sub(target, this.pos);
                    let d = desired.mag();
                    let speed = this.maxSpeed;
                    if (d < 100) {
                        speed = this.p.map(d, 0, 100, 0, this.maxSpeed);
                    }
                    desired.setMag(speed);
                    let steer = p5.Vector.sub(desired, this.vel);
                    return steer;
                }
                update() {
                    this.pos.add(this.vel);
                    this.vel.add(this.acc);
                    this.acc.mult(0);
                }
                show() {
                    this.p.stroke(100, 200, 255);
                    this.p.strokeWeight(4);
                    this.p.point(this.pos.x, this.pos.y);
                }
            }
        });
    </script>
    <!-- Load Navigation JavaScript -->
    <script src="../assets/js/navigation.js"></script>
</body>
</html>
