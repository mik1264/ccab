<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Monty Hall Problem | Surprising Mathematical Phenomena</title>
    <link href="https://fonts.googleapis.com/css2?family=Lora:wght@400;500;600;700&family=Nunito:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --sage: #8A9A5B;
            --moss: #606C38;
            --earth: #DDA15E;
            --cream: #FEFAE0;
            --terracotta: #BC6C25;
            --dark-moss: #3d4423;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Nunito', sans-serif;
            background: linear-gradient(135deg, var(--cream) 0%, #F4F1DE 50%, #EDE8D5 100%);
            min-height: 100vh;
            color: var(--dark-moss);
            overflow-x: hidden;
        }

        .organic-shape {
            position: fixed;
            border-radius: 30% 70% 70% 30% / 30% 30% 70% 70%;
            opacity: 0.1;
            z-index: 0;
            animation: morph 30s ease-in-out infinite;
        }

        .shape-1 {
            width: 600px;
            height: 600px;
            background: var(--sage);
            top: -200px;
            right: -200px;
        }

        .shape-2 {
            width: 400px;
            height: 400px;
            background: var(--earth);
            bottom: -100px;
            left: -100px;
            animation-delay: -10s;
        }

        @keyframes morph {
            0%, 100% { border-radius: 30% 70% 70% 30% / 30% 30% 70% 70%; }
            25% { border-radius: 58% 42% 75% 25% / 76% 46% 54% 24%; }
            50% { border-radius: 50% 50% 33% 67% / 55% 27% 73% 45%; }
            75% { border-radius: 33% 67% 58% 42% / 63% 68% 32% 37%; }
        }

        .back-link {
            position: fixed;
            top: 20px;
            left: 20px;
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 12px 20px;
            background: rgba(255,255,255,0.7);
            backdrop-filter: blur(10px);
            border-radius: 50px;
            text-decoration: none;
            color: var(--moss);
            font-weight: 600;
            transition: all 0.3s ease;
            z-index: 100;
        }

        .back-link:hover {
            background: var(--moss);
            color: white;
            transform: translateX(-5px);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 80px 20px 40px;
            position: relative;
            z-index: 1;
        }

        h1 {
            font-family: 'Lora', serif;
            font-size: clamp(2rem, 5vw, 3rem);
            color: var(--moss);
            text-align: center;
            margin-bottom: 10px;
        }

        .subtitle {
            text-align: center;
            font-size: 1.1rem;
            color: var(--dark-moss);
            opacity: 0.8;
            margin-bottom: 30px;
            max-width: 700px;
            margin-left: auto;
            margin-right: auto;
        }

        .game-section {
            background: rgba(255,255,255,0.7);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            border: 1px solid rgba(138, 154, 91, 0.2);
        }

        .stage-indicator {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 30px;
        }

        .stage {
            display: flex;
            align-items: center;
            gap: 10px;
            opacity: 0.4;
            transition: opacity 0.3s;
        }

        .stage.active {
            opacity: 1;
        }

        .stage-number {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: var(--sage);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        .stage.active .stage-number {
            background: var(--moss);
        }

        .message {
            text-align: center;
            font-size: 1.3rem;
            margin-bottom: 30px;
            font-family: 'Lora', serif;
            color: var(--moss);
            min-height: 60px;
        }

        .doors-container {
            display: flex;
            justify-content: center;
            gap: 40px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .door {
            width: 160px;
            height: 240px;
            perspective: 1000px;
            cursor: pointer;
        }

        .door-inner {
            width: 100%;
            height: 100%;
            position: relative;
            transform-style: preserve-3d;
            transition: transform 0.8s;
        }

        .door.open .door-inner {
            transform: rotateY(-120deg);
        }

        .door-front, .door-back {
            width: 100%;
            height: 100%;
            position: absolute;
            backface-visibility: hidden;
            border-radius: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .door-front {
            background: linear-gradient(180deg, #8B4513 0%, #654321 100%);
            border: 8px solid #5D3A1A;
            box-shadow: inset 0 0 30px rgba(0,0,0,0.3);
        }

        .door-number {
            font-size: 3rem;
            color: #D4AF37;
            font-family: 'Lora', serif;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }

        .door-handle {
            width: 20px;
            height: 40px;
            background: #D4AF37;
            border-radius: 10px;
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
        }

        .door-back {
            background: linear-gradient(135deg, var(--cream) 0%, #F5E6C8 100%);
            transform: rotateY(180deg);
            font-size: 80px;
        }

        .door.selected .door-front {
            box-shadow: 0 0 30px var(--earth), inset 0 0 30px rgba(0,0,0,0.3);
            border-color: var(--earth);
        }

        .door.disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .door:not(.disabled):not(.open):hover .door-front {
            box-shadow: 0 0 20px rgba(212, 175, 55, 0.5), inset 0 0 30px rgba(0,0,0,0.3);
        }

        .action-buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
        }

        .btn {
            padding: 15px 40px;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-family: 'Nunito', sans-serif;
            font-size: 1.1rem;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .btn-switch {
            background: linear-gradient(135deg, var(--earth), var(--terracotta));
            color: white;
        }

        .btn-stay {
            background: linear-gradient(135deg, var(--sage), var(--moss));
            color: white;
        }

        .btn-reset {
            background: transparent;
            border: 2px solid var(--moss);
            color: var(--moss);
        }

        .btn:not(:disabled):hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .stat-card {
            background: rgba(254, 250, 224, 0.8);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
        }

        .stat-label {
            font-size: 0.9rem;
            color: var(--dark-moss);
            opacity: 0.8;
            margin-bottom: 5px;
        }

        .stat-value {
            font-family: 'Lora', serif;
            font-size: 2rem;
            color: var(--moss);
            font-weight: 700;
        }

        .stat-percent {
            font-size: 0.9rem;
            color: var(--terracotta);
            margin-top: 5px;
        }

        .result-banner {
            text-align: center;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            font-size: 1.5rem;
            font-family: 'Lora', serif;
            animation: slideIn 0.5s ease;
        }

        .result-banner.win {
            background: linear-gradient(135deg, #4CAF50, #45a049);
            color: white;
        }

        .result-banner.lose {
            background: linear-gradient(135deg, #f44336, #d32f2f);
            color: white;
        }

        @keyframes slideIn {
            from { transform: translateY(-20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .explanation-section {
            margin-top: 40px;
            background: rgba(255,255,255,0.7);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            border: 1px solid rgba(138, 154, 91, 0.2);
        }

        .explanation-section h2 {
            font-family: 'Lora', serif;
            color: var(--moss);
            margin-bottom: 20px;
        }

        .probability-diagram {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin: 30px 0;
        }

        @media (max-width: 700px) {
            .probability-diagram {
                grid-template-columns: 1fr;
            }
        }

        .strategy-box {
            background: rgba(254, 250, 224, 0.8);
            border-radius: 15px;
            padding: 25px;
        }

        .strategy-box h3 {
            font-family: 'Lora', serif;
            color: var(--moss);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .probability-visual {
            display: flex;
            gap: 5px;
            margin: 15px 0;
        }

        .prob-segment {
            height: 40px;
            border-radius: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        .prob-win {
            background: #4CAF50;
        }

        .prob-lose {
            background: #f44336;
        }

        .simulation-controls {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            justify-content: center;
            margin-top: 20px;
        }

        .sim-btn {
            padding: 12px 25px;
            background: var(--moss);
            color: white;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-family: 'Nunito', sans-serif;
            font-weight: 600;
            transition: all 0.3s;
        }

        .sim-btn:hover {
            background: var(--dark-moss);
            transform: translateY(-2px);
        }

        .highlight {
            background: linear-gradient(90deg, var(--earth), var(--terracotta));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-weight: 700;
        }
    </style>
</head>
<body>
    <div class="organic-shape shape-1"></div>
    <div class="organic-shape shape-2"></div>

    <a href="index.html" class="back-link">
        <span>&larr;</span>
        <span>Back to Surprising</span>
    </a>

    <div class="container">
        <h1>The Monty Hall Problem</h1>
        <p class="subtitle">A probability puzzle so counterintuitive that even mathematicians got it wrong. Should you switch doors?</p>

        <div class="game-section">
            <div class="stage-indicator">
                <div class="stage active" id="stage1">
                    <span class="stage-number">1</span>
                    <span>Pick a door</span>
                </div>
                <div class="stage" id="stage2">
                    <span class="stage-number">2</span>
                    <span>Door revealed</span>
                </div>
                <div class="stage" id="stage3">
                    <span class="stage-number">3</span>
                    <span>Switch or Stay?</span>
                </div>
            </div>

            <div class="message" id="message">
                Behind one door is a car. Behind the other two are goats. Pick a door!
            </div>

            <div id="resultBanner"></div>

            <div class="doors-container" id="doors">
                <div class="door" data-door="0">
                    <div class="door-inner">
                        <div class="door-front">
                            <div class="door-number">1</div>
                            <div class="door-handle"></div>
                        </div>
                        <div class="door-back" id="prize0"></div>
                    </div>
                </div>
                <div class="door" data-door="1">
                    <div class="door-inner">
                        <div class="door-front">
                            <div class="door-number">2</div>
                            <div class="door-handle"></div>
                        </div>
                        <div class="door-back" id="prize1"></div>
                    </div>
                </div>
                <div class="door" data-door="2">
                    <div class="door-inner">
                        <div class="door-front">
                            <div class="door-number">3</div>
                            <div class="door-handle"></div>
                        </div>
                        <div class="door-back" id="prize2"></div>
                    </div>
                </div>
            </div>

            <div class="action-buttons" id="actionButtons" style="display: none;">
                <button class="btn btn-switch" id="switchBtn">Switch Door</button>
                <button class="btn btn-stay" id="stayBtn">Stay</button>
            </div>

            <div class="action-buttons">
                <button class="btn btn-reset" id="resetBtn">New Game</button>
            </div>

            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-label">Games Played</div>
                    <div class="stat-value" id="totalGames">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Switched & Won</div>
                    <div class="stat-value" id="switchWins">0</div>
                    <div class="stat-percent" id="switchPercent">-</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Stayed & Won</div>
                    <div class="stat-value" id="stayWins">0</div>
                    <div class="stat-percent" id="stayPercent">-</div>
                </div>
            </div>
        </div>

        <div class="explanation-section">
            <h2>Why Switching Wins 2/3 of the Time</h2>

            <p>When this problem appeared in Marilyn vos Savant's column in 1990, she correctly stated that switching doubles your odds. Thousands of people, including many PhDs and mathematicians, wrote in to say she was wrong. But she wasn't!</p>

            <div class="probability-diagram">
                <div class="strategy-box">
                    <h3>Always Stay</h3>
                    <p>If you always stay with your first choice:</p>
                    <ul style="margin: 15px 0 15px 20px;">
                        <li>You win only if you initially picked the car</li>
                        <li>Initial probability of picking car: <strong>1/3</strong></li>
                        <li>Opening a goat door doesn't change this</li>
                    </ul>
                    <div class="probability-visual">
                        <div class="prob-segment prob-win" style="flex: 1;">Win 1/3</div>
                        <div class="prob-segment prob-lose" style="flex: 2;">Lose 2/3</div>
                    </div>
                </div>
                <div class="strategy-box">
                    <h3>Always Switch</h3>
                    <p>If you always switch:</p>
                    <ul style="margin: 15px 0 15px 20px;">
                        <li>You win if you initially picked a goat</li>
                        <li>Initial probability of picking goat: <strong>2/3</strong></li>
                        <li>Monty reveals the other goat, so switching gets the car!</li>
                    </ul>
                    <div class="probability-visual">
                        <div class="prob-segment prob-win" style="flex: 2;">Win 2/3</div>
                        <div class="prob-segment prob-lose" style="flex: 1;">Lose 1/3</div>
                    </div>
                </div>
            </div>

            <p><strong>The Key Insight:</strong> Monty's action isn't random - he <em>always</em> reveals a goat. This means the 2/3 probability that was split between the two doors you didn't pick gets concentrated onto the one remaining door when Monty opens one of them.</p>

            <p style="margin-top: 20px;">Think of it this way: picking the right door initially has a 1/3 chance. Monty's reveal doesn't change whether you picked correctly - it just reveals information. If you picked wrong (2/3 chance), switching wins. If you picked right (1/3 chance), switching loses.</p>

            <div class="simulation-controls">
                <button class="sim-btn" id="sim100Switch">Simulate 100 Switches</button>
                <button class="sim-btn" id="sim100Stay">Simulate 100 Stays</button>
                <button class="sim-btn" id="resetStats">Reset Statistics</button>
            </div>
        </div>
    </div>

    <script>
        let carDoor;
        let selectedDoor = null;
        let revealedDoor = null;
        let gameStage = 'pick'; // pick, revealed, finished
        let stats = {
            total: 0,
            switchWins: 0,
            switchTotal: 0,
            stayWins: 0,
            stayTotal: 0
        };

        function initGame() {
            carDoor = Math.floor(Math.random() * 3);
            selectedDoor = null;
            revealedDoor = null;
            gameStage = 'pick';

            // Set prizes behind doors
            for (let i = 0; i < 3; i++) {
                document.getElementById(`prize${i}`).textContent = i === carDoor ? 'üöó' : 'üêê';
            }

            // Reset door states
            document.querySelectorAll('.door').forEach(door => {
                door.classList.remove('open', 'selected', 'disabled');
            });

            // Reset UI
            document.getElementById('actionButtons').style.display = 'none';
            document.getElementById('resultBanner').innerHTML = '';
            updateMessage("Behind one door is a car. Behind the other two are goats. Pick a door!");
            updateStages();
        }

        function updateMessage(msg) {
            document.getElementById('message').textContent = msg;
        }

        function updateStages() {
            document.getElementById('stage1').classList.toggle('active', gameStage === 'pick');
            document.getElementById('stage2').classList.toggle('active', gameStage === 'revealed');
            document.getElementById('stage3').classList.toggle('active', gameStage === 'revealed');
        }

        function revealGoat() {
            // Monty reveals a goat door (not selected, not car)
            const options = [0, 1, 2].filter(d => d !== selectedDoor && d !== carDoor);
            revealedDoor = options[Math.floor(Math.random() * options.length)];

            const door = document.querySelector(`[data-door="${revealedDoor}"]`);
            door.classList.add('open', 'disabled');

            gameStage = 'revealed';
            updateStages();
            updateMessage("Monty reveals a goat! Do you want to switch to the other closed door, or stay with your choice?");
            document.getElementById('actionButtons').style.display = 'flex';
        }

        function finishGame(switched) {
            gameStage = 'finished';
            const finalChoice = switched ?
                [0, 1, 2].find(d => d !== selectedDoor && d !== revealedDoor) :
                selectedDoor;

            const won = finalChoice === carDoor;

            // Open all doors
            document.querySelectorAll('.door').forEach(door => {
                door.classList.add('open');
            });

            // Update stats
            stats.total++;
            if (switched) {
                stats.switchTotal++;
                if (won) stats.switchWins++;
            } else {
                stats.stayTotal++;
                if (won) stats.stayWins++;
            }

            updateStats();
            document.getElementById('actionButtons').style.display = 'none';

            const resultBanner = document.getElementById('resultBanner');
            if (won) {
                resultBanner.innerHTML = `<div class="result-banner win">You ${switched ? 'switched and' : 'stayed and'} WON the car! üöó</div>`;
                updateMessage("Congratulations! You won!");
            } else {
                resultBanner.innerHTML = `<div class="result-banner lose">You ${switched ? 'switched and' : 'stayed and'} got a goat! üêê</div>`;
                updateMessage("Sorry, you got a goat. Better luck next time!");
            }
        }

        function updateStats() {
            document.getElementById('totalGames').textContent = stats.total;
            document.getElementById('switchWins').textContent = stats.switchWins;
            document.getElementById('stayWins').textContent = stats.stayWins;

            if (stats.switchTotal > 0) {
                const pct = ((stats.switchWins / stats.switchTotal) * 100).toFixed(1);
                document.getElementById('switchPercent').textContent = `${pct}% of ${stats.switchTotal}`;
            }
            if (stats.stayTotal > 0) {
                const pct = ((stats.stayWins / stats.stayTotal) * 100).toFixed(1);
                document.getElementById('stayPercent').textContent = `${pct}% of ${stats.stayTotal}`;
            }
        }

        function simulateGames(count, shouldSwitch) {
            for (let i = 0; i < count; i++) {
                const car = Math.floor(Math.random() * 3);
                const pick = Math.floor(Math.random() * 3);

                // Monty reveals a goat
                const options = [0, 1, 2].filter(d => d !== pick && d !== car);
                const revealed = options[Math.floor(Math.random() * options.length)];

                // Player's final choice
                const finalChoice = shouldSwitch ?
                    [0, 1, 2].find(d => d !== pick && d !== revealed) :
                    pick;

                const won = finalChoice === car;

                stats.total++;
                if (shouldSwitch) {
                    stats.switchTotal++;
                    if (won) stats.switchWins++;
                } else {
                    stats.stayTotal++;
                    if (won) stats.stayWins++;
                }
            }
            updateStats();
        }

        // Event listeners
        document.querySelectorAll('.door').forEach(door => {
            door.addEventListener('click', function() {
                if (gameStage !== 'pick') return;
                if (this.classList.contains('disabled')) return;

                selectedDoor = parseInt(this.dataset.door);
                document.querySelectorAll('.door').forEach(d => d.classList.remove('selected'));
                this.classList.add('selected');

                updateMessage(`You picked Door ${selectedDoor + 1}. Monty is about to reveal a goat...`);

                setTimeout(revealGoat, 1000);
            });
        });

        document.getElementById('switchBtn').addEventListener('click', () => finishGame(true));
        document.getElementById('stayBtn').addEventListener('click', () => finishGame(false));
        document.getElementById('resetBtn').addEventListener('click', initGame);

        document.getElementById('sim100Switch').addEventListener('click', () => {
            simulateGames(100, true);
        });

        document.getElementById('sim100Stay').addEventListener('click', () => {
            simulateGames(100, false);
        });

        document.getElementById('resetStats').addEventListener('click', () => {
            stats = { total: 0, switchWins: 0, switchTotal: 0, stayWins: 0, stayTotal: 0 };
            document.getElementById('switchPercent').textContent = '-';
            document.getElementById('stayPercent').textContent = '-';
            updateStats();
        });

        initGame();
    </script>
</body>
</html>
