<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Conformity Pressure - Asch Experiment</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #0a0e1a;
            color: #e0e0e0;
            overflow-x: hidden;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            text-align: center;
            padding: 30px 0;
            background: linear-gradient(135deg, #1a1f35 0%, #0f1423 100%);
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        }

        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            background: linear-gradient(135deg, #ec4899, #8b5cf6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .subtitle {
            font-size: 1.1rem;
            color: #9ca3af;
            max-width: 800px;
            margin: 0 auto;
            line-height: 1.6;
        }

        .back-link {
            display: inline-block;
            margin-bottom: 20px;
            padding: 10px 20px;
            background: rgba(236, 72, 153, 0.1);
            color: #f472b6;
            text-decoration: none;
            border-radius: 8px;
            border: 1px solid rgba(236, 72, 153, 0.3);
            transition: all 0.3s ease;
        }

        .back-link:hover {
            background: rgba(236, 72, 153, 0.2);
            border-color: rgba(236, 72, 153, 0.5);
        }

        .main-grid {
            display: grid;
            grid-template-columns: 1fr 350px;
            gap: 20px;
            margin-bottom: 20px;
        }

        .canvas-container {
            background: #151b2e;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4);
        }

        canvas {
            display: block;
            width: 100%;
            border-radius: 8px;
            background: #0d1117;
        }

        .controls {
            background: #151b2e;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4);
        }

        .control-group {
            margin-bottom: 25px;
        }

        .control-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #f9a8d4;
            font-size: 0.9rem;
        }

        .control-group input[type="range"] {
            width: 100%;
            margin-bottom: 5px;
        }

        .control-value {
            text-align: right;
            color: #f472b6;
            font-weight: 600;
            font-size: 0.95rem;
        }

        button {
            width: 100%;
            padding: 12px;
            margin-bottom: 10px;
            background: linear-gradient(135deg, #ec4899, #8b5cf6);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(236, 72, 153, 0.4);
        }

        .info-box {
            background: rgba(236, 72, 153, 0.1);
            border: 1px solid rgba(236, 72, 153, 0.3);
            border-radius: 8px;
            padding: 15px;
            margin-top: 20px;
            font-size: 0.9rem;
            line-height: 1.6;
        }

        .info-box h3 {
            color: #f9a8d4;
            margin-bottom: 10px;
            font-size: 1rem;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }

        .stat-item {
            background: rgba(236, 72, 153, 0.1);
            padding: 12px;
            border-radius: 8px;
            border: 1px solid rgba(236, 72, 153, 0.2);
        }

        .stat-label {
            font-size: 0.8rem;
            color: #9ca3af;
            margin-bottom: 4px;
        }

        .stat-value {
            font-size: 1.3rem;
            font-weight: 700;
            color: #f472b6;
        }

        .chart-container {
            background: #151b2e;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4);
        }

        @media (max-width: 1024px) {
            .main-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <a href="index.html" class="back-link">← Back to Social Dynamics</a>

        <header>
            <h1>Conformity Pressure</h1>
            <p class="subtitle">Based on Asch's conformity experiments: Individuals conform to group opinion even when the group is obviously wrong. Watch how social pressure overrides private judgment.</p>
        </header>

        <div class="main-grid">
            <div class="canvas-container">
                <canvas id="mainCanvas"></canvas>
            </div>

            <div class="controls">
                <div class="stats">
                    <div class="stat-item">
                        <div class="stat-label">Conformers</div>
                        <div class="stat-value" id="conformers">0%</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">Independent</div>
                        <div class="stat-value" id="independent">0%</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">Group Size</div>
                        <div class="stat-value" id="groupSize">5</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">Trials</div>
                        <div class="stat-value" id="trials">0</div>
                    </div>
                </div>

                <div class="control-group">
                    <label>Group Size: <span class="control-value" id="groupSizeValue">5</span></label>
                    <input type="range" id="groupSizeSlider" min="2" max="12" value="5" step="1">
                </div>

                <div class="control-group">
                    <label>Conformity Pressure: <span class="control-value" id="pressureValue">0.75</span></label>
                    <input type="range" id="pressure" min="0" max="1" value="0.75" step="0.05">
                </div>

                <div class="control-group">
                    <label>Private Confidence: <span class="control-value" id="confidenceValue">0.80</span></label>
                    <input type="range" id="confidence" min="0.5" max="1" value="0.80" step="0.05">
                </div>

                <div class="control-group">
                    <label>Speed: <span class="control-value" id="speedValue">60</span></label>
                    <input type="range" id="speed" min="20" max="120" value="60" step="10">
                </div>

                <button id="resetBtn">Reset Simulation</button>
                <button id="pauseBtn">Pause</button>

                <div class="info-box">
                    <h3>The Asch Experiment</h3>
                    <p>Solomon Asch (1951) showed that individuals conform to group opinion even on unambiguous tasks. In his experiments, 75% of subjects conformed at least once.</p>
                    <p style="margin-top: 10px;">
                        • <strong>Green:</strong> Correct answer<br>
                        • <strong>Red:</strong> Incorrect group consensus<br>
                        • <strong>Pink:</strong> Subject conformed<br>
                        • <strong>Cyan:</strong> Subject resisted
                    </p>
                </div>
            </div>
        </div>

        <div class="chart-container">
            <canvas id="chartCanvas"></canvas>
        </div>
    </div>

    <script>
        const mainCanvas = document.getElementById('mainCanvas');
        const chartCanvas = document.getElementById('chartCanvas');
        const mainCtx = mainCanvas.getContext('2d');
        const chartCtx = chartCanvas.getContext('2d');

        let trials = [];
        let history = [];
        let paused = false;
        let lastUpdate = 0;
        let trialCount = 0;

        const config = {
            groupSize: 5,
            pressure: 0.75,
            confidence: 0.80,
            speed: 60
        };

        function initCanvas() {
            mainCanvas.width = mainCanvas.offsetWidth * window.devicePixelRatio;
            mainCanvas.height = 600 * window.devicePixelRatio;
            chartCanvas.width = chartCanvas.offsetWidth * window.devicePixelRatio;
            chartCanvas.height = 300 * window.devicePixelRatio;

            const scale = window.devicePixelRatio;
            mainCtx.scale(scale, scale);
            chartCtx.scale(scale, scale);
        }

        function runTrial() {
            const correctAnswer = Math.random() > 0.5 ? 'A' : 'B';

            // Group members (confederates) give wrong answer
            const groupAnswer = correctAnswer === 'A' ? 'B' : 'A';

            // Subject decides: conform or resist
            const conformityStrength = config.pressure * (config.groupSize / 12);
            const resistanceStrength = config.confidence;

            const conformProbability = conformityStrength / (conformityStrength + resistanceStrength);
            const conformed = Math.random() < conformProbability;

            const subjectAnswer = conformed ? groupAnswer : correctAnswer;

            return {
                correctAnswer,
                groupAnswer,
                subjectAnswer,
                conformed,
                correct: subjectAnswer === correctAnswer
            };
        }

        function drawTrials() {
            const width = mainCanvas.width / window.devicePixelRatio;
            const height = mainCanvas.height / window.devicePixelRatio;

            mainCtx.fillStyle = '#0d1117';
            mainCtx.fillRect(0, 0, width, height);

            const maxDisplay = 100;
            const displayTrials = trials.slice(-maxDisplay);
            const cols = 10;
            const rows = Math.ceil(displayTrials.length / cols);
            const cellWidth = width / cols;
            const cellHeight = Math.min(height / rows, 50);

            displayTrials.forEach((trial, i) => {
                const col = i % cols;
                const row = Math.floor(i / cols);
                const x = col * cellWidth;
                const y = row * cellHeight;

                // Draw group members (confederates)
                for (let j = 0; j < config.groupSize; j++) {
                    const gx = x + 10 + j * ((cellWidth - 30) / config.groupSize);
                    const gy = y + 10;

                    mainCtx.fillStyle = '#ef4444'; // Wrong answer (red)
                    mainCtx.beginPath();
                    mainCtx.arc(gx, gy, 3, 0, Math.PI * 2);
                    mainCtx.fill();
                }

                // Draw subject
                const sx = x + cellWidth / 2;
                const sy = y + cellHeight - 12;

                if (trial.conformed) {
                    mainCtx.fillStyle = '#ec4899'; // Conformed (pink)
                } else {
                    mainCtx.fillStyle = '#06b6d4'; // Resisted (cyan)
                }

                mainCtx.beginPath();
                mainCtx.arc(sx, sy, 5, 0, Math.PI * 2);
                mainCtx.fill();

                // Border for correct/incorrect
                if (trial.correct) {
                    mainCtx.strokeStyle = '#10b981';
                } else {
                    mainCtx.strokeStyle = '#ef4444';
                }
                mainCtx.lineWidth = 2;
                mainCtx.stroke();

                // Draw connection lines
                mainCtx.strokeStyle = 'rgba(236, 72, 153, 0.2)';
                mainCtx.lineWidth = 1;
                for (let j = 0; j < config.groupSize; j++) {
                    const gx = x + 10 + j * ((cellWidth - 30) / config.groupSize);
                    const gy = y + 10;
                    mainCtx.beginPath();
                    mainCtx.moveTo(gx, gy);
                    mainCtx.lineTo(sx, sy);
                    mainCtx.stroke();
                }
            });

            // Labels
            mainCtx.fillStyle = '#9ca3af';
            mainCtx.font = '14px sans-serif';
            mainCtx.fillText(`Recent ${displayTrials.length} trials`, 10, height - 10);
        }

        function drawChart() {
            const width = chartCanvas.width / window.devicePixelRatio;
            const height = chartCanvas.height / window.devicePixelRatio;

            chartCtx.fillStyle = '#0d1117';
            chartCtx.fillRect(0, 0, width, height);

            if (history.length < 2) return;

            const maxHistory = 100;
            const displayHistory = history.slice(-maxHistory);
            const stepWidth = width / maxHistory;

            // Draw conformity rate
            chartCtx.strokeStyle = '#ec4899';
            chartCtx.lineWidth = 3;
            chartCtx.beginPath();
            displayHistory.forEach((point, i) => {
                const x = i * stepWidth;
                const y = height - (point.conformRate * height);
                if (i === 0) {
                    chartCtx.moveTo(x, y);
                } else {
                    chartCtx.lineTo(x, y);
                }
            });
            chartCtx.stroke();

            // Draw accuracy rate
            chartCtx.strokeStyle = '#10b981';
            chartCtx.lineWidth = 2;
            chartCtx.beginPath();
            displayHistory.forEach((point, i) => {
                const x = i * stepWidth;
                const y = height - (point.accuracyRate * height);
                if (i === 0) {
                    chartCtx.moveTo(x, y);
                } else {
                    chartCtx.lineTo(x, y);
                }
            });
            chartCtx.stroke();

            // Reference lines
            chartCtx.strokeStyle = '#374151';
            chartCtx.lineWidth = 1;
            chartCtx.setLineDash([5, 5]);
            [0.25, 0.5, 0.75].forEach(level => {
                chartCtx.beginPath();
                chartCtx.moveTo(0, height - level * height);
                chartCtx.lineTo(width, height - level * height);
                chartCtx.stroke();
            });
            chartCtx.setLineDash([]);

            // Labels
            chartCtx.fillStyle = '#9ca3af';
            chartCtx.font = '12px sans-serif';
            chartCtx.fillText('Conformity Rate (Pink)', 10, 20);
            chartCtx.fillText('Accuracy Rate (Green)', 10, 40);
        }

        function calculateStats() {
            const recentTrials = trials.slice(-100);

            const conformCount = recentTrials.filter(t => t.conformed).length;
            const independentCount = recentTrials.length - conformCount;
            const correctCount = recentTrials.filter(t => t.correct).length;

            const conformRate = recentTrials.length > 0 ? conformCount / recentTrials.length : 0;
            const accuracyRate = recentTrials.length > 0 ? correctCount / recentTrials.length : 0;

            document.getElementById('conformers').textContent = (conformRate * 100).toFixed(0) + '%';
            document.getElementById('independent').textContent = (100 - conformRate * 100).toFixed(0) + '%';
            document.getElementById('groupSize').textContent = config.groupSize;
            document.getElementById('trials').textContent = trials.length;

            history.push({ conformRate, accuracyRate });
            if (history.length > 100) history.shift();
        }

        function animate(timestamp) {
            if (!paused && (!lastUpdate || timestamp - lastUpdate > config.speed)) {
                const trial = runTrial();
                trials.push(trial);
                calculateStats();
                lastUpdate = timestamp;
            }

            drawTrials();
            drawChart();

            requestAnimationFrame(animate);
        }

        // Event listeners
        document.getElementById('groupSizeSlider').addEventListener('input', (e) => {
            config.groupSize = parseInt(e.target.value);
            document.getElementById('groupSizeValue').textContent = config.groupSize;
        });

        document.getElementById('pressure').addEventListener('input', (e) => {
            config.pressure = parseFloat(e.target.value);
            document.getElementById('pressureValue').textContent = config.pressure.toFixed(2);
        });

        document.getElementById('confidence').addEventListener('input', (e) => {
            config.confidence = parseFloat(e.target.value);
            document.getElementById('confidenceValue').textContent = config.confidence.toFixed(2);
        });

        document.getElementById('speed').addEventListener('input', (e) => {
            config.speed = parseInt(e.target.value);
            document.getElementById('speedValue').textContent = config.speed;
        });

        document.getElementById('resetBtn').addEventListener('click', () => {
            trials = [];
            history = [];
            trialCount = 0;
        });

        document.getElementById('pauseBtn').addEventListener('click', (e) => {
            paused = !paused;
            e.target.textContent = paused ? 'Resume' : 'Pause';
        });

        window.addEventListener('resize', () => {
            initCanvas();
        });

        // Initialize
        initCanvas();
        requestAnimationFrame(animate);
    </script>
</body>
</html>
