<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mutual Information - Information Theory</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #0a0e1a;
            color: #e0e0e0;
            overflow: hidden;
        }

        .back-link {
            position: fixed;
            top: 20px;
            left: 20px;
            color: #4fc3f7;
            text-decoration: none;
            font-size: 18px;
            z-index: 1000;
            padding: 10px 20px;
            background: rgba(79, 195, 247, 0.1);
            border-radius: 8px;
            border: 1px solid #4fc3f7;
            transition: all 0.3s;
        }

        .back-link:hover {
            background: rgba(79, 195, 247, 0.2);
            transform: translateX(-5px);
        }

        #canvas {
            display: block;
            width: 100%;
            height: 100vh;
        }

        .controls {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(20, 30, 50, 0.95);
            padding: 25px;
            border-radius: 12px;
            border: 1px solid #4fc3f7;
            max-width: 350px;
            max-height: 90vh;
            overflow-y: auto;
            z-index: 100;
        }

        .controls h2 {
            color: #4fc3f7;
            margin-bottom: 20px;
            font-size: 22px;
        }

        .slider-group {
            margin-bottom: 20px;
        }

        .slider-group label {
            display: block;
            color: #66bb6a;
            margin-bottom: 8px;
            font-size: 14px;
        }

        .slider-group input[type="range"] {
            width: 100%;
            margin-bottom: 5px;
        }

        .slider-value {
            color: #81c784;
            font-size: 16px;
            font-weight: bold;
        }

        .info-box {
            background: rgba(79, 195, 247, 0.1);
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
            border-left: 3px solid #4fc3f7;
        }

        .info-box h3 {
            color: #4fc3f7;
            font-size: 16px;
            margin-bottom: 10px;
        }

        .info-box p {
            color: #b0bec5;
            font-size: 13px;
            line-height: 1.6;
        }

        .formula {
            font-family: 'Courier New', monospace;
            background: rgba(102, 187, 106, 0.1);
            padding: 10px;
            border-radius: 6px;
            margin-top: 10px;
            color: #81c784;
            font-size: 12px;
        }

        .stat-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 15px;
        }

        .stat-item {
            background: rgba(79, 195, 247, 0.1);
            padding: 10px;
            border-radius: 6px;
            text-align: center;
        }

        .stat-label {
            color: #b0bec5;
            font-size: 11px;
            margin-bottom: 5px;
        }

        .stat-value {
            color: #66bb6a;
            font-size: 18px;
            font-weight: bold;
        }

        button {
            width: 100%;
            padding: 12px;
            background: #4fc3f7;
            color: #0a0e1a;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            margin-bottom: 10px;
        }

        button:hover {
            background: #29b6f6;
            transform: scale(1.02);
        }
    </style>
</head>
<body>
    <a href="index.html" class="back-link">‚Üê Back to Gallery</a>

    <canvas id="canvas"></canvas>

    <div class="controls">
        <h2>Mutual Information</h2>

        <div class="slider-group">
            <label>Correlation: <span class="slider-value" id="correlationValue">0.50</span></label>
            <input type="range" id="correlationSlider" min="0" max="100" value="50">
        </div>

        <div class="slider-group">
            <label>H(X) - Entropy of X: <span class="slider-value" id="hxValue">2.00</span></label>
            <input type="range" id="hxSlider" min="10" max="40" value="20">
        </div>

        <div class="slider-group">
            <label>H(Y) - Entropy of Y: <span class="slider-value" id="hyValue">2.00</span></label>
            <input type="range" id="hySlider" min="10" max="40" value="20">
        </div>

        <div class="stat-grid">
            <div class="stat-item">
                <div class="stat-label">I(X;Y)</div>
                <div class="stat-value" id="miValue">1.00</div>
            </div>
            <div class="stat-item">
                <div class="stat-label">H(X,Y)</div>
                <div class="stat-value" id="jointValue">3.00</div>
            </div>
            <div class="stat-item">
                <div class="stat-label">H(X|Y)</div>
                <div class="stat-value" id="condXValue">1.00</div>
            </div>
            <div class="stat-item">
                <div class="stat-label">H(Y|X)</div>
                <div class="stat-value" id="condYValue">1.00</div>
            </div>
        </div>

        <button onclick="setIndependent()">Independent (I=0)</button>
        <button onclick="setPerfectCorrelation()">Perfect (I=H)</button>

        <div class="info-box">
            <h3>About Mutual Information</h3>
            <p>Mutual information I(X;Y) measures how much knowing one variable reduces uncertainty about the other.</p>
            <div class="formula">I(X;Y) = H(X) + H(Y) - H(X,Y)</div>
            <div class="formula">I(X;Y) = H(X) - H(X|Y)</div>
            <p style="margin-top: 8px;">When X and Y are independent, I(X;Y) = 0. When perfectly correlated, I(X;Y) = min(H(X), H(Y)).</p>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');

        let width, height;

        function resizeCanvas() {
            width = canvas.width = window.innerWidth;
            height = canvas.height = window.innerHeight;
        }

        resizeCanvas();
        window.addEventListener('resize', resizeCanvas);

        let correlation = 0.5;
        let hX = 2.0;
        let hY = 2.0;

        const correlationSlider = document.getElementById('correlationSlider');
        const hxSlider = document.getElementById('hxSlider');
        const hySlider = document.getElementById('hySlider');

        correlationSlider.addEventListener('input', (e) => {
            correlation = parseInt(e.target.value) / 100;
            document.getElementById('correlationValue').textContent = correlation.toFixed(2);
            updateStats();
        });

        hxSlider.addEventListener('input', (e) => {
            hX = parseInt(e.target.value) / 10;
            document.getElementById('hxValue').textContent = hX.toFixed(2);
            updateStats();
        });

        hySlider.addEventListener('input', (e) => {
            hY = parseInt(e.target.value) / 10;
            document.getElementById('hyValue').textContent = hY.toFixed(2);
            updateStats();
        });

        function updateStats() {
            // Mutual information is correlation * min(H(X), H(Y))
            const mutualInfo = correlation * Math.min(hX, hY);

            // Joint entropy H(X,Y) = H(X) + H(Y) - I(X;Y)
            const jointEntropy = hX + hY - mutualInfo;

            // Conditional entropies
            const hX_givenY = hX - mutualInfo;
            const hY_givenX = hY - mutualInfo;

            document.getElementById('miValue').textContent = mutualInfo.toFixed(2);
            document.getElementById('jointValue').textContent = jointEntropy.toFixed(2);
            document.getElementById('condXValue').textContent = hX_givenY.toFixed(2);
            document.getElementById('condYValue').textContent = hY_givenX.toFixed(2);
        }

        function setIndependent() {
            correlationSlider.value = 0;
            correlation = 0;
            document.getElementById('correlationValue').textContent = '0.00';
            updateStats();
        }

        function setPerfectCorrelation() {
            correlationSlider.value = 100;
            correlation = 1;
            document.getElementById('correlationValue').textContent = '1.00';
            updateStats();
        }

        function drawVennDiagram() {
            const centerX = width / 2 - 100;
            const centerY = height / 2;
            const baseRadius = 150;

            // Scale radii based on entropies
            const radiusX = baseRadius * Math.sqrt(hX / 2);
            const radiusY = baseRadius * Math.sqrt(hY / 2);

            // Overlap based on correlation
            const mutualInfo = correlation * Math.min(hX, hY);
            const overlapDistance = radiusX + radiusY - (radiusX + radiusY) * (mutualInfo / Math.max(hX, hY, 0.1));

            const circleX = {x: centerX - overlapDistance / 2, y: centerY};
            const circleY = {x: centerX + overlapDistance / 2, y: centerY};

            // Draw title
            ctx.fillStyle = '#4fc3f7';
            ctx.font = 'bold 28px sans-serif';
            ctx.textAlign = 'center';
            ctx.fillText('Information Venn Diagram', centerX, 60);

            // Draw circles with transparency
            ctx.globalAlpha = 0.3;

            // Circle for X
            ctx.fillStyle = '#4fc3f7';
            ctx.beginPath();
            ctx.arc(circleX.x, circleX.y, radiusX, 0, Math.PI * 2);
            ctx.fill();

            // Circle for Y
            ctx.fillStyle = '#66bb6a';
            ctx.beginPath();
            ctx.arc(circleY.x, circleY.y, radiusY, 0, Math.PI * 2);
            ctx.fill();

            ctx.globalAlpha = 1;

            // Draw circle outlines
            ctx.strokeStyle = '#4fc3f7';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.arc(circleX.x, circleX.y, radiusX, 0, Math.PI * 2);
            ctx.stroke();

            ctx.strokeStyle = '#66bb6a';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.arc(circleY.x, circleY.y, radiusY, 0, Math.PI * 2);
            ctx.stroke();

            // Labels
            ctx.fillStyle = '#4fc3f7';
            ctx.font = 'bold 24px sans-serif';
            ctx.textAlign = 'center';
            ctx.fillText('H(X)', circleX.x - radiusX / 2, circleY.y - 20);
            ctx.font = '18px sans-serif';
            ctx.fillText(hX.toFixed(2), circleX.x - radiusX / 2, circleY.y + 10);

            ctx.fillStyle = '#66bb6a';
            ctx.font = 'bold 24px sans-serif';
            ctx.fillText('H(Y)', circleY.x + radiusY / 2, circleY.y - 20);
            ctx.font = '18px sans-serif';
            ctx.fillText(hY.toFixed(2), circleY.x + radiusY / 2, circleY.y + 10);

            // Mutual information label (intersection)
            const mutualInfoDisp = correlation * Math.min(hX, hY);
            ctx.fillStyle = '#ffa726';
            ctx.font = 'bold 20px sans-serif';
            ctx.fillText('I(X;Y)', centerX, centerY - 10);
            ctx.font = '16px sans-serif';
            ctx.fillText(mutualInfoDisp.toFixed(2), centerX, centerY + 15);

            // Conditional entropy labels
            const hX_givenY = hX - mutualInfoDisp;
            const hY_givenX = hY - mutualInfoDisp;

            if (hX_givenY > 0.1) {
                ctx.fillStyle = '#4fc3f7';
                ctx.font = '14px sans-serif';
                ctx.fillText('H(X|Y)', circleX.x - radiusX / 2, centerY + radiusY + 30);
                ctx.fillText(hX_givenY.toFixed(2), circleX.x - radiusX / 2, centerY + radiusY + 50);
            }

            if (hY_givenX > 0.1) {
                ctx.fillStyle = '#66bb6a';
                ctx.font = '14px sans-serif';
                ctx.fillText('H(Y|X)', circleY.x + radiusY / 2, centerY + radiusY + 30);
                ctx.fillText(hY_givenX.toFixed(2), circleY.x + radiusY / 2, centerY + radiusY + 50);
            }
        }

        function drawFormulas() {
            const startX = 100;
            const startY = height - 150;

            ctx.fillStyle = '#4fc3f7';
            ctx.font = 'bold 20px sans-serif';
            ctx.textAlign = 'left';
            ctx.fillText('Key Relationships:', startX, startY);

            const formulas = [
                'I(X;Y) = H(X) + H(Y) - H(X,Y)',
                'I(X;Y) = H(X) - H(X|Y) = H(Y) - H(Y|X)',
                'H(X,Y) = H(X) + H(Y|X) = H(Y) + H(X|Y)'
            ];

            ctx.fillStyle = '#81c784';
            ctx.font = '16px monospace';

            formulas.forEach((formula, i) => {
                ctx.fillText(formula, startX, startY + 35 + i * 30);
            });
        }

        function drawCorrelationVisualization() {
            const gridSize = 15;
            const cellSize = 8;
            const startX = width - 380;
            const startY = 120;

            ctx.fillStyle = '#4fc3f7';
            ctx.font = 'bold 18px sans-serif';
            ctx.textAlign = 'left';
            ctx.fillText('Joint Distribution', startX, startY - 20);

            // Draw grid showing correlation
            for (let i = 0; i < gridSize; i++) {
                for (let j = 0; j < gridSize; j++) {
                    // Probability is higher along diagonal for higher correlation
                    const diagonalDist = Math.abs(i - j);
                    const prob = Math.exp(-diagonalDist * diagonalDist / (2 * (1 - correlation + 0.1) * gridSize));

                    const intensity = prob / Math.exp(0);
                    const color = correlation > 0.5 ? `rgba(102, 187, 106, ${intensity})` : `rgba(79, 195, 247, ${intensity * 0.5})`;

                    ctx.fillStyle = color;
                    ctx.fillRect(
                        startX + i * (cellSize + 1),
                        startY + j * (cellSize + 1),
                        cellSize,
                        cellSize
                    );
                }
            }

            // Labels
            ctx.fillStyle = '#e0e0e0';
            ctx.font = '12px sans-serif';
            ctx.textAlign = 'center';
            ctx.fillText('X', startX + gridSize * (cellSize + 1) / 2, startY + gridSize * (cellSize + 1) + 20);

            ctx.save();
            ctx.translate(startX - 20, startY + gridSize * (cellSize + 1) / 2);
            ctx.rotate(-Math.PI / 2);
            ctx.fillText('Y', 0, 0);
            ctx.restore();
        }

        function drawChainRules() {
            const startX = width - 380;
            const startY = 320;

            ctx.fillStyle = '#66bb6a';
            ctx.font = 'bold 18px sans-serif';
            ctx.textAlign = 'left';
            ctx.fillText('Chain Rules:', startX, startY);

            const mutualInfo = correlation * Math.min(hX, hY);
            const jointEntropy = hX + hY - mutualInfo;
            const hX_givenY = hX - mutualInfo;
            const hY_givenX = hY - mutualInfo;

            const equations = [
                `H(X,Y) = ${jointEntropy.toFixed(2)}`,
                `      = H(X) + H(Y|X)`,
                `      = ${hX.toFixed(2)} + ${hY_givenX.toFixed(2)}`,
                '',
                `I(X;Y) = ${mutualInfo.toFixed(2)}`,
                `      = H(X) - H(X|Y)`,
                `      = ${hX.toFixed(2)} - ${hX_givenY.toFixed(2)}`
            ];

            ctx.fillStyle = '#b0bec5';
            ctx.font = '14px monospace';

            equations.forEach((eq, i) => {
                ctx.fillText(eq, startX, startY + 30 + i * 22);
            });
        }

        function draw() {
            // Clear canvas
            ctx.fillStyle = '#0a0e1a';
            ctx.fillRect(0, 0, width, height);

            drawVennDiagram();
            drawFormulas();
            drawCorrelationVisualization();
            drawChainRules();

            requestAnimationFrame(draw);
        }

        // Initialize
        updateStats();
        draw();
    </script>
</body>
</html>
