<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shannon Entropy Visualization - Information Theory</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #0a0e1a;
            color: #e0e0e0;
            overflow: hidden;
        }

        .back-link {
            position: fixed;
            top: 20px;
            left: 20px;
            color: #4fc3f7;
            text-decoration: none;
            font-size: 18px;
            z-index: 1000;
            padding: 10px 20px;
            background: rgba(79, 195, 247, 0.1);
            border-radius: 8px;
            border: 1px solid #4fc3f7;
            transition: all 0.3s;
        }

        .back-link:hover {
            background: rgba(79, 195, 247, 0.2);
            transform: translateX(-5px);
        }

        #canvas {
            display: block;
            width: 100%;
            height: 100vh;
        }

        .controls {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(20, 30, 50, 0.85);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            padding: 25px;
            border-radius: 12px;
            border: 1px solid #4fc3f7;
            max-width: 350px;
            max-height: 90vh;
            overflow-y: auto;
            z-index: 100;
        }

        .controls h2 {
            color: #4fc3f7;
            margin-bottom: 20px;
            font-size: 22px;
        }

        .slider-group {
            margin-bottom: 20px;
        }

        .slider-group label {
            display: block;
            color: #66bb6a;
            margin-bottom: 8px;
            font-size: 14px;
        }

        .slider-group input[type="range"] {
            width: 100%;
            margin-bottom: 5px;
        }

        .slider-value {
            color: #81c784;
            font-size: 16px;
            font-weight: bold;
        }

        .info-box {
            background: rgba(79, 195, 247, 0.1);
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
            border-left: 3px solid #4fc3f7;
        }

        .info-box h3 {
            color: #4fc3f7;
            font-size: 18px;
            margin-bottom: 10px;
        }

        .info-box p {
            color: #b0bec5;
            font-size: 14px;
            line-height: 1.6;
        }

        .entropy-value {
            font-size: 28px;
            font-weight: bold;
            color: #66bb6a;
            text-align: center;
            margin: 15px 0;
        }

        button {
            width: 100%;
            padding: 12px;
            background: #4fc3f7;
            color: #0a0e1a;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            margin-bottom: 10px;
        }

        button:hover {
            background: #29b6f6;
            transform: scale(1.02);
        }

        .formula {
            font-family: 'Courier New', monospace;
            background: rgba(102, 187, 106, 0.1);
            padding: 10px;
            border-radius: 6px;
            margin-top: 10px;
            color: #81c784;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <a href="index.html" class="back-link">← Back to Gallery</a>

    <canvas id="canvas"></canvas>

    <div class="controls">
        <h2>Shannon Entropy</h2>

        <div class="entropy-value" id="entropyValue">H = 0.00 bits</div>

        <div class="slider-group">
            <label>Symbol A Probability: <span class="slider-value" id="probA">0.25</span></label>
            <input type="range" id="sliderA" min="0" max="100" value="25">
        </div>

        <div class="slider-group">
            <label>Symbol B Probability: <span class="slider-value" id="probB">0.25</span></label>
            <input type="range" id="sliderB" min="0" max="100" value="25">
        </div>

        <div class="slider-group">
            <label>Symbol C Probability: <span class="slider-value" id="probC">0.25</span></label>
            <input type="range" id="sliderC" min="0" max="100" value="25">
        </div>

        <div class="slider-group">
            <label>Symbol D Probability: <span class="slider-value" id="probD">0.25</span></label>
            <input type="range" id="sliderD" min="0" max="100" value="25">
        </div>

        <button onclick="setUniform()">Uniform Distribution</button>
        <button onclick="setSkewed()">Skewed Distribution</button>
        <button onclick="setExtreme()">Extreme Distribution</button>

        <div class="info-box">
            <h3>About Entropy</h3>
            <p>Shannon entropy measures the average information content or uncertainty in a probability distribution.</p>
            <div class="formula">H(X) = -Σ p(x) log₂ p(x)</div>
            <p style="margin-top: 10px;">Maximum entropy occurs when all outcomes are equally likely (uniform distribution). Minimum entropy (0) occurs when one outcome is certain.</p>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');

        let width, height;

        function resizeCanvas() {
            width = canvas.width = window.innerWidth;
            height = canvas.height = window.innerHeight;
        }

        resizeCanvas();
        window.addEventListener('resize', resizeCanvas);

        // Probability state
        let probs = [0.25, 0.25, 0.25, 0.25];
        const symbols = ['A', 'B', 'C', 'D'];
        const colors = ['#4fc3f7', '#66bb6a', '#ffa726', '#ab47bc'];

        // Sliders
        const sliders = [
            document.getElementById('sliderA'),
            document.getElementById('sliderB'),
            document.getElementById('sliderC'),
            document.getElementById('sliderD')
        ];

        const probDisplays = [
            document.getElementById('probA'),
            document.getElementById('probB'),
            document.getElementById('probC'),
            document.getElementById('probD')
        ];

        // Update probabilities from sliders
        function updateProbs() {
            const raw = sliders.map(s => parseInt(s.value));
            const sum = raw.reduce((a, b) => a + b, 0);

            if (sum === 0) {
                probs = [0.25, 0.25, 0.25, 0.25];
            } else {
                probs = raw.map(v => v / sum);
            }

            probDisplays.forEach((display, i) => {
                display.textContent = probs[i].toFixed(3);
            });
        }

        sliders.forEach(slider => {
            slider.addEventListener('input', updateProbs);
        });

        // Calculate Shannon entropy
        function calculateEntropy() {
            let entropy = 0;
            for (let p of probs) {
                if (p > 0) {
                    entropy -= p * Math.log2(p);
                }
            }
            return entropy;
        }

        // Preset distributions
        function setUniform() {
            sliders.forEach(s => s.value = 25);
            updateProbs();
        }

        function setSkewed() {
            sliders[0].value = 50;
            sliders[1].value = 30;
            sliders[2].value = 15;
            sliders[3].value = 5;
            updateProbs();
        }

        function setExtreme() {
            sliders[0].value = 97;
            sliders[1].value = 1;
            sliders[2].value = 1;
            sliders[3].value = 1;
            updateProbs();
        }

        // Drawing functions
        function drawBarChart() {
            const chartX = 100;
            const chartY = height / 2 - 200;
            const barWidth = 80;
            const barSpacing = 120;
            const maxBarHeight = 300;

            ctx.font = 'bold 18px sans-serif';
            ctx.fillStyle = '#4fc3f7';
            ctx.fillText('Probability Distribution', chartX, chartY - 30);

            probs.forEach((p, i) => {
                const x = chartX + i * barSpacing;
                const barHeight = p * maxBarHeight;
                const y = chartY + maxBarHeight - barHeight;

                // Draw bar
                ctx.fillStyle = colors[i];
                ctx.fillRect(x, y, barWidth, barHeight);

                // Draw border
                ctx.strokeStyle = colors[i];
                ctx.lineWidth = 2;
                ctx.strokeRect(x, y, barWidth, barHeight);

                // Draw symbol label
                ctx.fillStyle = '#e0e0e0';
                ctx.font = 'bold 20px sans-serif';
                ctx.textAlign = 'center';
                ctx.fillText(symbols[i], x + barWidth / 2, chartY + maxBarHeight + 30);

                // Draw probability value
                ctx.fillStyle = colors[i];
                ctx.font = 'bold 16px sans-serif';
                ctx.fillText(p.toFixed(3), x + barWidth / 2, y - 10);
            });

            // Draw axis
            ctx.strokeStyle = '#4fc3f7';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(chartX - 10, chartY);
            ctx.lineTo(chartX - 10, chartY + maxBarHeight);
            ctx.lineTo(chartX + 4 * barSpacing + 10, chartY + maxBarHeight);
            ctx.stroke();
        }

        function drawInformationContent() {
            const chartX = 650;
            const chartY = height / 2 - 200;
            const barWidth = 80;
            const barSpacing = 120;
            const maxBarHeight = 300;

            ctx.font = 'bold 18px sans-serif';
            ctx.fillStyle = '#66bb6a';
            ctx.fillText('Information Content: -log₂(p)', chartX, chartY - 30);

            probs.forEach((p, i) => {
                const x = chartX + i * barSpacing;
                const info = p > 0 ? -Math.log2(p) : 0;
                const normalizedHeight = Math.min(info / 8, 1); // Normalize to 8 bits max
                const barHeight = normalizedHeight * maxBarHeight;
                const y = chartY + maxBarHeight - barHeight;

                // Draw bar
                ctx.fillStyle = colors[i];
                ctx.globalAlpha = 0.7;
                ctx.fillRect(x, y, barWidth, barHeight);
                ctx.globalAlpha = 1;

                // Draw border
                ctx.strokeStyle = colors[i];
                ctx.lineWidth = 2;
                ctx.strokeRect(x, y, barWidth, barHeight);

                // Draw symbol label
                ctx.fillStyle = '#e0e0e0';
                ctx.font = 'bold 20px sans-serif';
                ctx.textAlign = 'center';
                ctx.fillText(symbols[i], x + barWidth / 2, chartY + maxBarHeight + 30);

                // Draw information value
                ctx.fillStyle = colors[i];
                ctx.font = 'bold 14px sans-serif';
                ctx.fillText(info.toFixed(2) + ' bits', x + barWidth / 2, y - 10);
            });

            // Draw axis
            ctx.strokeStyle = '#66bb6a';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(chartX - 10, chartY);
            ctx.lineTo(chartX - 10, chartY + maxBarHeight);
            ctx.lineTo(chartX + 4 * barSpacing + 10, chartY + maxBarHeight);
            ctx.stroke();
        }

        function drawEntropyMeter() {
            const centerX = width / 2;
            const centerY = height - 150;
            const radius = 100;

            const entropy = calculateEntropy();
            const maxEntropy = 2; // log2(4) = 2 bits for 4 symbols
            const angle = (entropy / maxEntropy) * Math.PI;

            // Draw arc background
            ctx.strokeStyle = '#1e3a5f';
            ctx.lineWidth = 20;
            ctx.beginPath();
            ctx.arc(centerX, centerY, radius, Math.PI, 2 * Math.PI);
            ctx.stroke();

            // Draw entropy arc
            const gradient = ctx.createLinearGradient(centerX - radius, centerY, centerX + radius, centerY);
            gradient.addColorStop(0, '#ab47bc');
            gradient.addColorStop(0.5, '#66bb6a');
            gradient.addColorStop(1, '#4fc3f7');

            ctx.strokeStyle = gradient;
            ctx.lineWidth = 20;
            ctx.beginPath();
            ctx.arc(centerX, centerY, radius, Math.PI, Math.PI + angle);
            ctx.stroke();

            // Draw needle
            const needleAngle = Math.PI + angle;
            const needleLength = radius - 10;
            ctx.strokeStyle = '#ffa726';
            ctx.lineWidth = 4;
            ctx.beginPath();
            ctx.moveTo(centerX, centerY);
            ctx.lineTo(
                centerX + needleLength * Math.cos(needleAngle),
                centerY + needleLength * Math.sin(needleAngle)
            );
            ctx.stroke();

            // Draw center dot
            ctx.fillStyle = '#ffa726';
            ctx.beginPath();
            ctx.arc(centerX, centerY, 8, 0, Math.PI * 2);
            ctx.fill();

            // Draw labels
            ctx.fillStyle = '#e0e0e0';
            ctx.font = 'bold 18px sans-serif';
            ctx.textAlign = 'center';
            ctx.fillText('0 bits', centerX - radius - 20, centerY + 5);
            ctx.fillText('2 bits', centerX + radius + 20, centerY + 5);
            ctx.fillText('Entropy Meter', centerX, centerY + 60);

            // Draw current entropy value
            ctx.fillStyle = '#66bb6a';
            ctx.font = 'bold 32px sans-serif';
            ctx.fillText(entropy.toFixed(3) + ' bits', centerX, centerY - 30);
        }

        function draw() {
            // Clear canvas
            ctx.fillStyle = '#0a0e1a';
            ctx.fillRect(0, 0, width, height);

            // Update entropy display
            const entropy = calculateEntropy();
            document.getElementById('entropyValue').textContent = `H = ${entropy.toFixed(3)} bits`;

            // Draw visualizations
            drawBarChart();
            drawInformationContent();
            drawEntropyMeter();

            requestAnimationFrame(draw);
        }

        // Expose for enhance.js
        window.reset = setUniform;

        // Initialize
        updateProbs();
        draw();
    </script>
    <script src="../assets/js/enhance.js" defer></script>
</body>
</html>
