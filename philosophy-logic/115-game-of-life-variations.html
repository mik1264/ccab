<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Game of Life Variations - CCAB</title>
    <style>
        body { margin: 0; background: #000; display: flex; flex-direction: column; height: 100vh; font-family: sans-serif; color: white; }
        canvas { flex-grow: 1; image-rendering: pixelated; }
        .controls { padding: 10px; background: #222; display: flex; gap: 10px; align-items: center; }
        select, button { padding: 8px; font-size: 14px; background: #444; color: white; border: 1px solid #666; border-radius: 4px; cursor: pointer; }
    </style>
</head>
<body>
    <div class="controls">
        <select id="rules">
            <option value="conway">Conway (B3/S23)</option>
            <option value="highlife">HighLife (B36/S23)</option>
            <option value="daynight">Day & Night (B3678/S34678)</option>
            <option value="seeds">Seeds (B2/S)</option>
        </select>
        <button onclick="randomize()">Randomize</button>
        <button onclick="clearGrid()">Clear</button>
        <button id="playBtn" onclick="toggle()">Pause</button>
    </div>
    <canvas id="canvas"></canvas>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        const scale = 4;
        let w, h;
        let grid = [], next = [];
        let playing = true;
        
        let birth = [3], survive = [2,3];

        function resize() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight - 50; // Minus header
            w = Math.ceil(canvas.width / scale);
            h = Math.ceil(canvas.height / scale);
            grid = new Uint8Array(w*h);
            next = new Uint8Array(w*h);
            randomize();
        }
        window.addEventListener('resize', resize);

        function randomize() {
            for(let i=0; i<grid.length; i++) grid[i] = Math.random() > 0.5 ? 1 : 0;
        }
        
        function clearGrid() {
            for(let i=0; i<grid.length; i++) grid[i] = 0;
        }

        function step() {
            for(let y=0; y<h; y++) {
                for(let x=0; x<w; x++) {
                    let n = 0;
                    for(let dy=-1; dy<=1; dy++) {
                        for(let dx=-1; dx<=1; dx++) {
                            if(dx===0 && dy===0) continue;
                            const nx = (x+dx+w)%w;
                            const ny = (y+dy+h)%h;
                            n += grid[ny*w+nx];
                        }
                    }
                    
                    const i = y*w+x;
                    if(grid[i]) next[i] = survive.includes(n) ? 1 : 0;
                    else next[i] = birth.includes(n) ? 1 : 0;
                }
            }
            [grid, next] = [next, grid];
        }

        function draw() {
            ctx.fillStyle = '#000';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            ctx.fillStyle = '#0f0';
            
            for(let y=0; y<h; y++) {
                for(let x=0; x<w; x++) {
                    if(grid[y*w+x]) ctx.fillRect(x*scale, y*scale, scale-1, scale-1);
                }
            }
        }

        function loop() {
            if(playing) step();
            draw();
            requestAnimationFrame(loop);
        }

        document.getElementById('rules').onchange = e => {
            const r = e.target.value;
            if(r === 'conway') { birth = [3]; survive = [2,3]; }
            else if(r === 'highlife') { birth = [3,6]; survive = [2,3]; }
            else if(r === 'daynight') { birth = [3,6,7,8]; survive = [3,4,6,7,8]; }
            else if(r === 'seeds') { birth = [2]; survive = []; }
        };

        function toggle() {
            playing = !playing;
            document.getElementById('playBtn').textContent = playing ? 'Pause' : 'Play';
        }

        resize();
        loop();
    </script>
</body>
</html>
