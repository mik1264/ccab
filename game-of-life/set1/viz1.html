<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Classic Chromatic - Game of Life</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: #1a1a2e;
            font-family: Arial, sans-serif;
        }
        canvas {
            border: 2px solid #16213e;
            box-shadow: 0 0 20px rgba(0,0,0,0.5);
        }
        .controls {
            position: absolute;
            top: 20px;
            left: 20px;
            color: white;
            background: rgba(0,0,0,0.7);
            padding: 15px;
            border-radius: 10px;
        }
        button {
            margin: 5px;
            padding: 10px 15px;
            cursor: pointer;
            background: #e94560;
            color: white;
            border: none;
            border-radius: 5px;
        }
        button:hover {
            background: #d63447;
        }
        a.back {
            position: absolute;
            top: 20px;
            right: 20px;
            color: white;
            text-decoration: none;
            background: rgba(0,0,0,0.7);
            padding: 10px 20px;
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <a href="index.html" class="back">‚Üê Back</a>
    <div class="controls">
        <h3>Classic Chromatic</h3>
        <button onclick="game.toggle()">Play/Pause</button>
        <button onclick="game.clear()">Clear</button>
        <button onclick="game.random()">Random</button>
        <button onclick="game.addGlider()">Add Glider</button>
    </div>
    <canvas id="canvas"></canvas>

    <script>
        class GameOfLife {
            constructor(width, height, cellSize) {
                this.canvas = document.getElementById('canvas');
                this.ctx = this.canvas.getContext('2d');
                this.cellSize = cellSize;
                this.cols = Math.floor(width / cellSize);
                this.rows = Math.floor(height / cellSize);
                this.canvas.width = this.cols * cellSize;
                this.canvas.height = this.rows * cellSize;

                this.grid = this.createGrid();
                this.generation = this.createGrid();
                this.running = true;

                this.canvas.addEventListener('click', (e) => this.handleClick(e));
                this.random();
                this.animate();
            }

            createGrid() {
                return Array(this.rows).fill(null).map(() => Array(this.cols).fill(0));
            }

            random() {
                for (let i = 0; i < this.rows; i++) {
                    for (let j = 0; j < this.cols; j++) {
                        this.grid[i][j] = Math.random() > 0.7 ? 1 : 0;
                        this.generation[i][j] = 0;
                    }
                }
            }

            clear() {
                this.grid = this.createGrid();
                this.generation = this.createGrid();
            }

            toggle() {
                this.running = !this.running;
            }

            addGlider() {
                const r = Math.floor(this.rows / 2);
                const c = Math.floor(this.cols / 2);
                this.grid[r][c+1] = 1;
                this.grid[r+1][c+2] = 1;
                this.grid[r+2][c] = 1;
                this.grid[r+2][c+1] = 1;
                this.grid[r+2][c+2] = 1;
            }

            handleClick(e) {
                const rect = this.canvas.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;
                const col = Math.floor(x / this.cellSize);
                const row = Math.floor(y / this.cellSize);
                this.grid[row][col] = this.grid[row][col] ? 0 : 1;
            }

            countNeighbors(row, col) {
                let count = 0;
                for (let i = -1; i <= 1; i++) {
                    for (let j = -1; j <= 1; j++) {
                        if (i === 0 && j === 0) continue;
                        const r = (row + i + this.rows) % this.rows;
                        const c = (col + j + this.cols) % this.cols;
                        count += this.grid[r][c] ? 1 : 0;
                    }
                }
                return count;
            }

            update() {
                if (!this.running) return;

                const newGrid = this.createGrid();
                const newGen = this.createGrid();

                for (let i = 0; i < this.rows; i++) {
                    for (let j = 0; j < this.cols; j++) {
                        const neighbors = this.countNeighbors(i, j);
                        const cell = this.grid[i][j];

                        if (cell && (neighbors === 2 || neighbors === 3)) {
                            newGrid[i][j] = 1;
                            newGen[i][j] = this.generation[i][j] + 1;
                        } else if (!cell && neighbors === 3) {
                            newGrid[i][j] = 1;
                            newGen[i][j] = 1;
                        }
                    }
                }

                this.grid = newGrid;
                this.generation = newGen;
            }

            draw() {
                this.ctx.fillStyle = '#0f3460';
                this.ctx.fillRect(0, 0, this.canvas.width, this.canvas.height);

                for (let i = 0; i < this.rows; i++) {
                    for (let j = 0; j < this.cols; j++) {
                        if (this.grid[i][j]) {
                            const gen = Math.min(this.generation[i][j], 50);
                            const hue = (gen * 7) % 360;
                            const saturation = 70 + (gen % 30);
                            const lightness = 50 + (gen % 20);
                            this.ctx.fillStyle = `hsl(${hue}, ${saturation}%, ${lightness}%)`;
                            this.ctx.fillRect(j * this.cellSize, i * this.cellSize,
                                            this.cellSize - 1, this.cellSize - 1);
                        }
                    }
                }
            }

            animate() {
                this.update();
                this.draw();
                setTimeout(() => requestAnimationFrame(() => this.animate()), 100);
            }
        }

        const game = new GameOfLife(800, 600, 8);
    </script>
</body>
</html>
