<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Curl Noise - Screensaver</title>
    <style>
        body { margin: 0; overflow: hidden; background: #000; }
        canvas { display: block; }
        .back-btn {
            position: fixed; top: 20px; left: 20px;
            color: rgba(255,255,255,0.5); text-decoration: none;
            font-family: sans-serif; z-index: 100;
        }
    </style>
</head>
<body>
    <a href="index.html" class="back-btn">‚Üê Back</a>
    <canvas id="canvas"></canvas>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.min.js"></script>
    <script>
        let particles = [];
        const numParticles = 1000;
        const scale = 0.005;

        function setup() {
            createCanvas(window.innerWidth, window.innerHeight);
            background(0);
            colorMode(HSB, 360, 100, 100);
            
            for(let i=0; i<numParticles; i++) {
                particles.push({
                    pos: createVector(random(width), random(height)),
                    vel: createVector(0,0),
                    col: random(360)
                });
            }
        }

        function getCurl(x, y) {
            const eps = 1.0; // Epsilon derivative offset
            
            // Find rate of change of noise field in x and y
            let n1 = noise(x * scale, (y + eps) * scale);
            let n2 = noise(x * scale, (y - eps) * scale);
            let n3 = noise((x + eps) * scale, y * scale);
            let n4 = noise((x - eps) * scale, y * scale);

            // Curl definition: (d/dy, -d/dx)
            let a = (n1 - n2) / (2 * eps);
            let b = (n3 - n4) / (2 * eps);

            return createVector(a, -b);
        }

        function draw() {
            noStroke();
            fill(0, 0, 0, 0.05); // Fade trail
            rect(0, 0, width, height);

            for(let p of particles) {
                let curl = getCurl(p.pos.x, p.pos.y);
                curl.mult(20); // Speed
                
                p.vel.lerp(curl, 0.2); // Smooth movement
                p.pos.add(p.vel);

                stroke(p.col, 80, 100);
                strokeWeight(2);
                point(p.pos.x, p.pos.y);

                p.col = (p.col + 0.5) % 360;

                if(p.pos.x < 0) p.pos.x = width;
                if(p.pos.x > width) p.pos.x = 0;
                if(p.pos.y < 0) p.pos.y = height;
                if(p.pos.y > height) p.pos.y = 0;
            }
        }

        function windowResized() {
            resizeCanvas(window.innerWidth, window.innerHeight);
            background(0);
        }
    </script>
</body>
</html>
