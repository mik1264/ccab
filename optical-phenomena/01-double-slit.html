<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Young's Double Slit Experiment - Optical Phenomena</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            background: #0a0e1a;
            color: #e0e0e0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            overflow: hidden;
            width: 100vw;
            height: 100vh;
        }
        canvas {
            display: block;
            position: absolute;
            top: 0;
            left: 0;
        }
        .back-link {
            position: fixed;
            top: 15px;
            left: 15px;
            color: #8af;
            text-decoration: none;
            font-size: 14px;
            z-index: 100;
            background: rgba(20,20,40,0.85);
            padding: 6px 14px;
            border-radius: 8px;
            backdrop-filter: blur(10px);
        }
        .back-link:hover { color: #bdf; }
        #controls {
            position: fixed;
            top: 15px;
            right: 15px;
            background: rgba(20,20,40,0.85);
            backdrop-filter: blur(10px);
            border-radius: 12px;
            padding: 16px;
            z-index: 100;
            width: 260px;
            border: 1px solid rgba(100,140,255,0.15);
        }
        #controls h3 {
            color: #8af;
            margin-bottom: 10px;
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .control-group {
            margin-bottom: 10px;
        }
        .control-group label {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            margin-bottom: 3px;
            color: #aaa;
        }
        .control-group label span { color: #8af; }
        input[type="range"] {
            width: 100%;
            height: 4px;
            -webkit-appearance: none;
            background: rgba(100,140,255,0.2);
            border-radius: 2px;
            outline: none;
        }
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 14px;
            height: 14px;
            border-radius: 50%;
            background: #8af;
            cursor: pointer;
        }
        #info {
            position: fixed;
            bottom: 15px;
            left: 15px;
            background: rgba(20,20,40,0.85);
            backdrop-filter: blur(10px);
            border-radius: 12px;
            padding: 14px 18px;
            z-index: 100;
            max-width: 400px;
            border: 1px solid rgba(100,140,255,0.15);
            font-size: 12px;
            line-height: 1.6;
        }
        #info h4 { color: #8af; margin-bottom: 6px; font-size: 13px; }
        #info p { color: #bbb; }
        .wavelength-preview {
            width: 100%;
            height: 8px;
            border-radius: 4px;
            margin-top: 4px;
        }
    </style>
</head>
<body>
    <a href="index.html" class="back-link">&larr; Back to Gallery</a>

    <canvas id="canvas"></canvas>

    <div id="controls">
        <h3>Double Slit Controls</h3>
        <div class="control-group">
            <label>Wavelength <span id="wlVal">550 nm</span></label>
            <input type="range" id="wavelength" min="380" max="750" value="550" step="5">
            <div class="wavelength-preview" id="wlPreview"></div>
        </div>
        <div class="control-group">
            <label>Slit Width <span id="swVal">20</span></label>
            <input type="range" id="slitWidth" min="5" max="60" value="20" step="1">
        </div>
        <div class="control-group">
            <label>Slit Separation <span id="ssVal">80</span></label>
            <input type="range" id="slitSep" min="20" max="200" value="80" step="2">
        </div>
        <div class="control-group">
            <label>Screen Distance <span id="sdVal">400</span></label>
            <input type="range" id="screenDist" min="150" max="600" value="400" step="10">
        </div>
    </div>

    <div id="info">
        <h4>Young's Double Slit Experiment (1801)</h4>
        <p>Light passes through two narrow slits and the overlapping wave fronts
        create an interference pattern on a distant screen. Where crests meet crests
        (constructive interference), bright fringes appear. Where crests meet troughs
        (destructive interference), dark fringes form. This was the first definitive
        evidence that light behaves as a wave.</p>
    </div>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');

        let W, H;
        let time = 0;
        let animId;
        let paused = false;

        const sliders = {
            wavelength: document.getElementById('wavelength'),
            slitWidth: document.getElementById('slitWidth'),
            slitSep: document.getElementById('slitSep'),
            screenDist: document.getElementById('screenDist')
        };
        const vals = {
            wlVal: document.getElementById('wlVal'),
            swVal: document.getElementById('swVal'),
            ssVal: document.getElementById('ssVal'),
            sdVal: document.getElementById('sdVal')
        };
        const wlPreview = document.getElementById('wlPreview');

        function resize() {
            W = canvas.width = window.innerWidth;
            H = canvas.height = window.innerHeight;
        }
        resize();
        window.addEventListener('resize', resize);

        function wavelengthToRGB(wl) {
            let r = 0, g = 0, b = 0;
            if (wl >= 380 && wl < 440) {
                r = -(wl - 440) / (440 - 380);
                g = 0;
                b = 1;
            } else if (wl >= 440 && wl < 490) {
                r = 0;
                g = (wl - 440) / (490 - 440);
                b = 1;
            } else if (wl >= 490 && wl < 510) {
                r = 0;
                g = 1;
                b = -(wl - 510) / (510 - 490);
            } else if (wl >= 510 && wl < 580) {
                r = (wl - 510) / (580 - 510);
                g = 1;
                b = 0;
            } else if (wl >= 580 && wl < 645) {
                r = 1;
                g = -(wl - 645) / (645 - 580);
                b = 0;
            } else if (wl >= 645 && wl <= 750) {
                r = 1;
                g = 0;
                b = 0;
            }
            let factor;
            if (wl >= 380 && wl < 420) factor = 0.3 + 0.7 * (wl - 380) / (420 - 380);
            else if (wl >= 420 && wl <= 700) factor = 1.0;
            else if (wl > 700 && wl <= 750) factor = 0.3 + 0.7 * (750 - wl) / (750 - 700);
            else factor = 0;
            return [
                Math.round(255 * Math.pow(r * factor, 0.8)),
                Math.round(255 * Math.pow(g * factor, 0.8)),
                Math.round(255 * Math.pow(b * factor, 0.8))
            ];
        }

        function getParams() {
            const wl = +sliders.wavelength.value;
            const sw = +sliders.slitWidth.value;
            const ss = +sliders.slitSep.value;
            const sd = +sliders.screenDist.value;
            return { wl, sw, ss, sd };
        }

        function updateLabels() {
            const p = getParams();
            vals.wlVal.textContent = p.wl + ' nm';
            vals.swVal.textContent = p.sw;
            vals.ssVal.textContent = p.ss;
            vals.sdVal.textContent = p.sd;
            const rgb = wavelengthToRGB(p.wl);
            wlPreview.style.background = `rgb(${rgb[0]},${rgb[1]},${rgb[2]})`;
        }

        Object.values(sliders).forEach(s => s.addEventListener('input', updateLabels));
        updateLabels();

        function draw() {
            ctx.fillStyle = '#0a0e1a';
            ctx.fillRect(0, 0, W, H);

            const p = getParams();
            const rgb = wavelengthToRGB(p.wl);
            const waveColor = `rgb(${rgb[0]},${rgb[1]},${rgb[2]})`;

            // Scale wavelength for visual: real lambda ~ 400-750nm, we map to pixel wavelength
            const lambda = p.wl / 25; // pixel wavelength
            const k = 2 * Math.PI / lambda;
            const omega = 0.08; // angular frequency

            // Barrier position
            const barrierX = W * 0.3;
            // Slit positions (y center of screen)
            const cy = H / 2;
            const slit1Y = cy - p.ss / 2;
            const slit2Y = cy + p.ss / 2;

            // Screen position
            const screenX = barrierX + p.sd;

            // Draw barrier
            ctx.fillStyle = '#2a2a4a';
            ctx.fillRect(barrierX - 3, 0, 6, slit1Y - p.sw / 2);
            ctx.fillRect(barrierX - 3, slit1Y + p.sw / 2, 6, slit2Y - p.sw / 2 - slit1Y - p.sw / 2);
            ctx.fillRect(barrierX - 3, slit2Y + p.sw / 2, 6, H - slit2Y - p.sw / 2);

            // Draw slits highlighted
            ctx.fillStyle = 'rgba(' + rgb[0] + ',' + rgb[1] + ',' + rgb[2] + ',0.6)';
            ctx.fillRect(barrierX - 3, slit1Y - p.sw / 2, 6, p.sw);
            ctx.fillRect(barrierX - 3, slit2Y - p.sw / 2, 6, p.sw);

            // Draw incoming plane waves (left of barrier)
            ctx.save();
            ctx.globalAlpha = 0.15;
            for (let i = 0; i < 40; i++) {
                const x = barrierX - (i * lambda + (time * omega * lambda / (2 * Math.PI)) % lambda);
                if (x < 0) continue;
                ctx.strokeStyle = waveColor;
                ctx.lineWidth = 1.5;
                ctx.beginPath();
                ctx.moveTo(x, 0);
                ctx.lineTo(x, H);
                ctx.stroke();
            }
            ctx.restore();

            // Draw circular wave fronts from each slit (right of barrier)
            ctx.save();
            const maxR = Math.sqrt((W - barrierX) * (W - barrierX) + H * H);
            const numRings = Math.ceil(maxR / lambda);

            for (let slit = 0; slit < 2; slit++) {
                const sy = slit === 0 ? slit1Y : slit2Y;
                ctx.globalAlpha = 0.12;
                ctx.strokeStyle = waveColor;
                ctx.lineWidth = 1.2;

                for (let n = 0; n < numRings; n++) {
                    const r = n * lambda + (time * omega * lambda / (2 * Math.PI)) % lambda;
                    if (r < 2) continue;
                    ctx.beginPath();
                    ctx.arc(barrierX, sy, r, -Math.PI / 2, Math.PI / 2);
                    ctx.stroke();
                }
            }
            ctx.restore();

            // Compute interference pattern on the screen
            const intensities = [];
            const screenHeight = H;
            const graphWidth = 80;

            for (let py = 0; py < screenHeight; py++) {
                const y = py;
                const d1 = Math.sqrt((screenX - barrierX) * (screenX - barrierX) + (y - slit1Y) * (y - slit1Y));
                const d2 = Math.sqrt((screenX - barrierX) * (screenX - barrierX) + (y - slit2Y) * (y - slit2Y));

                // Single slit diffraction envelope
                const theta1 = Math.atan2(y - slit1Y, screenX - barrierX);
                const theta2 = Math.atan2(y - slit2Y, screenX - barrierX);
                const avgTheta = (theta1 + theta2) / 2;
                const beta = Math.PI * p.sw * Math.sin(avgTheta) / lambda;
                const envelope = beta === 0 ? 1 : Math.pow(Math.sin(beta) / beta, 2);

                // Double slit interference
                const phaseDiff = k * (d2 - d1);
                const interference = Math.pow(Math.cos(phaseDiff / 2), 2);

                const intensity = envelope * interference;
                intensities.push(intensity);
            }

            // Draw screen
            if (screenX < W - graphWidth - 20) {
                for (let py = 0; py < screenHeight; py++) {
                    const I = intensities[py];
                    ctx.fillStyle = `rgba(${Math.round(rgb[0] * I)},${Math.round(rgb[1] * I)},${Math.round(rgb[2] * I)},${0.3 + 0.7 * I})`;
                    ctx.fillRect(screenX - 2, py, 5, 1);
                }

                // Draw intensity graph
                const graphX = screenX + 20;
                ctx.strokeStyle = 'rgba(255,255,255,0.3)';
                ctx.lineWidth = 1;
                ctx.beginPath();
                ctx.moveTo(graphX, 0);
                ctx.lineTo(graphX, H);
                ctx.stroke();

                ctx.strokeStyle = waveColor;
                ctx.lineWidth = 2;
                ctx.beginPath();
                for (let py = 0; py < screenHeight; py++) {
                    const x = graphX + intensities[py] * graphWidth;
                    if (py === 0) ctx.moveTo(x, py);
                    else ctx.lineTo(x, py);
                }
                ctx.stroke();

                // Label
                ctx.fillStyle = 'rgba(255,255,255,0.5)';
                ctx.font = '11px sans-serif';
                ctx.fillText('Intensity', graphX + 10, 20);
            }

            // Draw screen line
            ctx.strokeStyle = 'rgba(255,255,255,0.15)';
            ctx.setLineDash([4, 4]);
            ctx.beginPath();
            ctx.moveTo(screenX, 0);
            ctx.lineTo(screenX, H);
            ctx.stroke();
            ctx.setLineDash([]);

            // Labels
            ctx.fillStyle = 'rgba(255,255,255,0.4)';
            ctx.font = '11px sans-serif';
            ctx.fillText('Light Source', 20, cy - 10);
            ctx.fillText('Barrier', barrierX - 20, 30);
            ctx.fillText('Screen', screenX - 15, 30);

            // Constructive / Destructive labels near screen center
            if (screenX < W - 120) {
                const centralMax = intensities[Math.floor(cy)];
                if (centralMax > 0.8) {
                    ctx.fillStyle = 'rgba(255,255,100,0.5)';
                    ctx.font = '10px sans-serif';
                    ctx.fillText('bright', screenX + 8, cy + 3);
                }
                // First dark fringe
                const firstDarkY = cy + (lambda * (screenX - barrierX)) / (2 * p.ss);
                if (firstDarkY < H && firstDarkY > 0) {
                    ctx.fillStyle = 'rgba(255,100,100,0.4)';
                    ctx.fillText('dark', screenX + 8, firstDarkY + 3);
                }
            }

            time += 1;
        }

        function animate() {
            if (!paused) draw();
            animId = requestAnimationFrame(animate);
        }

        window.reset = function() {
            time = 0;
            sliders.wavelength.value = 550;
            sliders.slitWidth.value = 20;
            sliders.slitSep.value = 80;
            sliders.screenDist.value = 400;
            updateLabels();
        };

        animate();
    </script>
    <script src="../assets/js/enhance.js"></script>
</body>
</html>
