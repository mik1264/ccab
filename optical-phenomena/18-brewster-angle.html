<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Brewster's Angle - Optical Phenomena</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            background: #0a0e1a;
            color: #e0e0e0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            overflow: hidden;
            width: 100vw;
            height: 100vh;
        }
        canvas {
            display: block;
            position: absolute;
            top: 0;
            left: 0;
        }
        .back-link {
            position: fixed;
            top: 15px;
            left: 15px;
            color: #8af;
            text-decoration: none;
            font-size: 14px;
            z-index: 100;
            background: rgba(20,20,40,0.85);
            padding: 6px 14px;
            border-radius: 8px;
            backdrop-filter: blur(10px);
        }
        .back-link:hover { color: #bdf; }
        #controls {
            position: fixed;
            top: 15px;
            right: 15px;
            background: rgba(20,20,40,0.85);
            backdrop-filter: blur(10px);
            border-radius: 12px;
            padding: 16px;
            z-index: 100;
            width: 270px;
            border: 1px solid rgba(100,140,255,0.15);
        }
        #controls h3 {
            color: #8af;
            margin-bottom: 10px;
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .control-group {
            margin-bottom: 10px;
        }
        .control-group label {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            margin-bottom: 3px;
            color: #aaa;
        }
        .control-group label span { color: #8af; }
        input[type="range"] {
            width: 100%;
            height: 4px;
            -webkit-appearance: none;
            background: rgba(100,140,255,0.2);
            border-radius: 2px;
            outline: none;
        }
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 14px;
            height: 14px;
            border-radius: 50%;
            background: #8af;
            cursor: pointer;
        }
        #info {
            position: fixed;
            bottom: 15px;
            left: 15px;
            background: rgba(20,20,40,0.85);
            backdrop-filter: blur(10px);
            border-radius: 12px;
            padding: 14px 18px;
            z-index: 100;
            max-width: 380px;
            border: 1px solid rgba(100,140,255,0.15);
            font-size: 12px;
            line-height: 1.6;
            color: #bbb;
        }
        #info h4 { color: #8af; margin-bottom: 6px; font-size: 13px; }
        .brewster-indicator {
            margin-top: 8px;
            padding: 6px 10px;
            border-radius: 6px;
            font-size: 12px;
            text-align: center;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <a href="index.html" class="back-link">&#8592; Optical Phenomena</a>
    <canvas id="canvas"></canvas>
    <div id="controls">
        <h3>Brewster's Angle</h3>
        <div class="control-group">
            <label>Incident Angle <span id="angleVal">56.3&#176;</span></label>
            <input type="range" id="angleSlider" min="1" max="89" value="56" step="0.1">
        </div>
        <div class="control-group">
            <label>Refractive Index (n&#8322;) <span id="nVal">1.50</span></label>
            <input type="range" id="nSlider" min="1.1" max="2.5" value="1.5" step="0.01">
        </div>
        <div id="brewsterInfo" class="brewster-indicator" style="background:rgba(100,200,100,0.15);color:#8f8;">
            Brewster's angle: 56.3&#176;
        </div>
        <div style="margin-top:10px;font-size:11px;color:#888;">
            <div>s-pol reflectance: <span id="sRef" style="color:#f88;">14.0%</span></div>
            <div>p-pol reflectance: <span id="pRef" style="color:#8bf;">0.0%</span></div>
        </div>
        <div style="margin-top:8px;font-size:10px;color:#666;">
            Applications: Anti-glare windows, laser Brewster windows, polarizing photography
        </div>
    </div>
    <div id="info">
        <h4>Brewster's Angle</h4>
        <p>At Brewster's angle &theta;<sub>B</sub> = arctan(n&#8322;/n&#8321;), the reflected light is <strong>100% s-polarized</strong>. The p-polarization reflectance drops to <strong>zero</strong>.</p>
        <p style="margin-top:5px;">This is why polarized sunglasses reduce glare from water and roads &mdash; the reflected light near Brewster's angle is predominantly s-polarized.</p>
    </div>
    <script>
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');

    let W, H;
    function resize() {
        W = canvas.width = window.innerWidth;
        H = canvas.height = window.innerHeight;
    }
    resize();
    window.addEventListener('resize', resize);

    let incAngle = 56;
    let n2 = 1.5;
    let time = 0;

    const angleSlider = document.getElementById('angleSlider');
    const nSlider = document.getElementById('nSlider');

    function getBrewster() {
        return Math.atan(n2) * 180 / Math.PI;
    }

    function fresnelS(theta1Deg) {
        const t1 = theta1Deg * Math.PI / 180;
        const sinT2 = Math.sin(t1) / n2;
        if (Math.abs(sinT2) > 1) return 1;
        const t2 = Math.asin(sinT2);
        const rs = Math.sin(t1 - t2) / Math.sin(t1 + t2);
        return rs * rs;
    }

    function fresnelP(theta1Deg) {
        const t1 = theta1Deg * Math.PI / 180;
        const sinT2 = Math.sin(t1) / n2;
        if (Math.abs(sinT2) > 1) return 1;
        const t2 = Math.asin(sinT2);
        const denom = Math.tan(t1 + t2);
        if (Math.abs(denom) < 0.0001) return 0;
        const rp = Math.tan(t1 - t2) / denom;
        return rp * rp;
    }

    function updateUI() {
        const brewster = getBrewster();
        document.getElementById('angleVal').innerHTML = incAngle.toFixed(1) + '&#176;';
        document.getElementById('nVal').textContent = n2.toFixed(2);
        document.getElementById('brewsterInfo').innerHTML = "Brewster's angle: " + brewster.toFixed(1) + '\u00B0';
        const rs = fresnelS(incAngle);
        const rp = fresnelP(incAngle);
        document.getElementById('sRef').textContent = (rs * 100).toFixed(1) + '%';
        document.getElementById('pRef').textContent = (rp * 100).toFixed(1) + '%';
        const diff = Math.abs(incAngle - brewster);
        if (diff < 1) {
            document.getElementById('brewsterInfo').style.background = 'rgba(100,255,100,0.25)';
            document.getElementById('brewsterInfo').style.color = '#8f8';
        } else {
            document.getElementById('brewsterInfo').style.background = 'rgba(100,140,255,0.1)';
            document.getElementById('brewsterInfo').style.color = '#8af';
        }
    }

    angleSlider.oninput = () => {
        incAngle = +angleSlider.value;
        updateUI();
    };
    nSlider.oninput = () => {
        n2 = +nSlider.value;
        updateUI();
    };

    function drawSurface() {
        const cy = H * 0.5;
        ctx.fillStyle = 'rgba(60,80,120,0.2)';
        ctx.fillRect(0, cy, W, H * 0.5);
        ctx.strokeStyle = 'rgba(100,140,255,0.4)';
        ctx.lineWidth = 2;
        ctx.beginPath();
        ctx.moveTo(0, cy);
        ctx.lineTo(W, cy);
        ctx.stroke();
        ctx.setLineDash([6, 6]);
        ctx.strokeStyle = 'rgba(255,255,255,0.2)';
        ctx.lineWidth = 1;
        ctx.beginPath();
        ctx.moveTo(W * 0.45, cy - 200);
        ctx.lineTo(W * 0.45, cy + 200);
        ctx.stroke();
        ctx.setLineDash([]);
        ctx.fillStyle = '#666';
        ctx.font = '11px sans-serif';
        ctx.fillText('n\u2081 = 1.00 (air)', W * 0.45 + 10, cy - 180);
        ctx.fillText('n\u2082 = ' + n2.toFixed(2), W * 0.45 + 10, cy + 190);
        ctx.fillText('Normal', W * 0.45 + 10, cy - 8);
    }

    function drawRay(ox, oy, angleDeg, length, color, width, alpha, dashed) {
        const rad = angleDeg * Math.PI / 180;
        const ex = ox + Math.cos(rad) * length;
        const ey = oy - Math.sin(rad) * length;
        ctx.save();
        ctx.globalAlpha = alpha;
        ctx.strokeStyle = color;
        ctx.lineWidth = width;
        if (dashed) ctx.setLineDash([4, 4]);
        ctx.beginPath();
        ctx.moveTo(ox, oy);
        ctx.lineTo(ex, ey);
        ctx.stroke();
        ctx.setLineDash([]);
        const arrLen = 10;
        const arrAngle = 0.35;
        ctx.fillStyle = color;
        ctx.beginPath();
        ctx.moveTo(ex, ey);
        ctx.lineTo(ex - Math.cos(rad - arrAngle) * arrLen, ey + Math.sin(rad - arrAngle) * arrLen);
        ctx.lineTo(ex - Math.cos(rad + arrAngle) * arrLen, ey + Math.sin(rad + arrAngle) * arrLen);
        ctx.fill();
        ctx.restore();
    }

    function drawWaveOnRay(ox, oy, angleDeg, length, polAngle, color, intensity, t) {
        if (intensity < 0.01) return;
        const rad = angleDeg * Math.PI / 180;
        const perpX = Math.sin(rad);
        const perpY = Math.cos(rad);
        ctx.save();
        ctx.globalAlpha = Math.min(1, intensity * 0.8 + 0.2);
        ctx.strokeStyle = color;
        ctx.lineWidth = 1.5;
        ctx.beginPath();
        const amp = 12 * Math.sqrt(intensity);
        for (let d = 0; d < length; d += 2) {
            const frac = d / length;
            const wave = Math.sin(d * 0.06 - t * 4) * amp;
            const px = ox + Math.cos(rad) * d + perpX * wave;
            const py = oy - Math.sin(rad) * d + perpY * wave;
            if (d === 0) ctx.moveTo(px, py);
            else ctx.lineTo(px, py);
        }
        ctx.stroke();
        ctx.restore();
    }

    function drawGraph() {
        const gx = 50;
        const gy = H * 0.08;
        const gw = 220;
        const gh = 140;
        ctx.fillStyle = 'rgba(20,20,40,0.8)';
        ctx.fillRect(gx - 5, gy - 5, gw + 30, gh + 40);
        ctx.strokeStyle = 'rgba(255,255,255,0.2)';
        ctx.lineWidth = 1;
        ctx.strokeRect(gx, gy, gw, gh);
        ctx.fillStyle = '#888';
        ctx.font = '10px sans-serif';
        ctx.textAlign = 'center';
        ctx.fillText('Incidence angle', gx + gw / 2, gy + gh + 28);
        ctx.save();
        ctx.translate(gx - 18, gy + gh / 2);
        ctx.rotate(-Math.PI / 2);
        ctx.fillText('Reflectance', 0, 0);
        ctx.restore();
        ctx.textAlign = 'left';
        ctx.fillText('0\u00B0', gx, gy + gh + 14);
        ctx.textAlign = 'right';
        ctx.fillText('90\u00B0', gx + gw, gy + gh + 14);
        ctx.textAlign = 'left';
        ctx.fillText('100%', gx + gw + 4, gy + 6);
        ctx.fillText('0%', gx + gw + 4, gy + gh + 4);
        ctx.strokeStyle = '#f88';
        ctx.lineWidth = 2;
        ctx.beginPath();
        for (let a = 1; a <= 89; a++) {
            const x = gx + (a / 90) * gw;
            const y = gy + gh - fresnelS(a) * gh;
            if (a === 1) ctx.moveTo(x, y);
            else ctx.lineTo(x, y);
        }
        ctx.stroke();
        ctx.strokeStyle = '#88f';
        ctx.lineWidth = 2;
        ctx.beginPath();
        for (let a = 1; a <= 89; a++) {
            const x = gx + (a / 90) * gw;
            const y = gy + gh - fresnelP(a) * gh;
            if (a === 1) ctx.moveTo(x, y);
            else ctx.lineTo(x, y);
        }
        ctx.stroke();
        const brewster = getBrewster();
        const bx = gx + (brewster / 90) * gw;
        ctx.setLineDash([3, 3]);
        ctx.strokeStyle = 'rgba(100,255,100,0.5)';
        ctx.lineWidth = 1;
        ctx.beginPath();
        ctx.moveTo(bx, gy);
        ctx.lineTo(bx, gy + gh);
        ctx.stroke();
        ctx.setLineDash([]);
        ctx.fillStyle = '#8f8';
        ctx.font = '9px sans-serif';
        ctx.textAlign = 'center';
        ctx.fillText('\u03B8B', bx, gy - 4);
        const cx = gx + (incAngle / 90) * gw;
        ctx.strokeStyle = 'rgba(255,255,255,0.6)';
        ctx.lineWidth = 1.5;
        ctx.beginPath();
        ctx.moveTo(cx, gy);
        ctx.lineTo(cx, gy + gh);
        ctx.stroke();
        ctx.fillStyle = '#f88';
        ctx.font = '10px sans-serif';
        ctx.textAlign = 'left';
        ctx.fillText('s-pol', gx + gw - 60, gy + 15);
        ctx.fillStyle = '#88f';
        ctx.fillText('p-pol', gx + gw - 60, gy + 28);
    }

    function animate(ts) {
        time = ts * 0.001;
        ctx.clearRect(0, 0, W, H);
        drawSurface();

        const hitX = W * 0.45;
        const hitY = H * 0.5;
        const incRad = incAngle * Math.PI / 180;
        const rayLen = 250;
        const incStartX = hitX - Math.sin(incRad) * rayLen;
        const incStartY = hitY - Math.cos(incRad) * rayLen;
        drawRay(incStartX, incStartY, 90 - incAngle, rayLen, '#fff', 2, 0.8, false);
        drawWaveOnRay(incStartX, incStartY, 90 - incAngle, rayLen, 0, '#aaf', 0.5, time);
        const rs = fresnelS(incAngle);
        const rp = fresnelP(incAngle);
        const refAngle = 180 - (90 - incAngle);
        drawRay(hitX, hitY, refAngle, rayLen * Math.max(0.3, (rs + rp) / 2 + 0.3), '#f88', 2, Math.max(0.15, rs), false);
        drawWaveOnRay(hitX, hitY, refAngle, rayLen * 0.8, 0, '#f88', rs, time);
        if (rp > 0.01) {
            drawWaveOnRay(hitX, hitY, refAngle, rayLen * 0.7, 90, '#88f', rp, time);
        }
        const sinT2 = Math.sin(incRad) / n2;
        if (Math.abs(sinT2) <= 1) {
            const transAngle = Math.asin(sinT2);
            const transAngleDeg = transAngle * 180 / Math.PI;
            const ts2 = 1 - (rs + rp) / 2;
            drawRay(hitX, hitY, -(90 - transAngleDeg), rayLen, '#8f8', 2, Math.max(0.3, ts2), false);
            drawWaveOnRay(hitX, hitY, -(90 - transAngleDeg), rayLen * 0.8, 0, '#8f8', ts2, time);
        }
        ctx.fillStyle = '#aaa';
        ctx.font = '11px sans-serif';
        ctx.textAlign = 'center';
        ctx.fillText('Incident', incStartX + 40, incStartY - 10);
        ctx.fillStyle = '#f88';
        const refEndX = hitX + Math.sin(incRad) * 100;
        const refEndY = hitY - Math.cos(incRad) * 100;
        ctx.fillText('Reflected', refEndX + 30, refEndY - 10);
        ctx.fillStyle = '#8f8';
        if (Math.abs(sinT2) <= 1) {
            const t2 = Math.asin(sinT2);
            ctx.fillText('Transmitted', hitX + Math.sin(t2) * 120 + 30, hitY + Math.cos(t2) * 120);
        }
        ctx.save();
        ctx.beginPath();
        ctx.arc(hitX, hitY, 40, -Math.PI / 2 - incRad, -Math.PI / 2);
        ctx.strokeStyle = 'rgba(255,255,255,0.4)';
        ctx.lineWidth = 1;
        ctx.stroke();
        ctx.fillStyle = '#ddd';
        ctx.font = '10px sans-serif';
        ctx.fillText('\u03B8\u2081=' + incAngle.toFixed(1) + '\u00B0', hitX - 55, hitY - 45);
        ctx.restore();
        drawGraph();
        requestAnimationFrame(animate);
    }

    window.reset = function() {
        incAngle = 56;
        n2 = 1.5;
        angleSlider.value = 56;
        nSlider.value = 1.5;
        updateUI();
    };

    updateUI();
    requestAnimationFrame(animate);
    </script>
    <script src="../assets/js/enhance.js"></script>
</body>
</html>
