<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rise of the Nones - American Religious Trends</title>
    <link href="https://fonts.googleapis.com/css2?family=Lora:wght@400;500;600;700&family=Nunito:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --cream: #FEFAE0;
            --earth: #DDA15E;
            --terracotta: #BC6C25;
            --none-blue: #5dade2;
            --atheist: #2e86ab;
            --agnostic: #58b19f;
            --nothing: #82c4c3;
            --christian: #d4a373;
        }

        body {
            font-family: 'Nunito', sans-serif;
            background: linear-gradient(135deg, #0a0a12 0%, #1a1a2e 50%, #0a0a12 100%);
            color: var(--cream);
            min-height: 100vh;
            overflow-x: hidden;
        }

        .back-link {
            position: fixed;
            top: 20px;
            left: 20px;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--earth);
            text-decoration: none;
            font-weight: 600;
            padding: 0.5rem 1rem;
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            transition: all 0.3s ease;
            z-index: 100;
        }

        .back-link:hover {
            background: rgba(221, 161, 94, 0.2);
            transform: translateX(-5px);
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
            padding-top: 80px;
        }

        .header {
            text-align: center;
            margin-bottom: 1.5rem;
        }

        h1 {
            font-family: 'Lora', serif;
            font-size: clamp(1.8rem, 4vw, 2.5rem);
            font-weight: 700;
            color: var(--cream);
            margin-bottom: 0.5rem;
        }

        .subtitle {
            font-size: 1rem;
            color: var(--earth);
            opacity: 0.9;
        }

        .chart-container {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            border: 1px solid rgba(255, 255, 255, 0.08);
        }

        #chart {
            width: 100%;
            height: 400px;
        }

        .stats-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 16px;
            padding: 1.25rem;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.08);
        }

        .stat-icon {
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
        }

        .stat-value {
            font-family: 'Lora', serif;
            font-size: 2.25rem;
            font-weight: 700;
            color: var(--none-blue);
        }

        .stat-label {
            font-size: 0.85rem;
            opacity: 0.7;
            margin-top: 0.25rem;
        }

        .stat-sublabel {
            font-size: 0.75rem;
            opacity: 0.5;
            margin-top: 0.15rem;
        }

        .generation-breakdown {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 16px;
            padding: 1.5rem;
            margin-top: 1.5rem;
        }

        .generation-title {
            font-family: 'Lora', serif;
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 1rem;
            color: var(--earth);
        }

        .generation-bars {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .gen-row {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .gen-label {
            width: 120px;
            font-size: 0.9rem;
            flex-shrink: 0;
        }

        .gen-bar-container {
            flex: 1;
            height: 24px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            overflow: hidden;
            position: relative;
        }

        .gen-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--none-blue), var(--agnostic));
            border-radius: 12px;
            transition: width 1s ease-out;
        }

        .gen-value {
            width: 50px;
            text-align: right;
            font-weight: 600;
            color: var(--none-blue);
        }

        .tooltip {
            position: absolute;
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 12px 16px;
            border-radius: 10px;
            font-size: 0.9rem;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.2s;
            z-index: 1000;
            max-width: 280px;
        }

        .key-insight {
            background: rgba(93, 173, 226, 0.1);
            border: 1px solid rgba(93, 173, 226, 0.3);
            border-radius: 16px;
            padding: 1.5rem;
            margin-top: 1.5rem;
        }

        .key-insight h3 {
            font-family: 'Lora', serif;
            font-size: 1.1rem;
            color: var(--none-blue);
            margin-bottom: 0.75rem;
        }

        .key-insight p {
            font-size: 0.95rem;
            line-height: 1.6;
            opacity: 0.85;
        }

        .composition-chart {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-top: 1rem;
            flex-wrap: wrap;
        }

        .composition-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.85rem;
        }

        .comp-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }

        @media (max-width: 768px) {
            .container {
                padding: 1rem;
                padding-top: 70px;
            }

            #chart {
                height: 300px;
            }

            .stats-row {
                grid-template-columns: repeat(2, 1fr);
            }

            .gen-label {
                width: 80px;
                font-size: 0.8rem;
            }
        }
    </style>
</head>
<body>
    <a href="index.html" class="back-link">← Back to Gallery</a>

    <div class="container">
        <header class="header">
            <h1>Rise of the Nones</h1>
            <p class="subtitle">The explosive growth of the religiously unaffiliated (1972–2024)</p>
        </header>

        <div class="stats-row">
            <div class="stat-card">
                <div class="stat-value">5%</div>
                <div class="stat-label">1972 Baseline</div>
                <div class="stat-sublabel">First GSS measurement</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" style="color: #58b19f;">29%</div>
                <div class="stat-label">2021 Peak</div>
                <div class="stat-sublabel">Nearly 1 in 3 Americans</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" style="color: #2e86ab;">+480%</div>
                <div class="stat-label">Total Growth</div>
                <div class="stat-sublabel">Over 50 years</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" style="color: #82c4c3;">~75M</div>
                <div class="stat-label">Americans</div>
                <div class="stat-sublabel">Currently unaffiliated</div>
            </div>
        </div>

        <div class="chart-container">
            <div id="chart"></div>
            <div class="composition-chart">
                <div class="composition-item">
                    <div class="comp-dot" style="background: #2e86ab;"></div>
                    <span>Atheist (~4%)</span>
                </div>
                <div class="composition-item">
                    <div class="comp-dot" style="background: #58b19f;"></div>
                    <span>Agnostic (~5%)</span>
                </div>
                <div class="composition-item">
                    <div class="comp-dot" style="background: #82c4c3;"></div>
                    <span>"Nothing in particular" (~20%)</span>
                </div>
            </div>
        </div>

        <div class="generation-breakdown">
            <h3 class="generation-title">Generational Divide: % Religiously Unaffiliated</h3>
            <div class="generation-bars">
                <div class="gen-row">
                    <div class="gen-label">Gen Z (1997+)</div>
                    <div class="gen-bar-container">
                        <div class="gen-bar" style="width: 0%;" data-value="34"></div>
                    </div>
                    <div class="gen-value">34%</div>
                </div>
                <div class="gen-row">
                    <div class="gen-label">Millennials</div>
                    <div class="gen-bar-container">
                        <div class="gen-bar" style="width: 0%;" data-value="32"></div>
                    </div>
                    <div class="gen-value">32%</div>
                </div>
                <div class="gen-row">
                    <div class="gen-label">Gen X</div>
                    <div class="gen-bar-container">
                        <div class="gen-bar" style="width: 0%;" data-value="25"></div>
                    </div>
                    <div class="gen-value">25%</div>
                </div>
                <div class="gen-row">
                    <div class="gen-label">Baby Boomers</div>
                    <div class="gen-bar-container">
                        <div class="gen-bar" style="width: 0%;" data-value="18"></div>
                    </div>
                    <div class="gen-value">18%</div>
                </div>
                <div class="gen-row">
                    <div class="gen-label">Silent Gen</div>
                    <div class="gen-bar-container">
                        <div class="gen-bar" style="width: 0%;" data-value="10"></div>
                    </div>
                    <div class="gen-value">10%</div>
                </div>
            </div>
        </div>

        <div class="key-insight">
            <h3>The "Stickiness" Problem</h3>
            <p>What distinguishes this trend from historical patterns is that having no religious affiliation has become "stickier." In the past, young adults often drifted away from religion in their 20s and returned when they married and had children. Today, a declining percentage of people raised without religion convert later in life, and those who leave are less likely to return. The religious marketplace has become essentially a one-way street: for every person who converts to Christianity, several leave to join the ranks of the unaffiliated.</p>
        </div>
    </div>

    <div class="tooltip" id="tooltip"></div>

    <script>
        // Data: % of U.S. population identifying as "None" (no religious affiliation)
        const nonesData = [
            { year: 1972, value: 5, context: "First GSS measurement; religious America at zenith" },
            { year: 1975, value: 6, context: "Post-Vietnam moral uncertainty" },
            { year: 1980, value: 7, context: "Rise of Moral Majority; backlash begins" },
            { year: 1985, value: 7, context: "Reagan era religious conservatism" },
            { year: 1990, value: 9, context: "Cold War ends; identity politics emerge" },
            { year: 1995, value: 10, context: "Internet age begins; information access expands" },
            { year: 2000, value: 14, context: "New millennium; digital natives come of age" },
            { year: 2004, value: 14, context: "Political polarization intensifies" },
            { year: 2007, value: 16, context: "First Pew Religious Landscape Study" },
            { year: 2010, value: 18, context: "Social media becomes ubiquitous" },
            { year: 2012, value: 20, context: "One in five Americans now unaffiliated" },
            { year: 2014, value: 23, context: "Second Pew Religious Landscape Study" },
            { year: 2017, value: 26, context: "Political backlash against Religious Right" },
            { year: 2019, value: 26, context: "Pre-pandemic levels" },
            { year: 2021, value: 29, context: "Post-COVID acceleration; near one-third mark" },
            { year: 2024, value: 28, context: "Possible plateau; stabilization signs" }
        ];

        // Breakdown data for stacked area
        const breakdownData = nonesData.map(d => ({
            year: d.year,
            atheist: d.value * 0.14,      // ~14% of nones are atheist
            agnostic: d.value * 0.17,     // ~17% agnostic
            nothing: d.value * 0.69       // ~69% "nothing in particular"
        }));

        const margin = { top: 30, right: 30, bottom: 50, left: 50 };
        let width, height;

        const svg = d3.select("#chart")
            .append("svg")
            .attr("width", "100%")
            .attr("height", "100%");

        const chartGroup = svg.append("g")
            .attr("transform", `translate(${margin.left},${margin.top})`);

        const tooltip = d3.select("#tooltip");

        function updateDimensions() {
            const container = document.getElementById("chart");
            width = container.clientWidth - margin.left - margin.right;
            height = container.clientHeight - margin.top - margin.bottom;
        }

        function drawChart() {
            chartGroup.selectAll("*").remove();

            const xScale = d3.scaleLinear()
                .domain([1972, 2024])
                .range([0, width]);

            const yScale = d3.scaleLinear()
                .domain([0, 35])
                .range([height, 0]);

            // Grid lines
            chartGroup.selectAll(".grid-line")
                .data([10, 20, 30])
                .enter()
                .append("line")
                .attr("class", "grid-line")
                .attr("x1", 0)
                .attr("x2", width)
                .attr("y1", d => yScale(d))
                .attr("y2", d => yScale(d))
                .attr("stroke", "rgba(255,255,255,0.1)")
                .attr("stroke-dasharray", "3,3");

            // Axes
            chartGroup.append("g")
                .attr("class", "x-axis")
                .attr("transform", `translate(0,${height})`)
                .call(d3.axisBottom(xScale).tickFormat(d3.format("d")).ticks(8))
                .selectAll("text")
                .style("fill", "rgba(255,255,255,0.7)");

            chartGroup.append("g")
                .attr("class", "y-axis")
                .call(d3.axisLeft(yScale).tickFormat(d => d + "%").ticks(5))
                .selectAll("text")
                .style("fill", "rgba(255,255,255,0.7)");

            chartGroup.selectAll(".x-axis path, .x-axis line, .y-axis path, .y-axis line")
                .style("stroke", "rgba(255,255,255,0.2)");

            // Stacked area
            const stack = d3.stack()
                .keys(["atheist", "agnostic", "nothing"])
                .order(d3.stackOrderNone)
                .offset(d3.stackOffsetNone);

            const series = stack(breakdownData);

            const colorScale = d3.scaleOrdinal()
                .domain(["atheist", "agnostic", "nothing"])
                .range(["#2e86ab", "#58b19f", "#82c4c3"]);

            const area = d3.area()
                .x(d => xScale(d.data.year))
                .y0(d => yScale(d[0]))
                .y1(d => yScale(d[1]))
                .curve(d3.curveMonotoneX);

            // Draw stacked areas with animation
            const areas = chartGroup.selectAll(".area")
                .data(series)
                .enter()
                .append("path")
                .attr("class", d => `area area-${d.key}`)
                .attr("fill", d => colorScale(d.key))
                .attr("opacity", 0.7)
                .attr("d", d => {
                    // Start with flat area at bottom
                    const flatArea = d3.area()
                        .x(d => xScale(d.data.year))
                        .y0(height)
                        .y1(height)
                        .curve(d3.curveMonotoneX);
                    return flatArea(d);
                })
                .transition()
                .duration(1500)
                .ease(d3.easeCubicOut)
                .attr("d", area);

            // Top line (total)
            const line = d3.line()
                .x(d => xScale(d.year))
                .y(d => yScale(d.value))
                .curve(d3.curveMonotoneX);

            const path = chartGroup.append("path")
                .datum(nonesData)
                .attr("class", "total-line")
                .attr("fill", "none")
                .attr("stroke", "#5dade2")
                .attr("stroke-width", 3)
                .attr("d", line);

            // Animate line
            const totalLength = path.node().getTotalLength();
            path.attr("stroke-dasharray", totalLength + " " + totalLength)
                .attr("stroke-dashoffset", totalLength)
                .transition()
                .duration(2000)
                .ease(d3.easeLinear)
                .attr("stroke-dashoffset", 0);

            // Data points
            chartGroup.selectAll(".data-point")
                .data(nonesData)
                .enter()
                .append("circle")
                .attr("class", "data-point")
                .attr("cx", d => xScale(d.year))
                .attr("cy", d => yScale(d.value))
                .attr("r", 0)
                .attr("fill", "#5dade2")
                .attr("stroke", "#fff")
                .attr("stroke-width", 2)
                .style("cursor", "pointer")
                .transition()
                .delay((d, i) => i * 100 + 1000)
                .duration(300)
                .attr("r", 5);

            // Tooltip interaction
            chartGroup.selectAll(".data-point")
                .on("mouseover", function(event, d) {
                    d3.select(this).attr("r", 8);
                    tooltip.style("opacity", 1)
                        .html(`
                            <strong style="color: #5dade2;">${d.year}: ${d.value}% unaffiliated</strong><br>
                            <span style="opacity: 0.8;">${d.context}</span>
                        `)
                        .style("left", (event.pageX + 15) + "px")
                        .style("top", (event.pageY - 30) + "px");
                })
                .on("mouseout", function() {
                    d3.select(this).attr("r", 5);
                    tooltip.style("opacity", 0);
                });

            // Key year annotations
            const annotations = [
                { year: 1990, label: "Cold War ends", yOffset: -15 },
                { year: 2007, label: "First Pew Study", yOffset: 20 },
                { year: 2020, label: "COVID-19", yOffset: -20 }
            ];

            annotations.forEach(ann => {
                const dataPoint = nonesData.find(d => d.year === ann.year);
                if (dataPoint) {
                    chartGroup.append("text")
                        .attr("x", xScale(ann.year))
                        .attr("y", yScale(dataPoint.value) + ann.yOffset)
                        .attr("text-anchor", "middle")
                        .style("fill", "rgba(255,255,255,0.6)")
                        .style("font-size", "11px")
                        .style("opacity", 0)
                        .text(ann.label)
                        .transition()
                        .delay(2000)
                        .duration(500)
                        .style("opacity", 1);
                }
            });
        }

        function animateGenerationBars() {
            document.querySelectorAll('.gen-bar').forEach((bar, i) => {
                const value = bar.dataset.value;
                setTimeout(() => {
                    bar.style.width = value + '%';
                }, 200 + i * 150);
            });
        }

        // Initialize
        function init() {
            updateDimensions();
            drawChart();
            setTimeout(animateGenerationBars, 500);
        }

        window.addEventListener("resize", () => {
            updateDimensions();
            drawChart();
        });

        init();
    </script>
    <script src="../assets/js/enhance.js" defer></script>
</body>
</html>
