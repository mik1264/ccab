<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Solar System Simulation - N-Body Gravity</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            background: linear-gradient(to bottom, #000000, #0a0a1a);
            color: #ffffff;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }

        h1 {
            margin: 0 0 10px 0;
            font-size: 2em;
            text-align: center;
            background: linear-gradient(45deg, #ffd700, #ff8c00);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .description {
            max-width: 900px;
            text-align: center;
            margin-bottom: 20px;
            color: #cccccc;
            line-height: 1.6;
        }

        .container {
            background: rgba(0, 0, 0, 0.5);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 10px 40px rgba(255, 215, 0, 0.3);
        }

        canvas {
            display: block;
            background: radial-gradient(circle at center, #0a0a1a, #000000);
            border-radius: 10px;
            box-shadow: 0 0 50px rgba(255, 215, 0, 0.2) inset;
        }

        .controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 20px;
            max-width: 900px;
        }

        .control-group {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 10px;
            border: 1px solid rgba(255, 215, 0, 0.3);
        }

        .control-group label {
            display: block;
            margin-bottom: 8px;
            color: #ffd700;
            font-weight: 600;
        }

        input[type="range"] {
            width: 100%;
            margin: 5px 0;
        }

        input[type="checkbox"] {
            margin-right: 8px;
        }

        button {
            background: linear-gradient(45deg, #ffd700, #ff8c00);
            border: none;
            color: #000;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            font-size: 14px;
            transition: transform 0.2s;
        }

        button:hover {
            transform: scale(1.05);
        }

        button:active {
            transform: scale(0.95);
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
            margin-top: 15px;
        }

        .stat {
            background: rgba(255, 215, 0, 0.1);
            padding: 10px;
            border-radius: 5px;
            text-align: center;
        }

        .stat-value {
            font-size: 1.5em;
            color: #ffd700;
            font-weight: bold;
        }

        .stat-label {
            font-size: 0.9em;
            color: #cccccc;
        }

        .planet-info {
            background: rgba(255, 255, 255, 0.05);
            padding: 10px;
            border-radius: 5px;
            margin-top: 10px;
            font-size: 0.9em;
            max-height: 200px;
            overflow-y: auto;
        }

        .planet-row {
            display: flex;
            justify-content: space-between;
            padding: 5px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .planet-name {
            font-weight: bold;
        }
    </style>
</head>
<body>
    <h1>⭐ Solar System Simulation</h1>
    <div class="description">
        <p>
            <strong>N-Body Gravitational Simulation</strong> of our Solar System using Newton's Law of Universal Gravitation.
            Each planet orbits according to F = G·m₁·m₂/r². Watch the complex gravitational interactions between all bodies,
            including the Sun's wobble caused by Jupiter's massive influence. Uses Velocity Verlet integration for stable, long-term orbits.
        </p>
    </div>

    <div class="container">
        <canvas id="canvas" width="900" height="900"></canvas>

        <div class="controls">
            <div class="control-group">
                <label>Time Scale: <span id="timeScaleValue">1.0</span>x</label>
                <input type="range" id="timeScale" min="0.1" max="5" step="0.1" value="1">

                <label>Trail Length: <span id="trailLengthValue">100</span></label>
                <input type="range" id="trailLength" min="10" max="500" step="10" value="100">

                <label>Zoom: <span id="zoomValue">1.0</span>x</label>
                <input type="range" id="zoom" min="0.5" max="3" step="0.1" value="1">
            </div>

            <div class="control-group">
                <label><input type="checkbox" id="showTrails" checked> Show Orbital Trails</label>
                <label><input type="checkbox" id="showNames" checked> Show Planet Names</label>
                <label><input type="checkbox" id="showDistances"> Show Distances</label>
                <label><input type="checkbox" id="showGrid"> Show Grid</label>
            </div>

            <div class="control-group">
                <button id="pauseBtn">Pause</button>
                <button id="resetBtn">Reset</button>
                <button id="centerSun">Center on Sun</button>
                <button id="centerEarth">Center on Earth</button>
            </div>
        </div>

        <div class="stats">
            <div class="stat">
                <div class="stat-value" id="fps">60</div>
                <div class="stat-label">FPS</div>
            </div>
            <div class="stat">
                <div class="stat-value" id="simTime">0</div>
                <div class="stat-label">Earth Years</div>
            </div>
            <div class="stat">
                <div class="stat-value" id="energy">0</div>
                <div class="stat-label">Total Energy</div>
            </div>
        </div>

        <div class="planet-info" id="planetInfo"></div>
    </div>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');

        // Physics constants (scaled for visual appeal)
        const G = 100; // Gravitational constant (scaled)
        const SOFTENING = 0.5; // Softening factor to prevent singularities
        const DT = 0.001; // Time step for integration

        // Simulation state
        let bodies = [];
        let paused = false;
        let timeScale = 1.0;
        let trailLength = 100;
        let zoom = 1.0;
        let showTrails = true;
        let showNames = true;
        let showDistances = false;
        let showGrid = false;
        let centerBody = null;
        let simTime = 0;
        let frameCount = 0;
        let lastFpsUpdate = Date.now();
        let fps = 60;

        // Planet data (semi-realistic scaled values)
        const planetData = [
            { name: 'Sun', mass: 1000, radius: 20, color: '#FDB813', x: 0, y: 0, vx: 0, vy: 0 },
            { name: 'Mercury', mass: 0.055, radius: 3, color: '#8C7853', distance: 60, speed: 4.7 },
            { name: 'Venus', mass: 0.815, radius: 6, color: '#FFC649', distance: 90, speed: 3.5 },
            { name: 'Earth', mass: 1, radius: 6, color: '#4169E1', distance: 120, speed: 2.98 },
            { name: 'Mars', mass: 0.107, radius: 4, color: '#CD5C5C', distance: 150, speed: 2.4 },
            { name: 'Jupiter', mass: 318, radius: 16, color: '#DAA520', distance: 250, speed: 1.3 },
            { name: 'Saturn', mass: 95, radius: 14, color: '#F4A460', distance: 320, speed: 0.97 },
            { name: 'Uranus', mass: 14.5, radius: 10, color: '#4FD0E0', distance: 380, speed: 0.68 },
            { name: 'Neptune', mass: 17, radius: 10, color: '#4169E1', distance: 440, speed: 0.54 }
        ];

        class Body {
            constructor(name, mass, radius, color, x, y, vx, vy) {
                this.name = name;
                this.mass = mass;
                this.radius = radius;
                this.color = color;
                this.x = x;
                this.y = y;
                this.vx = vx;
                this.vy = vy;
                this.ax = 0;
                this.ay = 0;
                this.trail = [];
            }

            addTrailPoint() {
                this.trail.push({ x: this.x, y: this.y });
                if (this.trail.length > trailLength) {
                    this.trail.shift();
                }
            }

            draw(offsetX, offsetY) {
                const screenX = canvas.width / 2 + (this.x - offsetX) * zoom;
                const screenY = canvas.height / 2 + (this.y - offsetY) * zoom;

                // Draw trail
                if (showTrails && this.trail.length > 1) {
                    ctx.strokeStyle = this.color;
                    ctx.lineWidth = 1;
                    ctx.globalAlpha = 0.5;
                    ctx.beginPath();

                    for (let i = 0; i < this.trail.length; i++) {
                        const tx = canvas.width / 2 + (this.trail[i].x - offsetX) * zoom;
                        const ty = canvas.height / 2 + (this.trail[i].y - offsetY) * zoom;

                        if (i === 0) {
                            ctx.moveTo(tx, ty);
                        } else {
                            ctx.lineTo(tx, ty);
                        }
                    }
                    ctx.stroke();
                    ctx.globalAlpha = 1.0;
                }

                // Draw glow
                const glowRadius = this.radius * zoom;
                const gradient = ctx.createRadialGradient(screenX, screenY, 0, screenX, screenY, glowRadius * 2);
                gradient.addColorStop(0, this.color);
                gradient.addColorStop(0.5, this.color + '44');
                gradient.addColorStop(1, this.color + '00');

                ctx.fillStyle = gradient;
                ctx.beginPath();
                ctx.arc(screenX, screenY, glowRadius * 2, 0, Math.PI * 2);
                ctx.fill();

                // Draw body
                ctx.fillStyle = this.color;
                ctx.beginPath();
                ctx.arc(screenX, screenY, glowRadius, 0, Math.PI * 2);
                ctx.fill();

                // Draw name
                if (showNames) {
                    ctx.fillStyle = '#ffffff';
                    ctx.font = '12px Arial';
                    ctx.textAlign = 'center';
                    ctx.fillText(this.name, screenX, screenY - glowRadius - 5);
                }

                // Draw distance from Sun
                if (showDistances && this.name !== 'Sun') {
                    const dist = Math.sqrt(this.x * this.x + this.y * this.y);
                    ctx.fillStyle = '#cccccc';
                    ctx.font = '10px Arial';
                    ctx.fillText(dist.toFixed(1) + ' AU', screenX, screenY + glowRadius + 15);
                }
            }

            computeAcceleration(bodies) {
                this.ax = 0;
                this.ay = 0;

                for (let other of bodies) {
                    if (other === this) continue;

                    const dx = other.x - this.x;
                    const dy = other.y - this.y;
                    const r2 = dx * dx + dy * dy + SOFTENING * SOFTENING;
                    const r = Math.sqrt(r2);
                    const f = G * other.mass / r2;

                    this.ax += f * dx / r;
                    this.ay += f * dy / r;
                }
            }

            updateVelocityVerlet(dt, bodies) {
                // Velocity Verlet integration
                // v(t + dt/2) = v(t) + a(t) * dt/2
                const vx_half = this.vx + this.ax * dt / 2;
                const vy_half = this.vy + this.ay * dt / 2;

                // x(t + dt) = x(t) + v(t + dt/2) * dt
                this.x += vx_half * dt;
                this.y += vy_half * dt;

                // Compute new acceleration
                this.computeAcceleration(bodies);

                // v(t + dt) = v(t + dt/2) + a(t + dt) * dt/2
                this.vx = vx_half + this.ax * dt / 2;
                this.vy = vy_half + this.ay * dt / 2;
            }
        }

        function initBodies() {
            bodies = [];
            simTime = 0;

            // Create Sun
            const sun = planetData[0];
            bodies.push(new Body(sun.name, sun.mass, sun.radius, sun.color, sun.x, sun.y, sun.vx, sun.vy));

            // Create planets in circular orbits
            for (let i = 1; i < planetData.length; i++) {
                const planet = planetData[i];
                const angle = Math.random() * Math.PI * 2; // Random starting angle
                const x = Math.cos(angle) * planet.distance;
                const y = Math.sin(angle) * planet.distance;

                // Circular orbit velocity (perpendicular to radius)
                const vx = -Math.sin(angle) * planet.speed;
                const vy = Math.cos(angle) * planet.speed;

                bodies.push(new Body(planet.name, planet.mass, planet.radius, planet.color, x, y, vx, vy));
            }

            centerBody = bodies[0]; // Center on Sun initially
        }

        function drawGrid(offsetX, offsetY) {
            if (!showGrid) return;

            ctx.strokeStyle = 'rgba(255, 255, 255, 0.1)';
            ctx.lineWidth = 1;

            const gridSize = 50 * zoom;
            const startX = -(offsetX * zoom) % gridSize;
            const startY = -(offsetY * zoom) % gridSize;

            // Vertical lines
            for (let x = startX; x < canvas.width; x += gridSize) {
                ctx.beginPath();
                ctx.moveTo(x, 0);
                ctx.lineTo(x, canvas.height);
                ctx.stroke();
            }

            // Horizontal lines
            for (let y = startY; y < canvas.height; y += gridSize) {
                ctx.beginPath();
                ctx.moveTo(0, y);
                ctx.lineTo(canvas.width, y);
                ctx.stroke();
            }

            // Center cross
            ctx.strokeStyle = 'rgba(255, 215, 0, 0.3)';
            ctx.lineWidth = 2;
            const centerX = canvas.width / 2 - offsetX * zoom;
            const centerY = canvas.height / 2 - offsetY * zoom;

            ctx.beginPath();
            ctx.moveTo(centerX - 20, centerY);
            ctx.lineTo(centerX + 20, centerY);
            ctx.moveTo(centerX, centerY - 20);
            ctx.lineTo(centerX, centerY + 20);
            ctx.stroke();
        }

        function computeEnergy() {
            let totalEnergy = 0;

            // Kinetic energy
            for (let body of bodies) {
                const v2 = body.vx * body.vx + body.vy * body.vy;
                totalEnergy += 0.5 * body.mass * v2;
            }

            // Potential energy
            for (let i = 0; i < bodies.length; i++) {
                for (let j = i + 1; j < bodies.length; j++) {
                    const dx = bodies[j].x - bodies[i].x;
                    const dy = bodies[j].y - bodies[i].y;
                    const r = Math.sqrt(dx * dx + dy * dy + SOFTENING * SOFTENING);
                    totalEnergy -= G * bodies[i].mass * bodies[j].mass / r;
                }
            }

            return totalEnergy;
        }

        function updatePlanetInfo() {
            const info = document.getElementById('planetInfo');
            let html = '<div style="font-weight: bold; margin-bottom: 10px;">Planet Status:</div>';

            for (let body of bodies) {
                const speed = Math.sqrt(body.vx * body.vx + body.vy * body.vy);
                const distFromSun = Math.sqrt(body.x * body.x + body.y * body.y);

                html += `<div class="planet-row">
                    <span class="planet-name" style="color: ${body.color}">${body.name}</span>
                    <span>${distFromSun.toFixed(1)} AU | ${speed.toFixed(2)} v</span>
                </div>`;
            }

            info.innerHTML = html;
        }

        function update() {
            if (paused) return;

            const dt = DT * timeScale;

            // Update all bodies
            for (let body of bodies) {
                body.computeAcceleration(bodies);
            }

            for (let body of bodies) {
                body.updateVelocityVerlet(dt, bodies);

                if (frameCount % 3 === 0) {
                    body.addTrailPoint();
                }
            }

            simTime += dt;
        }

        function draw() {
            // Clear canvas
            ctx.fillStyle = 'rgba(0, 0, 0, 0.1)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // Calculate offset for centering
            let offsetX = 0, offsetY = 0;
            if (centerBody) {
                offsetX = centerBody.x;
                offsetY = centerBody.y;
            }

            // Draw grid
            drawGrid(offsetX, offsetY);

            // Draw all bodies
            for (let body of bodies) {
                body.draw(offsetX, offsetY);
            }

            // Update stats
            frameCount++;
            if (frameCount % 30 === 0) {
                const now = Date.now();
                fps = Math.round(30000 / (now - lastFpsUpdate));
                lastFpsUpdate = now;

                document.getElementById('fps').textContent = fps;
                document.getElementById('simTime').textContent = (simTime / 6.28).toFixed(2); // Convert to Earth years
                document.getElementById('energy').textContent = computeEnergy().toFixed(0);

                updatePlanetInfo();
            }
        }

        function animate() {
            update();
            draw();
            requestAnimationFrame(animate);
        }

        // Event listeners
        document.getElementById('timeScale').addEventListener('input', (e) => {
            timeScale = parseFloat(e.target.value);
            document.getElementById('timeScaleValue').textContent = timeScale.toFixed(1);
        });

        document.getElementById('trailLength').addEventListener('input', (e) => {
            trailLength = parseInt(e.target.value);
            document.getElementById('trailLengthValue').textContent = trailLength;
        });

        document.getElementById('zoom').addEventListener('input', (e) => {
            zoom = parseFloat(e.target.value);
            document.getElementById('zoomValue').textContent = zoom.toFixed(1);
        });

        document.getElementById('showTrails').addEventListener('change', (e) => {
            showTrails = e.target.checked;
        });

        document.getElementById('showNames').addEventListener('change', (e) => {
            showNames = e.target.checked;
        });

        document.getElementById('showDistances').addEventListener('change', (e) => {
            showDistances = e.target.checked;
        });

        document.getElementById('showGrid').addEventListener('change', (e) => {
            showGrid = e.target.checked;
        });

        document.getElementById('pauseBtn').addEventListener('click', () => {
            paused = !paused;
            document.getElementById('pauseBtn').textContent = paused ? 'Resume' : 'Pause';
        });

        document.getElementById('resetBtn').addEventListener('click', () => {
            initBodies();
        });

        document.getElementById('centerSun').addEventListener('click', () => {
            centerBody = bodies[0];
        });

        document.getElementById('centerEarth').addEventListener('click', () => {
            centerBody = bodies.find(b => b.name === 'Earth');
        });

        // Initialize and start
        initBodies();
        animate();
    </script>
</body>
</html>
